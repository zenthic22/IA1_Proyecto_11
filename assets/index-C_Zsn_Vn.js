function VA(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in n)){const r=Object.getOwnPropertyDescriptor(s,o);r&&Object.defineProperty(n,o,r.get?r:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();function pu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function UA(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var o=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:function(){return n[s]}})}),t}var fg={exports:{}},Bl={},mg={exports:{}},Qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gw;function GA(){if(gw)return Qe;gw=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),r=Symbol.for("react.provider"),i=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function f(L){return L===null||typeof L!="object"?null:(L=p&&L[p]||L["@@iterator"],typeof L=="function"?L:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function v(L,W,ie){this.props=L,this.context=W,this.refs=b,this.updater=ie||g}v.prototype.isReactComponent={},v.prototype.setState=function(L,W){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,W,"setState")},v.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function w(){}w.prototype=v.prototype;function C(L,W,ie){this.props=L,this.context=W,this.refs=b,this.updater=ie||g}var $=C.prototype=new w;$.constructor=C,y($,v.prototype),$.isPureReactComponent=!0;var S=Array.isArray,N=Object.prototype.hasOwnProperty,R={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function O(L,W,ie){var he,pe={},me=null,we=null;if(W!=null)for(he in W.ref!==void 0&&(we=W.ref),W.key!==void 0&&(me=""+W.key),W)N.call(W,he)&&!F.hasOwnProperty(he)&&(pe[he]=W[he]);var ke=arguments.length-2;if(ke===1)pe.children=ie;else if(1<ke){for(var Ce=Array(ke),Fe=0;Fe<ke;Fe++)Ce[Fe]=arguments[Fe+2];pe.children=Ce}if(L&&L.defaultProps)for(he in ke=L.defaultProps,ke)pe[he]===void 0&&(pe[he]=ke[he]);return{$$typeof:n,type:L,key:me,ref:we,props:pe,_owner:R.current}}function D(L,W){return{$$typeof:n,type:L.type,key:W,ref:L.ref,props:L.props,_owner:L._owner}}function A(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function T(L){var W={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(ie){return W[ie]})}var B=/\/+/g;function U(L,W){return typeof L=="object"&&L!==null&&L.key!=null?T(""+L.key):W.toString(36)}function Q(L,W,ie,he,pe){var me=typeof L;(me==="undefined"||me==="boolean")&&(L=null);var we=!1;if(L===null)we=!0;else switch(me){case"string":case"number":we=!0;break;case"object":switch(L.$$typeof){case n:case e:we=!0}}if(we)return we=L,pe=pe(we),L=he===""?"."+U(we,0):he,S(pe)?(ie="",L!=null&&(ie=L.replace(B,"$&/")+"/"),Q(pe,W,ie,"",function(Fe){return Fe})):pe!=null&&(A(pe)&&(pe=D(pe,ie+(!pe.key||we&&we.key===pe.key?"":(""+pe.key).replace(B,"$&/")+"/")+L)),W.push(pe)),1;if(we=0,he=he===""?".":he+":",S(L))for(var ke=0;ke<L.length;ke++){me=L[ke];var Ce=he+U(me,ke);we+=Q(me,W,ie,Ce,pe)}else if(Ce=f(L),typeof Ce=="function")for(L=Ce.call(L),ke=0;!(me=L.next()).done;)me=me.value,Ce=he+U(me,ke++),we+=Q(me,W,ie,Ce,pe);else if(me==="object")throw W=String(L),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.");return we}function K(L,W,ie){if(L==null)return L;var he=[],pe=0;return Q(L,he,"","",function(me){return W.call(ie,me,pe++)}),he}function J(L){if(L._status===-1){var W=L._result;W=W(),W.then(function(ie){(L._status===0||L._status===-1)&&(L._status=1,L._result=ie)},function(ie){(L._status===0||L._status===-1)&&(L._status=2,L._result=ie)}),L._status===-1&&(L._status=0,L._result=W)}if(L._status===1)return L._result.default;throw L._result}var te={current:null},P={transition:null},X={ReactCurrentDispatcher:te,ReactCurrentBatchConfig:P,ReactCurrentOwner:R};function Y(){throw Error("act(...) is not supported in production builds of React.")}return Qe.Children={map:K,forEach:function(L,W,ie){K(L,function(){W.apply(this,arguments)},ie)},count:function(L){var W=0;return K(L,function(){W++}),W},toArray:function(L){return K(L,function(W){return W})||[]},only:function(L){if(!A(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},Qe.Component=v,Qe.Fragment=t,Qe.Profiler=o,Qe.PureComponent=C,Qe.StrictMode=s,Qe.Suspense=u,Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Qe.act=Y,Qe.cloneElement=function(L,W,ie){if(L==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+L+".");var he=y({},L.props),pe=L.key,me=L.ref,we=L._owner;if(W!=null){if(W.ref!==void 0&&(me=W.ref,we=R.current),W.key!==void 0&&(pe=""+W.key),L.type&&L.type.defaultProps)var ke=L.type.defaultProps;for(Ce in W)N.call(W,Ce)&&!F.hasOwnProperty(Ce)&&(he[Ce]=W[Ce]===void 0&&ke!==void 0?ke[Ce]:W[Ce])}var Ce=arguments.length-2;if(Ce===1)he.children=ie;else if(1<Ce){ke=Array(Ce);for(var Fe=0;Fe<Ce;Fe++)ke[Fe]=arguments[Fe+2];he.children=ke}return{$$typeof:n,type:L.type,key:pe,ref:me,props:he,_owner:we}},Qe.createContext=function(L){return L={$$typeof:i,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:r,_context:L},L.Consumer=L},Qe.createElement=O,Qe.createFactory=function(L){var W=O.bind(null,L);return W.type=L,W},Qe.createRef=function(){return{current:null}},Qe.forwardRef=function(L){return{$$typeof:a,render:L}},Qe.isValidElement=A,Qe.lazy=function(L){return{$$typeof:h,_payload:{_status:-1,_result:L},_init:J}},Qe.memo=function(L,W){return{$$typeof:d,type:L,compare:W===void 0?null:W}},Qe.startTransition=function(L){var W=P.transition;P.transition={};try{L()}finally{P.transition=W}},Qe.unstable_act=Y,Qe.useCallback=function(L,W){return te.current.useCallback(L,W)},Qe.useContext=function(L){return te.current.useContext(L)},Qe.useDebugValue=function(){},Qe.useDeferredValue=function(L){return te.current.useDeferredValue(L)},Qe.useEffect=function(L,W){return te.current.useEffect(L,W)},Qe.useId=function(){return te.current.useId()},Qe.useImperativeHandle=function(L,W,ie){return te.current.useImperativeHandle(L,W,ie)},Qe.useInsertionEffect=function(L,W){return te.current.useInsertionEffect(L,W)},Qe.useLayoutEffect=function(L,W){return te.current.useLayoutEffect(L,W)},Qe.useMemo=function(L,W){return te.current.useMemo(L,W)},Qe.useReducer=function(L,W,ie){return te.current.useReducer(L,W,ie)},Qe.useRef=function(L){return te.current.useRef(L)},Qe.useState=function(L){return te.current.useState(L)},Qe.useSyncExternalStore=function(L,W,ie){return te.current.useSyncExternalStore(L,W,ie)},Qe.useTransition=function(){return te.current.useTransition()},Qe.version="18.3.1",Qe}var yw;function Ly(){return yw||(yw=1,mg.exports=GA()),mg.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xw;function jA(){if(xw)return Bl;xw=1;var n=Ly(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function i(a,u,d){var h,p={},f=null,g=null;d!==void 0&&(f=""+d),u.key!==void 0&&(f=""+u.key),u.ref!==void 0&&(g=u.ref);for(h in u)s.call(u,h)&&!r.hasOwnProperty(h)&&(p[h]=u[h]);if(a&&a.defaultProps)for(h in u=a.defaultProps,u)p[h]===void 0&&(p[h]=u[h]);return{$$typeof:e,type:a,key:f,ref:g,props:p,_owner:o.current}}return Bl.Fragment=t,Bl.jsx=i,Bl.jsxs=i,Bl}var bw;function HA(){return bw||(bw=1,fg.exports=jA()),fg.exports}var oe=HA(),ue=Ly();const di=pu(ue);var Wd={},gg={exports:{}},Qn={},yg={exports:{}},xg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vw;function qA(){return vw||(vw=1,function(n){function e(P,X){var Y=P.length;P.push(X);e:for(;0<Y;){var L=Y-1>>>1,W=P[L];if(0<o(W,X))P[L]=X,P[Y]=W,Y=L;else break e}}function t(P){return P.length===0?null:P[0]}function s(P){if(P.length===0)return null;var X=P[0],Y=P.pop();if(Y!==X){P[0]=Y;e:for(var L=0,W=P.length,ie=W>>>1;L<ie;){var he=2*(L+1)-1,pe=P[he],me=he+1,we=P[me];if(0>o(pe,Y))me<W&&0>o(we,pe)?(P[L]=we,P[me]=Y,L=me):(P[L]=pe,P[he]=Y,L=he);else if(me<W&&0>o(we,Y))P[L]=we,P[me]=Y,L=me;else break e}}return X}function o(P,X){var Y=P.sortIndex-X.sortIndex;return Y!==0?Y:P.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var i=Date,a=i.now();n.unstable_now=function(){return i.now()-a}}var u=[],d=[],h=1,p=null,f=3,g=!1,y=!1,b=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function $(P){for(var X=t(d);X!==null;){if(X.callback===null)s(d);else if(X.startTime<=P)s(d),X.sortIndex=X.expirationTime,e(u,X);else break;X=t(d)}}function S(P){if(b=!1,$(P),!y)if(t(u)!==null)y=!0,J(N);else{var X=t(d);X!==null&&te(S,X.startTime-P)}}function N(P,X){y=!1,b&&(b=!1,w(O),O=-1),g=!0;var Y=f;try{for($(X),p=t(u);p!==null&&(!(p.expirationTime>X)||P&&!T());){var L=p.callback;if(typeof L=="function"){p.callback=null,f=p.priorityLevel;var W=L(p.expirationTime<=X);X=n.unstable_now(),typeof W=="function"?p.callback=W:p===t(u)&&s(u),$(X)}else s(u);p=t(u)}if(p!==null)var ie=!0;else{var he=t(d);he!==null&&te(S,he.startTime-X),ie=!1}return ie}finally{p=null,f=Y,g=!1}}var R=!1,F=null,O=-1,D=5,A=-1;function T(){return!(n.unstable_now()-A<D)}function B(){if(F!==null){var P=n.unstable_now();A=P;var X=!0;try{X=F(!0,P)}finally{X?U():(R=!1,F=null)}}else R=!1}var U;if(typeof C=="function")U=function(){C(B)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,K=Q.port2;Q.port1.onmessage=B,U=function(){K.postMessage(null)}}else U=function(){v(B,0)};function J(P){F=P,R||(R=!0,U())}function te(P,X){O=v(function(){P(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(P){P.callback=null},n.unstable_continueExecution=function(){y||g||(y=!0,J(N))},n.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<P?Math.floor(1e3/P):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(u)},n.unstable_next=function(P){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var Y=f;f=X;try{return P()}finally{f=Y}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(P,X){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var Y=f;f=P;try{return X()}finally{f=Y}},n.unstable_scheduleCallback=function(P,X,Y){var L=n.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?L+Y:L):Y=L,P){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=Y+W,P={id:h++,callback:X,priorityLevel:P,startTime:Y,expirationTime:W,sortIndex:-1},Y>L?(P.sortIndex=Y,e(d,P),t(u)===null&&P===t(d)&&(b?(w(O),O=-1):b=!0,te(S,Y-L))):(P.sortIndex=W,e(u,P),y||g||(y=!0,J(N))),P},n.unstable_shouldYield=T,n.unstable_wrapCallback=function(P){var X=f;return function(){var Y=f;f=X;try{return P.apply(this,arguments)}finally{f=Y}}}}(xg)),xg}var ww;function KA(){return ww||(ww=1,yg.exports=qA()),yg.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kw;function XA(){if(kw)return Qn;kw=1;var n=Ly(),e=KA();function t(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,m=1;m<arguments.length;m++)c+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function r(l,c){i(l,c),i(l+"Capture",c)}function i(l,c){for(o[l]=c,l=0;l<c.length;l++)s.add(c[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function f(l){return u.call(p,l)?!0:u.call(h,l)?!1:d.test(l)?p[l]=!0:(h[l]=!0,!1)}function g(l,c,m,x){if(m!==null&&m.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return x?!1:m!==null?!m.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function y(l,c,m,x){if(c===null||typeof c>"u"||g(l,c,m,x))return!0;if(x)return!1;if(m!==null)switch(m.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function b(l,c,m,x,k,I,E){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=x,this.attributeNamespace=k,this.mustUseProperty=m,this.propertyName=l,this.type=c,this.sanitizeURL=I,this.removeEmptyString=E}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){v[l]=new b(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var c=l[0];v[c]=new b(c,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){v[l]=new b(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){v[l]=new b(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){v[l]=new b(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){v[l]=new b(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){v[l]=new b(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){v[l]=new b(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){v[l]=new b(l,5,!1,l.toLowerCase(),null,!1,!1)});var w=/[\-:]([a-z])/g;function C(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var c=l.replace(w,C);v[c]=new b(c,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var c=l.replace(w,C);v[c]=new b(c,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var c=l.replace(w,C);v[c]=new b(c,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){v[l]=new b(l,1,!1,l.toLowerCase(),null,!1,!1)}),v.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){v[l]=new b(l,1,!1,l.toLowerCase(),null,!0,!0)});function $(l,c,m,x){var k=v.hasOwnProperty(c)?v[c]:null;(k!==null?k.type!==0:x||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,m,k,x)&&(m=null),x||k===null?f(c)&&(m===null?l.removeAttribute(c):l.setAttribute(c,""+m)):k.mustUseProperty?l[k.propertyName]=m===null?k.type===3?!1:"":m:(c=k.attributeName,x=k.attributeNamespace,m===null?l.removeAttribute(c):(k=k.type,m=k===3||k===4&&m===!0?"":""+m,x?l.setAttributeNS(x,c,m):l.setAttribute(c,m))))}var S=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),R=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),T=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),P=Symbol.iterator;function X(l){return l===null||typeof l!="object"?null:(l=P&&l[P]||l["@@iterator"],typeof l=="function"?l:null)}var Y=Object.assign,L;function W(l){if(L===void 0)try{throw Error()}catch(m){var c=m.stack.trim().match(/\n( *(at )?)/);L=c&&c[1]||""}return`
`+L+l}var ie=!1;function he(l,c){if(!l||ie)return"";ie=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(le){var x=le}Reflect.construct(l,[],c)}else{try{c.call()}catch(le){x=le}l.call(c.prototype)}else{try{throw Error()}catch(le){x=le}l()}}catch(le){if(le&&x&&typeof le.stack=="string"){for(var k=le.stack.split(`
`),I=x.stack.split(`
`),E=k.length-1,M=I.length-1;1<=E&&0<=M&&k[E]!==I[M];)M--;for(;1<=E&&0<=M;E--,M--)if(k[E]!==I[M]){if(E!==1||M!==1)do if(E--,M--,0>M||k[E]!==I[M]){var V=`
`+k[E].replace(" at new "," at ");return l.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",l.displayName)),V}while(1<=E&&0<=M);break}}}finally{ie=!1,Error.prepareStackTrace=m}return(l=l?l.displayName||l.name:"")?W(l):""}function pe(l){switch(l.tag){case 5:return W(l.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return l=he(l.type,!1),l;case 11:return l=he(l.type.render,!1),l;case 1:return l=he(l.type,!0),l;default:return""}}function me(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case F:return"Fragment";case R:return"Portal";case D:return"Profiler";case O:return"StrictMode";case U:return"Suspense";case Q:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case T:return(l.displayName||"Context")+".Consumer";case A:return(l._context.displayName||"Context")+".Provider";case B:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case K:return c=l.displayName||null,c!==null?c:me(l.type)||"Memo";case J:c=l._payload,l=l._init;try{return me(l(c))}catch{}}return null}function we(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(c);case 8:return c===O?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function ke(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Ce(l){var c=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Fe(l){var c=Ce(l)?"checked":"value",m=Object.getOwnPropertyDescriptor(l.constructor.prototype,c),x=""+l[c];if(!l.hasOwnProperty(c)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var k=m.get,I=m.set;return Object.defineProperty(l,c,{configurable:!0,get:function(){return k.call(this)},set:function(E){x=""+E,I.call(this,E)}}),Object.defineProperty(l,c,{enumerable:m.enumerable}),{getValue:function(){return x},setValue:function(E){x=""+E},stopTracking:function(){l._valueTracker=null,delete l[c]}}}}function Ue(l){l._valueTracker||(l._valueTracker=Fe(l))}function Ze(l){if(!l)return!1;var c=l._valueTracker;if(!c)return!0;var m=c.getValue(),x="";return l&&(x=Ce(l)?l.checked?"true":"false":l.value),l=x,l!==m?(c.setValue(l),!0):!1}function et(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function at(l,c){var m=c.checked;return Y({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??l._wrapperState.initialChecked})}function Pe(l,c){var m=c.defaultValue==null?"":c.defaultValue,x=c.checked!=null?c.checked:c.defaultChecked;m=ke(c.value!=null?c.value:m),l._wrapperState={initialChecked:x,initialValue:m,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function tt(l,c){c=c.checked,c!=null&&$(l,"checked",c,!1)}function lt(l,c){tt(l,c);var m=ke(c.value),x=c.type;if(m!=null)x==="number"?(m===0&&l.value===""||l.value!=m)&&(l.value=""+m):l.value!==""+m&&(l.value=""+m);else if(x==="submit"||x==="reset"){l.removeAttribute("value");return}c.hasOwnProperty("value")?os(l,c.type,m):c.hasOwnProperty("defaultValue")&&os(l,c.type,ke(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(l.defaultChecked=!!c.defaultChecked)}function xt(l,c,m){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var x=c.type;if(!(x!=="submit"&&x!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+l._wrapperState.initialValue,m||c===l.value||(l.value=c),l.defaultValue=c}m=l.name,m!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,m!==""&&(l.name=m)}function os(l,c,m){(c!=="number"||et(l.ownerDocument)!==l)&&(m==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+m&&(l.defaultValue=""+m))}var Et=Array.isArray;function On(l,c,m,x){if(l=l.options,c){c={};for(var k=0;k<m.length;k++)c["$"+m[k]]=!0;for(m=0;m<l.length;m++)k=c.hasOwnProperty("$"+l[m].value),l[m].selected!==k&&(l[m].selected=k),k&&x&&(l[m].defaultSelected=!0)}else{for(m=""+ke(m),c=null,k=0;k<l.length;k++){if(l[k].value===m){l[k].selected=!0,x&&(l[k].defaultSelected=!0);return}c!==null||l[k].disabled||(c=l[k])}c!==null&&(c.selected=!0)}}function mn(l,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return Y({},c,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function to(l,c){var m=c.value;if(m==null){if(m=c.children,c=c.defaultValue,m!=null){if(c!=null)throw Error(t(92));if(Et(m)){if(1<m.length)throw Error(t(93));m=m[0]}c=m}c==null&&(c=""),m=c}l._wrapperState={initialValue:ke(m)}}function jn(l,c){var m=ke(c.value),x=ke(c.defaultValue);m!=null&&(m=""+m,m!==l.value&&(l.value=m),c.defaultValue==null&&l.defaultValue!==m&&(l.defaultValue=m)),x!=null&&(l.defaultValue=""+x)}function gs(l){var c=l.textContent;c===l._wrapperState.initialValue&&c!==""&&c!==null&&(l.value=c)}function Os(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ys(l,c){return l==null||l==="http://www.w3.org/1999/xhtml"?Os(c):l==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var rs,Jo=function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,m,x,k){MSApp.execUnsafeLocalFunction(function(){return l(c,m,x,k)})}:l}(function(l,c){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=c;else{for(rs=rs||document.createElement("div"),rs.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=rs.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;c.firstChild;)l.appendChild(c.firstChild)}});function No(l,c){if(c){var m=l.firstChild;if(m&&m===l.lastChild&&m.nodeType===3){m.nodeValue=c;return}}l.textContent=c}var To={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},If=["Webkit","ms","Moz","O"];Object.keys(To).forEach(function(l){If.forEach(function(c){c=c+l.charAt(0).toUpperCase()+l.substring(1),To[c]=To[l]})});function Ur(l,c,m){return c==null||typeof c=="boolean"||c===""?"":m||typeof c!="number"||c===0||To.hasOwnProperty(l)&&To[l]?(""+c).trim():c+"px"}function Fc(l,c){l=l.style;for(var m in c)if(c.hasOwnProperty(m)){var x=m.indexOf("--")===0,k=Ur(m,c[m],x);m==="float"&&(m="cssFloat"),x?l.setProperty(m,k):l[m]=k}}var Sf=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $f(l,c){if(c){if(Sf[l]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function Nf(l,c){if(l.indexOf("-")===-1)return typeof c.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tf=null;function Ef(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Rf=null,Vi=null,Ui=null;function F1(l){if(l=Sl(l)){if(typeof Rf!="function")throw Error(t(280));var c=l.stateNode;c&&(c=nd(c),Rf(l.stateNode,l.type,c))}}function _1(l){Vi?Ui?Ui.push(l):Ui=[l]:Vi=l}function O1(){if(Vi){var l=Vi,c=Ui;if(Ui=Vi=null,F1(l),c)for(l=0;l<c.length;l++)F1(c[l])}}function L1(l,c){return l(c)}function M1(){}var Af=!1;function P1(l,c,m){if(Af)return l(c,m);Af=!0;try{return L1(l,c,m)}finally{Af=!1,(Vi!==null||Ui!==null)&&(M1(),O1())}}function ol(l,c){var m=l.stateNode;if(m===null)return null;var x=nd(m);if(x===null)return null;m=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(l=l.type,x=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!x;break e;default:l=!1}if(l)return null;if(m&&typeof m!="function")throw Error(t(231,c,typeof m));return m}var Df=!1;if(a)try{var rl={};Object.defineProperty(rl,"passive",{get:function(){Df=!0}}),window.addEventListener("test",rl,rl),window.removeEventListener("test",rl,rl)}catch{Df=!1}function KE(l,c,m,x,k,I,E,M,V){var le=Array.prototype.slice.call(arguments,3);try{c.apply(m,le)}catch(ye){this.onError(ye)}}var il=!1,_c=null,Oc=!1,Ff=null,XE={onError:function(l){il=!0,_c=l}};function YE(l,c,m,x,k,I,E,M,V){il=!1,_c=null,KE.apply(XE,arguments)}function QE(l,c,m,x,k,I,E,M,V){if(YE.apply(this,arguments),il){if(il){var le=_c;il=!1,_c=null}else throw Error(t(198));Oc||(Oc=!0,Ff=le)}}function Gr(l){var c=l,m=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,c.flags&4098&&(m=c.return),l=c.return;while(l)}return c.tag===3?m:null}function z1(l){if(l.tag===13){var c=l.memoizedState;if(c===null&&(l=l.alternate,l!==null&&(c=l.memoizedState)),c!==null)return c.dehydrated}return null}function B1(l){if(Gr(l)!==l)throw Error(t(188))}function JE(l){var c=l.alternate;if(!c){if(c=Gr(l),c===null)throw Error(t(188));return c!==l?null:l}for(var m=l,x=c;;){var k=m.return;if(k===null)break;var I=k.alternate;if(I===null){if(x=k.return,x!==null){m=x;continue}break}if(k.child===I.child){for(I=k.child;I;){if(I===m)return B1(k),l;if(I===x)return B1(k),c;I=I.sibling}throw Error(t(188))}if(m.return!==x.return)m=k,x=I;else{for(var E=!1,M=k.child;M;){if(M===m){E=!0,m=k,x=I;break}if(M===x){E=!0,x=k,m=I;break}M=M.sibling}if(!E){for(M=I.child;M;){if(M===m){E=!0,m=I,x=k;break}if(M===x){E=!0,x=I,m=k;break}M=M.sibling}if(!E)throw Error(t(189))}}if(m.alternate!==x)throw Error(t(190))}if(m.tag!==3)throw Error(t(188));return m.stateNode.current===m?l:c}function W1(l){return l=JE(l),l!==null?V1(l):null}function V1(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=V1(l);if(c!==null)return c;l=l.sibling}return null}var U1=e.unstable_scheduleCallback,G1=e.unstable_cancelCallback,ZE=e.unstable_shouldYield,eR=e.unstable_requestPaint,Vt=e.unstable_now,tR=e.unstable_getCurrentPriorityLevel,_f=e.unstable_ImmediatePriority,j1=e.unstable_UserBlockingPriority,Lc=e.unstable_NormalPriority,nR=e.unstable_LowPriority,H1=e.unstable_IdlePriority,Mc=null,no=null;function sR(l){if(no&&typeof no.onCommitFiberRoot=="function")try{no.onCommitFiberRoot(Mc,l,void 0,(l.current.flags&128)===128)}catch{}}var Ls=Math.clz32?Math.clz32:iR,oR=Math.log,rR=Math.LN2;function iR(l){return l>>>=0,l===0?32:31-(oR(l)/rR|0)|0}var Pc=64,zc=4194304;function al(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Bc(l,c){var m=l.pendingLanes;if(m===0)return 0;var x=0,k=l.suspendedLanes,I=l.pingedLanes,E=m&268435455;if(E!==0){var M=E&~k;M!==0?x=al(M):(I&=E,I!==0&&(x=al(I)))}else E=m&~k,E!==0?x=al(E):I!==0&&(x=al(I));if(x===0)return 0;if(c!==0&&c!==x&&!(c&k)&&(k=x&-x,I=c&-c,k>=I||k===16&&(I&4194240)!==0))return c;if(x&4&&(x|=m&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=x;0<c;)m=31-Ls(c),k=1<<m,x|=l[m],c&=~k;return x}function aR(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lR(l,c){for(var m=l.suspendedLanes,x=l.pingedLanes,k=l.expirationTimes,I=l.pendingLanes;0<I;){var E=31-Ls(I),M=1<<E,V=k[E];V===-1?(!(M&m)||M&x)&&(k[E]=aR(M,c)):V<=c&&(l.expiredLanes|=M),I&=~M}}function Of(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function q1(){var l=Pc;return Pc<<=1,!(Pc&4194240)&&(Pc=64),l}function Lf(l){for(var c=[],m=0;31>m;m++)c.push(l);return c}function ll(l,c,m){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-Ls(c),l[c]=m}function uR(l,c){var m=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var x=l.eventTimes;for(l=l.expirationTimes;0<m;){var k=31-Ls(m),I=1<<k;c[k]=0,x[k]=-1,l[k]=-1,m&=~I}}function Mf(l,c){var m=l.entangledLanes|=c;for(l=l.entanglements;m;){var x=31-Ls(m),k=1<<x;k&c|l[x]&c&&(l[x]|=c),m&=~k}}var gt=0;function K1(l){return l&=-l,1<l?4<l?l&268435455?16:536870912:4:1}var X1,Pf,Y1,Q1,J1,zf=!1,Wc=[],Zo=null,er=null,tr=null,ul=new Map,cl=new Map,nr=[],cR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Z1(l,c){switch(l){case"focusin":case"focusout":Zo=null;break;case"dragenter":case"dragleave":er=null;break;case"mouseover":case"mouseout":tr=null;break;case"pointerover":case"pointerout":ul.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":cl.delete(c.pointerId)}}function dl(l,c,m,x,k,I){return l===null||l.nativeEvent!==I?(l={blockedOn:c,domEventName:m,eventSystemFlags:x,nativeEvent:I,targetContainers:[k]},c!==null&&(c=Sl(c),c!==null&&Pf(c)),l):(l.eventSystemFlags|=x,c=l.targetContainers,k!==null&&c.indexOf(k)===-1&&c.push(k),l)}function dR(l,c,m,x,k){switch(c){case"focusin":return Zo=dl(Zo,l,c,m,x,k),!0;case"dragenter":return er=dl(er,l,c,m,x,k),!0;case"mouseover":return tr=dl(tr,l,c,m,x,k),!0;case"pointerover":var I=k.pointerId;return ul.set(I,dl(ul.get(I)||null,l,c,m,x,k)),!0;case"gotpointercapture":return I=k.pointerId,cl.set(I,dl(cl.get(I)||null,l,c,m,x,k)),!0}return!1}function eb(l){var c=jr(l.target);if(c!==null){var m=Gr(c);if(m!==null){if(c=m.tag,c===13){if(c=z1(m),c!==null){l.blockedOn=c,J1(l.priority,function(){Y1(m)});return}}else if(c===3&&m.stateNode.current.memoizedState.isDehydrated){l.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Vc(l){if(l.blockedOn!==null)return!1;for(var c=l.targetContainers;0<c.length;){var m=Wf(l.domEventName,l.eventSystemFlags,c[0],l.nativeEvent);if(m===null){m=l.nativeEvent;var x=new m.constructor(m.type,m);Tf=x,m.target.dispatchEvent(x),Tf=null}else return c=Sl(m),c!==null&&Pf(c),l.blockedOn=m,!1;c.shift()}return!0}function tb(l,c,m){Vc(l)&&m.delete(c)}function hR(){zf=!1,Zo!==null&&Vc(Zo)&&(Zo=null),er!==null&&Vc(er)&&(er=null),tr!==null&&Vc(tr)&&(tr=null),ul.forEach(tb),cl.forEach(tb)}function hl(l,c){l.blockedOn===c&&(l.blockedOn=null,zf||(zf=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,hR)))}function pl(l){function c(k){return hl(k,l)}if(0<Wc.length){hl(Wc[0],l);for(var m=1;m<Wc.length;m++){var x=Wc[m];x.blockedOn===l&&(x.blockedOn=null)}}for(Zo!==null&&hl(Zo,l),er!==null&&hl(er,l),tr!==null&&hl(tr,l),ul.forEach(c),cl.forEach(c),m=0;m<nr.length;m++)x=nr[m],x.blockedOn===l&&(x.blockedOn=null);for(;0<nr.length&&(m=nr[0],m.blockedOn===null);)eb(m),m.blockedOn===null&&nr.shift()}var Gi=S.ReactCurrentBatchConfig,Uc=!0;function pR(l,c,m,x){var k=gt,I=Gi.transition;Gi.transition=null;try{gt=1,Bf(l,c,m,x)}finally{gt=k,Gi.transition=I}}function fR(l,c,m,x){var k=gt,I=Gi.transition;Gi.transition=null;try{gt=4,Bf(l,c,m,x)}finally{gt=k,Gi.transition=I}}function Bf(l,c,m,x){if(Uc){var k=Wf(l,c,m,x);if(k===null)om(l,c,x,Gc,m),Z1(l,x);else if(dR(k,l,c,m,x))x.stopPropagation();else if(Z1(l,x),c&4&&-1<cR.indexOf(l)){for(;k!==null;){var I=Sl(k);if(I!==null&&X1(I),I=Wf(l,c,m,x),I===null&&om(l,c,x,Gc,m),I===k)break;k=I}k!==null&&x.stopPropagation()}else om(l,c,x,null,m)}}var Gc=null;function Wf(l,c,m,x){if(Gc=null,l=Ef(x),l=jr(l),l!==null)if(c=Gr(l),c===null)l=null;else if(m=c.tag,m===13){if(l=z1(c),l!==null)return l;l=null}else if(m===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;l=null}else c!==l&&(l=null);return Gc=l,null}function nb(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tR()){case _f:return 1;case j1:return 4;case Lc:case nR:return 16;case H1:return 536870912;default:return 16}default:return 16}}var sr=null,Vf=null,jc=null;function sb(){if(jc)return jc;var l,c=Vf,m=c.length,x,k="value"in sr?sr.value:sr.textContent,I=k.length;for(l=0;l<m&&c[l]===k[l];l++);var E=m-l;for(x=1;x<=E&&c[m-x]===k[I-x];x++);return jc=k.slice(l,1<x?1-x:void 0)}function Hc(l){var c=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&c===13&&(l=13)):l=c,l===10&&(l=13),32<=l||l===13?l:0}function qc(){return!0}function ob(){return!1}function is(l){function c(m,x,k,I,E){this._reactName=m,this._targetInst=k,this.type=x,this.nativeEvent=I,this.target=E,this.currentTarget=null;for(var M in l)l.hasOwnProperty(M)&&(m=l[M],this[M]=m?m(I):I[M]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?qc:ob,this.isPropagationStopped=ob,this}return Y(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=qc)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=qc)},persist:function(){},isPersistent:qc}),c}var ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uf=is(ji),fl=Y({},ji,{view:0,detail:0}),mR=is(fl),Gf,jf,ml,Kc=Y({},fl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qf,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==ml&&(ml&&l.type==="mousemove"?(Gf=l.screenX-ml.screenX,jf=l.screenY-ml.screenY):jf=Gf=0,ml=l),Gf)},movementY:function(l){return"movementY"in l?l.movementY:jf}}),rb=is(Kc),gR=Y({},Kc,{dataTransfer:0}),yR=is(gR),xR=Y({},fl,{relatedTarget:0}),Hf=is(xR),bR=Y({},ji,{animationName:0,elapsedTime:0,pseudoElement:0}),vR=is(bR),wR=Y({},ji,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),kR=is(wR),CR=Y({},ji,{data:0}),ib=is(CR),IR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},SR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$R={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NR(l){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(l):(l=$R[l])?!!c[l]:!1}function qf(){return NR}var TR=Y({},fl,{key:function(l){if(l.key){var c=IR[l.key]||l.key;if(c!=="Unidentified")return c}return l.type==="keypress"?(l=Hc(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?SR[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qf,charCode:function(l){return l.type==="keypress"?Hc(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Hc(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),ER=is(TR),RR=Y({},Kc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ab=is(RR),AR=Y({},fl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qf}),DR=is(AR),FR=Y({},ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),_R=is(FR),OR=Y({},Kc,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),LR=is(OR),MR=[9,13,27,32],Kf=a&&"CompositionEvent"in window,gl=null;a&&"documentMode"in document&&(gl=document.documentMode);var PR=a&&"TextEvent"in window&&!gl,lb=a&&(!Kf||gl&&8<gl&&11>=gl),ub=" ",cb=!1;function db(l,c){switch(l){case"keyup":return MR.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hb(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Hi=!1;function zR(l,c){switch(l){case"compositionend":return hb(c);case"keypress":return c.which!==32?null:(cb=!0,ub);case"textInput":return l=c.data,l===ub&&cb?null:l;default:return null}}function BR(l,c){if(Hi)return l==="compositionend"||!Kf&&db(l,c)?(l=sb(),jc=Vf=sr=null,Hi=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return lb&&c.locale!=="ko"?null:c.data;default:return null}}var WR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pb(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c==="input"?!!WR[l.type]:c==="textarea"}function fb(l,c,m,x){_1(x),c=Zc(c,"onChange"),0<c.length&&(m=new Uf("onChange","change",null,m,x),l.push({event:m,listeners:c}))}var yl=null,xl=null;function VR(l){Db(l,0)}function Xc(l){var c=Qi(l);if(Ze(c))return l}function UR(l,c){if(l==="change")return c}var mb=!1;if(a){var Xf;if(a){var Yf="oninput"in document;if(!Yf){var gb=document.createElement("div");gb.setAttribute("oninput","return;"),Yf=typeof gb.oninput=="function"}Xf=Yf}else Xf=!1;mb=Xf&&(!document.documentMode||9<document.documentMode)}function yb(){yl&&(yl.detachEvent("onpropertychange",xb),xl=yl=null)}function xb(l){if(l.propertyName==="value"&&Xc(xl)){var c=[];fb(c,xl,l,Ef(l)),P1(VR,c)}}function GR(l,c,m){l==="focusin"?(yb(),yl=c,xl=m,yl.attachEvent("onpropertychange",xb)):l==="focusout"&&yb()}function jR(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Xc(xl)}function HR(l,c){if(l==="click")return Xc(c)}function qR(l,c){if(l==="input"||l==="change")return Xc(c)}function KR(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var Ms=typeof Object.is=="function"?Object.is:KR;function bl(l,c){if(Ms(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var m=Object.keys(l),x=Object.keys(c);if(m.length!==x.length)return!1;for(x=0;x<m.length;x++){var k=m[x];if(!u.call(c,k)||!Ms(l[k],c[k]))return!1}return!0}function bb(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function vb(l,c){var m=bb(l);l=0;for(var x;m;){if(m.nodeType===3){if(x=l+m.textContent.length,l<=c&&x>=c)return{node:m,offset:c-l};l=x}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=bb(m)}}function wb(l,c){return l&&c?l===c?!0:l&&l.nodeType===3?!1:c&&c.nodeType===3?wb(l,c.parentNode):"contains"in l?l.contains(c):l.compareDocumentPosition?!!(l.compareDocumentPosition(c)&16):!1:!1}function kb(){for(var l=window,c=et();c instanceof l.HTMLIFrameElement;){try{var m=typeof c.contentWindow.location.href=="string"}catch{m=!1}if(m)l=c.contentWindow;else break;c=et(l.document)}return c}function Qf(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c&&(c==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||c==="textarea"||l.contentEditable==="true")}function XR(l){var c=kb(),m=l.focusedElem,x=l.selectionRange;if(c!==m&&m&&m.ownerDocument&&wb(m.ownerDocument.documentElement,m)){if(x!==null&&Qf(m)){if(c=x.start,l=x.end,l===void 0&&(l=c),"selectionStart"in m)m.selectionStart=c,m.selectionEnd=Math.min(l,m.value.length);else if(l=(c=m.ownerDocument||document)&&c.defaultView||window,l.getSelection){l=l.getSelection();var k=m.textContent.length,I=Math.min(x.start,k);x=x.end===void 0?I:Math.min(x.end,k),!l.extend&&I>x&&(k=x,x=I,I=k),k=vb(m,I);var E=vb(m,x);k&&E&&(l.rangeCount!==1||l.anchorNode!==k.node||l.anchorOffset!==k.offset||l.focusNode!==E.node||l.focusOffset!==E.offset)&&(c=c.createRange(),c.setStart(k.node,k.offset),l.removeAllRanges(),I>x?(l.addRange(c),l.extend(E.node,E.offset)):(c.setEnd(E.node,E.offset),l.addRange(c)))}}for(c=[],l=m;l=l.parentNode;)l.nodeType===1&&c.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<c.length;m++)l=c[m],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var YR=a&&"documentMode"in document&&11>=document.documentMode,qi=null,Jf=null,vl=null,Zf=!1;function Cb(l,c,m){var x=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;Zf||qi==null||qi!==et(x)||(x=qi,"selectionStart"in x&&Qf(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),vl&&bl(vl,x)||(vl=x,x=Zc(Jf,"onSelect"),0<x.length&&(c=new Uf("onSelect","select",null,c,m),l.push({event:c,listeners:x}),c.target=qi)))}function Yc(l,c){var m={};return m[l.toLowerCase()]=c.toLowerCase(),m["Webkit"+l]="webkit"+c,m["Moz"+l]="moz"+c,m}var Ki={animationend:Yc("Animation","AnimationEnd"),animationiteration:Yc("Animation","AnimationIteration"),animationstart:Yc("Animation","AnimationStart"),transitionend:Yc("Transition","TransitionEnd")},em={},Ib={};a&&(Ib=document.createElement("div").style,"AnimationEvent"in window||(delete Ki.animationend.animation,delete Ki.animationiteration.animation,delete Ki.animationstart.animation),"TransitionEvent"in window||delete Ki.transitionend.transition);function Qc(l){if(em[l])return em[l];if(!Ki[l])return l;var c=Ki[l],m;for(m in c)if(c.hasOwnProperty(m)&&m in Ib)return em[l]=c[m];return l}var Sb=Qc("animationend"),$b=Qc("animationiteration"),Nb=Qc("animationstart"),Tb=Qc("transitionend"),Eb=new Map,Rb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function or(l,c){Eb.set(l,c),r(c,[l])}for(var tm=0;tm<Rb.length;tm++){var nm=Rb[tm],QR=nm.toLowerCase(),JR=nm[0].toUpperCase()+nm.slice(1);or(QR,"on"+JR)}or(Sb,"onAnimationEnd"),or($b,"onAnimationIteration"),or(Nb,"onAnimationStart"),or("dblclick","onDoubleClick"),or("focusin","onFocus"),or("focusout","onBlur"),or(Tb,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),r("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),r("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),r("onBeforeInput",["compositionend","keypress","textInput","paste"]),r("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZR=new Set("cancel close invalid load scroll toggle".split(" ").concat(wl));function Ab(l,c,m){var x=l.type||"unknown-event";l.currentTarget=m,QE(x,c,void 0,l),l.currentTarget=null}function Db(l,c){c=(c&4)!==0;for(var m=0;m<l.length;m++){var x=l[m],k=x.event;x=x.listeners;e:{var I=void 0;if(c)for(var E=x.length-1;0<=E;E--){var M=x[E],V=M.instance,le=M.currentTarget;if(M=M.listener,V!==I&&k.isPropagationStopped())break e;Ab(k,M,le),I=V}else for(E=0;E<x.length;E++){if(M=x[E],V=M.instance,le=M.currentTarget,M=M.listener,V!==I&&k.isPropagationStopped())break e;Ab(k,M,le),I=V}}}if(Oc)throw l=Ff,Oc=!1,Ff=null,l}function St(l,c){var m=c[cm];m===void 0&&(m=c[cm]=new Set);var x=l+"__bubble";m.has(x)||(Fb(c,l,2,!1),m.add(x))}function sm(l,c,m){var x=0;c&&(x|=4),Fb(m,l,x,c)}var Jc="_reactListening"+Math.random().toString(36).slice(2);function kl(l){if(!l[Jc]){l[Jc]=!0,s.forEach(function(m){m!=="selectionchange"&&(ZR.has(m)||sm(m,!1,l),sm(m,!0,l))});var c=l.nodeType===9?l:l.ownerDocument;c===null||c[Jc]||(c[Jc]=!0,sm("selectionchange",!1,c))}}function Fb(l,c,m,x){switch(nb(c)){case 1:var k=pR;break;case 4:k=fR;break;default:k=Bf}m=k.bind(null,c,m,l),k=void 0,!Df||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(k=!0),x?k!==void 0?l.addEventListener(c,m,{capture:!0,passive:k}):l.addEventListener(c,m,!0):k!==void 0?l.addEventListener(c,m,{passive:k}):l.addEventListener(c,m,!1)}function om(l,c,m,x,k){var I=x;if(!(c&1)&&!(c&2)&&x!==null)e:for(;;){if(x===null)return;var E=x.tag;if(E===3||E===4){var M=x.stateNode.containerInfo;if(M===k||M.nodeType===8&&M.parentNode===k)break;if(E===4)for(E=x.return;E!==null;){var V=E.tag;if((V===3||V===4)&&(V=E.stateNode.containerInfo,V===k||V.nodeType===8&&V.parentNode===k))return;E=E.return}for(;M!==null;){if(E=jr(M),E===null)return;if(V=E.tag,V===5||V===6){x=I=E;continue e}M=M.parentNode}}x=x.return}P1(function(){var le=I,ye=Ef(m),be=[];e:{var ge=Eb.get(l);if(ge!==void 0){var Ne=Uf,Re=l;switch(l){case"keypress":if(Hc(m)===0)break e;case"keydown":case"keyup":Ne=ER;break;case"focusin":Re="focus",Ne=Hf;break;case"focusout":Re="blur",Ne=Hf;break;case"beforeblur":case"afterblur":Ne=Hf;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ne=rb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ne=yR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ne=DR;break;case Sb:case $b:case Nb:Ne=vR;break;case Tb:Ne=_R;break;case"scroll":Ne=mR;break;case"wheel":Ne=LR;break;case"copy":case"cut":case"paste":Ne=kR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ne=ab}var De=(c&4)!==0,Ut=!De&&l==="scroll",ne=De?ge!==null?ge+"Capture":null:ge;De=[];for(var H=le,re;H!==null;){re=H;var ve=re.stateNode;if(re.tag===5&&ve!==null&&(re=ve,ne!==null&&(ve=ol(H,ne),ve!=null&&De.push(Cl(H,ve,re)))),Ut)break;H=H.return}0<De.length&&(ge=new Ne(ge,Re,null,m,ye),be.push({event:ge,listeners:De}))}}if(!(c&7)){e:{if(ge=l==="mouseover"||l==="pointerover",Ne=l==="mouseout"||l==="pointerout",ge&&m!==Tf&&(Re=m.relatedTarget||m.fromElement)&&(jr(Re)||Re[Eo]))break e;if((Ne||ge)&&(ge=ye.window===ye?ye:(ge=ye.ownerDocument)?ge.defaultView||ge.parentWindow:window,Ne?(Re=m.relatedTarget||m.toElement,Ne=le,Re=Re?jr(Re):null,Re!==null&&(Ut=Gr(Re),Re!==Ut||Re.tag!==5&&Re.tag!==6)&&(Re=null)):(Ne=null,Re=le),Ne!==Re)){if(De=rb,ve="onMouseLeave",ne="onMouseEnter",H="mouse",(l==="pointerout"||l==="pointerover")&&(De=ab,ve="onPointerLeave",ne="onPointerEnter",H="pointer"),Ut=Ne==null?ge:Qi(Ne),re=Re==null?ge:Qi(Re),ge=new De(ve,H+"leave",Ne,m,ye),ge.target=Ut,ge.relatedTarget=re,ve=null,jr(ye)===le&&(De=new De(ne,H+"enter",Re,m,ye),De.target=re,De.relatedTarget=Ut,ve=De),Ut=ve,Ne&&Re)t:{for(De=Ne,ne=Re,H=0,re=De;re;re=Xi(re))H++;for(re=0,ve=ne;ve;ve=Xi(ve))re++;for(;0<H-re;)De=Xi(De),H--;for(;0<re-H;)ne=Xi(ne),re--;for(;H--;){if(De===ne||ne!==null&&De===ne.alternate)break t;De=Xi(De),ne=Xi(ne)}De=null}else De=null;Ne!==null&&_b(be,ge,Ne,De,!1),Re!==null&&Ut!==null&&_b(be,Ut,Re,De,!0)}}e:{if(ge=le?Qi(le):window,Ne=ge.nodeName&&ge.nodeName.toLowerCase(),Ne==="select"||Ne==="input"&&ge.type==="file")var _e=UR;else if(pb(ge))if(mb)_e=qR;else{_e=jR;var ze=GR}else(Ne=ge.nodeName)&&Ne.toLowerCase()==="input"&&(ge.type==="checkbox"||ge.type==="radio")&&(_e=HR);if(_e&&(_e=_e(l,le))){fb(be,_e,m,ye);break e}ze&&ze(l,ge,le),l==="focusout"&&(ze=ge._wrapperState)&&ze.controlled&&ge.type==="number"&&os(ge,"number",ge.value)}switch(ze=le?Qi(le):window,l){case"focusin":(pb(ze)||ze.contentEditable==="true")&&(qi=ze,Jf=le,vl=null);break;case"focusout":vl=Jf=qi=null;break;case"mousedown":Zf=!0;break;case"contextmenu":case"mouseup":case"dragend":Zf=!1,Cb(be,m,ye);break;case"selectionchange":if(YR)break;case"keydown":case"keyup":Cb(be,m,ye)}var Be;if(Kf)e:{switch(l){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else Hi?db(l,m)&&(Ge="onCompositionEnd"):l==="keydown"&&m.keyCode===229&&(Ge="onCompositionStart");Ge&&(lb&&m.locale!=="ko"&&(Hi||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&Hi&&(Be=sb()):(sr=ye,Vf="value"in sr?sr.value:sr.textContent,Hi=!0)),ze=Zc(le,Ge),0<ze.length&&(Ge=new ib(Ge,l,null,m,ye),be.push({event:Ge,listeners:ze}),Be?Ge.data=Be:(Be=hb(m),Be!==null&&(Ge.data=Be)))),(Be=PR?zR(l,m):BR(l,m))&&(le=Zc(le,"onBeforeInput"),0<le.length&&(ye=new ib("onBeforeInput","beforeinput",null,m,ye),be.push({event:ye,listeners:le}),ye.data=Be))}Db(be,c)})}function Cl(l,c,m){return{instance:l,listener:c,currentTarget:m}}function Zc(l,c){for(var m=c+"Capture",x=[];l!==null;){var k=l,I=k.stateNode;k.tag===5&&I!==null&&(k=I,I=ol(l,m),I!=null&&x.unshift(Cl(l,I,k)),I=ol(l,c),I!=null&&x.push(Cl(l,I,k))),l=l.return}return x}function Xi(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function _b(l,c,m,x,k){for(var I=c._reactName,E=[];m!==null&&m!==x;){var M=m,V=M.alternate,le=M.stateNode;if(V!==null&&V===x)break;M.tag===5&&le!==null&&(M=le,k?(V=ol(m,I),V!=null&&E.unshift(Cl(m,V,M))):k||(V=ol(m,I),V!=null&&E.push(Cl(m,V,M)))),m=m.return}E.length!==0&&l.push({event:c,listeners:E})}var eA=/\r\n?/g,tA=/\u0000|\uFFFD/g;function Ob(l){return(typeof l=="string"?l:""+l).replace(eA,`
`).replace(tA,"")}function ed(l,c,m){if(c=Ob(c),Ob(l)!==c&&m)throw Error(t(425))}function td(){}var rm=null,im=null;function am(l,c){return l==="textarea"||l==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var lm=typeof setTimeout=="function"?setTimeout:void 0,nA=typeof clearTimeout=="function"?clearTimeout:void 0,Lb=typeof Promise=="function"?Promise:void 0,sA=typeof queueMicrotask=="function"?queueMicrotask:typeof Lb<"u"?function(l){return Lb.resolve(null).then(l).catch(oA)}:lm;function oA(l){setTimeout(function(){throw l})}function um(l,c){var m=c,x=0;do{var k=m.nextSibling;if(l.removeChild(m),k&&k.nodeType===8)if(m=k.data,m==="/$"){if(x===0){l.removeChild(k),pl(c);return}x--}else m!=="$"&&m!=="$?"&&m!=="$!"||x++;m=k}while(m);pl(c)}function rr(l){for(;l!=null;l=l.nextSibling){var c=l.nodeType;if(c===1||c===3)break;if(c===8){if(c=l.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return l}function Mb(l){l=l.previousSibling;for(var c=0;l;){if(l.nodeType===8){var m=l.data;if(m==="$"||m==="$!"||m==="$?"){if(c===0)return l;c--}else m==="/$"&&c++}l=l.previousSibling}return null}var Yi=Math.random().toString(36).slice(2),so="__reactFiber$"+Yi,Il="__reactProps$"+Yi,Eo="__reactContainer$"+Yi,cm="__reactEvents$"+Yi,rA="__reactListeners$"+Yi,iA="__reactHandles$"+Yi;function jr(l){var c=l[so];if(c)return c;for(var m=l.parentNode;m;){if(c=m[Eo]||m[so]){if(m=c.alternate,c.child!==null||m!==null&&m.child!==null)for(l=Mb(l);l!==null;){if(m=l[so])return m;l=Mb(l)}return c}l=m,m=l.parentNode}return null}function Sl(l){return l=l[so]||l[Eo],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Qi(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function nd(l){return l[Il]||null}var dm=[],Ji=-1;function ir(l){return{current:l}}function $t(l){0>Ji||(l.current=dm[Ji],dm[Ji]=null,Ji--)}function Ct(l,c){Ji++,dm[Ji]=l.current,l.current=c}var ar={},In=ir(ar),Hn=ir(!1),Hr=ar;function Zi(l,c){var m=l.type.contextTypes;if(!m)return ar;var x=l.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===c)return x.__reactInternalMemoizedMaskedChildContext;var k={},I;for(I in m)k[I]=c[I];return x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=k),k}function qn(l){return l=l.childContextTypes,l!=null}function sd(){$t(Hn),$t(In)}function Pb(l,c,m){if(In.current!==ar)throw Error(t(168));Ct(In,c),Ct(Hn,m)}function zb(l,c,m){var x=l.stateNode;if(c=c.childContextTypes,typeof x.getChildContext!="function")return m;x=x.getChildContext();for(var k in x)if(!(k in c))throw Error(t(108,we(l)||"Unknown",k));return Y({},m,x)}function od(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||ar,Hr=In.current,Ct(In,l),Ct(Hn,Hn.current),!0}function Bb(l,c,m){var x=l.stateNode;if(!x)throw Error(t(169));m?(l=zb(l,c,Hr),x.__reactInternalMemoizedMergedChildContext=l,$t(Hn),$t(In),Ct(In,l)):$t(Hn),Ct(Hn,m)}var Ro=null,rd=!1,hm=!1;function Wb(l){Ro===null?Ro=[l]:Ro.push(l)}function aA(l){rd=!0,Wb(l)}function lr(){if(!hm&&Ro!==null){hm=!0;var l=0,c=gt;try{var m=Ro;for(gt=1;l<m.length;l++){var x=m[l];do x=x(!0);while(x!==null)}Ro=null,rd=!1}catch(k){throw Ro!==null&&(Ro=Ro.slice(l+1)),U1(_f,lr),k}finally{gt=c,hm=!1}}return null}var ea=[],ta=0,id=null,ad=0,xs=[],bs=0,qr=null,Ao=1,Do="";function Kr(l,c){ea[ta++]=ad,ea[ta++]=id,id=l,ad=c}function Vb(l,c,m){xs[bs++]=Ao,xs[bs++]=Do,xs[bs++]=qr,qr=l;var x=Ao;l=Do;var k=32-Ls(x)-1;x&=~(1<<k),m+=1;var I=32-Ls(c)+k;if(30<I){var E=k-k%5;I=(x&(1<<E)-1).toString(32),x>>=E,k-=E,Ao=1<<32-Ls(c)+k|m<<k|x,Do=I+l}else Ao=1<<I|m<<k|x,Do=l}function pm(l){l.return!==null&&(Kr(l,1),Vb(l,1,0))}function fm(l){for(;l===id;)id=ea[--ta],ea[ta]=null,ad=ea[--ta],ea[ta]=null;for(;l===qr;)qr=xs[--bs],xs[bs]=null,Do=xs[--bs],xs[bs]=null,Ao=xs[--bs],xs[bs]=null}var as=null,ls=null,Rt=!1,Ps=null;function Ub(l,c){var m=Cs(5,null,null,0);m.elementType="DELETED",m.stateNode=c,m.return=l,c=l.deletions,c===null?(l.deletions=[m],l.flags|=16):c.push(m)}function Gb(l,c){switch(l.tag){case 5:var m=l.type;return c=c.nodeType!==1||m.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(l.stateNode=c,as=l,ls=rr(c.firstChild),!0):!1;case 6:return c=l.pendingProps===""||c.nodeType!==3?null:c,c!==null?(l.stateNode=c,as=l,ls=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(m=qr!==null?{id:Ao,overflow:Do}:null,l.memoizedState={dehydrated:c,treeContext:m,retryLane:1073741824},m=Cs(18,null,null,0),m.stateNode=c,m.return=l,l.child=m,as=l,ls=null,!0):!1;default:return!1}}function mm(l){return(l.mode&1)!==0&&(l.flags&128)===0}function gm(l){if(Rt){var c=ls;if(c){var m=c;if(!Gb(l,c)){if(mm(l))throw Error(t(418));c=rr(m.nextSibling);var x=as;c&&Gb(l,c)?Ub(x,m):(l.flags=l.flags&-4097|2,Rt=!1,as=l)}}else{if(mm(l))throw Error(t(418));l.flags=l.flags&-4097|2,Rt=!1,as=l}}}function jb(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;as=l}function ld(l){if(l!==as)return!1;if(!Rt)return jb(l),Rt=!0,!1;var c;if((c=l.tag!==3)&&!(c=l.tag!==5)&&(c=l.type,c=c!=="head"&&c!=="body"&&!am(l.type,l.memoizedProps)),c&&(c=ls)){if(mm(l))throw Hb(),Error(t(418));for(;c;)Ub(l,c),c=rr(c.nextSibling)}if(jb(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,c=0;l;){if(l.nodeType===8){var m=l.data;if(m==="/$"){if(c===0){ls=rr(l.nextSibling);break e}c--}else m!=="$"&&m!=="$!"&&m!=="$?"||c++}l=l.nextSibling}ls=null}}else ls=as?rr(l.stateNode.nextSibling):null;return!0}function Hb(){for(var l=ls;l;)l=rr(l.nextSibling)}function na(){ls=as=null,Rt=!1}function ym(l){Ps===null?Ps=[l]:Ps.push(l)}var lA=S.ReactCurrentBatchConfig;function $l(l,c,m){if(l=m.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(t(309));var x=m.stateNode}if(!x)throw Error(t(147,l));var k=x,I=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===I?c.ref:(c=function(E){var M=k.refs;E===null?delete M[I]:M[I]=E},c._stringRef=I,c)}if(typeof l!="string")throw Error(t(284));if(!m._owner)throw Error(t(290,l))}return l}function ud(l,c){throw l=Object.prototype.toString.call(c),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function qb(l){var c=l._init;return c(l._payload)}function Kb(l){function c(ne,H){if(l){var re=ne.deletions;re===null?(ne.deletions=[H],ne.flags|=16):re.push(H)}}function m(ne,H){if(!l)return null;for(;H!==null;)c(ne,H),H=H.sibling;return null}function x(ne,H){for(ne=new Map;H!==null;)H.key!==null?ne.set(H.key,H):ne.set(H.index,H),H=H.sibling;return ne}function k(ne,H){return ne=gr(ne,H),ne.index=0,ne.sibling=null,ne}function I(ne,H,re){return ne.index=re,l?(re=ne.alternate,re!==null?(re=re.index,re<H?(ne.flags|=2,H):re):(ne.flags|=2,H)):(ne.flags|=1048576,H)}function E(ne){return l&&ne.alternate===null&&(ne.flags|=2),ne}function M(ne,H,re,ve){return H===null||H.tag!==6?(H=lg(re,ne.mode,ve),H.return=ne,H):(H=k(H,re),H.return=ne,H)}function V(ne,H,re,ve){var _e=re.type;return _e===F?ye(ne,H,re.props.children,ve,re.key):H!==null&&(H.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===J&&qb(_e)===H.type)?(ve=k(H,re.props),ve.ref=$l(ne,H,re),ve.return=ne,ve):(ve=Fd(re.type,re.key,re.props,null,ne.mode,ve),ve.ref=$l(ne,H,re),ve.return=ne,ve)}function le(ne,H,re,ve){return H===null||H.tag!==4||H.stateNode.containerInfo!==re.containerInfo||H.stateNode.implementation!==re.implementation?(H=ug(re,ne.mode,ve),H.return=ne,H):(H=k(H,re.children||[]),H.return=ne,H)}function ye(ne,H,re,ve,_e){return H===null||H.tag!==7?(H=ni(re,ne.mode,ve,_e),H.return=ne,H):(H=k(H,re),H.return=ne,H)}function be(ne,H,re){if(typeof H=="string"&&H!==""||typeof H=="number")return H=lg(""+H,ne.mode,re),H.return=ne,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case N:return re=Fd(H.type,H.key,H.props,null,ne.mode,re),re.ref=$l(ne,null,H),re.return=ne,re;case R:return H=ug(H,ne.mode,re),H.return=ne,H;case J:var ve=H._init;return be(ne,ve(H._payload),re)}if(Et(H)||X(H))return H=ni(H,ne.mode,re,null),H.return=ne,H;ud(ne,H)}return null}function ge(ne,H,re,ve){var _e=H!==null?H.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return _e!==null?null:M(ne,H,""+re,ve);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case N:return re.key===_e?V(ne,H,re,ve):null;case R:return re.key===_e?le(ne,H,re,ve):null;case J:return _e=re._init,ge(ne,H,_e(re._payload),ve)}if(Et(re)||X(re))return _e!==null?null:ye(ne,H,re,ve,null);ud(ne,re)}return null}function Ne(ne,H,re,ve,_e){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return ne=ne.get(re)||null,M(H,ne,""+ve,_e);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case N:return ne=ne.get(ve.key===null?re:ve.key)||null,V(H,ne,ve,_e);case R:return ne=ne.get(ve.key===null?re:ve.key)||null,le(H,ne,ve,_e);case J:var ze=ve._init;return Ne(ne,H,re,ze(ve._payload),_e)}if(Et(ve)||X(ve))return ne=ne.get(re)||null,ye(H,ne,ve,_e,null);ud(H,ve)}return null}function Re(ne,H,re,ve){for(var _e=null,ze=null,Be=H,Ge=H=0,un=null;Be!==null&&Ge<re.length;Ge++){Be.index>Ge?(un=Be,Be=null):un=Be.sibling;var ut=ge(ne,Be,re[Ge],ve);if(ut===null){Be===null&&(Be=un);break}l&&Be&&ut.alternate===null&&c(ne,Be),H=I(ut,H,Ge),ze===null?_e=ut:ze.sibling=ut,ze=ut,Be=un}if(Ge===re.length)return m(ne,Be),Rt&&Kr(ne,Ge),_e;if(Be===null){for(;Ge<re.length;Ge++)Be=be(ne,re[Ge],ve),Be!==null&&(H=I(Be,H,Ge),ze===null?_e=Be:ze.sibling=Be,ze=Be);return Rt&&Kr(ne,Ge),_e}for(Be=x(ne,Be);Ge<re.length;Ge++)un=Ne(Be,ne,Ge,re[Ge],ve),un!==null&&(l&&un.alternate!==null&&Be.delete(un.key===null?Ge:un.key),H=I(un,H,Ge),ze===null?_e=un:ze.sibling=un,ze=un);return l&&Be.forEach(function(yr){return c(ne,yr)}),Rt&&Kr(ne,Ge),_e}function De(ne,H,re,ve){var _e=X(re);if(typeof _e!="function")throw Error(t(150));if(re=_e.call(re),re==null)throw Error(t(151));for(var ze=_e=null,Be=H,Ge=H=0,un=null,ut=re.next();Be!==null&&!ut.done;Ge++,ut=re.next()){Be.index>Ge?(un=Be,Be=null):un=Be.sibling;var yr=ge(ne,Be,ut.value,ve);if(yr===null){Be===null&&(Be=un);break}l&&Be&&yr.alternate===null&&c(ne,Be),H=I(yr,H,Ge),ze===null?_e=yr:ze.sibling=yr,ze=yr,Be=un}if(ut.done)return m(ne,Be),Rt&&Kr(ne,Ge),_e;if(Be===null){for(;!ut.done;Ge++,ut=re.next())ut=be(ne,ut.value,ve),ut!==null&&(H=I(ut,H,Ge),ze===null?_e=ut:ze.sibling=ut,ze=ut);return Rt&&Kr(ne,Ge),_e}for(Be=x(ne,Be);!ut.done;Ge++,ut=re.next())ut=Ne(Be,ne,Ge,ut.value,ve),ut!==null&&(l&&ut.alternate!==null&&Be.delete(ut.key===null?Ge:ut.key),H=I(ut,H,Ge),ze===null?_e=ut:ze.sibling=ut,ze=ut);return l&&Be.forEach(function(WA){return c(ne,WA)}),Rt&&Kr(ne,Ge),_e}function Ut(ne,H,re,ve){if(typeof re=="object"&&re!==null&&re.type===F&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case N:e:{for(var _e=re.key,ze=H;ze!==null;){if(ze.key===_e){if(_e=re.type,_e===F){if(ze.tag===7){m(ne,ze.sibling),H=k(ze,re.props.children),H.return=ne,ne=H;break e}}else if(ze.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===J&&qb(_e)===ze.type){m(ne,ze.sibling),H=k(ze,re.props),H.ref=$l(ne,ze,re),H.return=ne,ne=H;break e}m(ne,ze);break}else c(ne,ze);ze=ze.sibling}re.type===F?(H=ni(re.props.children,ne.mode,ve,re.key),H.return=ne,ne=H):(ve=Fd(re.type,re.key,re.props,null,ne.mode,ve),ve.ref=$l(ne,H,re),ve.return=ne,ne=ve)}return E(ne);case R:e:{for(ze=re.key;H!==null;){if(H.key===ze)if(H.tag===4&&H.stateNode.containerInfo===re.containerInfo&&H.stateNode.implementation===re.implementation){m(ne,H.sibling),H=k(H,re.children||[]),H.return=ne,ne=H;break e}else{m(ne,H);break}else c(ne,H);H=H.sibling}H=ug(re,ne.mode,ve),H.return=ne,ne=H}return E(ne);case J:return ze=re._init,Ut(ne,H,ze(re._payload),ve)}if(Et(re))return Re(ne,H,re,ve);if(X(re))return De(ne,H,re,ve);ud(ne,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,H!==null&&H.tag===6?(m(ne,H.sibling),H=k(H,re),H.return=ne,ne=H):(m(ne,H),H=lg(re,ne.mode,ve),H.return=ne,ne=H),E(ne)):m(ne,H)}return Ut}var sa=Kb(!0),Xb=Kb(!1),cd=ir(null),dd=null,oa=null,xm=null;function bm(){xm=oa=dd=null}function vm(l){var c=cd.current;$t(cd),l._currentValue=c}function wm(l,c,m){for(;l!==null;){var x=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),l===m)break;l=l.return}}function ra(l,c){dd=l,xm=oa=null,l=l.dependencies,l!==null&&l.firstContext!==null&&(l.lanes&c&&(Kn=!0),l.firstContext=null)}function vs(l){var c=l._currentValue;if(xm!==l)if(l={context:l,memoizedValue:c,next:null},oa===null){if(dd===null)throw Error(t(308));oa=l,dd.dependencies={lanes:0,firstContext:l}}else oa=oa.next=l;return c}var Xr=null;function km(l){Xr===null?Xr=[l]:Xr.push(l)}function Yb(l,c,m,x){var k=c.interleaved;return k===null?(m.next=m,km(c)):(m.next=k.next,k.next=m),c.interleaved=m,Fo(l,x)}function Fo(l,c){l.lanes|=c;var m=l.alternate;for(m!==null&&(m.lanes|=c),m=l,l=l.return;l!==null;)l.childLanes|=c,m=l.alternate,m!==null&&(m.childLanes|=c),m=l,l=l.return;return m.tag===3?m.stateNode:null}var ur=!1;function Cm(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qb(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function _o(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function cr(l,c,m){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,it&2){var k=x.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),x.pending=c,Fo(l,m)}return k=x.interleaved,k===null?(c.next=c,km(x)):(c.next=k.next,k.next=c),x.interleaved=c,Fo(l,m)}function hd(l,c,m){if(c=c.updateQueue,c!==null&&(c=c.shared,(m&4194240)!==0)){var x=c.lanes;x&=l.pendingLanes,m|=x,c.lanes=m,Mf(l,m)}}function Jb(l,c){var m=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,m===x)){var k=null,I=null;if(m=m.firstBaseUpdate,m!==null){do{var E={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};I===null?k=I=E:I=I.next=E,m=m.next}while(m!==null);I===null?k=I=c:I=I.next=c}else k=I=c;m={baseState:x.baseState,firstBaseUpdate:k,lastBaseUpdate:I,shared:x.shared,effects:x.effects},l.updateQueue=m;return}l=m.lastBaseUpdate,l===null?m.firstBaseUpdate=c:l.next=c,m.lastBaseUpdate=c}function pd(l,c,m,x){var k=l.updateQueue;ur=!1;var I=k.firstBaseUpdate,E=k.lastBaseUpdate,M=k.shared.pending;if(M!==null){k.shared.pending=null;var V=M,le=V.next;V.next=null,E===null?I=le:E.next=le,E=V;var ye=l.alternate;ye!==null&&(ye=ye.updateQueue,M=ye.lastBaseUpdate,M!==E&&(M===null?ye.firstBaseUpdate=le:M.next=le,ye.lastBaseUpdate=V))}if(I!==null){var be=k.baseState;E=0,ye=le=V=null,M=I;do{var ge=M.lane,Ne=M.eventTime;if((x&ge)===ge){ye!==null&&(ye=ye.next={eventTime:Ne,lane:0,tag:M.tag,payload:M.payload,callback:M.callback,next:null});e:{var Re=l,De=M;switch(ge=c,Ne=m,De.tag){case 1:if(Re=De.payload,typeof Re=="function"){be=Re.call(Ne,be,ge);break e}be=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=De.payload,ge=typeof Re=="function"?Re.call(Ne,be,ge):Re,ge==null)break e;be=Y({},be,ge);break e;case 2:ur=!0}}M.callback!==null&&M.lane!==0&&(l.flags|=64,ge=k.effects,ge===null?k.effects=[M]:ge.push(M))}else Ne={eventTime:Ne,lane:ge,tag:M.tag,payload:M.payload,callback:M.callback,next:null},ye===null?(le=ye=Ne,V=be):ye=ye.next=Ne,E|=ge;if(M=M.next,M===null){if(M=k.shared.pending,M===null)break;ge=M,M=ge.next,ge.next=null,k.lastBaseUpdate=ge,k.shared.pending=null}}while(!0);if(ye===null&&(V=be),k.baseState=V,k.firstBaseUpdate=le,k.lastBaseUpdate=ye,c=k.shared.interleaved,c!==null){k=c;do E|=k.lane,k=k.next;while(k!==c)}else I===null&&(k.shared.lanes=0);Jr|=E,l.lanes=E,l.memoizedState=be}}function Zb(l,c,m){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var x=l[c],k=x.callback;if(k!==null){if(x.callback=null,x=m,typeof k!="function")throw Error(t(191,k));k.call(x)}}}var Nl={},oo=ir(Nl),Tl=ir(Nl),El=ir(Nl);function Yr(l){if(l===Nl)throw Error(t(174));return l}function Im(l,c){switch(Ct(El,c),Ct(Tl,l),Ct(oo,Nl),l=c.nodeType,l){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:ys(null,"");break;default:l=l===8?c.parentNode:c,c=l.namespaceURI||null,l=l.tagName,c=ys(c,l)}$t(oo),Ct(oo,c)}function ia(){$t(oo),$t(Tl),$t(El)}function ev(l){Yr(El.current);var c=Yr(oo.current),m=ys(c,l.type);c!==m&&(Ct(Tl,l),Ct(oo,m))}function Sm(l){Tl.current===l&&($t(oo),$t(Tl))}var Ft=ir(0);function fd(l){for(var c=l;c!==null;){if(c.tag===13){var m=c.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var $m=[];function Nm(){for(var l=0;l<$m.length;l++)$m[l]._workInProgressVersionPrimary=null;$m.length=0}var md=S.ReactCurrentDispatcher,Tm=S.ReactCurrentBatchConfig,Qr=0,_t=null,en=null,an=null,gd=!1,Rl=!1,Al=0,uA=0;function Sn(){throw Error(t(321))}function Em(l,c){if(c===null)return!1;for(var m=0;m<c.length&&m<l.length;m++)if(!Ms(l[m],c[m]))return!1;return!0}function Rm(l,c,m,x,k,I){if(Qr=I,_t=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,md.current=l===null||l.memoizedState===null?pA:fA,l=m(x,k),Rl){I=0;do{if(Rl=!1,Al=0,25<=I)throw Error(t(301));I+=1,an=en=null,c.updateQueue=null,md.current=mA,l=m(x,k)}while(Rl)}if(md.current=bd,c=en!==null&&en.next!==null,Qr=0,an=en=_t=null,gd=!1,c)throw Error(t(300));return l}function Am(){var l=Al!==0;return Al=0,l}function ro(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?_t.memoizedState=an=l:an=an.next=l,an}function ws(){if(en===null){var l=_t.alternate;l=l!==null?l.memoizedState:null}else l=en.next;var c=an===null?_t.memoizedState:an.next;if(c!==null)an=c,en=l;else{if(l===null)throw Error(t(310));en=l,l={memoizedState:en.memoizedState,baseState:en.baseState,baseQueue:en.baseQueue,queue:en.queue,next:null},an===null?_t.memoizedState=an=l:an=an.next=l}return an}function Dl(l,c){return typeof c=="function"?c(l):c}function Dm(l){var c=ws(),m=c.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=l;var x=en,k=x.baseQueue,I=m.pending;if(I!==null){if(k!==null){var E=k.next;k.next=I.next,I.next=E}x.baseQueue=k=I,m.pending=null}if(k!==null){I=k.next,x=x.baseState;var M=E=null,V=null,le=I;do{var ye=le.lane;if((Qr&ye)===ye)V!==null&&(V=V.next={lane:0,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),x=le.hasEagerState?le.eagerState:l(x,le.action);else{var be={lane:ye,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null};V===null?(M=V=be,E=x):V=V.next=be,_t.lanes|=ye,Jr|=ye}le=le.next}while(le!==null&&le!==I);V===null?E=x:V.next=M,Ms(x,c.memoizedState)||(Kn=!0),c.memoizedState=x,c.baseState=E,c.baseQueue=V,m.lastRenderedState=x}if(l=m.interleaved,l!==null){k=l;do I=k.lane,_t.lanes|=I,Jr|=I,k=k.next;while(k!==l)}else k===null&&(m.lanes=0);return[c.memoizedState,m.dispatch]}function Fm(l){var c=ws(),m=c.queue;if(m===null)throw Error(t(311));m.lastRenderedReducer=l;var x=m.dispatch,k=m.pending,I=c.memoizedState;if(k!==null){m.pending=null;var E=k=k.next;do I=l(I,E.action),E=E.next;while(E!==k);Ms(I,c.memoizedState)||(Kn=!0),c.memoizedState=I,c.baseQueue===null&&(c.baseState=I),m.lastRenderedState=I}return[I,x]}function tv(){}function nv(l,c){var m=_t,x=ws(),k=c(),I=!Ms(x.memoizedState,k);if(I&&(x.memoizedState=k,Kn=!0),x=x.queue,_m(rv.bind(null,m,x,l),[l]),x.getSnapshot!==c||I||an!==null&&an.memoizedState.tag&1){if(m.flags|=2048,Fl(9,ov.bind(null,m,x,k,c),void 0,null),ln===null)throw Error(t(349));Qr&30||sv(m,c,k)}return k}function sv(l,c,m){l.flags|=16384,l={getSnapshot:c,value:m},c=_t.updateQueue,c===null?(c={lastEffect:null,stores:null},_t.updateQueue=c,c.stores=[l]):(m=c.stores,m===null?c.stores=[l]:m.push(l))}function ov(l,c,m,x){c.value=m,c.getSnapshot=x,iv(c)&&av(l)}function rv(l,c,m){return m(function(){iv(c)&&av(l)})}function iv(l){var c=l.getSnapshot;l=l.value;try{var m=c();return!Ms(l,m)}catch{return!0}}function av(l){var c=Fo(l,1);c!==null&&Vs(c,l,1,-1)}function lv(l){var c=ro();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dl,lastRenderedState:l},c.queue=l,l=l.dispatch=hA.bind(null,_t,l),[c.memoizedState,l]}function Fl(l,c,m,x){return l={tag:l,create:c,destroy:m,deps:x,next:null},c=_t.updateQueue,c===null?(c={lastEffect:null,stores:null},_t.updateQueue=c,c.lastEffect=l.next=l):(m=c.lastEffect,m===null?c.lastEffect=l.next=l:(x=m.next,m.next=l,l.next=x,c.lastEffect=l)),l}function uv(){return ws().memoizedState}function yd(l,c,m,x){var k=ro();_t.flags|=l,k.memoizedState=Fl(1|c,m,void 0,x===void 0?null:x)}function xd(l,c,m,x){var k=ws();x=x===void 0?null:x;var I=void 0;if(en!==null){var E=en.memoizedState;if(I=E.destroy,x!==null&&Em(x,E.deps)){k.memoizedState=Fl(c,m,I,x);return}}_t.flags|=l,k.memoizedState=Fl(1|c,m,I,x)}function cv(l,c){return yd(8390656,8,l,c)}function _m(l,c){return xd(2048,8,l,c)}function dv(l,c){return xd(4,2,l,c)}function hv(l,c){return xd(4,4,l,c)}function pv(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function fv(l,c,m){return m=m!=null?m.concat([l]):null,xd(4,4,pv.bind(null,c,l),m)}function Om(){}function mv(l,c){var m=ws();c=c===void 0?null:c;var x=m.memoizedState;return x!==null&&c!==null&&Em(c,x[1])?x[0]:(m.memoizedState=[l,c],l)}function gv(l,c){var m=ws();c=c===void 0?null:c;var x=m.memoizedState;return x!==null&&c!==null&&Em(c,x[1])?x[0]:(l=l(),m.memoizedState=[l,c],l)}function yv(l,c,m){return Qr&21?(Ms(m,c)||(m=q1(),_t.lanes|=m,Jr|=m,l.baseState=!0),c):(l.baseState&&(l.baseState=!1,Kn=!0),l.memoizedState=m)}function cA(l,c){var m=gt;gt=m!==0&&4>m?m:4,l(!0);var x=Tm.transition;Tm.transition={};try{l(!1),c()}finally{gt=m,Tm.transition=x}}function xv(){return ws().memoizedState}function dA(l,c,m){var x=fr(l);if(m={lane:x,action:m,hasEagerState:!1,eagerState:null,next:null},bv(l))vv(c,m);else if(m=Yb(l,c,m,x),m!==null){var k=Mn();Vs(m,l,x,k),wv(m,c,x)}}function hA(l,c,m){var x=fr(l),k={lane:x,action:m,hasEagerState:!1,eagerState:null,next:null};if(bv(l))vv(c,k);else{var I=l.alternate;if(l.lanes===0&&(I===null||I.lanes===0)&&(I=c.lastRenderedReducer,I!==null))try{var E=c.lastRenderedState,M=I(E,m);if(k.hasEagerState=!0,k.eagerState=M,Ms(M,E)){var V=c.interleaved;V===null?(k.next=k,km(c)):(k.next=V.next,V.next=k),c.interleaved=k;return}}catch{}finally{}m=Yb(l,c,k,x),m!==null&&(k=Mn(),Vs(m,l,x,k),wv(m,c,x))}}function bv(l){var c=l.alternate;return l===_t||c!==null&&c===_t}function vv(l,c){Rl=gd=!0;var m=l.pending;m===null?c.next=c:(c.next=m.next,m.next=c),l.pending=c}function wv(l,c,m){if(m&4194240){var x=c.lanes;x&=l.pendingLanes,m|=x,c.lanes=m,Mf(l,m)}}var bd={readContext:vs,useCallback:Sn,useContext:Sn,useEffect:Sn,useImperativeHandle:Sn,useInsertionEffect:Sn,useLayoutEffect:Sn,useMemo:Sn,useReducer:Sn,useRef:Sn,useState:Sn,useDebugValue:Sn,useDeferredValue:Sn,useTransition:Sn,useMutableSource:Sn,useSyncExternalStore:Sn,useId:Sn,unstable_isNewReconciler:!1},pA={readContext:vs,useCallback:function(l,c){return ro().memoizedState=[l,c===void 0?null:c],l},useContext:vs,useEffect:cv,useImperativeHandle:function(l,c,m){return m=m!=null?m.concat([l]):null,yd(4194308,4,pv.bind(null,c,l),m)},useLayoutEffect:function(l,c){return yd(4194308,4,l,c)},useInsertionEffect:function(l,c){return yd(4,2,l,c)},useMemo:function(l,c){var m=ro();return c=c===void 0?null:c,l=l(),m.memoizedState=[l,c],l},useReducer:function(l,c,m){var x=ro();return c=m!==void 0?m(c):c,x.memoizedState=x.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},x.queue=l,l=l.dispatch=dA.bind(null,_t,l),[x.memoizedState,l]},useRef:function(l){var c=ro();return l={current:l},c.memoizedState=l},useState:lv,useDebugValue:Om,useDeferredValue:function(l){return ro().memoizedState=l},useTransition:function(){var l=lv(!1),c=l[0];return l=cA.bind(null,l[1]),ro().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,m){var x=_t,k=ro();if(Rt){if(m===void 0)throw Error(t(407));m=m()}else{if(m=c(),ln===null)throw Error(t(349));Qr&30||sv(x,c,m)}k.memoizedState=m;var I={value:m,getSnapshot:c};return k.queue=I,cv(rv.bind(null,x,I,l),[l]),x.flags|=2048,Fl(9,ov.bind(null,x,I,m,c),void 0,null),m},useId:function(){var l=ro(),c=ln.identifierPrefix;if(Rt){var m=Do,x=Ao;m=(x&~(1<<32-Ls(x)-1)).toString(32)+m,c=":"+c+"R"+m,m=Al++,0<m&&(c+="H"+m.toString(32)),c+=":"}else m=uA++,c=":"+c+"r"+m.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},fA={readContext:vs,useCallback:mv,useContext:vs,useEffect:_m,useImperativeHandle:fv,useInsertionEffect:dv,useLayoutEffect:hv,useMemo:gv,useReducer:Dm,useRef:uv,useState:function(){return Dm(Dl)},useDebugValue:Om,useDeferredValue:function(l){var c=ws();return yv(c,en.memoizedState,l)},useTransition:function(){var l=Dm(Dl)[0],c=ws().memoizedState;return[l,c]},useMutableSource:tv,useSyncExternalStore:nv,useId:xv,unstable_isNewReconciler:!1},mA={readContext:vs,useCallback:mv,useContext:vs,useEffect:_m,useImperativeHandle:fv,useInsertionEffect:dv,useLayoutEffect:hv,useMemo:gv,useReducer:Fm,useRef:uv,useState:function(){return Fm(Dl)},useDebugValue:Om,useDeferredValue:function(l){var c=ws();return en===null?c.memoizedState=l:yv(c,en.memoizedState,l)},useTransition:function(){var l=Fm(Dl)[0],c=ws().memoizedState;return[l,c]},useMutableSource:tv,useSyncExternalStore:nv,useId:xv,unstable_isNewReconciler:!1};function zs(l,c){if(l&&l.defaultProps){c=Y({},c),l=l.defaultProps;for(var m in l)c[m]===void 0&&(c[m]=l[m]);return c}return c}function Lm(l,c,m,x){c=l.memoizedState,m=m(x,c),m=m==null?c:Y({},c,m),l.memoizedState=m,l.lanes===0&&(l.updateQueue.baseState=m)}var vd={isMounted:function(l){return(l=l._reactInternals)?Gr(l)===l:!1},enqueueSetState:function(l,c,m){l=l._reactInternals;var x=Mn(),k=fr(l),I=_o(x,k);I.payload=c,m!=null&&(I.callback=m),c=cr(l,I,k),c!==null&&(Vs(c,l,k,x),hd(c,l,k))},enqueueReplaceState:function(l,c,m){l=l._reactInternals;var x=Mn(),k=fr(l),I=_o(x,k);I.tag=1,I.payload=c,m!=null&&(I.callback=m),c=cr(l,I,k),c!==null&&(Vs(c,l,k,x),hd(c,l,k))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var m=Mn(),x=fr(l),k=_o(m,x);k.tag=2,c!=null&&(k.callback=c),c=cr(l,k,x),c!==null&&(Vs(c,l,x,m),hd(c,l,x))}};function kv(l,c,m,x,k,I,E){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,I,E):c.prototype&&c.prototype.isPureReactComponent?!bl(m,x)||!bl(k,I):!0}function Cv(l,c,m){var x=!1,k=ar,I=c.contextType;return typeof I=="object"&&I!==null?I=vs(I):(k=qn(c)?Hr:In.current,x=c.contextTypes,I=(x=x!=null)?Zi(l,k):ar),c=new c(m,I),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=vd,l.stateNode=c,c._reactInternals=l,x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=k,l.__reactInternalMemoizedMaskedChildContext=I),c}function Iv(l,c,m,x){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(m,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(m,x),c.state!==l&&vd.enqueueReplaceState(c,c.state,null)}function Mm(l,c,m,x){var k=l.stateNode;k.props=m,k.state=l.memoizedState,k.refs={},Cm(l);var I=c.contextType;typeof I=="object"&&I!==null?k.context=vs(I):(I=qn(c)?Hr:In.current,k.context=Zi(l,I)),k.state=l.memoizedState,I=c.getDerivedStateFromProps,typeof I=="function"&&(Lm(l,c,I,m),k.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(c=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),c!==k.state&&vd.enqueueReplaceState(k,k.state,null),pd(l,m,k,x),k.state=l.memoizedState),typeof k.componentDidMount=="function"&&(l.flags|=4194308)}function aa(l,c){try{var m="",x=c;do m+=pe(x),x=x.return;while(x);var k=m}catch(I){k=`
Error generating stack: `+I.message+`
`+I.stack}return{value:l,source:c,stack:k,digest:null}}function Pm(l,c,m){return{value:l,source:null,stack:m??null,digest:c??null}}function zm(l,c){try{console.error(c.value)}catch(m){setTimeout(function(){throw m})}}var gA=typeof WeakMap=="function"?WeakMap:Map;function Sv(l,c,m){m=_o(-1,m),m.tag=3,m.payload={element:null};var x=c.value;return m.callback=function(){Nd||(Nd=!0,eg=x),zm(l,c)},m}function $v(l,c,m){m=_o(-1,m),m.tag=3;var x=l.type.getDerivedStateFromError;if(typeof x=="function"){var k=c.value;m.payload=function(){return x(k)},m.callback=function(){zm(l,c)}}var I=l.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(m.callback=function(){zm(l,c),typeof x!="function"&&(hr===null?hr=new Set([this]):hr.add(this));var E=c.stack;this.componentDidCatch(c.value,{componentStack:E!==null?E:""})}),m}function Nv(l,c,m){var x=l.pingCache;if(x===null){x=l.pingCache=new gA;var k=new Set;x.set(c,k)}else k=x.get(c),k===void 0&&(k=new Set,x.set(c,k));k.has(m)||(k.add(m),l=RA.bind(null,l,c,m),c.then(l,l))}function Tv(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function Ev(l,c,m,x,k){return l.mode&1?(l.flags|=65536,l.lanes=k,l):(l===c?l.flags|=65536:(l.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(c=_o(-1,1),c.tag=2,cr(m,c,1))),m.lanes|=1),l)}var yA=S.ReactCurrentOwner,Kn=!1;function Ln(l,c,m,x){c.child=l===null?Xb(c,null,m,x):sa(c,l.child,m,x)}function Rv(l,c,m,x,k){m=m.render;var I=c.ref;return ra(c,k),x=Rm(l,c,m,x,I,k),m=Am(),l!==null&&!Kn?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~k,Oo(l,c,k)):(Rt&&m&&pm(c),c.flags|=1,Ln(l,c,x,k),c.child)}function Av(l,c,m,x,k){if(l===null){var I=m.type;return typeof I=="function"&&!ag(I)&&I.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(c.tag=15,c.type=I,Dv(l,c,I,x,k)):(l=Fd(m.type,null,x,c,c.mode,k),l.ref=c.ref,l.return=c,c.child=l)}if(I=l.child,!(l.lanes&k)){var E=I.memoizedProps;if(m=m.compare,m=m!==null?m:bl,m(E,x)&&l.ref===c.ref)return Oo(l,c,k)}return c.flags|=1,l=gr(I,x),l.ref=c.ref,l.return=c,c.child=l}function Dv(l,c,m,x,k){if(l!==null){var I=l.memoizedProps;if(bl(I,x)&&l.ref===c.ref)if(Kn=!1,c.pendingProps=x=I,(l.lanes&k)!==0)l.flags&131072&&(Kn=!0);else return c.lanes=l.lanes,Oo(l,c,k)}return Bm(l,c,m,x,k)}function Fv(l,c,m){var x=c.pendingProps,k=x.children,I=l!==null?l.memoizedState:null;if(x.mode==="hidden")if(!(c.mode&1))c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ct(ua,us),us|=m;else{if(!(m&1073741824))return l=I!==null?I.baseLanes|m:m,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,Ct(ua,us),us|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=I!==null?I.baseLanes:m,Ct(ua,us),us|=x}else I!==null?(x=I.baseLanes|m,c.memoizedState=null):x=m,Ct(ua,us),us|=x;return Ln(l,c,k,m),c.child}function _v(l,c){var m=c.ref;(l===null&&m!==null||l!==null&&l.ref!==m)&&(c.flags|=512,c.flags|=2097152)}function Bm(l,c,m,x,k){var I=qn(m)?Hr:In.current;return I=Zi(c,I),ra(c,k),m=Rm(l,c,m,x,I,k),x=Am(),l!==null&&!Kn?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~k,Oo(l,c,k)):(Rt&&x&&pm(c),c.flags|=1,Ln(l,c,m,k),c.child)}function Ov(l,c,m,x,k){if(qn(m)){var I=!0;od(c)}else I=!1;if(ra(c,k),c.stateNode===null)kd(l,c),Cv(c,m,x),Mm(c,m,x,k),x=!0;else if(l===null){var E=c.stateNode,M=c.memoizedProps;E.props=M;var V=E.context,le=m.contextType;typeof le=="object"&&le!==null?le=vs(le):(le=qn(m)?Hr:In.current,le=Zi(c,le));var ye=m.getDerivedStateFromProps,be=typeof ye=="function"||typeof E.getSnapshotBeforeUpdate=="function";be||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(M!==x||V!==le)&&Iv(c,E,x,le),ur=!1;var ge=c.memoizedState;E.state=ge,pd(c,x,E,k),V=c.memoizedState,M!==x||ge!==V||Hn.current||ur?(typeof ye=="function"&&(Lm(c,m,ye,x),V=c.memoizedState),(M=ur||kv(c,m,M,x,ge,V,le))?(be||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(c.flags|=4194308)):(typeof E.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=V),E.props=x,E.state=V,E.context=le,x=M):(typeof E.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{E=c.stateNode,Qb(l,c),M=c.memoizedProps,le=c.type===c.elementType?M:zs(c.type,M),E.props=le,be=c.pendingProps,ge=E.context,V=m.contextType,typeof V=="object"&&V!==null?V=vs(V):(V=qn(m)?Hr:In.current,V=Zi(c,V));var Ne=m.getDerivedStateFromProps;(ye=typeof Ne=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(M!==be||ge!==V)&&Iv(c,E,x,V),ur=!1,ge=c.memoizedState,E.state=ge,pd(c,x,E,k);var Re=c.memoizedState;M!==be||ge!==Re||Hn.current||ur?(typeof Ne=="function"&&(Lm(c,m,Ne,x),Re=c.memoizedState),(le=ur||kv(c,m,le,x,ge,Re,V)||!1)?(ye||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(x,Re,V),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(x,Re,V)),typeof E.componentDidUpdate=="function"&&(c.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof E.componentDidUpdate!="function"||M===l.memoizedProps&&ge===l.memoizedState||(c.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||M===l.memoizedProps&&ge===l.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=Re),E.props=x,E.state=Re,E.context=V,x=le):(typeof E.componentDidUpdate!="function"||M===l.memoizedProps&&ge===l.memoizedState||(c.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||M===l.memoizedProps&&ge===l.memoizedState||(c.flags|=1024),x=!1)}return Wm(l,c,m,x,I,k)}function Wm(l,c,m,x,k,I){_v(l,c);var E=(c.flags&128)!==0;if(!x&&!E)return k&&Bb(c,m,!1),Oo(l,c,I);x=c.stateNode,yA.current=c;var M=E&&typeof m.getDerivedStateFromError!="function"?null:x.render();return c.flags|=1,l!==null&&E?(c.child=sa(c,l.child,null,I),c.child=sa(c,null,M,I)):Ln(l,c,M,I),c.memoizedState=x.state,k&&Bb(c,m,!0),c.child}function Lv(l){var c=l.stateNode;c.pendingContext?Pb(l,c.pendingContext,c.pendingContext!==c.context):c.context&&Pb(l,c.context,!1),Im(l,c.containerInfo)}function Mv(l,c,m,x,k){return na(),ym(k),c.flags|=256,Ln(l,c,m,x),c.child}var Vm={dehydrated:null,treeContext:null,retryLane:0};function Um(l){return{baseLanes:l,cachePool:null,transitions:null}}function Pv(l,c,m){var x=c.pendingProps,k=Ft.current,I=!1,E=(c.flags&128)!==0,M;if((M=E)||(M=l!==null&&l.memoizedState===null?!1:(k&2)!==0),M?(I=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(k|=1),Ct(Ft,k&1),l===null)return gm(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?(c.mode&1?l.data==="$!"?c.lanes=8:c.lanes=1073741824:c.lanes=1,null):(E=x.children,l=x.fallback,I?(x=c.mode,I=c.child,E={mode:"hidden",children:E},!(x&1)&&I!==null?(I.childLanes=0,I.pendingProps=E):I=_d(E,x,0,null),l=ni(l,x,m,null),I.return=c,l.return=c,I.sibling=l,c.child=I,c.child.memoizedState=Um(m),c.memoizedState=Vm,l):Gm(c,E));if(k=l.memoizedState,k!==null&&(M=k.dehydrated,M!==null))return xA(l,c,E,x,M,k,m);if(I){I=x.fallback,E=c.mode,k=l.child,M=k.sibling;var V={mode:"hidden",children:x.children};return!(E&1)&&c.child!==k?(x=c.child,x.childLanes=0,x.pendingProps=V,c.deletions=null):(x=gr(k,V),x.subtreeFlags=k.subtreeFlags&14680064),M!==null?I=gr(M,I):(I=ni(I,E,m,null),I.flags|=2),I.return=c,x.return=c,x.sibling=I,c.child=x,x=I,I=c.child,E=l.child.memoizedState,E=E===null?Um(m):{baseLanes:E.baseLanes|m,cachePool:null,transitions:E.transitions},I.memoizedState=E,I.childLanes=l.childLanes&~m,c.memoizedState=Vm,x}return I=l.child,l=I.sibling,x=gr(I,{mode:"visible",children:x.children}),!(c.mode&1)&&(x.lanes=m),x.return=c,x.sibling=null,l!==null&&(m=c.deletions,m===null?(c.deletions=[l],c.flags|=16):m.push(l)),c.child=x,c.memoizedState=null,x}function Gm(l,c){return c=_d({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function wd(l,c,m,x){return x!==null&&ym(x),sa(c,l.child,null,m),l=Gm(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function xA(l,c,m,x,k,I,E){if(m)return c.flags&256?(c.flags&=-257,x=Pm(Error(t(422))),wd(l,c,E,x)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(I=x.fallback,k=c.mode,x=_d({mode:"visible",children:x.children},k,0,null),I=ni(I,k,E,null),I.flags|=2,x.return=c,I.return=c,x.sibling=I,c.child=x,c.mode&1&&sa(c,l.child,null,E),c.child.memoizedState=Um(E),c.memoizedState=Vm,I);if(!(c.mode&1))return wd(l,c,E,null);if(k.data==="$!"){if(x=k.nextSibling&&k.nextSibling.dataset,x)var M=x.dgst;return x=M,I=Error(t(419)),x=Pm(I,x,void 0),wd(l,c,E,x)}if(M=(E&l.childLanes)!==0,Kn||M){if(x=ln,x!==null){switch(E&-E){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=k&(x.suspendedLanes|E)?0:k,k!==0&&k!==I.retryLane&&(I.retryLane=k,Fo(l,k),Vs(x,l,k,-1))}return ig(),x=Pm(Error(t(421))),wd(l,c,E,x)}return k.data==="$?"?(c.flags|=128,c.child=l.child,c=AA.bind(null,l),k._reactRetry=c,null):(l=I.treeContext,ls=rr(k.nextSibling),as=c,Rt=!0,Ps=null,l!==null&&(xs[bs++]=Ao,xs[bs++]=Do,xs[bs++]=qr,Ao=l.id,Do=l.overflow,qr=c),c=Gm(c,x.children),c.flags|=4096,c)}function zv(l,c,m){l.lanes|=c;var x=l.alternate;x!==null&&(x.lanes|=c),wm(l.return,c,m)}function jm(l,c,m,x,k){var I=l.memoizedState;I===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:m,tailMode:k}:(I.isBackwards=c,I.rendering=null,I.renderingStartTime=0,I.last=x,I.tail=m,I.tailMode=k)}function Bv(l,c,m){var x=c.pendingProps,k=x.revealOrder,I=x.tail;if(Ln(l,c,x.children,m),x=Ft.current,x&2)x=x&1|2,c.flags|=128;else{if(l!==null&&l.flags&128)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&zv(l,m,c);else if(l.tag===19)zv(l,m,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}x&=1}if(Ct(Ft,x),!(c.mode&1))c.memoizedState=null;else switch(k){case"forwards":for(m=c.child,k=null;m!==null;)l=m.alternate,l!==null&&fd(l)===null&&(k=m),m=m.sibling;m=k,m===null?(k=c.child,c.child=null):(k=m.sibling,m.sibling=null),jm(c,!1,k,m,I);break;case"backwards":for(m=null,k=c.child,c.child=null;k!==null;){if(l=k.alternate,l!==null&&fd(l)===null){c.child=k;break}l=k.sibling,k.sibling=m,m=k,k=l}jm(c,!0,m,null,I);break;case"together":jm(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function kd(l,c){!(c.mode&1)&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function Oo(l,c,m){if(l!==null&&(c.dependencies=l.dependencies),Jr|=c.lanes,!(m&c.childLanes))return null;if(l!==null&&c.child!==l.child)throw Error(t(153));if(c.child!==null){for(l=c.child,m=gr(l,l.pendingProps),c.child=m,m.return=c;l.sibling!==null;)l=l.sibling,m=m.sibling=gr(l,l.pendingProps),m.return=c;m.sibling=null}return c.child}function bA(l,c,m){switch(c.tag){case 3:Lv(c),na();break;case 5:ev(c);break;case 1:qn(c.type)&&od(c);break;case 4:Im(c,c.stateNode.containerInfo);break;case 10:var x=c.type._context,k=c.memoizedProps.value;Ct(cd,x._currentValue),x._currentValue=k;break;case 13:if(x=c.memoizedState,x!==null)return x.dehydrated!==null?(Ct(Ft,Ft.current&1),c.flags|=128,null):m&c.child.childLanes?Pv(l,c,m):(Ct(Ft,Ft.current&1),l=Oo(l,c,m),l!==null?l.sibling:null);Ct(Ft,Ft.current&1);break;case 19:if(x=(m&c.childLanes)!==0,l.flags&128){if(x)return Bv(l,c,m);c.flags|=128}if(k=c.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),Ct(Ft,Ft.current),x)break;return null;case 22:case 23:return c.lanes=0,Fv(l,c,m)}return Oo(l,c,m)}var Wv,Hm,Vv,Uv;Wv=function(l,c){for(var m=c.child;m!==null;){if(m.tag===5||m.tag===6)l.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===c)break;for(;m.sibling===null;){if(m.return===null||m.return===c)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},Hm=function(){},Vv=function(l,c,m,x){var k=l.memoizedProps;if(k!==x){l=c.stateNode,Yr(oo.current);var I=null;switch(m){case"input":k=at(l,k),x=at(l,x),I=[];break;case"select":k=Y({},k,{value:void 0}),x=Y({},x,{value:void 0}),I=[];break;case"textarea":k=mn(l,k),x=mn(l,x),I=[];break;default:typeof k.onClick!="function"&&typeof x.onClick=="function"&&(l.onclick=td)}$f(m,x);var E;m=null;for(le in k)if(!x.hasOwnProperty(le)&&k.hasOwnProperty(le)&&k[le]!=null)if(le==="style"){var M=k[le];for(E in M)M.hasOwnProperty(E)&&(m||(m={}),m[E]="")}else le!=="dangerouslySetInnerHTML"&&le!=="children"&&le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&le!=="autoFocus"&&(o.hasOwnProperty(le)?I||(I=[]):(I=I||[]).push(le,null));for(le in x){var V=x[le];if(M=k!=null?k[le]:void 0,x.hasOwnProperty(le)&&V!==M&&(V!=null||M!=null))if(le==="style")if(M){for(E in M)!M.hasOwnProperty(E)||V&&V.hasOwnProperty(E)||(m||(m={}),m[E]="");for(E in V)V.hasOwnProperty(E)&&M[E]!==V[E]&&(m||(m={}),m[E]=V[E])}else m||(I||(I=[]),I.push(le,m)),m=V;else le==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,M=M?M.__html:void 0,V!=null&&M!==V&&(I=I||[]).push(le,V)):le==="children"?typeof V!="string"&&typeof V!="number"||(I=I||[]).push(le,""+V):le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&(o.hasOwnProperty(le)?(V!=null&&le==="onScroll"&&St("scroll",l),I||M===V||(I=[])):(I=I||[]).push(le,V))}m&&(I=I||[]).push("style",m);var le=I;(c.updateQueue=le)&&(c.flags|=4)}},Uv=function(l,c,m,x){m!==x&&(c.flags|=4)};function _l(l,c){if(!Rt)switch(l.tailMode){case"hidden":c=l.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?l.tail=null:m.sibling=null;break;case"collapsed":m=l.tail;for(var x=null;m!==null;)m.alternate!==null&&(x=m),m=m.sibling;x===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function $n(l){var c=l.alternate!==null&&l.alternate.child===l.child,m=0,x=0;if(c)for(var k=l.child;k!==null;)m|=k.lanes|k.childLanes,x|=k.subtreeFlags&14680064,x|=k.flags&14680064,k.return=l,k=k.sibling;else for(k=l.child;k!==null;)m|=k.lanes|k.childLanes,x|=k.subtreeFlags,x|=k.flags,k.return=l,k=k.sibling;return l.subtreeFlags|=x,l.childLanes=m,c}function vA(l,c,m){var x=c.pendingProps;switch(fm(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(c),null;case 1:return qn(c.type)&&sd(),$n(c),null;case 3:return x=c.stateNode,ia(),$t(Hn),$t(In),Nm(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(l===null||l.child===null)&&(ld(c)?c.flags|=4:l===null||l.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,Ps!==null&&(sg(Ps),Ps=null))),Hm(l,c),$n(c),null;case 5:Sm(c);var k=Yr(El.current);if(m=c.type,l!==null&&c.stateNode!=null)Vv(l,c,m,x,k),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!x){if(c.stateNode===null)throw Error(t(166));return $n(c),null}if(l=Yr(oo.current),ld(c)){x=c.stateNode,m=c.type;var I=c.memoizedProps;switch(x[so]=c,x[Il]=I,l=(c.mode&1)!==0,m){case"dialog":St("cancel",x),St("close",x);break;case"iframe":case"object":case"embed":St("load",x);break;case"video":case"audio":for(k=0;k<wl.length;k++)St(wl[k],x);break;case"source":St("error",x);break;case"img":case"image":case"link":St("error",x),St("load",x);break;case"details":St("toggle",x);break;case"input":Pe(x,I),St("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!I.multiple},St("invalid",x);break;case"textarea":to(x,I),St("invalid",x)}$f(m,I),k=null;for(var E in I)if(I.hasOwnProperty(E)){var M=I[E];E==="children"?typeof M=="string"?x.textContent!==M&&(I.suppressHydrationWarning!==!0&&ed(x.textContent,M,l),k=["children",M]):typeof M=="number"&&x.textContent!==""+M&&(I.suppressHydrationWarning!==!0&&ed(x.textContent,M,l),k=["children",""+M]):o.hasOwnProperty(E)&&M!=null&&E==="onScroll"&&St("scroll",x)}switch(m){case"input":Ue(x),xt(x,I,!0);break;case"textarea":Ue(x),gs(x);break;case"select":case"option":break;default:typeof I.onClick=="function"&&(x.onclick=td)}x=k,c.updateQueue=x,x!==null&&(c.flags|=4)}else{E=k.nodeType===9?k:k.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Os(m)),l==="http://www.w3.org/1999/xhtml"?m==="script"?(l=E.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof x.is=="string"?l=E.createElement(m,{is:x.is}):(l=E.createElement(m),m==="select"&&(E=l,x.multiple?E.multiple=!0:x.size&&(E.size=x.size))):l=E.createElementNS(l,m),l[so]=c,l[Il]=x,Wv(l,c,!1,!1),c.stateNode=l;e:{switch(E=Nf(m,x),m){case"dialog":St("cancel",l),St("close",l),k=x;break;case"iframe":case"object":case"embed":St("load",l),k=x;break;case"video":case"audio":for(k=0;k<wl.length;k++)St(wl[k],l);k=x;break;case"source":St("error",l),k=x;break;case"img":case"image":case"link":St("error",l),St("load",l),k=x;break;case"details":St("toggle",l),k=x;break;case"input":Pe(l,x),k=at(l,x),St("invalid",l);break;case"option":k=x;break;case"select":l._wrapperState={wasMultiple:!!x.multiple},k=Y({},x,{value:void 0}),St("invalid",l);break;case"textarea":to(l,x),k=mn(l,x),St("invalid",l);break;default:k=x}$f(m,k),M=k;for(I in M)if(M.hasOwnProperty(I)){var V=M[I];I==="style"?Fc(l,V):I==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,V!=null&&Jo(l,V)):I==="children"?typeof V=="string"?(m!=="textarea"||V!=="")&&No(l,V):typeof V=="number"&&No(l,""+V):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(o.hasOwnProperty(I)?V!=null&&I==="onScroll"&&St("scroll",l):V!=null&&$(l,I,V,E))}switch(m){case"input":Ue(l),xt(l,x,!1);break;case"textarea":Ue(l),gs(l);break;case"option":x.value!=null&&l.setAttribute("value",""+ke(x.value));break;case"select":l.multiple=!!x.multiple,I=x.value,I!=null?On(l,!!x.multiple,I,!1):x.defaultValue!=null&&On(l,!!x.multiple,x.defaultValue,!0);break;default:typeof k.onClick=="function"&&(l.onclick=td)}switch(m){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return $n(c),null;case 6:if(l&&c.stateNode!=null)Uv(l,c,l.memoizedProps,x);else{if(typeof x!="string"&&c.stateNode===null)throw Error(t(166));if(m=Yr(El.current),Yr(oo.current),ld(c)){if(x=c.stateNode,m=c.memoizedProps,x[so]=c,(I=x.nodeValue!==m)&&(l=as,l!==null))switch(l.tag){case 3:ed(x.nodeValue,m,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&ed(x.nodeValue,m,(l.mode&1)!==0)}I&&(c.flags|=4)}else x=(m.nodeType===9?m:m.ownerDocument).createTextNode(x),x[so]=c,c.stateNode=x}return $n(c),null;case 13:if($t(Ft),x=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Rt&&ls!==null&&c.mode&1&&!(c.flags&128))Hb(),na(),c.flags|=98560,I=!1;else if(I=ld(c),x!==null&&x.dehydrated!==null){if(l===null){if(!I)throw Error(t(318));if(I=c.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(t(317));I[so]=c}else na(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;$n(c),I=!1}else Ps!==null&&(sg(Ps),Ps=null),I=!0;if(!I)return c.flags&65536?c:null}return c.flags&128?(c.lanes=m,c):(x=x!==null,x!==(l!==null&&l.memoizedState!==null)&&x&&(c.child.flags|=8192,c.mode&1&&(l===null||Ft.current&1?tn===0&&(tn=3):ig())),c.updateQueue!==null&&(c.flags|=4),$n(c),null);case 4:return ia(),Hm(l,c),l===null&&kl(c.stateNode.containerInfo),$n(c),null;case 10:return vm(c.type._context),$n(c),null;case 17:return qn(c.type)&&sd(),$n(c),null;case 19:if($t(Ft),I=c.memoizedState,I===null)return $n(c),null;if(x=(c.flags&128)!==0,E=I.rendering,E===null)if(x)_l(I,!1);else{if(tn!==0||l!==null&&l.flags&128)for(l=c.child;l!==null;){if(E=fd(l),E!==null){for(c.flags|=128,_l(I,!1),x=E.updateQueue,x!==null&&(c.updateQueue=x,c.flags|=4),c.subtreeFlags=0,x=m,m=c.child;m!==null;)I=m,l=x,I.flags&=14680066,E=I.alternate,E===null?(I.childLanes=0,I.lanes=l,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=E.childLanes,I.lanes=E.lanes,I.child=E.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=E.memoizedProps,I.memoizedState=E.memoizedState,I.updateQueue=E.updateQueue,I.type=E.type,l=E.dependencies,I.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),m=m.sibling;return Ct(Ft,Ft.current&1|2),c.child}l=l.sibling}I.tail!==null&&Vt()>ca&&(c.flags|=128,x=!0,_l(I,!1),c.lanes=4194304)}else{if(!x)if(l=fd(E),l!==null){if(c.flags|=128,x=!0,m=l.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),_l(I,!0),I.tail===null&&I.tailMode==="hidden"&&!E.alternate&&!Rt)return $n(c),null}else 2*Vt()-I.renderingStartTime>ca&&m!==1073741824&&(c.flags|=128,x=!0,_l(I,!1),c.lanes=4194304);I.isBackwards?(E.sibling=c.child,c.child=E):(m=I.last,m!==null?m.sibling=E:c.child=E,I.last=E)}return I.tail!==null?(c=I.tail,I.rendering=c,I.tail=c.sibling,I.renderingStartTime=Vt(),c.sibling=null,m=Ft.current,Ct(Ft,x?m&1|2:m&1),c):($n(c),null);case 22:case 23:return rg(),x=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==x&&(c.flags|=8192),x&&c.mode&1?us&1073741824&&($n(c),c.subtreeFlags&6&&(c.flags|=8192)):$n(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function wA(l,c){switch(fm(c),c.tag){case 1:return qn(c.type)&&sd(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return ia(),$t(Hn),$t(In),Nm(),l=c.flags,l&65536&&!(l&128)?(c.flags=l&-65537|128,c):null;case 5:return Sm(c),null;case 13:if($t(Ft),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(t(340));na()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return $t(Ft),null;case 4:return ia(),null;case 10:return vm(c.type._context),null;case 22:case 23:return rg(),null;case 24:return null;default:return null}}var Cd=!1,Nn=!1,kA=typeof WeakSet=="function"?WeakSet:Set,Te=null;function la(l,c){var m=l.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(x){Ot(l,c,x)}else m.current=null}function qm(l,c,m){try{m()}catch(x){Ot(l,c,x)}}var Gv=!1;function CA(l,c){if(rm=Uc,l=kb(),Qf(l)){if("selectionStart"in l)var m={start:l.selectionStart,end:l.selectionEnd};else e:{m=(m=l.ownerDocument)&&m.defaultView||window;var x=m.getSelection&&m.getSelection();if(x&&x.rangeCount!==0){m=x.anchorNode;var k=x.anchorOffset,I=x.focusNode;x=x.focusOffset;try{m.nodeType,I.nodeType}catch{m=null;break e}var E=0,M=-1,V=-1,le=0,ye=0,be=l,ge=null;t:for(;;){for(var Ne;be!==m||k!==0&&be.nodeType!==3||(M=E+k),be!==I||x!==0&&be.nodeType!==3||(V=E+x),be.nodeType===3&&(E+=be.nodeValue.length),(Ne=be.firstChild)!==null;)ge=be,be=Ne;for(;;){if(be===l)break t;if(ge===m&&++le===k&&(M=E),ge===I&&++ye===x&&(V=E),(Ne=be.nextSibling)!==null)break;be=ge,ge=be.parentNode}be=Ne}m=M===-1||V===-1?null:{start:M,end:V}}else m=null}m=m||{start:0,end:0}}else m=null;for(im={focusedElem:l,selectionRange:m},Uc=!1,Te=c;Te!==null;)if(c=Te,l=c.child,(c.subtreeFlags&1028)!==0&&l!==null)l.return=c,Te=l;else for(;Te!==null;){c=Te;try{var Re=c.alternate;if(c.flags&1024)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Re!==null){var De=Re.memoizedProps,Ut=Re.memoizedState,ne=c.stateNode,H=ne.getSnapshotBeforeUpdate(c.elementType===c.type?De:zs(c.type,De),Ut);ne.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var re=c.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ve){Ot(c,c.return,ve)}if(l=c.sibling,l!==null){l.return=c.return,Te=l;break}Te=c.return}return Re=Gv,Gv=!1,Re}function Ol(l,c,m){var x=c.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var k=x=x.next;do{if((k.tag&l)===l){var I=k.destroy;k.destroy=void 0,I!==void 0&&qm(c,m,I)}k=k.next}while(k!==x)}}function Id(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var m=c=c.next;do{if((m.tag&l)===l){var x=m.create;m.destroy=x()}m=m.next}while(m!==c)}}function Km(l){var c=l.ref;if(c!==null){var m=l.stateNode;switch(l.tag){case 5:l=m;break;default:l=m}typeof c=="function"?c(l):c.current=l}}function jv(l){var c=l.alternate;c!==null&&(l.alternate=null,jv(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&(delete c[so],delete c[Il],delete c[cm],delete c[rA],delete c[iA])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function Hv(l){return l.tag===5||l.tag===3||l.tag===4}function qv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Hv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Xm(l,c,m){var x=l.tag;if(x===5||x===6)l=l.stateNode,c?m.nodeType===8?m.parentNode.insertBefore(l,c):m.insertBefore(l,c):(m.nodeType===8?(c=m.parentNode,c.insertBefore(l,m)):(c=m,c.appendChild(l)),m=m._reactRootContainer,m!=null||c.onclick!==null||(c.onclick=td));else if(x!==4&&(l=l.child,l!==null))for(Xm(l,c,m),l=l.sibling;l!==null;)Xm(l,c,m),l=l.sibling}function Ym(l,c,m){var x=l.tag;if(x===5||x===6)l=l.stateNode,c?m.insertBefore(l,c):m.appendChild(l);else if(x!==4&&(l=l.child,l!==null))for(Ym(l,c,m),l=l.sibling;l!==null;)Ym(l,c,m),l=l.sibling}var gn=null,Bs=!1;function dr(l,c,m){for(m=m.child;m!==null;)Kv(l,c,m),m=m.sibling}function Kv(l,c,m){if(no&&typeof no.onCommitFiberUnmount=="function")try{no.onCommitFiberUnmount(Mc,m)}catch{}switch(m.tag){case 5:Nn||la(m,c);case 6:var x=gn,k=Bs;gn=null,dr(l,c,m),gn=x,Bs=k,gn!==null&&(Bs?(l=gn,m=m.stateNode,l.nodeType===8?l.parentNode.removeChild(m):l.removeChild(m)):gn.removeChild(m.stateNode));break;case 18:gn!==null&&(Bs?(l=gn,m=m.stateNode,l.nodeType===8?um(l.parentNode,m):l.nodeType===1&&um(l,m),pl(l)):um(gn,m.stateNode));break;case 4:x=gn,k=Bs,gn=m.stateNode.containerInfo,Bs=!0,dr(l,c,m),gn=x,Bs=k;break;case 0:case 11:case 14:case 15:if(!Nn&&(x=m.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){k=x=x.next;do{var I=k,E=I.destroy;I=I.tag,E!==void 0&&(I&2||I&4)&&qm(m,c,E),k=k.next}while(k!==x)}dr(l,c,m);break;case 1:if(!Nn&&(la(m,c),x=m.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=m.memoizedProps,x.state=m.memoizedState,x.componentWillUnmount()}catch(M){Ot(m,c,M)}dr(l,c,m);break;case 21:dr(l,c,m);break;case 22:m.mode&1?(Nn=(x=Nn)||m.memoizedState!==null,dr(l,c,m),Nn=x):dr(l,c,m);break;default:dr(l,c,m)}}function Xv(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var m=l.stateNode;m===null&&(m=l.stateNode=new kA),c.forEach(function(x){var k=DA.bind(null,l,x);m.has(x)||(m.add(x),x.then(k,k))})}}function Ws(l,c){var m=c.deletions;if(m!==null)for(var x=0;x<m.length;x++){var k=m[x];try{var I=l,E=c,M=E;e:for(;M!==null;){switch(M.tag){case 5:gn=M.stateNode,Bs=!1;break e;case 3:gn=M.stateNode.containerInfo,Bs=!0;break e;case 4:gn=M.stateNode.containerInfo,Bs=!0;break e}M=M.return}if(gn===null)throw Error(t(160));Kv(I,E,k),gn=null,Bs=!1;var V=k.alternate;V!==null&&(V.return=null),k.return=null}catch(le){Ot(k,c,le)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Yv(c,l),c=c.sibling}function Yv(l,c){var m=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Ws(c,l),io(l),x&4){try{Ol(3,l,l.return),Id(3,l)}catch(De){Ot(l,l.return,De)}try{Ol(5,l,l.return)}catch(De){Ot(l,l.return,De)}}break;case 1:Ws(c,l),io(l),x&512&&m!==null&&la(m,m.return);break;case 5:if(Ws(c,l),io(l),x&512&&m!==null&&la(m,m.return),l.flags&32){var k=l.stateNode;try{No(k,"")}catch(De){Ot(l,l.return,De)}}if(x&4&&(k=l.stateNode,k!=null)){var I=l.memoizedProps,E=m!==null?m.memoizedProps:I,M=l.type,V=l.updateQueue;if(l.updateQueue=null,V!==null)try{M==="input"&&I.type==="radio"&&I.name!=null&&tt(k,I),Nf(M,E);var le=Nf(M,I);for(E=0;E<V.length;E+=2){var ye=V[E],be=V[E+1];ye==="style"?Fc(k,be):ye==="dangerouslySetInnerHTML"?Jo(k,be):ye==="children"?No(k,be):$(k,ye,be,le)}switch(M){case"input":lt(k,I);break;case"textarea":jn(k,I);break;case"select":var ge=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!I.multiple;var Ne=I.value;Ne!=null?On(k,!!I.multiple,Ne,!1):ge!==!!I.multiple&&(I.defaultValue!=null?On(k,!!I.multiple,I.defaultValue,!0):On(k,!!I.multiple,I.multiple?[]:"",!1))}k[Il]=I}catch(De){Ot(l,l.return,De)}}break;case 6:if(Ws(c,l),io(l),x&4){if(l.stateNode===null)throw Error(t(162));k=l.stateNode,I=l.memoizedProps;try{k.nodeValue=I}catch(De){Ot(l,l.return,De)}}break;case 3:if(Ws(c,l),io(l),x&4&&m!==null&&m.memoizedState.isDehydrated)try{pl(c.containerInfo)}catch(De){Ot(l,l.return,De)}break;case 4:Ws(c,l),io(l);break;case 13:Ws(c,l),io(l),k=l.child,k.flags&8192&&(I=k.memoizedState!==null,k.stateNode.isHidden=I,!I||k.alternate!==null&&k.alternate.memoizedState!==null||(Zm=Vt())),x&4&&Xv(l);break;case 22:if(ye=m!==null&&m.memoizedState!==null,l.mode&1?(Nn=(le=Nn)||ye,Ws(c,l),Nn=le):Ws(c,l),io(l),x&8192){if(le=l.memoizedState!==null,(l.stateNode.isHidden=le)&&!ye&&l.mode&1)for(Te=l,ye=l.child;ye!==null;){for(be=Te=ye;Te!==null;){switch(ge=Te,Ne=ge.child,ge.tag){case 0:case 11:case 14:case 15:Ol(4,ge,ge.return);break;case 1:la(ge,ge.return);var Re=ge.stateNode;if(typeof Re.componentWillUnmount=="function"){x=ge,m=ge.return;try{c=x,Re.props=c.memoizedProps,Re.state=c.memoizedState,Re.componentWillUnmount()}catch(De){Ot(x,m,De)}}break;case 5:la(ge,ge.return);break;case 22:if(ge.memoizedState!==null){Zv(be);continue}}Ne!==null?(Ne.return=ge,Te=Ne):Zv(be)}ye=ye.sibling}e:for(ye=null,be=l;;){if(be.tag===5){if(ye===null){ye=be;try{k=be.stateNode,le?(I=k.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none"):(M=be.stateNode,V=be.memoizedProps.style,E=V!=null&&V.hasOwnProperty("display")?V.display:null,M.style.display=Ur("display",E))}catch(De){Ot(l,l.return,De)}}}else if(be.tag===6){if(ye===null)try{be.stateNode.nodeValue=le?"":be.memoizedProps}catch(De){Ot(l,l.return,De)}}else if((be.tag!==22&&be.tag!==23||be.memoizedState===null||be===l)&&be.child!==null){be.child.return=be,be=be.child;continue}if(be===l)break e;for(;be.sibling===null;){if(be.return===null||be.return===l)break e;ye===be&&(ye=null),be=be.return}ye===be&&(ye=null),be.sibling.return=be.return,be=be.sibling}}break;case 19:Ws(c,l),io(l),x&4&&Xv(l);break;case 21:break;default:Ws(c,l),io(l)}}function io(l){var c=l.flags;if(c&2){try{e:{for(var m=l.return;m!==null;){if(Hv(m)){var x=m;break e}m=m.return}throw Error(t(160))}switch(x.tag){case 5:var k=x.stateNode;x.flags&32&&(No(k,""),x.flags&=-33);var I=qv(l);Ym(l,I,k);break;case 3:case 4:var E=x.stateNode.containerInfo,M=qv(l);Xm(l,M,E);break;default:throw Error(t(161))}}catch(V){Ot(l,l.return,V)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function IA(l,c,m){Te=l,Qv(l)}function Qv(l,c,m){for(var x=(l.mode&1)!==0;Te!==null;){var k=Te,I=k.child;if(k.tag===22&&x){var E=k.memoizedState!==null||Cd;if(!E){var M=k.alternate,V=M!==null&&M.memoizedState!==null||Nn;M=Cd;var le=Nn;if(Cd=E,(Nn=V)&&!le)for(Te=k;Te!==null;)E=Te,V=E.child,E.tag===22&&E.memoizedState!==null?ew(k):V!==null?(V.return=E,Te=V):ew(k);for(;I!==null;)Te=I,Qv(I),I=I.sibling;Te=k,Cd=M,Nn=le}Jv(l)}else k.subtreeFlags&8772&&I!==null?(I.return=k,Te=I):Jv(l)}}function Jv(l){for(;Te!==null;){var c=Te;if(c.flags&8772){var m=c.alternate;try{if(c.flags&8772)switch(c.tag){case 0:case 11:case 15:Nn||Id(5,c);break;case 1:var x=c.stateNode;if(c.flags&4&&!Nn)if(m===null)x.componentDidMount();else{var k=c.elementType===c.type?m.memoizedProps:zs(c.type,m.memoizedProps);x.componentDidUpdate(k,m.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var I=c.updateQueue;I!==null&&Zb(c,I,x);break;case 3:var E=c.updateQueue;if(E!==null){if(m=null,c.child!==null)switch(c.child.tag){case 5:m=c.child.stateNode;break;case 1:m=c.child.stateNode}Zb(c,E,m)}break;case 5:var M=c.stateNode;if(m===null&&c.flags&4){m=M;var V=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":V.autoFocus&&m.focus();break;case"img":V.src&&(m.src=V.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var le=c.alternate;if(le!==null){var ye=le.memoizedState;if(ye!==null){var be=ye.dehydrated;be!==null&&pl(be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Nn||c.flags&512&&Km(c)}catch(ge){Ot(c,c.return,ge)}}if(c===l){Te=null;break}if(m=c.sibling,m!==null){m.return=c.return,Te=m;break}Te=c.return}}function Zv(l){for(;Te!==null;){var c=Te;if(c===l){Te=null;break}var m=c.sibling;if(m!==null){m.return=c.return,Te=m;break}Te=c.return}}function ew(l){for(;Te!==null;){var c=Te;try{switch(c.tag){case 0:case 11:case 15:var m=c.return;try{Id(4,c)}catch(V){Ot(c,m,V)}break;case 1:var x=c.stateNode;if(typeof x.componentDidMount=="function"){var k=c.return;try{x.componentDidMount()}catch(V){Ot(c,k,V)}}var I=c.return;try{Km(c)}catch(V){Ot(c,I,V)}break;case 5:var E=c.return;try{Km(c)}catch(V){Ot(c,E,V)}}}catch(V){Ot(c,c.return,V)}if(c===l){Te=null;break}var M=c.sibling;if(M!==null){M.return=c.return,Te=M;break}Te=c.return}}var SA=Math.ceil,Sd=S.ReactCurrentDispatcher,Qm=S.ReactCurrentOwner,ks=S.ReactCurrentBatchConfig,it=0,ln=null,Ht=null,yn=0,us=0,ua=ir(0),tn=0,Ll=null,Jr=0,$d=0,Jm=0,Ml=null,Xn=null,Zm=0,ca=1/0,Lo=null,Nd=!1,eg=null,hr=null,Td=!1,pr=null,Ed=0,Pl=0,tg=null,Rd=-1,Ad=0;function Mn(){return it&6?Vt():Rd!==-1?Rd:Rd=Vt()}function fr(l){return l.mode&1?it&2&&yn!==0?yn&-yn:lA.transition!==null?(Ad===0&&(Ad=q1()),Ad):(l=gt,l!==0||(l=window.event,l=l===void 0?16:nb(l.type)),l):1}function Vs(l,c,m,x){if(50<Pl)throw Pl=0,tg=null,Error(t(185));ll(l,m,x),(!(it&2)||l!==ln)&&(l===ln&&(!(it&2)&&($d|=m),tn===4&&mr(l,yn)),Yn(l,x),m===1&&it===0&&!(c.mode&1)&&(ca=Vt()+500,rd&&lr()))}function Yn(l,c){var m=l.callbackNode;lR(l,c);var x=Bc(l,l===ln?yn:0);if(x===0)m!==null&&G1(m),l.callbackNode=null,l.callbackPriority=0;else if(c=x&-x,l.callbackPriority!==c){if(m!=null&&G1(m),c===1)l.tag===0?aA(nw.bind(null,l)):Wb(nw.bind(null,l)),sA(function(){!(it&6)&&lr()}),m=null;else{switch(K1(x)){case 1:m=_f;break;case 4:m=j1;break;case 16:m=Lc;break;case 536870912:m=H1;break;default:m=Lc}m=cw(m,tw.bind(null,l))}l.callbackPriority=c,l.callbackNode=m}}function tw(l,c){if(Rd=-1,Ad=0,it&6)throw Error(t(327));var m=l.callbackNode;if(da()&&l.callbackNode!==m)return null;var x=Bc(l,l===ln?yn:0);if(x===0)return null;if(x&30||x&l.expiredLanes||c)c=Dd(l,x);else{c=x;var k=it;it|=2;var I=ow();(ln!==l||yn!==c)&&(Lo=null,ca=Vt()+500,ei(l,c));do try{TA();break}catch(M){sw(l,M)}while(!0);bm(),Sd.current=I,it=k,Ht!==null?c=0:(ln=null,yn=0,c=tn)}if(c!==0){if(c===2&&(k=Of(l),k!==0&&(x=k,c=ng(l,k))),c===1)throw m=Ll,ei(l,0),mr(l,x),Yn(l,Vt()),m;if(c===6)mr(l,x);else{if(k=l.current.alternate,!(x&30)&&!$A(k)&&(c=Dd(l,x),c===2&&(I=Of(l),I!==0&&(x=I,c=ng(l,I))),c===1))throw m=Ll,ei(l,0),mr(l,x),Yn(l,Vt()),m;switch(l.finishedWork=k,l.finishedLanes=x,c){case 0:case 1:throw Error(t(345));case 2:ti(l,Xn,Lo);break;case 3:if(mr(l,x),(x&130023424)===x&&(c=Zm+500-Vt(),10<c)){if(Bc(l,0)!==0)break;if(k=l.suspendedLanes,(k&x)!==x){Mn(),l.pingedLanes|=l.suspendedLanes&k;break}l.timeoutHandle=lm(ti.bind(null,l,Xn,Lo),c);break}ti(l,Xn,Lo);break;case 4:if(mr(l,x),(x&4194240)===x)break;for(c=l.eventTimes,k=-1;0<x;){var E=31-Ls(x);I=1<<E,E=c[E],E>k&&(k=E),x&=~I}if(x=k,x=Vt()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*SA(x/1960))-x,10<x){l.timeoutHandle=lm(ti.bind(null,l,Xn,Lo),x);break}ti(l,Xn,Lo);break;case 5:ti(l,Xn,Lo);break;default:throw Error(t(329))}}}return Yn(l,Vt()),l.callbackNode===m?tw.bind(null,l):null}function ng(l,c){var m=Ml;return l.current.memoizedState.isDehydrated&&(ei(l,c).flags|=256),l=Dd(l,c),l!==2&&(c=Xn,Xn=m,c!==null&&sg(c)),l}function sg(l){Xn===null?Xn=l:Xn.push.apply(Xn,l)}function $A(l){for(var c=l;;){if(c.flags&16384){var m=c.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var x=0;x<m.length;x++){var k=m[x],I=k.getSnapshot;k=k.value;try{if(!Ms(I(),k))return!1}catch{return!1}}}if(m=c.child,c.subtreeFlags&16384&&m!==null)m.return=c,c=m;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function mr(l,c){for(c&=~Jm,c&=~$d,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var m=31-Ls(c),x=1<<m;l[m]=-1,c&=~x}}function nw(l){if(it&6)throw Error(t(327));da();var c=Bc(l,0);if(!(c&1))return Yn(l,Vt()),null;var m=Dd(l,c);if(l.tag!==0&&m===2){var x=Of(l);x!==0&&(c=x,m=ng(l,x))}if(m===1)throw m=Ll,ei(l,0),mr(l,c),Yn(l,Vt()),m;if(m===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,ti(l,Xn,Lo),Yn(l,Vt()),null}function og(l,c){var m=it;it|=1;try{return l(c)}finally{it=m,it===0&&(ca=Vt()+500,rd&&lr())}}function Zr(l){pr!==null&&pr.tag===0&&!(it&6)&&da();var c=it;it|=1;var m=ks.transition,x=gt;try{if(ks.transition=null,gt=1,l)return l()}finally{gt=x,ks.transition=m,it=c,!(it&6)&&lr()}}function rg(){us=ua.current,$t(ua)}function ei(l,c){l.finishedWork=null,l.finishedLanes=0;var m=l.timeoutHandle;if(m!==-1&&(l.timeoutHandle=-1,nA(m)),Ht!==null)for(m=Ht.return;m!==null;){var x=m;switch(fm(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&sd();break;case 3:ia(),$t(Hn),$t(In),Nm();break;case 5:Sm(x);break;case 4:ia();break;case 13:$t(Ft);break;case 19:$t(Ft);break;case 10:vm(x.type._context);break;case 22:case 23:rg()}m=m.return}if(ln=l,Ht=l=gr(l.current,null),yn=us=c,tn=0,Ll=null,Jm=$d=Jr=0,Xn=Ml=null,Xr!==null){for(c=0;c<Xr.length;c++)if(m=Xr[c],x=m.interleaved,x!==null){m.interleaved=null;var k=x.next,I=m.pending;if(I!==null){var E=I.next;I.next=k,x.next=E}m.pending=x}Xr=null}return l}function sw(l,c){do{var m=Ht;try{if(bm(),md.current=bd,gd){for(var x=_t.memoizedState;x!==null;){var k=x.queue;k!==null&&(k.pending=null),x=x.next}gd=!1}if(Qr=0,an=en=_t=null,Rl=!1,Al=0,Qm.current=null,m===null||m.return===null){tn=1,Ll=c,Ht=null;break}e:{var I=l,E=m.return,M=m,V=c;if(c=yn,M.flags|=32768,V!==null&&typeof V=="object"&&typeof V.then=="function"){var le=V,ye=M,be=ye.tag;if(!(ye.mode&1)&&(be===0||be===11||be===15)){var ge=ye.alternate;ge?(ye.updateQueue=ge.updateQueue,ye.memoizedState=ge.memoizedState,ye.lanes=ge.lanes):(ye.updateQueue=null,ye.memoizedState=null)}var Ne=Tv(E);if(Ne!==null){Ne.flags&=-257,Ev(Ne,E,M,I,c),Ne.mode&1&&Nv(I,le,c),c=Ne,V=le;var Re=c.updateQueue;if(Re===null){var De=new Set;De.add(V),c.updateQueue=De}else Re.add(V);break e}else{if(!(c&1)){Nv(I,le,c),ig();break e}V=Error(t(426))}}else if(Rt&&M.mode&1){var Ut=Tv(E);if(Ut!==null){!(Ut.flags&65536)&&(Ut.flags|=256),Ev(Ut,E,M,I,c),ym(aa(V,M));break e}}I=V=aa(V,M),tn!==4&&(tn=2),Ml===null?Ml=[I]:Ml.push(I),I=E;do{switch(I.tag){case 3:I.flags|=65536,c&=-c,I.lanes|=c;var ne=Sv(I,V,c);Jb(I,ne);break e;case 1:M=V;var H=I.type,re=I.stateNode;if(!(I.flags&128)&&(typeof H.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(hr===null||!hr.has(re)))){I.flags|=65536,c&=-c,I.lanes|=c;var ve=$v(I,M,c);Jb(I,ve);break e}}I=I.return}while(I!==null)}iw(m)}catch(_e){c=_e,Ht===m&&m!==null&&(Ht=m=m.return);continue}break}while(!0)}function ow(){var l=Sd.current;return Sd.current=bd,l===null?bd:l}function ig(){(tn===0||tn===3||tn===2)&&(tn=4),ln===null||!(Jr&268435455)&&!($d&268435455)||mr(ln,yn)}function Dd(l,c){var m=it;it|=2;var x=ow();(ln!==l||yn!==c)&&(Lo=null,ei(l,c));do try{NA();break}catch(k){sw(l,k)}while(!0);if(bm(),it=m,Sd.current=x,Ht!==null)throw Error(t(261));return ln=null,yn=0,tn}function NA(){for(;Ht!==null;)rw(Ht)}function TA(){for(;Ht!==null&&!ZE();)rw(Ht)}function rw(l){var c=uw(l.alternate,l,us);l.memoizedProps=l.pendingProps,c===null?iw(l):Ht=c,Qm.current=null}function iw(l){var c=l;do{var m=c.alternate;if(l=c.return,c.flags&32768){if(m=wA(m,c),m!==null){m.flags&=32767,Ht=m;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{tn=6,Ht=null;return}}else if(m=vA(m,c,us),m!==null){Ht=m;return}if(c=c.sibling,c!==null){Ht=c;return}Ht=c=l}while(c!==null);tn===0&&(tn=5)}function ti(l,c,m){var x=gt,k=ks.transition;try{ks.transition=null,gt=1,EA(l,c,m,x)}finally{ks.transition=k,gt=x}return null}function EA(l,c,m,x){do da();while(pr!==null);if(it&6)throw Error(t(327));m=l.finishedWork;var k=l.finishedLanes;if(m===null)return null;if(l.finishedWork=null,l.finishedLanes=0,m===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var I=m.lanes|m.childLanes;if(uR(l,I),l===ln&&(Ht=ln=null,yn=0),!(m.subtreeFlags&2064)&&!(m.flags&2064)||Td||(Td=!0,cw(Lc,function(){return da(),null})),I=(m.flags&15990)!==0,m.subtreeFlags&15990||I){I=ks.transition,ks.transition=null;var E=gt;gt=1;var M=it;it|=4,Qm.current=null,CA(l,m),Yv(m,l),XR(im),Uc=!!rm,im=rm=null,l.current=m,IA(m),eR(),it=M,gt=E,ks.transition=I}else l.current=m;if(Td&&(Td=!1,pr=l,Ed=k),I=l.pendingLanes,I===0&&(hr=null),sR(m.stateNode),Yn(l,Vt()),c!==null)for(x=l.onRecoverableError,m=0;m<c.length;m++)k=c[m],x(k.value,{componentStack:k.stack,digest:k.digest});if(Nd)throw Nd=!1,l=eg,eg=null,l;return Ed&1&&l.tag!==0&&da(),I=l.pendingLanes,I&1?l===tg?Pl++:(Pl=0,tg=l):Pl=0,lr(),null}function da(){if(pr!==null){var l=K1(Ed),c=ks.transition,m=gt;try{if(ks.transition=null,gt=16>l?16:l,pr===null)var x=!1;else{if(l=pr,pr=null,Ed=0,it&6)throw Error(t(331));var k=it;for(it|=4,Te=l.current;Te!==null;){var I=Te,E=I.child;if(Te.flags&16){var M=I.deletions;if(M!==null){for(var V=0;V<M.length;V++){var le=M[V];for(Te=le;Te!==null;){var ye=Te;switch(ye.tag){case 0:case 11:case 15:Ol(8,ye,I)}var be=ye.child;if(be!==null)be.return=ye,Te=be;else for(;Te!==null;){ye=Te;var ge=ye.sibling,Ne=ye.return;if(jv(ye),ye===le){Te=null;break}if(ge!==null){ge.return=Ne,Te=ge;break}Te=Ne}}}var Re=I.alternate;if(Re!==null){var De=Re.child;if(De!==null){Re.child=null;do{var Ut=De.sibling;De.sibling=null,De=Ut}while(De!==null)}}Te=I}}if(I.subtreeFlags&2064&&E!==null)E.return=I,Te=E;else e:for(;Te!==null;){if(I=Te,I.flags&2048)switch(I.tag){case 0:case 11:case 15:Ol(9,I,I.return)}var ne=I.sibling;if(ne!==null){ne.return=I.return,Te=ne;break e}Te=I.return}}var H=l.current;for(Te=H;Te!==null;){E=Te;var re=E.child;if(E.subtreeFlags&2064&&re!==null)re.return=E,Te=re;else e:for(E=H;Te!==null;){if(M=Te,M.flags&2048)try{switch(M.tag){case 0:case 11:case 15:Id(9,M)}}catch(_e){Ot(M,M.return,_e)}if(M===E){Te=null;break e}var ve=M.sibling;if(ve!==null){ve.return=M.return,Te=ve;break e}Te=M.return}}if(it=k,lr(),no&&typeof no.onPostCommitFiberRoot=="function")try{no.onPostCommitFiberRoot(Mc,l)}catch{}x=!0}return x}finally{gt=m,ks.transition=c}}return!1}function aw(l,c,m){c=aa(m,c),c=Sv(l,c,1),l=cr(l,c,1),c=Mn(),l!==null&&(ll(l,1,c),Yn(l,c))}function Ot(l,c,m){if(l.tag===3)aw(l,l,m);else for(;c!==null;){if(c.tag===3){aw(c,l,m);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(hr===null||!hr.has(x))){l=aa(m,l),l=$v(c,l,1),c=cr(c,l,1),l=Mn(),c!==null&&(ll(c,1,l),Yn(c,l));break}}c=c.return}}function RA(l,c,m){var x=l.pingCache;x!==null&&x.delete(c),c=Mn(),l.pingedLanes|=l.suspendedLanes&m,ln===l&&(yn&m)===m&&(tn===4||tn===3&&(yn&130023424)===yn&&500>Vt()-Zm?ei(l,0):Jm|=m),Yn(l,c)}function lw(l,c){c===0&&(l.mode&1?(c=zc,zc<<=1,!(zc&130023424)&&(zc=4194304)):c=1);var m=Mn();l=Fo(l,c),l!==null&&(ll(l,c,m),Yn(l,m))}function AA(l){var c=l.memoizedState,m=0;c!==null&&(m=c.retryLane),lw(l,m)}function DA(l,c){var m=0;switch(l.tag){case 13:var x=l.stateNode,k=l.memoizedState;k!==null&&(m=k.retryLane);break;case 19:x=l.stateNode;break;default:throw Error(t(314))}x!==null&&x.delete(c),lw(l,m)}var uw;uw=function(l,c,m){if(l!==null)if(l.memoizedProps!==c.pendingProps||Hn.current)Kn=!0;else{if(!(l.lanes&m)&&!(c.flags&128))return Kn=!1,bA(l,c,m);Kn=!!(l.flags&131072)}else Kn=!1,Rt&&c.flags&1048576&&Vb(c,ad,c.index);switch(c.lanes=0,c.tag){case 2:var x=c.type;kd(l,c),l=c.pendingProps;var k=Zi(c,In.current);ra(c,m),k=Rm(null,c,x,l,k,m);var I=Am();return c.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,qn(x)?(I=!0,od(c)):I=!1,c.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,Cm(c),k.updater=vd,c.stateNode=k,k._reactInternals=c,Mm(c,x,l,m),c=Wm(null,c,x,!0,I,m)):(c.tag=0,Rt&&I&&pm(c),Ln(null,c,k,m),c=c.child),c;case 16:x=c.elementType;e:{switch(kd(l,c),l=c.pendingProps,k=x._init,x=k(x._payload),c.type=x,k=c.tag=_A(x),l=zs(x,l),k){case 0:c=Bm(null,c,x,l,m);break e;case 1:c=Ov(null,c,x,l,m);break e;case 11:c=Rv(null,c,x,l,m);break e;case 14:c=Av(null,c,x,zs(x.type,l),m);break e}throw Error(t(306,x,""))}return c;case 0:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:zs(x,k),Bm(l,c,x,k,m);case 1:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:zs(x,k),Ov(l,c,x,k,m);case 3:e:{if(Lv(c),l===null)throw Error(t(387));x=c.pendingProps,I=c.memoizedState,k=I.element,Qb(l,c),pd(c,x,null,m);var E=c.memoizedState;if(x=E.element,I.isDehydrated)if(I={element:x,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},c.updateQueue.baseState=I,c.memoizedState=I,c.flags&256){k=aa(Error(t(423)),c),c=Mv(l,c,x,m,k);break e}else if(x!==k){k=aa(Error(t(424)),c),c=Mv(l,c,x,m,k);break e}else for(ls=rr(c.stateNode.containerInfo.firstChild),as=c,Rt=!0,Ps=null,m=Xb(c,null,x,m),c.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(na(),x===k){c=Oo(l,c,m);break e}Ln(l,c,x,m)}c=c.child}return c;case 5:return ev(c),l===null&&gm(c),x=c.type,k=c.pendingProps,I=l!==null?l.memoizedProps:null,E=k.children,am(x,k)?E=null:I!==null&&am(x,I)&&(c.flags|=32),_v(l,c),Ln(l,c,E,m),c.child;case 6:return l===null&&gm(c),null;case 13:return Pv(l,c,m);case 4:return Im(c,c.stateNode.containerInfo),x=c.pendingProps,l===null?c.child=sa(c,null,x,m):Ln(l,c,x,m),c.child;case 11:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:zs(x,k),Rv(l,c,x,k,m);case 7:return Ln(l,c,c.pendingProps,m),c.child;case 8:return Ln(l,c,c.pendingProps.children,m),c.child;case 12:return Ln(l,c,c.pendingProps.children,m),c.child;case 10:e:{if(x=c.type._context,k=c.pendingProps,I=c.memoizedProps,E=k.value,Ct(cd,x._currentValue),x._currentValue=E,I!==null)if(Ms(I.value,E)){if(I.children===k.children&&!Hn.current){c=Oo(l,c,m);break e}}else for(I=c.child,I!==null&&(I.return=c);I!==null;){var M=I.dependencies;if(M!==null){E=I.child;for(var V=M.firstContext;V!==null;){if(V.context===x){if(I.tag===1){V=_o(-1,m&-m),V.tag=2;var le=I.updateQueue;if(le!==null){le=le.shared;var ye=le.pending;ye===null?V.next=V:(V.next=ye.next,ye.next=V),le.pending=V}}I.lanes|=m,V=I.alternate,V!==null&&(V.lanes|=m),wm(I.return,m,c),M.lanes|=m;break}V=V.next}}else if(I.tag===10)E=I.type===c.type?null:I.child;else if(I.tag===18){if(E=I.return,E===null)throw Error(t(341));E.lanes|=m,M=E.alternate,M!==null&&(M.lanes|=m),wm(E,m,c),E=I.sibling}else E=I.child;if(E!==null)E.return=I;else for(E=I;E!==null;){if(E===c){E=null;break}if(I=E.sibling,I!==null){I.return=E.return,E=I;break}E=E.return}I=E}Ln(l,c,k.children,m),c=c.child}return c;case 9:return k=c.type,x=c.pendingProps.children,ra(c,m),k=vs(k),x=x(k),c.flags|=1,Ln(l,c,x,m),c.child;case 14:return x=c.type,k=zs(x,c.pendingProps),k=zs(x.type,k),Av(l,c,x,k,m);case 15:return Dv(l,c,c.type,c.pendingProps,m);case 17:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:zs(x,k),kd(l,c),c.tag=1,qn(x)?(l=!0,od(c)):l=!1,ra(c,m),Cv(c,x,k),Mm(c,x,k,m),Wm(null,c,x,!0,l,m);case 19:return Bv(l,c,m);case 22:return Fv(l,c,m)}throw Error(t(156,c.tag))};function cw(l,c){return U1(l,c)}function FA(l,c,m,x){this.tag=l,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cs(l,c,m,x){return new FA(l,c,m,x)}function ag(l){return l=l.prototype,!(!l||!l.isReactComponent)}function _A(l){if(typeof l=="function")return ag(l)?1:0;if(l!=null){if(l=l.$$typeof,l===B)return 11;if(l===K)return 14}return 2}function gr(l,c){var m=l.alternate;return m===null?(m=Cs(l.tag,c,l.key,l.mode),m.elementType=l.elementType,m.type=l.type,m.stateNode=l.stateNode,m.alternate=l,l.alternate=m):(m.pendingProps=c,m.type=l.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=l.flags&14680064,m.childLanes=l.childLanes,m.lanes=l.lanes,m.child=l.child,m.memoizedProps=l.memoizedProps,m.memoizedState=l.memoizedState,m.updateQueue=l.updateQueue,c=l.dependencies,m.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},m.sibling=l.sibling,m.index=l.index,m.ref=l.ref,m}function Fd(l,c,m,x,k,I){var E=2;if(x=l,typeof l=="function")ag(l)&&(E=1);else if(typeof l=="string")E=5;else e:switch(l){case F:return ni(m.children,k,I,c);case O:E=8,k|=8;break;case D:return l=Cs(12,m,c,k|2),l.elementType=D,l.lanes=I,l;case U:return l=Cs(13,m,c,k),l.elementType=U,l.lanes=I,l;case Q:return l=Cs(19,m,c,k),l.elementType=Q,l.lanes=I,l;case te:return _d(m,k,I,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case A:E=10;break e;case T:E=9;break e;case B:E=11;break e;case K:E=14;break e;case J:E=16,x=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return c=Cs(E,m,c,k),c.elementType=l,c.type=x,c.lanes=I,c}function ni(l,c,m,x){return l=Cs(7,l,x,c),l.lanes=m,l}function _d(l,c,m,x){return l=Cs(22,l,x,c),l.elementType=te,l.lanes=m,l.stateNode={isHidden:!1},l}function lg(l,c,m){return l=Cs(6,l,null,c),l.lanes=m,l}function ug(l,c,m){return c=Cs(4,l.children!==null?l.children:[],l.key,c),c.lanes=m,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function OA(l,c,m,x,k){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lf(0),this.expirationTimes=Lf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lf(0),this.identifierPrefix=x,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function cg(l,c,m,x,k,I,E,M,V){return l=new OA(l,c,m,M,V),c===1?(c=1,I===!0&&(c|=8)):c=0,I=Cs(3,null,null,c),l.current=I,I.stateNode=l,I.memoizedState={element:x,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cm(I),l}function LA(l,c,m){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:R,key:x==null?null:""+x,children:l,containerInfo:c,implementation:m}}function dw(l){if(!l)return ar;l=l._reactInternals;e:{if(Gr(l)!==l||l.tag!==1)throw Error(t(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(qn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(l.tag===1){var m=l.type;if(qn(m))return zb(l,m,c)}return c}function hw(l,c,m,x,k,I,E,M,V){return l=cg(m,x,!0,l,k,I,E,M,V),l.context=dw(null),m=l.current,x=Mn(),k=fr(m),I=_o(x,k),I.callback=c??null,cr(m,I,k),l.current.lanes=k,ll(l,k,x),Yn(l,x),l}function Od(l,c,m,x){var k=c.current,I=Mn(),E=fr(k);return m=dw(m),c.context===null?c.context=m:c.pendingContext=m,c=_o(I,E),c.payload={element:l},x=x===void 0?null:x,x!==null&&(c.callback=x),l=cr(k,c,E),l!==null&&(Vs(l,k,E,I),hd(l,k,E)),E}function Ld(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function pw(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var m=l.retryLane;l.retryLane=m!==0&&m<c?m:c}}function dg(l,c){pw(l,c),(l=l.alternate)&&pw(l,c)}function MA(){return null}var fw=typeof reportError=="function"?reportError:function(l){console.error(l)};function hg(l){this._internalRoot=l}Md.prototype.render=hg.prototype.render=function(l){var c=this._internalRoot;if(c===null)throw Error(t(409));Od(l,c,null,null)},Md.prototype.unmount=hg.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var c=l.containerInfo;Zr(function(){Od(null,l,null,null)}),c[Eo]=null}};function Md(l){this._internalRoot=l}Md.prototype.unstable_scheduleHydration=function(l){if(l){var c=Q1();l={blockedOn:null,target:l,priority:c};for(var m=0;m<nr.length&&c!==0&&c<nr[m].priority;m++);nr.splice(m,0,l),m===0&&eb(l)}};function pg(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Pd(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function mw(){}function PA(l,c,m,x,k){if(k){if(typeof x=="function"){var I=x;x=function(){var le=Ld(E);I.call(le)}}var E=hw(c,x,l,0,null,!1,!1,"",mw);return l._reactRootContainer=E,l[Eo]=E.current,kl(l.nodeType===8?l.parentNode:l),Zr(),E}for(;k=l.lastChild;)l.removeChild(k);if(typeof x=="function"){var M=x;x=function(){var le=Ld(V);M.call(le)}}var V=cg(l,0,!1,null,null,!1,!1,"",mw);return l._reactRootContainer=V,l[Eo]=V.current,kl(l.nodeType===8?l.parentNode:l),Zr(function(){Od(c,V,m,x)}),V}function zd(l,c,m,x,k){var I=m._reactRootContainer;if(I){var E=I;if(typeof k=="function"){var M=k;k=function(){var V=Ld(E);M.call(V)}}Od(c,E,l,k)}else E=PA(m,c,l,k,x);return Ld(E)}X1=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var m=al(c.pendingLanes);m!==0&&(Mf(c,m|1),Yn(c,Vt()),!(it&6)&&(ca=Vt()+500,lr()))}break;case 13:Zr(function(){var x=Fo(l,1);if(x!==null){var k=Mn();Vs(x,l,1,k)}}),dg(l,1)}},Pf=function(l){if(l.tag===13){var c=Fo(l,134217728);if(c!==null){var m=Mn();Vs(c,l,134217728,m)}dg(l,134217728)}},Y1=function(l){if(l.tag===13){var c=fr(l),m=Fo(l,c);if(m!==null){var x=Mn();Vs(m,l,c,x)}dg(l,c)}},Q1=function(){return gt},J1=function(l,c){var m=gt;try{return gt=l,c()}finally{gt=m}},Rf=function(l,c,m){switch(c){case"input":if(lt(l,m),c=m.name,m.type==="radio"&&c!=null){for(m=l;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<m.length;c++){var x=m[c];if(x!==l&&x.form===l.form){var k=nd(x);if(!k)throw Error(t(90));Ze(x),lt(x,k)}}}break;case"textarea":jn(l,m);break;case"select":c=m.value,c!=null&&On(l,!!m.multiple,c,!1)}},L1=og,M1=Zr;var zA={usingClientEntryPoint:!1,Events:[Sl,Qi,nd,_1,O1,og]},zl={findFiberByHostInstance:jr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BA={bundleType:zl.bundleType,version:zl.version,rendererPackageName:zl.rendererPackageName,rendererConfig:zl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:S.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=W1(l),l===null?null:l.stateNode},findFiberByHostInstance:zl.findFiberByHostInstance||MA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bd.isDisabled&&Bd.supportsFiber)try{Mc=Bd.inject(BA),no=Bd}catch{}}return Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zA,Qn.createPortal=function(l,c){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pg(c))throw Error(t(200));return LA(l,c,null,m)},Qn.createRoot=function(l,c){if(!pg(l))throw Error(t(299));var m=!1,x="",k=fw;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onRecoverableError!==void 0&&(k=c.onRecoverableError)),c=cg(l,1,!1,null,null,m,!1,x,k),l[Eo]=c.current,kl(l.nodeType===8?l.parentNode:l),new hg(c)},Qn.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=W1(c),l=l===null?null:l.stateNode,l},Qn.flushSync=function(l){return Zr(l)},Qn.hydrate=function(l,c,m){if(!Pd(c))throw Error(t(200));return zd(null,l,c,!0,m)},Qn.hydrateRoot=function(l,c,m){if(!pg(l))throw Error(t(405));var x=m!=null&&m.hydratedSources||null,k=!1,I="",E=fw;if(m!=null&&(m.unstable_strictMode===!0&&(k=!0),m.identifierPrefix!==void 0&&(I=m.identifierPrefix),m.onRecoverableError!==void 0&&(E=m.onRecoverableError)),c=hw(c,null,l,1,m??null,k,!1,I,E),l[Eo]=c.current,kl(l),x)for(l=0;l<x.length;l++)m=x[l],k=m._getVersion,k=k(m._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[m,k]:c.mutableSourceEagerHydrationData.push(m,k);return new Md(c)},Qn.render=function(l,c,m){if(!Pd(c))throw Error(t(200));return zd(null,l,c,!1,m)},Qn.unmountComponentAtNode=function(l){if(!Pd(l))throw Error(t(40));return l._reactRootContainer?(Zr(function(){zd(null,null,l,!1,function(){l._reactRootContainer=null,l[Eo]=null})}),!0):!1},Qn.unstable_batchedUpdates=og,Qn.unstable_renderSubtreeIntoContainer=function(l,c,m,x){if(!Pd(m))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return zd(l,c,m,!1,x)},Qn.version="18.3.1-next-f1338f8080-20240426",Qn}var Cw;function NC(){if(Cw)return gg.exports;Cw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),gg.exports=XA(),gg.exports}var Iw;function YA(){if(Iw)return Wd;Iw=1;var n=NC();return Wd.createRoot=n.createRoot,Wd.hydrateRoot=n.hydrateRoot,Wd}var QA=YA(),bg={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Sw;function JA(){return Sw||(Sw=1,function(n){(function(){var e={}.hasOwnProperty;function t(){for(var r="",i=0;i<arguments.length;i++){var a=arguments[i];a&&(r=o(r,s(a)))}return r}function s(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return t.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var i="";for(var a in r)e.call(r,a)&&r[a]&&(i=o(i,a));return i}function o(r,i){return i?r?r+" "+i:r+i:r}n.exports?(t.default=t,n.exports=t):window.classNames=t})()}(bg)),bg.exports}var ZA=JA();const Je=pu(ZA);function eD(n,e){if(n==null)return{};var t={};for(var s in n)if({}.hasOwnProperty.call(n,s)){if(e.includes(s))continue;t[s]=n[s]}return t}function Kg(n,e){return Kg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,s){return t.__proto__=s,t},Kg(n,e)}function tD(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Kg(n,e)}const nD=["xxl","xl","lg","md","sm","xs"],sD="xs",My=ue.createContext({prefixes:{},breakpoints:nD,minBreakpoint:sD});function pt(n,e){const{prefixes:t}=ue.useContext(My);return n||t[e]||e}function TC(){const{breakpoints:n}=ue.useContext(My);return n}function EC(){const{minBreakpoint:n}=ue.useContext(My);return n}function Py(n){return n&&n.ownerDocument||document}function oD(n){var e=Py(n);return e&&e.defaultView||window}function rD(n,e){return oD(n).getComputedStyle(n,e)}var iD=/([A-Z])/g;function aD(n){return n.replace(iD,"-$1").toLowerCase()}var lD=/^ms-/;function Vd(n){return aD(n).replace(lD,"-ms-")}var uD=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function cD(n){return!!(n&&uD.test(n))}function fi(n,e){var t="",s="";if(typeof e=="string")return n.style.getPropertyValue(Vd(e))||rD(n).getPropertyValue(Vd(e));Object.keys(e).forEach(function(o){var r=e[o];!r&&r!==0?n.style.removeProperty(Vd(o)):cD(o)?s+=o+"("+r+") ":t+=Vd(o)+": "+r+";"}),s&&(t+="transform: "+s+";"),n.style.cssText+=";"+t}var vg={exports:{}},wg,$w;function dD(){if($w)return wg;$w=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return wg=n,wg}var kg,Nw;function hD(){if(Nw)return kg;Nw=1;var n=dD();function e(){}function t(){}return t.resetWarningCache=e,kg=function(){function s(i,a,u,d,h,p){if(p!==n){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}s.isRequired=s;function o(){return s}var r={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:o,element:s,elementType:s,instanceOf:o,node:s,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:t,resetWarningCache:e};return r.PropTypes=r,r},kg}var Tw;function pD(){return Tw||(Tw=1,vg.exports=hD()()),vg.exports}var fD=pD();const Bo=pu(fD);var mD=NC();const wa=pu(mD),Ew={disabled:!1},RC=di.createContext(null);var gD=function(e){return e.scrollTop},jl="unmounted",ri="exited",uo="entering",br="entered",hh="exiting",qo=function(n){tD(e,n);function e(s,o){var r;r=n.call(this,s,o)||this;var i=o,a=i&&!i.isMounting?s.enter:s.appear,u;return r.appearStatus=null,s.in?a?(u=ri,r.appearStatus=uo):u=br:s.unmountOnExit||s.mountOnEnter?u=jl:u=ri,r.state={status:u},r.nextCallback=null,r}e.getDerivedStateFromProps=function(o,r){var i=o.in;return i&&r.status===jl?{status:ri}:null};var t=e.prototype;return t.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},t.componentDidUpdate=function(o){var r=null;if(o!==this.props){var i=this.state.status;this.props.in?i!==uo&&i!==br&&(r=uo):(i===uo||i===br)&&(r=hh)}this.updateStatus(!1,r)},t.componentWillUnmount=function(){this.cancelNextCallback()},t.getTimeouts=function(){var o=this.props.timeout,r,i,a;return r=i=a=o,o!=null&&typeof o!="number"&&(r=o.exit,i=o.enter,a=o.appear!==void 0?o.appear:i),{exit:r,enter:i,appear:a}},t.updateStatus=function(o,r){if(o===void 0&&(o=!1),r!==null)if(this.cancelNextCallback(),r===uo){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:wa.findDOMNode(this);i&&gD(i)}this.performEnter(o)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ri&&this.setState({status:jl})},t.performEnter=function(o){var r=this,i=this.props.enter,a=this.context?this.context.isMounting:o,u=this.props.nodeRef?[a]:[wa.findDOMNode(this),a],d=u[0],h=u[1],p=this.getTimeouts(),f=a?p.appear:p.enter;if(!o&&!i||Ew.disabled){this.safeSetState({status:br},function(){r.props.onEntered(d)});return}this.props.onEnter(d,h),this.safeSetState({status:uo},function(){r.props.onEntering(d,h),r.onTransitionEnd(f,function(){r.safeSetState({status:br},function(){r.props.onEntered(d,h)})})})},t.performExit=function(){var o=this,r=this.props.exit,i=this.getTimeouts(),a=this.props.nodeRef?void 0:wa.findDOMNode(this);if(!r||Ew.disabled){this.safeSetState({status:ri},function(){o.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:hh},function(){o.props.onExiting(a),o.onTransitionEnd(i.exit,function(){o.safeSetState({status:ri},function(){o.props.onExited(a)})})})},t.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},t.safeSetState=function(o,r){r=this.setNextCallback(r),this.setState(o,r)},t.setNextCallback=function(o){var r=this,i=!0;return this.nextCallback=function(a){i&&(i=!1,r.nextCallback=null,o(a))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},t.onTransitionEnd=function(o,r){this.setNextCallback(r);var i=this.props.nodeRef?this.props.nodeRef.current:wa.findDOMNode(this),a=o==null&&!this.props.addEndListener;if(!i||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var u=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],d=u[0],h=u[1];this.props.addEndListener(d,h)}o!=null&&setTimeout(this.nextCallback,o)},t.render=function(){var o=this.state.status;if(o===jl)return null;var r=this.props,i=r.children;r.in,r.mountOnEnter,r.unmountOnExit,r.appear,r.enter,r.exit,r.timeout,r.addEndListener,r.onEnter,r.onEntering,r.onEntered,r.onExit,r.onExiting,r.onExited,r.nodeRef;var a=eD(r,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return di.createElement(RC.Provider,{value:null},typeof i=="function"?i(o,a):di.cloneElement(di.Children.only(i),a))},e}(di.Component);qo.contextType=RC;qo.propTypes={};function ha(){}qo.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ha,onEntering:ha,onEntered:ha,onExit:ha,onExiting:ha,onExited:ha};qo.UNMOUNTED=jl;qo.EXITED=ri;qo.ENTERING=uo;qo.ENTERED=br;qo.EXITING=hh;function yD(n){return n.code==="Escape"||n.keyCode===27}function xD(){const n=ue.version.split(".");return{major:+n[0],minor:+n[1],patch:+n[2]}}function zy(n){if(!n||typeof n=="function")return null;const{major:e}=xD();return e>=19?n.props.ref:n.ref}const jh=!!(typeof window<"u"&&window.document&&window.document.createElement);var Xg=!1,Yg=!1;try{var Cg={get passive(){return Xg=!0},get once(){return Yg=Xg=!0}};jh&&(window.addEventListener("test",Cg,Cg),window.removeEventListener("test",Cg,!0))}catch{}function bD(n,e,t,s){if(s&&typeof s!="boolean"&&!Yg){var o=s.once,r=s.capture,i=t;!Yg&&o&&(i=t.__once||function a(u){this.removeEventListener(e,a,r),t.call(this,u)},t.__once=i),n.addEventListener(e,i,Xg?s:r)}n.addEventListener(e,t,s)}function vD(n,e,t,s){var o=s&&typeof s!="boolean"?s.capture:s;n.removeEventListener(e,t,o),t.__once&&n.removeEventListener(e,t.__once,o)}function ph(n,e,t,s){return bD(n,e,t,s),function(){vD(n,e,t,s)}}function wD(n,e,t,s){if(s===void 0&&(s=!0),n){var o=document.createEvent("HTMLEvents");o.initEvent(e,t,s),n.dispatchEvent(o)}}function kD(n){var e=fi(n,"transitionDuration")||"",t=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*t}function CD(n,e,t){t===void 0&&(t=5);var s=!1,o=setTimeout(function(){s||wD(n,"transitionend",!0)},e+t),r=ph(n,"transitionend",function(){s=!0},{once:!0});return function(){clearTimeout(o),r()}}function ID(n,e,t,s){t==null&&(t=kD(n)||0);var o=CD(n,t,s),r=ph(n,"transitionend",e);return function(){o(),r()}}function Rw(n,e){const t=fi(n,e)||"",s=t.indexOf("ms")===-1?1e3:1;return parseFloat(t)*s}function AC(n,e){const t=Rw(n,"transitionDuration"),s=Rw(n,"transitionDelay"),o=ID(n,r=>{r.target===n&&(o(),e(r))},t+s)}function SD(n){n.offsetHeight}const Aw=n=>!n||typeof n=="function"?n:e=>{n.current=e};function $D(n,e){const t=Aw(n),s=Aw(e);return o=>{t&&t(o),s&&s(o)}}function ND(n,e){return ue.useMemo(()=>$D(n,e),[n,e])}function TD(n){return n&&"setState"in n?wa.findDOMNode(n):n??null}const DC=di.forwardRef(({onEnter:n,onEntering:e,onEntered:t,onExit:s,onExiting:o,onExited:r,addEndListener:i,children:a,childRef:u,...d},h)=>{const p=ue.useRef(null),f=ND(p,u),g=R=>{f(TD(R))},y=R=>F=>{R&&p.current&&R(p.current,F)},b=ue.useCallback(y(n),[n]),v=ue.useCallback(y(e),[e]),w=ue.useCallback(y(t),[t]),C=ue.useCallback(y(s),[s]),$=ue.useCallback(y(o),[o]),S=ue.useCallback(y(r),[r]),N=ue.useCallback(y(i),[i]);return oe.jsx(qo,{ref:h,...d,onEnter:b,onEntered:w,onEntering:v,onExit:C,onExited:S,onExiting:$,addEndListener:N,nodeRef:p,children:typeof a=="function"?(R,F)=>a(R,{...F,ref:g}):di.cloneElement(a,{ref:g})})});function ED(n){const e=ue.useRef(n);return ue.useEffect(()=>{e.current=n},[n]),e}function FC(n){const e=ED(n);return ue.useCallback(function(...t){return e.current&&e.current(...t)},[e])}const By=n=>ue.forwardRef((e,t)=>oe.jsx("div",{...e,ref:t,className:Je(e.className,n)}));function RD(n){const e=ue.useRef(n);return ue.useEffect(()=>{e.current=n},[n]),e}function ai(n){const e=RD(n);return ue.useCallback(function(...t){return e.current&&e.current(...t)},[e])}function AD(){const n=ue.useRef(!0),e=ue.useRef(()=>n.current);return ue.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),e.current}function DD(n){const e=ue.useRef(null);return ue.useEffect(()=>{e.current=n}),e.current}const FD=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",_D=typeof document<"u",Dw=_D||FD?ue.useLayoutEffect:ue.useEffect,OD=["as","disabled"];function LD(n,e){if(n==null)return{};var t={};for(var s in n)if({}.hasOwnProperty.call(n,s)){if(e.indexOf(s)>=0)continue;t[s]=n[s]}return t}function MD(n){return!n||n.trim()==="#"}function _C({tagName:n,disabled:e,href:t,target:s,rel:o,role:r,onClick:i,tabIndex:a=0,type:u}){n||(t!=null||s!=null||o!=null?n="a":n="button");const d={tagName:n};if(n==="button")return[{type:u||"button",disabled:e},d];const h=f=>{if((e||n==="a"&&MD(t))&&f.preventDefault(),e){f.stopPropagation();return}i==null||i(f)},p=f=>{f.key===" "&&(f.preventDefault(),h(f))};return n==="a"&&(t||(t="#"),e&&(t=void 0)),[{role:r??"button",disabled:void 0,tabIndex:e?void 0:a,href:t,target:n==="a"?s:void 0,"aria-disabled":e||void 0,rel:n==="a"?o:void 0,onClick:h,onKeyDown:p},d]}const PD=ue.forwardRef((n,e)=>{let{as:t,disabled:s}=n,o=LD(n,OD);const[r,{tagName:i}]=_C(Object.assign({tagName:t,disabled:s},o));return oe.jsx(i,Object.assign({},o,r,{ref:e}))});PD.displayName="Button";const zD={[uo]:"show",[br]:"show"},OC=ue.forwardRef(({className:n,children:e,transitionClasses:t={},onEnter:s,...o},r)=>{const i={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...o},a=ue.useCallback((u,d)=>{SD(u),s==null||s(u,d)},[s]);return oe.jsx(DC,{ref:r,addEndListener:AC,...i,onEnter:a,childRef:zy(e),children:(u,d)=>ue.cloneElement(e,{...d,className:Je("fade",n,e.props.className,zD[u],t[u])})})});OC.displayName="Fade";const BD={"aria-label":Bo.string,onClick:Bo.func,variant:Bo.oneOf(["white"])},Wy=ue.forwardRef(({className:n,variant:e,"aria-label":t="Close",...s},o)=>oe.jsx("button",{ref:o,type:"button",className:Je("btn-close",e&&`btn-close-${e}`,n),"aria-label":t,...s}));Wy.displayName="CloseButton";Wy.propTypes=BD;const fo=ue.forwardRef(({as:n,bsPrefix:e,variant:t="primary",size:s,active:o=!1,disabled:r=!1,className:i,...a},u)=>{const d=pt(e,"btn"),[h,{tagName:p}]=_C({tagName:n,disabled:r,...a}),f=p;return oe.jsx(f,{...h,...a,ref:u,disabled:r,className:Je(i,d,o&&"active",t&&`${d}-${t}`,s&&`${d}-${s}`,a.href&&r&&"disabled")})});fo.displayName="Button";const Vy=ue.forwardRef(({className:n,bsPrefix:e,as:t="div",...s},o)=>(e=pt(e,"card-body"),oe.jsx(t,{ref:o,className:Je(n,e),...s})));Vy.displayName="CardBody";const LC=ue.forwardRef(({className:n,bsPrefix:e,as:t="div",...s},o)=>(e=pt(e,"card-footer"),oe.jsx(t,{ref:o,className:Je(n,e),...s})));LC.displayName="CardFooter";const MC=ue.createContext(null);MC.displayName="CardHeaderContext";const PC=ue.forwardRef(({bsPrefix:n,className:e,as:t="div",...s},o)=>{const r=pt(n,"card-header"),i=ue.useMemo(()=>({cardHeaderBsPrefix:r}),[r]);return oe.jsx(MC.Provider,{value:i,children:oe.jsx(t,{ref:o,...s,className:Je(e,r)})})});PC.displayName="CardHeader";const zC=ue.forwardRef(({bsPrefix:n,className:e,variant:t,as:s="img",...o},r)=>{const i=pt(n,"card-img");return oe.jsx(s,{ref:r,className:Je(t?`${i}-${t}`:i,e),...o})});zC.displayName="CardImg";const BC=ue.forwardRef(({className:n,bsPrefix:e,as:t="div",...s},o)=>(e=pt(e,"card-img-overlay"),oe.jsx(t,{ref:o,className:Je(n,e),...s})));BC.displayName="CardImgOverlay";const WC=ue.forwardRef(({className:n,bsPrefix:e,as:t="a",...s},o)=>(e=pt(e,"card-link"),oe.jsx(t,{ref:o,className:Je(n,e),...s})));WC.displayName="CardLink";const WD=By("h6"),VC=ue.forwardRef(({className:n,bsPrefix:e,as:t=WD,...s},o)=>(e=pt(e,"card-subtitle"),oe.jsx(t,{ref:o,className:Je(n,e),...s})));VC.displayName="CardSubtitle";const UC=ue.forwardRef(({className:n,bsPrefix:e,as:t="p",...s},o)=>(e=pt(e,"card-text"),oe.jsx(t,{ref:o,className:Je(n,e),...s})));UC.displayName="CardText";const VD=By("h5"),GC=ue.forwardRef(({className:n,bsPrefix:e,as:t=VD,...s},o)=>(e=pt(e,"card-title"),oe.jsx(t,{ref:o,className:Je(n,e),...s})));GC.displayName="CardTitle";const jC=ue.forwardRef(({bsPrefix:n,className:e,bg:t,text:s,border:o,body:r=!1,children:i,as:a="div",...u},d)=>{const h=pt(n,"card");return oe.jsx(a,{ref:d,...u,className:Je(e,h,t&&`bg-${t}`,s&&`text-${s}`,o&&`border-${o}`),children:r?oe.jsx(Vy,{children:i}):i})});jC.displayName="Card";const Fw=Object.assign(jC,{Img:zC,Title:GC,Subtitle:VC,Body:Vy,Link:WC,Text:UC,Header:PC,Footer:LC,ImgOverlay:BC});function UD(n,e){return ue.Children.toArray(n).some(t=>ue.isValidElement(t)&&t.type===e)}function GD({as:n,bsPrefix:e,className:t,...s}){e=pt(e,"col");const o=TC(),r=EC(),i=[],a=[];return o.forEach(u=>{const d=s[u];delete s[u];let h,p,f;typeof d=="object"&&d!=null?{span:h,offset:p,order:f}=d:h=d;const g=u!==r?`-${u}`:"";h&&i.push(h===!0?`${e}${g}`:`${e}${g}-${h}`),f!=null&&a.push(`order${g}-${f}`),p!=null&&a.push(`offset${g}-${p}`)}),[{...s,className:Je(t,...i,...a)},{as:n,bsPrefix:e,spans:i}]}const eu=ue.forwardRef((n,e)=>{const[{className:t,...s},{as:o="div",bsPrefix:r,spans:i}]=GD(n);return oe.jsx(o,{...s,ref:e,className:Je(t,!i.length&&r)})});eu.displayName="Col";const fu=ue.forwardRef(({bsPrefix:n,fluid:e=!1,as:t="div",className:s,...o},r)=>{const i=pt(n,"container"),a=typeof e=="string"?`-${e}`:"-fluid";return oe.jsx(t,{ref:r,...o,className:Je(s,e?`${i}${a}`:i)})});fu.displayName="Container";var jD=Function.prototype.bind.call(Function.prototype.call,[].slice);function pa(n,e){return jD(n.querySelectorAll(e))}function _w(n,e){if(n.contains)return n.contains(e);if(n.compareDocumentPosition)return n===e||!!(n.compareDocumentPosition(e)&16)}const HD="data-rr-ui-";function qD(n){return`${HD}${n}`}const HC=ue.createContext(jh?window:void 0);HC.Provider;function Uy(){return ue.useContext(HC)}const KD=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",XD=typeof document<"u",YD=XD||KD?ue.useLayoutEffect:ue.useEffect,QD={type:Bo.string,tooltip:Bo.bool,as:Bo.elementType},Hh=ue.forwardRef(({as:n="div",className:e,type:t="valid",tooltip:s=!1,...o},r)=>oe.jsx(n,{...o,ref:r,className:Je(e,`${t}-${s?"tooltip":"feedback"}`)}));Hh.displayName="Feedback";Hh.propTypes=QD;const Vo=ue.createContext({}),Gy=ue.forwardRef(({id:n,bsPrefix:e,className:t,type:s="checkbox",isValid:o=!1,isInvalid:r=!1,as:i="input",...a},u)=>{const{controlId:d}=ue.useContext(Vo);return e=pt(e,"form-check-input"),oe.jsx(i,{...a,ref:u,type:s,id:n||d,className:Je(t,e,o&&"is-valid",r&&"is-invalid")})});Gy.displayName="FormCheckInput";const fh=ue.forwardRef(({bsPrefix:n,className:e,htmlFor:t,...s},o)=>{const{controlId:r}=ue.useContext(Vo);return n=pt(n,"form-check-label"),oe.jsx("label",{...s,ref:o,htmlFor:t||r,className:Je(e,n)})});fh.displayName="FormCheckLabel";const qC=ue.forwardRef(({id:n,bsPrefix:e,bsSwitchPrefix:t,inline:s=!1,reverse:o=!1,disabled:r=!1,isValid:i=!1,isInvalid:a=!1,feedbackTooltip:u=!1,feedback:d,feedbackType:h,className:p,style:f,title:g="",type:y="checkbox",label:b,children:v,as:w="input",...C},$)=>{e=pt(e,"form-check"),t=pt(t,"form-switch");const{controlId:S}=ue.useContext(Vo),N=ue.useMemo(()=>({controlId:n||S}),[S,n]),R=!v&&b!=null&&b!==!1||UD(v,fh),F=oe.jsx(Gy,{...C,type:y==="switch"?"checkbox":y,ref:$,isValid:i,isInvalid:a,disabled:r,as:w});return oe.jsx(Vo.Provider,{value:N,children:oe.jsx("div",{style:f,className:Je(p,R&&e,s&&`${e}-inline`,o&&`${e}-reverse`,y==="switch"&&t),children:v||oe.jsxs(oe.Fragment,{children:[F,R&&oe.jsx(fh,{title:g,children:b}),d&&oe.jsx(Hh,{type:h,tooltip:u,children:d})]})})})});qC.displayName="FormCheck";const mh=Object.assign(qC,{Input:Gy,Label:fh}),KC=ue.forwardRef(({bsPrefix:n,type:e,size:t,htmlSize:s,id:o,className:r,isValid:i=!1,isInvalid:a=!1,plaintext:u,readOnly:d,as:h="input",...p},f)=>{const{controlId:g}=ue.useContext(Vo);return n=pt(n,"form-control"),oe.jsx(h,{...p,type:e,size:s,ref:f,readOnly:d,id:o||g,className:Je(r,u?`${n}-plaintext`:n,t&&`${n}-${t}`,e==="color"&&`${n}-color`,i&&"is-valid",a&&"is-invalid")})});KC.displayName="FormControl";const JD=Object.assign(KC,{Feedback:Hh}),XC=ue.forwardRef(({className:n,bsPrefix:e,as:t="div",...s},o)=>(e=pt(e,"form-floating"),oe.jsx(t,{ref:o,className:Je(n,e),...s})));XC.displayName="FormFloating";const jy=ue.forwardRef(({controlId:n,as:e="div",...t},s)=>{const o=ue.useMemo(()=>({controlId:n}),[n]);return oe.jsx(Vo.Provider,{value:o,children:oe.jsx(e,{...t,ref:s})})});jy.displayName="FormGroup";const YC=ue.forwardRef(({as:n="label",bsPrefix:e,column:t=!1,visuallyHidden:s=!1,className:o,htmlFor:r,...i},a)=>{const{controlId:u}=ue.useContext(Vo);e=pt(e,"form-label");let d="col-form-label";typeof t=="string"&&(d=`${d} ${d}-${t}`);const h=Je(o,e,s&&"visually-hidden",t&&d);return r=r||u,t?oe.jsx(eu,{ref:a,as:"label",className:h,htmlFor:r,...i}):oe.jsx(n,{ref:a,className:h,htmlFor:r,...i})});YC.displayName="FormLabel";const QC=ue.forwardRef(({bsPrefix:n,className:e,id:t,...s},o)=>{const{controlId:r}=ue.useContext(Vo);return n=pt(n,"form-range"),oe.jsx("input",{...s,type:"range",ref:o,className:Je(e,n),id:t||r})});QC.displayName="FormRange";const JC=ue.forwardRef(({bsPrefix:n,size:e,htmlSize:t,className:s,isValid:o=!1,isInvalid:r=!1,id:i,...a},u)=>{const{controlId:d}=ue.useContext(Vo);return n=pt(n,"form-select"),oe.jsx("select",{...a,size:t,ref:u,className:Je(s,n,e&&`${n}-${e}`,o&&"is-valid",r&&"is-invalid"),id:i||d})});JC.displayName="FormSelect";const ZC=ue.forwardRef(({bsPrefix:n,className:e,as:t="small",muted:s,...o},r)=>(n=pt(n,"form-text"),oe.jsx(t,{...o,ref:r,className:Je(e,n,s&&"text-muted")})));ZC.displayName="FormText";const eI=ue.forwardRef((n,e)=>oe.jsx(mh,{...n,ref:e,type:"switch"}));eI.displayName="Switch";const ZD=Object.assign(eI,{Input:mh.Input,Label:mh.Label}),tI=ue.forwardRef(({bsPrefix:n,className:e,children:t,controlId:s,label:o,...r},i)=>(n=pt(n,"form-floating"),oe.jsxs(jy,{ref:i,className:Je(e,n),controlId:s,...r,children:[t,oe.jsx("label",{htmlFor:s,children:o})]})));tI.displayName="FloatingLabel";const eF={_ref:Bo.any,validated:Bo.bool,as:Bo.elementType},Hy=ue.forwardRef(({className:n,validated:e,as:t="form",...s},o)=>oe.jsx(t,{...s,ref:o,className:Je(n,e&&"was-validated")}));Hy.displayName="Form";Hy.propTypes=eF;const tF=Object.assign(Hy,{Group:jy,Control:JD,Floating:XC,Check:mh,Switch:ZD,Label:YC,Text:ZC,Range:QC,Select:JC,FloatingLabel:tI}),Ow=n=>!n||typeof n=="function"?n:e=>{n.current=e};function nF(n,e){const t=Ow(n),s=Ow(e);return o=>{t&&t(o),s&&s(o)}}function qy(n,e){return ue.useMemo(()=>nF(n,e),[n,e])}function Ig(n){n===void 0&&(n=Py());try{var e=n.activeElement;return!e||!e.nodeName?null:e}catch{return n.body}}function sF(n){const e=ue.useRef(n);return e.current=n,e}function oF(n){const e=sF(n);ue.useEffect(()=>()=>e.current(),[])}function rF(n=document){const e=n.defaultView;return Math.abs(e.innerWidth-n.documentElement.clientWidth)}const Lw=qD("modal-open");class Ky{constructor({ownerDocument:e,handleContainerOverflow:t=!0,isRTL:s=!1}={}){this.handleContainerOverflow=t,this.isRTL=s,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return rF(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const t={overflow:"hidden"},s=this.isRTL?"paddingLeft":"paddingRight",o=this.getElement();e.style={overflow:o.style.overflow,[s]:o.style[s]},e.scrollBarWidth&&(t[s]=`${parseInt(fi(o,s)||"0",10)+e.scrollBarWidth}px`),o.setAttribute(Lw,""),fi(o,t)}reset(){[...this.modals].forEach(e=>this.remove(e))}removeContainerStyle(e){const t=this.getElement();t.removeAttribute(Lw),Object.assign(t.style,e.style)}add(e){let t=this.modals.indexOf(e);return t!==-1||(t=this.modals.length,this.modals.push(e),this.setModalAttributes(e),t!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),t}remove(e){const t=this.modals.indexOf(e);t!==-1&&(this.modals.splice(t,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}const Sg=(n,e)=>jh?n==null?(e||Py()).body:(typeof n=="function"&&(n=n()),n&&"current"in n&&(n=n.current),n&&("nodeType"in n||n.getBoundingClientRect)?n:null):null;function iF(n,e){const t=Uy(),[s,o]=ue.useState(()=>Sg(n,t==null?void 0:t.document));if(!s){const r=Sg(n);r&&o(r)}return ue.useEffect(()=>{},[e,s]),ue.useEffect(()=>{const r=Sg(n);r!==s&&o(r)},[n,s]),s}function aF({children:n,in:e,onExited:t,mountOnEnter:s,unmountOnExit:o}){const r=ue.useRef(null),i=ue.useRef(e),a=ai(t);ue.useEffect(()=>{e?i.current=!0:a(r.current)},[e,a]);const u=qy(r,n.ref),d=ue.cloneElement(n,{ref:u});return e?d:o||!i.current&&s?null:d}const lF=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function uF(n,e){if(n==null)return{};var t={};for(var s in n)if({}.hasOwnProperty.call(n,s)){if(e.indexOf(s)>=0)continue;t[s]=n[s]}return t}function cF(n){let{onEnter:e,onEntering:t,onEntered:s,onExit:o,onExiting:r,onExited:i,addEndListener:a,children:u}=n,d=uF(n,lF);const h=ue.useRef(null),p=qy(h,zy(u)),f=S=>N=>{S&&h.current&&S(h.current,N)},g=ue.useCallback(f(e),[e]),y=ue.useCallback(f(t),[t]),b=ue.useCallback(f(s),[s]),v=ue.useCallback(f(o),[o]),w=ue.useCallback(f(r),[r]),C=ue.useCallback(f(i),[i]),$=ue.useCallback(f(a),[a]);return Object.assign({},d,{nodeRef:h},e&&{onEnter:g},t&&{onEntering:y},s&&{onEntered:b},o&&{onExit:v},r&&{onExiting:w},i&&{onExited:C},a&&{addEndListener:$},{children:typeof u=="function"?(S,N)=>u(S,Object.assign({},N,{ref:p})):ue.cloneElement(u,{ref:p})})}const dF=["component"];function hF(n,e){if(n==null)return{};var t={};for(var s in n)if({}.hasOwnProperty.call(n,s)){if(e.indexOf(s)>=0)continue;t[s]=n[s]}return t}const pF=ue.forwardRef((n,e)=>{let{component:t}=n,s=hF(n,dF);const o=cF(s);return oe.jsx(t,Object.assign({ref:e},o))});function fF({in:n,onTransition:e}){const t=ue.useRef(null),s=ue.useRef(!0),o=ai(e);return Dw(()=>{if(!t.current)return;let r=!1;return o({in:n,element:t.current,initial:s.current,isStale:()=>r}),()=>{r=!0}},[n,o]),Dw(()=>(s.current=!1,()=>{s.current=!0}),[]),t}function mF({children:n,in:e,onExited:t,onEntered:s,transition:o}){const[r,i]=ue.useState(!e);e&&r&&i(!1);const a=fF({in:!!e,onTransition:d=>{const h=()=>{d.isStale()||(d.in?s==null||s(d.element,d.initial):(i(!0),t==null||t(d.element)))};Promise.resolve(o(d)).then(h,p=>{throw d.in||i(!0),p})}}),u=qy(a,n.ref);return r&&!e?null:ue.cloneElement(n,{ref:u})}function Mw(n,e,t){return n?oe.jsx(pF,Object.assign({},t,{component:n})):e?oe.jsx(mF,Object.assign({},t,{transition:e})):oe.jsx(aF,Object.assign({},t))}const gF=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function yF(n,e){if(n==null)return{};var t={};for(var s in n)if({}.hasOwnProperty.call(n,s)){if(e.indexOf(s)>=0)continue;t[s]=n[s]}return t}let $g;function xF(n){return $g||($g=new Ky({ownerDocument:n==null?void 0:n.document})),$g}function bF(n){const e=Uy(),t=n||xF(e),s=ue.useRef({dialog:null,backdrop:null});return Object.assign(s.current,{add:()=>t.add(s.current),remove:()=>t.remove(s.current),isTopModal:()=>t.isTopModal(s.current),setDialogRef:ue.useCallback(o=>{s.current.dialog=o},[]),setBackdropRef:ue.useCallback(o=>{s.current.backdrop=o},[])})}const nI=ue.forwardRef((n,e)=>{let{show:t=!1,role:s="dialog",className:o,style:r,children:i,backdrop:a=!0,keyboard:u=!0,onBackdropClick:d,onEscapeKeyDown:h,transition:p,runTransition:f,backdropTransition:g,runBackdropTransition:y,autoFocus:b=!0,enforceFocus:v=!0,restoreFocus:w=!0,restoreFocusOptions:C,renderDialog:$,renderBackdrop:S=Pe=>oe.jsx("div",Object.assign({},Pe)),manager:N,container:R,onShow:F,onHide:O=()=>{},onExit:D,onExited:A,onExiting:T,onEnter:B,onEntering:U,onEntered:Q}=n,K=yF(n,gF);const J=Uy(),te=iF(R),P=bF(N),X=AD(),Y=DD(t),[L,W]=ue.useState(!t),ie=ue.useRef(null);ue.useImperativeHandle(e,()=>P,[P]),jh&&!Y&&t&&(ie.current=Ig(J==null?void 0:J.document)),t&&L&&W(!1);const he=ai(()=>{if(P.add(),Fe.current=ph(document,"keydown",ke),Ce.current=ph(document,"focus",()=>setTimeout(me),!0),F&&F(),b){var Pe,tt;const lt=Ig((Pe=(tt=P.dialog)==null?void 0:tt.ownerDocument)!=null?Pe:J==null?void 0:J.document);P.dialog&&lt&&!_w(P.dialog,lt)&&(ie.current=lt,P.dialog.focus())}}),pe=ai(()=>{if(P.remove(),Fe.current==null||Fe.current(),Ce.current==null||Ce.current(),w){var Pe;(Pe=ie.current)==null||Pe.focus==null||Pe.focus(C),ie.current=null}});ue.useEffect(()=>{!t||!te||he()},[t,te,he]),ue.useEffect(()=>{L&&pe()},[L,pe]),oF(()=>{pe()});const me=ai(()=>{if(!v||!X()||!P.isTopModal())return;const Pe=Ig(J==null?void 0:J.document);P.dialog&&Pe&&!_w(P.dialog,Pe)&&P.dialog.focus()}),we=ai(Pe=>{Pe.target===Pe.currentTarget&&(d==null||d(Pe),a===!0&&O())}),ke=ai(Pe=>{u&&yD(Pe)&&P.isTopModal()&&(h==null||h(Pe),Pe.defaultPrevented||O())}),Ce=ue.useRef(),Fe=ue.useRef(),Ue=(...Pe)=>{W(!0),A==null||A(...Pe)};if(!te)return null;const Ze=Object.assign({role:s,ref:P.setDialogRef,"aria-modal":s==="dialog"?!0:void 0},K,{style:r,className:o,tabIndex:-1});let et=$?$(Ze):oe.jsx("div",Object.assign({},Ze,{children:ue.cloneElement(i,{role:"document"})}));et=Mw(p,f,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!t,onExit:D,onExiting:T,onExited:Ue,onEnter:B,onEntering:U,onEntered:Q,children:et});let at=null;return a&&(at=S({ref:P.setBackdropRef,onClick:we}),at=Mw(g,y,{in:!!t,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:at})),oe.jsx(oe.Fragment,{children:wa.createPortal(oe.jsxs(oe.Fragment,{children:[at,et]}),te)})});nI.displayName="Modal";const vF=Object.assign(nI,{Manager:Ky});function wF(n,e){return n.classList?n.classList.contains(e):(" "+(n.className.baseVal||n.className)+" ").indexOf(" "+e+" ")!==-1}function kF(n,e){n.classList?n.classList.add(e):wF(n,e)||(typeof n.className=="string"?n.className=n.className+" "+e:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+e))}function Pw(n,e){return n.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function CF(n,e){n.classList?n.classList.remove(e):typeof n.className=="string"?n.className=Pw(n.className,e):n.setAttribute("class",Pw(n.className&&n.className.baseVal||"",e))}const fa={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class sI extends Ky{adjustAndStore(e,t,s){const o=t.style[e];t.dataset[e]=o,fi(t,{[e]:`${parseFloat(fi(t,e))+s}px`})}restore(e,t){const s=t.dataset[e];s!==void 0&&(delete t.dataset[e],fi(t,{[e]:s}))}setContainerStyle(e){super.setContainerStyle(e);const t=this.getElement();if(kF(t,"modal-open"),!e.scrollBarWidth)return;const s=this.isRTL?"paddingLeft":"paddingRight",o=this.isRTL?"marginLeft":"marginRight";pa(t,fa.FIXED_CONTENT).forEach(r=>this.adjustAndStore(s,r,e.scrollBarWidth)),pa(t,fa.STICKY_CONTENT).forEach(r=>this.adjustAndStore(o,r,-e.scrollBarWidth)),pa(t,fa.NAVBAR_TOGGLER).forEach(r=>this.adjustAndStore(o,r,e.scrollBarWidth))}removeContainerStyle(e){super.removeContainerStyle(e);const t=this.getElement();CF(t,"modal-open");const s=this.isRTL?"paddingLeft":"paddingRight",o=this.isRTL?"marginLeft":"marginRight";pa(t,fa.FIXED_CONTENT).forEach(r=>this.restore(s,r)),pa(t,fa.STICKY_CONTENT).forEach(r=>this.restore(o,r)),pa(t,fa.NAVBAR_TOGGLER).forEach(r=>this.restore(o,r))}}let Ng;function IF(n){return Ng||(Ng=new sI(n)),Ng}const oI=ue.createContext({onHide(){}}),SF=ue.forwardRef(({closeLabel:n="Close",closeVariant:e,closeButton:t=!1,onHide:s,children:o,...r},i)=>{const a=ue.useContext(oI),u=FC(()=>{a==null||a.onHide(),s==null||s()});return oe.jsxs("div",{ref:i,...r,children:[o,t&&oe.jsx(Wy,{"aria-label":n,variant:e,onClick:u})]})}),Qg=new WeakMap,zw=(n,e)=>{if(!n||!e)return;const t=Qg.get(e)||new Map;Qg.set(e,t);let s=t.get(n);return s||(s=e.matchMedia(n),s.refCount=0,t.set(s.media,s)),s};function $F(n,e=typeof window>"u"?void 0:window){const t=zw(n,e),[s,o]=ue.useState(()=>t?t.matches:!1);return YD(()=>{let r=zw(n,e);if(!r)return o(!1);let i=Qg.get(e);const a=()=>{o(r.matches)};return r.refCount++,r.addListener(a),a(),()=>{r.removeListener(a),r.refCount--,r.refCount<=0&&(i==null||i.delete(r.media)),r=void 0}},[n]),s}function NF(n){const e=Object.keys(n);function t(a,u){return a===u?u:a?`${a} and ${u}`:u}function s(a){return e[Math.min(e.indexOf(a)+1,e.length-1)]}function o(a){const u=s(a);let d=n[u];return typeof d=="number"?d=`${d-.2}px`:d=`calc(${d} - 0.2px)`,`(max-width: ${d})`}function r(a){let u=n[a];return typeof u=="number"&&(u=`${u}px`),`(min-width: ${u})`}function i(a,u,d){let h;typeof a=="object"?(h=a,d=u,u=!0):(u=u||!0,h={[a]:u});let p=ue.useMemo(()=>Object.entries(h).reduce((f,[g,y])=>((y==="up"||y===!0)&&(f=t(f,r(g))),(y==="down"||y===!0)&&(f=t(f,o(g))),f),""),[JSON.stringify(h)]);return $F(p,d)}return i}const TF=NF({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),rI=ue.forwardRef(({className:n,bsPrefix:e,as:t="div",...s},o)=>(e=pt(e,"offcanvas-body"),oe.jsx(t,{ref:o,className:Je(n,e),...s})));rI.displayName="OffcanvasBody";const EF={[uo]:"show",[br]:"show"},iI=ue.forwardRef(({bsPrefix:n,className:e,children:t,in:s=!1,mountOnEnter:o=!1,unmountOnExit:r=!1,appear:i=!1,...a},u)=>(n=pt(n,"offcanvas"),oe.jsx(DC,{ref:u,addEndListener:AC,in:s,mountOnEnter:o,unmountOnExit:r,appear:i,...a,childRef:zy(t),children:(d,h)=>ue.cloneElement(t,{...h,className:Je(e,t.props.className,(d===uo||d===hh)&&`${n}-toggling`,EF[d])})})));iI.displayName="OffcanvasToggling";const aI=ue.forwardRef(({bsPrefix:n,className:e,closeLabel:t="Close",closeButton:s=!1,...o},r)=>(n=pt(n,"offcanvas-header"),oe.jsx(SF,{ref:r,...o,className:Je(e,n),closeLabel:t,closeButton:s})));aI.displayName="OffcanvasHeader";const RF=By("h5"),lI=ue.forwardRef(({className:n,bsPrefix:e,as:t=RF,...s},o)=>(e=pt(e,"offcanvas-title"),oe.jsx(t,{ref:o,className:Je(n,e),...s})));lI.displayName="OffcanvasTitle";function AF(n){return oe.jsx(iI,{...n})}function DF(n){return oe.jsx(OC,{...n})}const uI=ue.forwardRef(({bsPrefix:n,className:e,children:t,"aria-labelledby":s,placement:o="start",responsive:r,show:i=!1,backdrop:a=!0,keyboard:u=!0,scroll:d=!1,onEscapeKeyDown:h,onShow:p,onHide:f,container:g,autoFocus:y=!0,enforceFocus:b=!0,restoreFocus:v=!0,restoreFocusOptions:w,onEntered:C,onExit:$,onExiting:S,onEnter:N,onEntering:R,onExited:F,backdropClassName:O,manager:D,renderStaticNode:A=!1,...T},B)=>{const U=ue.useRef();n=pt(n,"offcanvas");const[Q,K]=ue.useState(!1),J=FC(f),te=TF(r||"xs","up");ue.useEffect(()=>{K(r?i&&!te:i)},[i,r,te]);const P=ue.useMemo(()=>({onHide:J}),[J]);function X(){return D||(d?(U.current||(U.current=new sI({handleContainerOverflow:!1})),U.current):IF())}const Y=(he,...pe)=>{he&&(he.style.visibility="visible"),N==null||N(he,...pe)},L=(he,...pe)=>{he&&(he.style.visibility=""),F==null||F(...pe)},W=ue.useCallback(he=>oe.jsx("div",{...he,className:Je(`${n}-backdrop`,O)}),[O,n]),ie=he=>oe.jsx("div",{...he,...T,className:Je(e,r?`${n}-${r}`:n,`${n}-${o}`),"aria-labelledby":s,children:t});return oe.jsxs(oe.Fragment,{children:[!Q&&(r||A)&&ie({}),oe.jsx(oI.Provider,{value:P,children:oe.jsx(vF,{show:Q,ref:B,backdrop:a,container:g,keyboard:u,autoFocus:y,enforceFocus:b&&!d,restoreFocus:v,restoreFocusOptions:w,onEscapeKeyDown:h,onShow:p,onHide:J,onEnter:Y,onEntering:R,onEntered:C,onExit:$,onExiting:S,onExited:L,manager:X(),transition:AF,backdropTransition:DF,renderBackdrop:W,renderDialog:ie})})]})});uI.displayName="Offcanvas";const Ud=Object.assign(uI,{Body:rI,Header:aI,Title:lI}),gh=ue.forwardRef(({bsPrefix:n,className:e,as:t="div",...s},o)=>{const r=pt(n,"row"),i=TC(),a=EC(),u=`${r}-cols`,d=[];return i.forEach(h=>{const p=s[h];delete s[h];let f;p!=null&&typeof p=="object"?{cols:f}=p:f=p;const g=h!==a?`-${h}`:"";f!=null&&d.push(`${u}${g}-${f}`)}),oe.jsx(t,{ref:o,...s,className:Je(e,r,...d)})});gh.displayName="Row";const FF=ue.forwardRef(({bsPrefix:n,className:e,striped:t,bordered:s,borderless:o,hover:r,size:i,variant:a,responsive:u,...d},h)=>{const p=pt(n,"table"),f=Je(e,p,a&&`${p}-${a}`,i&&`${p}-${i}`,t&&`${p}-${typeof t=="string"?`striped-${t}`:"striped"}`,s&&`${p}-bordered`,o&&`${p}-borderless`,r&&`${p}-hover`),g=oe.jsx("table",{...d,className:f,ref:h});if(u){let y=`${p}-responsive`;return typeof u=="string"&&(y=`${y}-${u}`),oe.jsx("div",{className:y,children:g})}return g});function _F(){return oe.jsx(fu,{className:"bienvenida-container d-flex flex-column justify-content-center align-items-center text-center",style:{maxWidth:"500px",padding:"30px",marginTop:"50px",height:"80vh"},children:oe.jsxs("div",{children:[oe.jsx("h1",{className:"mb-3",children:"¡Bienvenido a ChatAmigo"}),oe.jsxs("p",{className:"mb-3",children:["Este chatbot puede ayudarte con preguntas tanto en ingles como en español, haz clic en el menu para dirigirte con él.",oe.jsx("br",{}),oe.jsx("br",{}),"Puedes preguntarme cosas sobre estos temas:",oe.jsx("br",{}),"- Chiste",oe.jsx("br",{}),"- Flores",oe.jsx("br",{}),"- Animales",oe.jsx("br",{}),"- Películas",oe.jsx("br",{}),"- IAs",oe.jsx("br",{}),"- Deportes",oe.jsx("br",{}),"- Contabilidad",oe.jsx("br",{}),oe.jsx("br",{}),"Hazme preguntas como:",oe.jsx("br",{}),"- ¿Qué es IA?",oe.jsx("br",{}),"- Dime un chiste",oe.jsx("br",{}),"- Háblame de animales",oe.jsx("br",{}),"- ¿Qué es la contabilidad?",oe.jsx("br",{}),"- Recomiéndame películas",oe.jsx("br",{}),oe.jsx("br",{}),"TE ESTA ESPERANDO!!"]})]})})}const OF="https://zenthic22.github.io/IA1_Proyecto_11/assets/jugador-Cer6uPJ0.png",LF="https://zenthic22.github.io/IA1_Proyecto_11/assets/inteligencia-artificial-QHg1rVlE.png",MF="https://zenthic22.github.io/IA1_Proyecto_11/assets/enviar-BNtL_y3C.png";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PF=1e-7,zF=1e-4;class cI{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Xy{refCount(e){return Jn("refCount")}incRef(e){return Jn("incRef")}timerAvailable(){return!0}time(e){return Jn("time")}read(e){return Jn("read")}readSync(e){return Jn("readSync")}readToGPU(e,t){return Jn("readToGPU")}numDataIds(){return Jn("numDataIds")}disposeData(e,t){return Jn("disposeData")}write(e,t,s){return Jn("write")}move(e,t,s,o,r){return Jn("move")}createTensorFromGPUData(e,t,s){return Jn("createTensorFromGPUData")}memory(){return Jn("memory")}floatPrecision(){return Jn("floatPrecision")}epsilon(){return this.floatPrecision()===32?PF:zF}dispose(){return Jn("dispose")}}function Jn(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BF(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,xa(n,e,t)}function xi(n,e,t){return Math.max(n,Math.min(e,t))}function Yy(n){return n%2===0?n:n+1}function xa(n,e,t){const s=n[e];n[e]=n[t],n[t]=s}function WF(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function _(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function Qy(n,e,t=""){_(ht(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function dI(n){_(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function de(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function ht(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Ta(n){return n%1===0}function Jg(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function ka(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function Bw(n,e=o=>0,t,s){return new Promise((o,r)=>{let i=0;const a=()=>{if(n()){o();return}i++;const u=e(i);if(t!=null&&i>=t){r();return}s!=null?s(a,u):setTimeout(a,u)};a()})}function hI(n,e){let t=1,s=-1;for(let r=0;r<n.length;++r)if(n[r]>=0)t*=n[r];else if(n[r]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${r}`);s=r}else if(n[r]<0)throw Error(`Shapes can not be < 0. Found ${n[r]} at dim ${r}`);if(s===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const o=n.slice();return o[s]=e/t,o}function Ke(n,e){const t=e.length;return n=n==null?e.map((s,o)=>o):[].concat(n),_(n.every(s=>s>=-t&&s<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),_(n.every(s=>Ta(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?t+s:s)}function Fr(n,e){const t=[],s=[],o=e!=null&&Array.isArray(e)&&e.length===0,r=e==null||o?null:Ke(e,n).sort();let i=0;for(let a=0;a<n.length;++a){if(r!=null){if(r[i]===a&&n[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(r[i]==null||r[i]>a)&&n[a]===1&&(t.push(n[a]),s.push(a)),r[i]<=a&&i++}n[a]!==1&&(t.push(n[a]),s.push(a))}return{newShape:t,keptDims:s}}function xn(n,e){return Lt(n,e)}function Lt(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function VF(n,e){for(let t=0;t<n.length;t++){const s=n[t];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function UF(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function pI(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function yh(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function GF(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function mu(n){return typeof n=="string"||n instanceof String}function jF(n){return typeof n=="boolean"}function Zg(n){return typeof n=="number"}function Ba(n){return Array.isArray(n)?Ba(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":Zg(n)?"float32":mu(n)?"string":jF(n)?"bool":"float32"}function ey(n){return!!(n&&n.constructor&&n.call&&n.apply)}function ty(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Oe(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let s=e-3;s>=0;--s)t[s]=t[s+1]*n[s+1];return t}function fI(n,e,t,s=!1){const o=new Array;if(e.length===1){const r=e[0]*(s?2:1);for(let i=0;i<r;i++)o[i]=t[n+i]}else{const r=e[0],i=e.slice(1),a=i.reduce((u,d)=>u*d)*(s?2:1);for(let u=0;u<r;u++)o[u]=fI(n+u*a,i,t,s)}return o}function Ks(n,e,t=!1){if(n.length===0)return e[0];const s=n.reduce((o,r)=>o*r)*(t?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return fI(0,n,e,t)}function HF(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function Jy(n,e){const t=bn(n,e);for(let s=0;s<t.length;s++)t[s]=1;return t}function bn(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function mI(n,e){const t=n.reduce((s,o)=>s*o,1);if(e==null||e==="float32")return Ks(n,new Float32Array(t));if(e==="int32")return Ks(n,new Int32Array(t));if(e==="bool")return Ks(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function Ko(n){n.forEach(e=>{_(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function go(n,e,t){if(e===0)return 0;if(e===1)return n[0];let s=n[n.length-1];for(let o=0;o<n.length-1;++o)s+=t[o]*n[o];return s}function Wa(n,e,t){if(e===0)return[];if(e===1)return[n];const s=new Array(e);for(let o=0;o<s.length-1;++o)s[o]=Math.floor(n/t[o]),n-=s[o]*t[o];return s[s.length-1]=n,s}function Zy(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ww="tfjsflags";class qF{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=KF,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,s){if(this.flagRegistry[e]={evaluationFn:t,setHook:s},this.urlFlags[e]!=null){const o=this.urlFlags[e];ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${o}.`),this.set(e,o)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Zy(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);Ww in e&&e[Ww].split(",").forEach(s=>{const[o,r]=s.split(":");this.urlFlags[o]=YF(o,r)})}}function KF(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...s)=>(XF(e,s[0],s[1]),s.join("="))),e}function XF(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function YF(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function ae(){return gI}let gI=null;function QF(n){gI=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Tg;function yI(){if(Tg==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");Tg=n}return Tg}function JF(){const n=yI();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function ex(n,e){const t=JF();if(t.has(n))return t.get(n);{const s=e();return t.set(n,s),t.get(n)}}const qh="Abs",gu="Acos",yu="Acosh",Va="Add",tx="AddN",nx="All",sx="Any",Kh="ArgMax",Xh="ArgMin",xu="Asin",bu="Asinh",vu="Atan",wu="Atanh",ku="Atan2",Yh="AvgPool",ox="AvgPoolGrad",Qh="AvgPool3D",rx="AvgPool3DGrad",Jh="BatchMatMul",Zh="BatchToSpaceND",ix="Bincount",ax="BitwiseAnd",ZF="BroadcastTo",xI="BroadcastArgs",Cu="Cast",Iu="Ceil",Su="ClipByValue",lx="Complex",ep="ComplexAbs",tp="Concat",np="Conv2D",ux="Conv2DBackpropFilter",sp="Conv2DBackpropInput",op="Conv3D",cx="Conv3DBackpropFilterV2",dx="Conv3DBackpropInputV2",$u="Cos",Nu="Cosh",hx="Cumprod",rp="Cumsum",px="CropAndResize",fx="DenseBincount",mx="DepthToSpace",ip="DepthwiseConv2dNative",gx="DepthwiseConv2dNativeBackpropFilter",yx="DepthwiseConv2dNativeBackpropInput",bI="Diag",ap="Dilation2D",ny="Dilation2DBackpropInput",sy="Dilation2DBackpropFilter",e_="Draw",Tu="RealDiv",xx="Einsum",Eu="Elu",bx="EluGrad",Ru="Erf",lp="Equal",Au="Exp",up="ExpandDims",Du="Expm1",vx="FFT",wx="Fill",kx="FlipLeftRight",Fu="Floor",_u="FloorDiv",cp="FusedBatchNorm",dp="GatherV2",vI="GatherNd",hp="Greater",Ou="GreaterEqual",Lu="Identity",Cx="IFFT",Ix="Imag",Mu="IsFinite",Pu="IsInf",zu="IsNan",pp="LeakyRelu",fp="Less",mp="LessEqual",wI="LinSpace",Bu="Log",Wu="Log1p",gp="LogicalAnd",yp="LogicalNot",xp="LogicalOr",t_="LogSoftmax",bp="LRN",Sx="LRNGrad",vp="Max",Vu="Maximum",wp="MaxPool",$x="MaxPoolGrad",kp="MaxPool3D",Nx="MaxPool3DGrad",kI="MaxPoolWithArgmax",Cp="Mean",Ip="Min",Uu="Minimum",Sp="MirrorPad",Gu="Mod",CI="Multinomial",ju="Multiply",$p="Neg",Np="NotEqual",Tx="NonMaxSuppressionV3",Ex="NonMaxSuppressionV4",Rx="NonMaxSuppressionV5",Tp="OnesLike",Ep="OneHot",Rp="Pack",Ap="PadV2",Hu="Pow",Dp="Prelu",Fp="Prod",II="RaggedGather",SI="RaggedRange",$I="RaggedTensorToTensor",Ax="Range",Dx="Real",qu="Reciprocal",Ku="Relu",_p="Reshape",Op="ResizeNearestNeighbor",Fx="ResizeNearestNeighborGrad",Lp="ResizeBilinear",_x="ResizeBilinearGrad",Xu="Relu6",Mp="Reverse",Yu="Round",Qu="Rsqrt",NI="ScatterNd",TI="TensorScatterUpdate",EI="SearchSorted",Pp="Select",Ju="Selu",zp="Slice",Zu="Sin",ec="Sinh",tc="Sign",nc="Sigmoid",sc="Softplus",oc="Sqrt",Bp="Sum",Wp="SpaceToBatchND",Vp="SplitV",Up="Softmax",RI="SparseFillEmptyRows",AI="SparseReshape",DI="SparseSegmentMean",FI="SparseSegmentSum",_I="SparseToDense",rc="SquaredDifference",Ox="Square",Lx="StaticRegexReplace",Mx="StridedSlice",OI="StringNGrams",LI="StringSplit",MI="StringToHashBucketFast",ic="Sub",ac="Tan",lc="Tanh",uc="Tile",Px="TopK",zx="Transform",Ca="Transpose",Bx="Unique",Gp="Unpack",jp="UnsortedSegmentSum",Hp="ZerosLike",cc="Step",n_="FromPixels",Wx="RotateWithOffset",xh="_FusedMatMul",bh="FusedConv2D",PI="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(...n){ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(...n)}function s_(...n){ae().getBool("IS_TEST")||ae().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vh=ex("kernelRegistry",()=>new Map),oy=ex("gradRegistry",()=>new Map);function Vw(n,e){const t=BI(n,e);return vh.get(t)}function Uw(n){return oy.get(n)}function Gw(n){const e=vh.entries(),t=[];for(;;){const{done:s,value:o}=e.next();if(s)break;const[r,i]=o,[a]=r.split("_");a===n&&t.push(i)}return t}function zI(n){const{kernelName:e,backendName:t}=n,s=BI(e,t);vh.has(s)&&cs(`The kernel '${e}' for backend '${t}' is already registered`),vh.set(s,n)}function o_(n){const{kernelName:e}=n;oy.has(e)&&ae().getBool("DEBUG")&&cs(`Overriding the gradient for '${e}'`),oy.set(e,n)}function BI(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WI(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var Eg,jw;function r_(){if(jw)return Eg;jw=1,Eg=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(A,T,B){this.low=A|0,this.high=T|0,this.unsigned=!!B}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(A){return(A&&A.__isLong__)===!0}e.isLong=t;var s={},o={};function r(A,T){var B,U,Q;return T?(A>>>=0,(Q=0<=A&&A<256)&&(U=o[A],U)?U:(B=a(A,(A|0)<0?-1:0,!0),Q&&(o[A]=B),B)):(A|=0,(Q=-128<=A&&A<128)&&(U=s[A],U)?U:(B=a(A,A<0?-1:0,!1),Q&&(s[A]=B),B))}e.fromInt=r;function i(A,T){if(isNaN(A))return T?C:w;if(T){if(A<0)return C;if(A>=y)return F}else{if(A<=-b)return O;if(A+1>=b)return R}return A<0?i(-A,T).neg():a(A%g|0,A/g|0,T)}e.fromNumber=i;function a(A,T,B){return new e(A,T,B)}e.fromBits=a;var u=Math.pow;function d(A,T,B){if(A.length===0)throw Error("empty string");if(A==="NaN"||A==="Infinity"||A==="+Infinity"||A==="-Infinity")return w;if(typeof T=="number"?(B=T,T=!1):T=!!T,B=B||10,B<2||36<B)throw RangeError("radix");var U;if((U=A.indexOf("-"))>0)throw Error("interior hyphen");if(U===0)return d(A.substring(1),T,B).neg();for(var Q=i(u(B,8)),K=w,J=0;J<A.length;J+=8){var te=Math.min(8,A.length-J),P=parseInt(A.substring(J,J+te),B);if(te<8){var X=i(u(B,te));K=K.mul(X).add(i(P))}else K=K.mul(Q),K=K.add(i(P))}return K.unsigned=T,K}e.fromString=d;function h(A,T){return typeof A=="number"?i(A,T):typeof A=="string"?d(A,T):a(A.low,A.high,typeof T=="boolean"?T:A.unsigned)}e.fromValue=h;var p=65536,f=1<<24,g=p*p,y=g*g,b=y/2,v=r(f),w=r(0);e.ZERO=w;var C=r(0,!0);e.UZERO=C;var $=r(1);e.ONE=$;var S=r(1,!0);e.UONE=S;var N=r(-1);e.NEG_ONE=N;var R=a(-1,2147483647,!1);e.MAX_VALUE=R;var F=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=F;var O=a(0,-2147483648,!1);e.MIN_VALUE=O;var D=e.prototype;return D.toInt=function(){return this.unsigned?this.low>>>0:this.low},D.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},D.toString=function(T){if(T=T||10,T<2||36<T)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(O)){var B=i(T),U=this.div(B),Q=U.mul(B).sub(this);return U.toString(T)+Q.toInt().toString(T)}else return"-"+this.neg().toString(T);for(var K=i(u(T,6),this.unsigned),J=this,te="";;){var P=J.div(K),X=J.sub(P.mul(K)).toInt()>>>0,Y=X.toString(T);if(J=P,J.isZero())return Y+te;for(;Y.length<6;)Y="0"+Y;te=""+Y+te}},D.getHighBits=function(){return this.high},D.getHighBitsUnsigned=function(){return this.high>>>0},D.getLowBits=function(){return this.low},D.getLowBitsUnsigned=function(){return this.low>>>0},D.getNumBitsAbs=function(){if(this.isNegative())return this.eq(O)?64:this.neg().getNumBitsAbs();for(var T=this.high!=0?this.high:this.low,B=31;B>0&&!(T&1<<B);B--);return this.high!=0?B+33:B+1},D.isZero=function(){return this.high===0&&this.low===0},D.eqz=D.isZero,D.isNegative=function(){return!this.unsigned&&this.high<0},D.isPositive=function(){return this.unsigned||this.high>=0},D.isOdd=function(){return(this.low&1)===1},D.isEven=function(){return(this.low&1)===0},D.equals=function(T){return t(T)||(T=h(T)),this.unsigned!==T.unsigned&&this.high>>>31===1&&T.high>>>31===1?!1:this.high===T.high&&this.low===T.low},D.eq=D.equals,D.notEquals=function(T){return!this.eq(T)},D.neq=D.notEquals,D.ne=D.notEquals,D.lessThan=function(T){return this.comp(T)<0},D.lt=D.lessThan,D.lessThanOrEqual=function(T){return this.comp(T)<=0},D.lte=D.lessThanOrEqual,D.le=D.lessThanOrEqual,D.greaterThan=function(T){return this.comp(T)>0},D.gt=D.greaterThan,D.greaterThanOrEqual=function(T){return this.comp(T)>=0},D.gte=D.greaterThanOrEqual,D.ge=D.greaterThanOrEqual,D.compare=function(T){if(t(T)||(T=h(T)),this.eq(T))return 0;var B=this.isNegative(),U=T.isNegative();return B&&!U?-1:!B&&U?1:this.unsigned?T.high>>>0>this.high>>>0||T.high===this.high&&T.low>>>0>this.low>>>0?-1:1:this.sub(T).isNegative()?-1:1},D.comp=D.compare,D.negate=function(){return!this.unsigned&&this.eq(O)?O:this.not().add($)},D.neg=D.negate,D.add=function(T){t(T)||(T=h(T));var B=this.high>>>16,U=this.high&65535,Q=this.low>>>16,K=this.low&65535,J=T.high>>>16,te=T.high&65535,P=T.low>>>16,X=T.low&65535,Y=0,L=0,W=0,ie=0;return ie+=K+X,W+=ie>>>16,ie&=65535,W+=Q+P,L+=W>>>16,W&=65535,L+=U+te,Y+=L>>>16,L&=65535,Y+=B+J,Y&=65535,a(W<<16|ie,Y<<16|L,this.unsigned)},D.subtract=function(T){return t(T)||(T=h(T)),this.add(T.neg())},D.sub=D.subtract,D.multiply=function(T){if(this.isZero())return w;if(t(T)||(T=h(T)),n){var B=n.mul(this.low,this.high,T.low,T.high);return a(B,n.get_high(),this.unsigned)}if(T.isZero())return w;if(this.eq(O))return T.isOdd()?O:w;if(T.eq(O))return this.isOdd()?O:w;if(this.isNegative())return T.isNegative()?this.neg().mul(T.neg()):this.neg().mul(T).neg();if(T.isNegative())return this.mul(T.neg()).neg();if(this.lt(v)&&T.lt(v))return i(this.toNumber()*T.toNumber(),this.unsigned);var U=this.high>>>16,Q=this.high&65535,K=this.low>>>16,J=this.low&65535,te=T.high>>>16,P=T.high&65535,X=T.low>>>16,Y=T.low&65535,L=0,W=0,ie=0,he=0;return he+=J*Y,ie+=he>>>16,he&=65535,ie+=K*Y,W+=ie>>>16,ie&=65535,ie+=J*X,W+=ie>>>16,ie&=65535,W+=Q*Y,L+=W>>>16,W&=65535,W+=K*X,L+=W>>>16,W&=65535,W+=J*P,L+=W>>>16,W&=65535,L+=U*Y+Q*X+K*P+J*te,L&=65535,a(ie<<16|he,L<<16|W,this.unsigned)},D.mul=D.multiply,D.divide=function(T){if(t(T)||(T=h(T)),T.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&T.low===-1&&T.high===-1)return this;var B=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,T.low,T.high);return a(B,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?C:w;var U,Q,K;if(this.unsigned){if(T.unsigned||(T=T.toUnsigned()),T.gt(this))return C;if(T.gt(this.shru(1)))return S;K=C}else{if(this.eq(O)){if(T.eq($)||T.eq(N))return O;if(T.eq(O))return $;var J=this.shr(1);return U=J.div(T).shl(1),U.eq(w)?T.isNegative()?$:N:(Q=this.sub(T.mul(U)),K=U.add(Q.div(T)),K)}else if(T.eq(O))return this.unsigned?C:w;if(this.isNegative())return T.isNegative()?this.neg().div(T.neg()):this.neg().div(T).neg();if(T.isNegative())return this.div(T.neg()).neg();K=w}for(Q=this;Q.gte(T);){U=Math.max(1,Math.floor(Q.toNumber()/T.toNumber()));for(var te=Math.ceil(Math.log(U)/Math.LN2),P=te<=48?1:u(2,te-48),X=i(U),Y=X.mul(T);Y.isNegative()||Y.gt(Q);)U-=P,X=i(U,this.unsigned),Y=X.mul(T);X.isZero()&&(X=$),K=K.add(X),Q=Q.sub(Y)}return K},D.div=D.divide,D.modulo=function(T){if(t(T)||(T=h(T)),n){var B=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,T.low,T.high);return a(B,n.get_high(),this.unsigned)}return this.sub(this.div(T).mul(T))},D.mod=D.modulo,D.rem=D.modulo,D.not=function(){return a(~this.low,~this.high,this.unsigned)},D.and=function(T){return t(T)||(T=h(T)),a(this.low&T.low,this.high&T.high,this.unsigned)},D.or=function(T){return t(T)||(T=h(T)),a(this.low|T.low,this.high|T.high,this.unsigned)},D.xor=function(T){return t(T)||(T=h(T)),a(this.low^T.low,this.high^T.high,this.unsigned)},D.shiftLeft=function(T){return t(T)&&(T=T.toInt()),(T&=63)===0?this:T<32?a(this.low<<T,this.high<<T|this.low>>>32-T,this.unsigned):a(0,this.low<<T-32,this.unsigned)},D.shl=D.shiftLeft,D.shiftRight=function(T){return t(T)&&(T=T.toInt()),(T&=63)===0?this:T<32?a(this.low>>>T|this.high<<32-T,this.high>>T,this.unsigned):a(this.high>>T-32,this.high>=0?0:-1,this.unsigned)},D.shr=D.shiftRight,D.shiftRightUnsigned=function(T){if(t(T)&&(T=T.toInt()),T&=63,T===0)return this;var B=this.high;if(T<32){var U=this.low;return a(U>>>T|B<<32-T,B>>>T,this.unsigned)}else return T===32?a(B,0,this.unsigned):a(B>>>T-32,0,this.unsigned)},D.shru=D.shiftRightUnsigned,D.shr_u=D.shiftRightUnsigned,D.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},D.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},D.toBytes=function(T){return T?this.toBytesLE():this.toBytesBE()},D.toBytesLE=function(){var T=this.high,B=this.low;return[B&255,B>>>8&255,B>>>16&255,B>>>24,T&255,T>>>8&255,T>>>16&255,T>>>24]},D.toBytesBE=function(){var T=this.high,B=this.low;return[T>>>24,T>>>16&255,T>>>8&255,T&255,B>>>24,B>>>16&255,B>>>8&255,B&255]},e.fromBytes=function(T,B,U){return U?e.fromBytesLE(T,B):e.fromBytesBE(T,B)},e.fromBytesLE=function(T,B){return new e(T[0]|T[1]<<8|T[2]<<16|T[3]<<24,T[4]|T[5]<<8|T[6]<<16|T[7]<<24,B)},e.fromBytesBE=function(T,B){return new e(T[4]<<24|T[5]<<16|T[6]<<8|T[7],T[0]<<24|T[1]<<16|T[2]<<8|T[3],B)},Eg}var VI=r_();const UI=pu(VI),i_=VA({__proto__:null,default:UI},[VI]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const li=UI||i_;function qp(n){return li.fromString(n,!0,16)}const GI=qp("c3a5c85c97cb3127"),ii=qp("b492b66fbe98f273"),Rn=qp("9ae16a3b2f90404f");function ry(n){return n.xor(n.shru(47))}function jI(n,e,t){const s=n.slice(e,e+t);return li.fromBytes(Array.from(s),!0,!0)}function vt(n,e){return jI(n,e,8)}function Hw(n,e){return jI(n,e,4)}function nn(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function Cr(n,e,t=qp("9ddfea08eb382d69")){let s=n.xor(e).mul(t);s=s.xor(s.shru(47));let o=e.xor(s).mul(t);return o=o.xor(o.shru(47)),o=o.mul(t),o}function a_(n,e,t,s,o,r){o=o.add(n),r=nn(r.add(o).add(s),21);const i=o;return o=o.add(e),o=o.add(t),r=r.add(nn(o,44)),[o.add(s),r.add(i)]}function Gd(n,e,t,s){return a_(vt(n,e),vt(n,e+8),vt(n,e+16),vt(n,e+24),t,s)}function l_(n,e=n.length){if(e>=8){const t=Rn.add(e*2),s=vt(n,0).add(Rn),o=vt(n,e-8),r=nn(o,37).mul(t).add(s),i=nn(s,25).add(o).mul(t);return Cr(r,i,t)}if(e>=4){const t=Rn.add(e*2),s=Hw(n,0);return Cr(s.shl(3).add(e),Hw(n,e-4),t)}if(e>0){const t=n[0],s=n[e>>1],o=n[e-1],r=t+(s<<8),i=e+(o<<2);return ry(Rn.mul(r).xor(GI.mul(i))).mul(Rn)}return Rn}function u_(n,e=n.length){const t=Rn.add(e*2),s=vt(n,0).mul(ii),o=vt(n,8),r=vt(n,e-8).mul(t),i=vt(n,e-16).mul(Rn);return Cr(nn(s.add(o),43).add(nn(r,30)).add(i),s.add(nn(o.add(Rn),18)).add(r),t)}function c_(n,e=n.length){const t=Rn.add(e*2),s=vt(n,0).mul(Rn),o=vt(n,8),r=vt(n,e-8).mul(t),i=vt(n,e-16).mul(Rn),a=nn(s.add(o),43).add(nn(r,30)).add(i),u=Cr(a,s.add(nn(o.add(Rn),18)).add(r),t),d=vt(n,16).mul(t),h=vt(n,24),p=a.add(vt(n,e-32)).mul(t),f=u.add(vt(n,e-24)).mul(t);return Cr(nn(d.add(h),43).add(nn(p,30)).add(f),d.add(nn(h.add(s),18)).add(p),t)}function d_(n,e=n.length){const t=li.fromNumber(81,!0);if(e<=32)return e<=16?l_(n,e):u_(n,e);if(e<=64)return c_(n,e);let s=t,o=t.mul(ii).add(113),r=ry(o.mul(Rn).add(113)).mul(Rn),i=[li.UZERO,li.UZERO],a=[li.UZERO,li.UZERO];s=s.mul(Rn).add(vt(n,0));let u=0;const d=(e-1>>6)*64,h=d+(e-1&63)-63;do s=nn(s.add(o).add(i[0]).add(vt(n,u+8)),37).mul(ii),o=nn(o.add(i[1]).add(vt(n,u+48)),42).mul(ii),s=s.xor(a[1]),o=o.add(i[0]).add(vt(n,u+40)),r=nn(r.add(a[0]),33).mul(ii),i=Gd(n,u,i[1].mul(ii),s.add(a[0])),a=Gd(n,u+32,r.add(a[1]),o.add(vt(n,u+16))),[r,s]=[s,r],u+=64;while(u!==d);const p=ii.add(r.and(255).shl(1));return u=h,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),s=nn(s.add(o).add(i[0]).add(vt(n,u+8)),37).mul(p),o=nn(o.add(i[1]).add(vt(n,u+48)),42).mul(p),s=s.xor(a[1].mul(9)),o=o.add(i[0].mul(9).add(vt(n,u+40))),r=nn(r.add(a[0]),33).mul(p),i=Gd(n,u,i[1].mul(p),s.add(a[0])),a=Gd(n,u+32,r.add(a[1]),o.add(vt(n,u+16))),[r,s]=[s,r],Cr(Cr(i[0],a[0],p).add(ry(o).mul(GI)).add(r),Cr(i[1],a[1],p).add(s),p)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _r(n,e){return e==="string"?Ir(n):Di([n],e)}function h_(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function Di(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=bi(n)),ae().getBool("DEBUG")&&VF(n,e),h_(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let s=0;s<t.length;++s)Math.round(n[s])!==0&&(t[s]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Pn(){return ae().platform.now()}function Ir(n,e="utf-8"){return e=e||"utf-8",ae().platform.encode(n,e)}function Nr(n,e="utf-8"){return e=e||"utf-8",ae().platform.decode(n,e)}function Rs(n){return ae().platform.isTypedArray!=null?ae().platform.isTypedArray(n):WI(n)}function bi(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||Zy(n)||n==null||Rs(n)&&t)e.push(n);else if(Array.isArray(n)||Rs(n))for(let s=0;s<n.length;++s)bi(n[s],e,t);else{let s=-1;for(const o of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(o)&&(s=Math.max(s,Number(o)));for(let o=0;o<=s;o++)bi(n[o],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p_{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new m_)}profileKernel(e,t,s){let o;const r=()=>{o=s()};let i;const a=Pn();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(r);else{r();for(const d of o)d.dataSync();i=Promise.resolve({kernelMs:Pn()-a})}if(ae().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let d=0;d<o.length;d++){const h=o[d];h.data().then(p=>{f_(p,h.dtype,e)})}return{kernelName:e,outputs:o,inputs:t,timeMs:i.then(d=>d.kernelMs),extraInfo:i.then(d=>d.getExtraProfileInfo!=null?d.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:s,timeMs:o,inputs:r,extraInfo:i}=e;s.forEach(a=>{Promise.all([a.data(),o,i]).then(u=>{this.logger.logKernelProfile(t,a,u[0],u[1],r,u[2])})})}}function f_(n,e,t){if(e!=="float32")return!1;for(let s=0;s<n.length;s++){const o=n[s];if(isNaN(o)||!isFinite(o))return console.warn(`Found ${o} in the result of '${t}'`),!0}return!1}class m_{logKernelProfile(e,t,s,o,r,i){const a=typeof o=="number"?ka(`${o}ms`,9):o.error,u=ka(e,25),d=t.rank,h=t.size,p=ka(t.shape.toString(),14);let f="";for(const g in r){const y=r[g];if(y!=null){const b=y.shape||t.shape,v=b.length;f+=`${g}: ${v}D ${v>0?b:""} `}}console.log(`%c${u}	%c${a}	%c${d}D ${p}	%c${h}	%c${f}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g_(n,e,t){const s={},o={};for(let u=0;u<e.length;u++)s[e[u].id]=!0;for(let u=0;u<n.length;u++){const d=n[u],h=d.inputs;for(const p in h){const f=h[p];let g=!1;for(let y=0;y<e.length;y++)if(s[f.id]){d.outputs.forEach(b=>s[b.id]=!0),g=!0,o[d.id]=!0;break}if(g)break}}const r={};r[t.id]=!0;const i={};for(let u=n.length-1;u>=0;u--){const d=n[u],h=d.inputs;for(let p=0;p<d.outputs.length;p++)if(r[d.outputs[p].id]){for(const f in h)r[h[f].id]=!0,i[d.id]=!0;break}}const a=[];for(let u=0;u<n.length;u++){const d=n[u];if(o[d.id]&&i[d.id]){const h={};for(const f in d.inputs){const g=d.inputs[f];s[g.id]&&(h[f]=g)}const p=Object.assign({},d);p.inputs=h,p.outputs=d.outputs,a.push(p)}}return a}function y_(n,e,t,s){for(let o=e.length-1;o>=0;o--){const r=e[o],i=[];if(r.outputs.forEach(u=>{const d=n[u.id];d!=null?i.push(d):i.push(null)}),r.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${r.kernelName}.`);const a=r.gradient(i);for(const u in r.inputs){if(!(u in a))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(a)}.`);const d=t(()=>a[u]());if(d.dtype!=="float32")throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${d.dtype}'`);const h=r.inputs[u];if(!ht(d.shape,h.shape))throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input '${u}' has shape '${d.shape}', which does not match the shape of the input '${h.shape}'`);if(n[h.id]==null)n[h.id]=d;else{const p=n[h.id];n[h.id]=s(p,d),p.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qw=20,Wl=3,Rg=7;function x_(n,e,t,s){const o=Oe(e),r=b_(n,e,t,o),i=e.length,a=sh(n,e,t,o,r),u=["Tensor"];return s&&(u.push(`  dtype: ${t}`),u.push(`  rank: ${i}`),u.push(`  shape: [${e}]`),u.push("  values:")),u.push(a.map(d=>"    "+d).join(`
`)),u.join(`
`)}function b_(n,e,t,s){const o=de(e),r=s[s.length-1],i=new Array(r).fill(0),a=e.length,u=t==="complex64"?ql(n):n;if(a>1)for(let d=0;d<o/r;d++){const h=d*r;for(let p=0;p<r;p++)i[p]=Math.max(i[p],Hl(u[h+p],0,t).length)}return i}function Hl(n,e,t){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(Rg))} + ${parseFloat(n[1].toFixed(Rg))}j`:mu(n)?s=`'${n}'`:t==="bool"?s=HI(n):s=parseFloat(n.toFixed(Rg)).toString(),ka(s,e)}function HI(n){return n===0?"false":"true"}function sh(n,e,t,s,o,r=!0){const i=t==="complex64"?2:1,a=e[0],u=e.length;if(u===0){if(t==="complex64"){const b=ql(n);return[Hl(b[0],0,t)]}return t==="bool"?[HI(n[0])]:[n[0].toString()]}if(u===1){if(a>qw){const v=Wl*i;let w=Array.from(n.slice(0,v)),C=Array.from(n.slice((a-Wl)*i,a*i));return t==="complex64"&&(w=ql(w),C=ql(C)),["["+w.map(($,S)=>Hl($,o[S],t)).join(", ")+", ..., "+C.map(($,S)=>Hl($,o[a-Wl+S],t)).join(", ")+"]"]}return["["+(t==="complex64"?ql(n):Array.from(n)).map((v,w)=>Hl(v,o[w],t)).join(", ")+"]"]}const d=e.slice(1),h=s.slice(1),p=s[0]*i,f=[];if(a>qw){for(let b=0;b<Wl;b++){const v=b*p,w=v+p;f.push(...sh(n.slice(v,w),d,t,h,o,!1))}f.push("...");for(let b=a-Wl;b<a;b++){const v=b*p,w=v+p;f.push(...sh(n.slice(v,w),d,t,h,o,b===a-1))}}else for(let b=0;b<a;b++){const v=b*p,w=v+p;f.push(...sh(n.slice(v,w),d,t,h,o,b===a-1))}const g=u===2?",":"";f[0]="["+(a>0?f[0]+g:"");for(let b=1;b<f.length-1;b++)f[b]=" "+f[b]+g;let y=`,
`;for(let b=2;b<u;b++)y+=`
`;return f[f.length-1]=" "+f[f.length-1]+"]"+(r?"":y),f}function ql(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dn{constructor(e,t,s){if(this.dtype=t,this.shape=e.slice(),this.size=de(e),s!=null){const o=s.length;_(o===this.size,()=>`Length of values '${o}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Lt(t,this.size),this.strides=Oe(e)}set(e,...t){t.length===0&&(t=[0]),_(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const s=this.locToIndex(t);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const o of e){if(o<0||o>=this.shape[t]){const r=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(r)}t++}let s=e[e.length-1];for(let o=0;o<e.length-1;++o)s+=this.strides[o]*e[o];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let s=0;s<e.length-1;++s)t+=this.strides[s]*e[s];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let s=0;s<t.length-1;++s)t[s]=Math.floor(e/this.strides[s]),e-=t[s]*this.strides[s];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return js().makeTensor(this.values,this.shape,this.dtype)}}let js=null,ba=null;function v_(n){js=n}function w_(n){ba=n}class qt{constructor(e,t,s,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=de(e),this.strides=Oe(e),this.dataId=s,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return ba.buffer(this.shape,this.dtype,e)}bufferSync(){return ba.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Ks(this.shape,e,this.dtype==="complex64")}arraySync(){return Ks(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=js().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(s=>Nr(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),js().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=js().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Nr(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await js().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),js().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return ba.print(this,e)}clone(){return this.throwIfDisposed(),ba.clone(this)}toString(e=!1){const t=this.dataSync();return x_(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),ba.cast(this,e)}variable(e=!0,t,s){return this.throwIfDisposed(),js().makeVariable(this,e,t,s)}}Object.defineProperty(qt,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function ce(){return ex("Tensor",()=>qt)}ce();class wh extends qt{constructor(e,t,s,o){super(e.shape,e.dtype,e.dataId,o),this.trainable=t,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!ht(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);js().disposeTensor(this),this.dataId=e.dataId,js().incRef(this,null)}dispose(){js().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(wh,Symbol.hasInstance,{value:n=>n instanceof qt&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Kw;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(Kw||(Kw={}));var iy;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(iy||(iy={}));var ay;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(ay||(ay={}));var ly;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(ly||(ly={}));var uy;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(uy||(uy={}));const k_={float32:ly,int32:iy,bool:ay,complex64:uy};function ts(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return k_[n][e]}function Vx(n){return ts(n,"int32")}function qI(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function KI(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pt(n,e){if(n.dtype===e.dtype)return[n,e];const t=ts(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function XI(n){const e=[];return YI(n,e,new Set),e}function YI(n,e,t){if(n==null)return;if(n instanceof qt){e.push(n);return}if(!C_(n))return;const s=n;for(const o in s){const r=s[o];t.has(r)||(t.add(r),YI(r,e,t))}}function C_(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ag(n){return n.kernelName!=null}class Xw{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Ea{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Xw}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,s=1){return e in this.registryFactory?(cs(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:s}=this.initializeBackend(e);if(!(s?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new p_(this.backendInstance),!0}setupRegisteredKernels(){Gw(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Gw(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=t.factory();if(s&&!(s instanceof Xy)&&typeof s.then=="function"){const o=++this.pendingBackendInitId,r=s.then(i=>o<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(o<this.pendingBackendInitId||(this.pendingBackendInit=null,cs(`Initialization of backend ${e} failed`),cs(i.stack||i.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return cs(`Initialization of backend ${e} failed`),cs(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t],{success:o,asyncInit:r}=this.initializeBackend(s);if(r||o)return{name:s,asyncInit:r}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const s=this.state.tensorInfo.get(t),o=s.backend,r=this.readSync(t),i=o.refCount(t);o.disposeData(t,!0),s.backend=e,e.move(t,r,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let o;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(o),()=>(o=t(),o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),o))}scopedRun(e,t,s){e();try{const o=s();return t(),o}catch(o){throw t(),o}}nextTensorId(){return Ea.nextTensorId++}nextVariableId(){return Ea.nextVariableId++}clone(e){const t=q.runKernel(Lu,{x:e}),s={x:e},o=i=>({x:()=>{const a="float32",u={x:i},d={dtype:a};return q.runKernel(Cu,u,d)}}),r=[];return this.addTapeNode(this.state.activeScope.name,s,[t],o,r,{}),t}runKernel(e,t,s){if(this.backendName==null&&this.backend,!(Vw(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,s){const o=this.backend.numDataIds();let r=0;s.forEach(u=>{r+=u.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=o-t-r-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let t,s=[];const o=this.isTapeOn(),r=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let u;const d=Ag(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Ag(e)){const{kernelName:y,inputs:b,attrs:v}=e;this.backendName==null&&this.backend;const w=Vw(y,this.backendName);_(w!=null,()=>`Cannot find registered kernel '${y}' for backend '${this.backendName}'`),a=()=>{const C=this.backend.numDataIds();u=w.kernelFunc({inputs:b,attrs:v,backend:this.backend});const $=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(y,C,$);const S=$.map(N=>N.rank!=null?N:this.makeTensorFromTensorInfo(N));if(o){const N=this.getTensorsForGradient(y,b,S);s=this.saveTensorsForBackwardMode(N)}return S}}else{const{forwardFunc:y}=e,b=v=>{o&&(s=v.map(w=>this.keep(this.clone(w))))};a=()=>{const v=this.backend.numDataIds();u=this.tidy(()=>y(this.backend,b));const w=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(d,v,w),w}}const{inputs:h,attrs:p}=e,f=Ag(e)?null:e.backwardsFunc;let g;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=a():(g=this.profiler.profileKernel(d,h,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(g),t=g.outputs)}),o&&this.addTapeNode(d,h,t,f,s,p),this.state.profiling&&this.state.activeProfile.kernels.push({name:d,bytesAdded:this.state.numBytes-r,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(y=>h[y]!=null?h[y].shape:null),outputShapes:t.map(y=>y.shape),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(u)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,t,s){const o=Uw(e);if(o!=null){const r=o.inputsToSave||[],i=o.outputsToSave||[];let a;o.saveAllInputs?(_(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(t).map(d=>t[d])):a=r.map(d=>t[d]);const u=s.filter((d,h)=>i[h]);return a.concat(u)}return[]}makeTensor(e,t,s,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",o=o||this.backend;let r=e;s==="string"&&mu(e[0])&&(r=e.map(u=>Ir(u)));const i=o.write(r,t,s),a=new qt(t,s,i,this.nextTensorId());if(this.trackTensor(a,o),s==="string"){const u=this.state.tensorInfo.get(i),d=GF(r);this.state.numBytes+=d-u.bytes,u.bytes=d}return a}makeTensorFromDataId(e,t,s,o){s=s||"float32";const r={dataId:e,shape:t,dtype:s};return this.makeTensorFromTensorInfo(r,o)}makeTensorFromTensorInfo(e,t){const{dataId:s,shape:o,dtype:r}=e,i=new qt(o,r,s,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,s,o){s=s||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.cast(o));const r=new wh(e,t,s,this.nextTensorId());if(this.state.registeredVariables[r.name]!=null)throw new Error(`Variable with name ${r.name} was already registered`);return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*yh(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof wh||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*yh(e.dtype);this.state.numBytes-=s}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(o=>o.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const o of this.state.activeProfile.kernels)o.kernelTimeMs=await o.kernelTimeMs,o.extraInfo=await o.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,s,o,r,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:s,saved:r},u=Uw(e);u!=null&&(o=u.gradFunc),o!=null&&(a.gradient=d=>(d=d.map((h,p)=>{if(h==null){const f=s[p],g=bn(f.size,f.dtype);return this.makeTensor(g,f.shape,f.dtype)}return h}),o(d.length>1?d:d[0],r,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=XI(e),s=new Set(t.map(r=>r.id));for(let r=0;r<this.state.activeScope.track.length;r++){const i=this.state.activeScope.track[r];!i.kept&&!s.has(i.id)&&i.dispose()}const o=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(r=>{!r.kept&&r.scopeId===o.id&&this.track(r)})}gradients(e,t,s,o=!1){if(_(t.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const r=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));_(r instanceof qt,()=>"The result y returned by f() must be a tensor.");const i=g_(this.state.activeTape,t,r);if(!o&&i.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[r.id]=s??I_(r.shape),y_(a,i,d=>this.tidy(d),S_);const u=t.map(d=>a[d.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(d=>{for(const h of d.saved)h.dispose()}),this.state.activeTape=null),{value:r,grads:u}})}customGrad(e){return _(ey(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{_(t.every(a=>a instanceof qt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const o={};t.forEach((a,u)=>{o[u]=a});const r=(a,u)=>(s=e(...t,u),_(s.value instanceof qt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),_(ey(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(a,u)=>{const d=s.gradFunc(a,u),h=Array.isArray(d)?d:[d];_(h.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),_(h.every(f=>f instanceof qt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const p={};return h.forEach((f,g)=>{p[g]=()=>f}),p};return this.runKernelFunc({forwardFunc:r,backwardsFunc:i,inputs:o})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Pn(),s=await this.backend.time(e);return s.wallMs=Pn()-t,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Xw;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Ea.nextTensorId=0;Ea.nextVariableId=0;function I_(n){const e=Jy(de(n),"float32");return q.makeTensor(e,n,"float32")}function QI(){const n=yI();if(n._tfengine==null){const e=new qF(n);n._tfengine=new Ea(e)}return QF(n._tfengine.ENV),v_(()=>n._tfengine),n._tfengine}const q=QI();function S_(n,e){const t={a:n,b:e};return q.runKernel(Va,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $_(){return typeof navigator<"u"&&navigator!=null}function JI(n){if(n||$_()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function ZI(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vn=ae();Vn.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Vn.registerFlag("IS_BROWSER",()=>ZI());Vn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Vn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Vn.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Vn.registerFlag("PROD",()=>!1);Vn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Vn.getBool("DEBUG"));Vn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Vn.registerFlag("IS_TEST",()=>!1);Vn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Vn.getBool("DEBUG"));Vn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Vn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Vn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kp(n,e){let t=n;if(Rs(n))return e==="string"?[]:[n.length];if(qI(n)){const o=n.channels||"RGBA";return[n.height,n.width*o.length]}else if(KI(n))return[n.buffer.size/(e==null?4:yh(e))];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(t)||Rs(t)&&e!=="string";)s.push(t.length),t=t[0];return Array.isArray(n)&&ae().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&eS(n,s,[]),s}function eS(n,e,t){if(t=t||[],!Array.isArray(n)&&!Rs(n)){_(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}_(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),_(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const s=e.slice(1);for(let o=0;o<n.length;++o)eS(n[o],s,t.concat(o))}function Yw(n,e,t,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${s}' must be ${n} tensor, but got ${e} tensor`)}}function z(n,e,t,s="numeric"){if(n instanceof ce())return Yw(s,n.dtype,e,t),n;let o=Ba(n);if(o!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(o=s),Yw(s,o,e,t),n==null||!Rs(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const u=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${u}'`)}const r=Kp(n,o);!Rs(n)&&!Array.isArray(n)&&(n=[n]);const a=o!=="string"?Di(n,o):bi(n,[],!0);return q.makeTensor(a,r,o)}function tS(n,e,t,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((r,i)=>z(r,`${e}[${i}]`,t,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N_="__op";function ee(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const s=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+N_;const o=(...r)=>{q.startScope(t);try{const i=s(...r);return Zy(i)&&console.error("Cannot return a Promise inside of tidy."),q.endScope(i),i}catch(i){throw q.endScope(null),i}};return Object.defineProperty(o,"name",{value:t,configurable:!0}),o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T_(n,e){const t=z(n,"real","complex"),s=z(e,"imag","complex");Qy(t.shape,s.shape,`real and imag shapes, ${t.shape} and ${s.shape}, must match in call to tf.complex().`);const o={real:t,imag:s};return q.runKernel(lx,o)}const Ra=ee({complex_:T_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xp(n,e,t,s){if(s==null)s=Ba(n);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(KI(n)||qI(n)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return q.backend.createTensorFromGPUData(n,e||t,s)}if(!Rs(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Ko(e);const o=de(e),r=de(t);_(o===r,()=>`Based on the provided shape, [${e}], the tensor should have ${o} values but has ${r}`);for(let i=0;i<t.length;++i){const a=t[i],u=i===t.length-1?a!==de(e.slice(i)):!0;_(t[i]===e[i]||!u,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!Rs(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=s!=="string"?Di(n,s):bi(n,[],!0),q.makeTensor(n,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nS(n,e,t){const s=Kp(n,t);return Xp(n,e,s,t)}class Ua{static join(e){return new Ua(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>Rs(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let s=0;s<e.length;s++){const o=e[s];s!==e.length-1&&o.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const r=t+o.byteLength;this.shards.push({buffer:o,start:t,end:r}),t=r}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const o=t-e,r=new ArrayBuffer(o),i=new Uint8Array(r);let a=0;for(let u=s;u<this.shards.length;u++){const d=this.shards[u],p=e+a-d.start,f=a,y=Math.min(t,d.end)-d.start,b=new Uint8Array(d.buffer,p,y-p);if(i.set(b,f),a+=b.length,t<d.end)break}return r}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(o){return e<o.start?-1:e>=o.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=E_(this.shards,t);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function E_(n,e){let t=0,s=n.length;for(;t<=s;){const o=Math.floor((s-t)/2)+t,r=e(n[o]);if(r===0)return o;r<0?s=o:t=o+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ao(){return q}function Qw(){return q.memory()}function se(n,e){return q.tidy(n,e)}function Ye(n){XI(n).forEach(t=>t.dispose())}function yo(n){return q.keep(n)}function sS(n,e,t=1){return q.registerBackend(n,e,t)}function R_(){return q.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jw=4;async function Zw(n,e){const t=[],s=[],o=Array.isArray(n)?n.map(i=>i.name):Object.keys(n);for(let i=0;i<o.length;++i){const a=o[i],u=Array.isArray(n)?n[i].tensor:n[a];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${u.dtype}`);const d={name:a,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const h=new Promise(async p=>{const f=await u.bytes(),g=f.reduce((v,w)=>v+w.length,0)+Jw*f.length,y=new Uint8Array(g);let b=0;for(let v=0;v<f.length;v++){const w=f[v],C=new Uint8Array(new Uint32Array([w.length]).buffer);y.set(C,b),b+=Jw,y.set(w,b),b+=w.length}p(y)});s.push(h)}else s.push(u.data());e!=null&&(d.group=e),t.push(d)}const r=await Promise.all(s);return{data:A_(r),specs:t}}function A_(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(r=>{if(e+=r.byteLength,t.push(r.byteLength===r.buffer.byteLength?r:new r.constructor(r)),!(r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${r.constructor.name}`)});const s=new Uint8Array(e);let o=0;return t.forEach(r=>{s.set(new Uint8Array(r.buffer),o),o+=r.byteLength}),s.buffer}const Ux=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function ek(n){return Ux?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function D_(n){if(Ux)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let s=0,o=e.length;s<o;s++)t+=String.fromCharCode(e[s]);return btoa(t)}function F_(n){if(Ux){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t.set([e.charCodeAt(s)],s);return t.buffer}function __(n){return Ua.join(n)}function oS(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:ek(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:ek(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new Ua(n.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Tn.instance==null&&(Tn.instance=new Tn),Tn.instance}static registerSaveRouter(e){Tn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Tn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Tn.getHandlers(e,"save")}static getLoadHandlers(e,t){return Tn.getHandlers(e,"load",t)}static getHandlers(e,t,s){const o=[];return(t==="load"?Tn.getInstance().loadRouters:Tn.getInstance().saveRouters).forEach(i=>{const a=i(e,s);a!==null&&o.push(a)}),o}}const O_=n=>Tn.getSaveHandlers(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cy="tensorflowjs",dy=1,hi="models_store",vr="model_info_store";function rS(){if(!ae().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function hy(n){const e=n.result;e.createObjectStore(hi,{keyPath:"modelPath"}),e.createObjectStore(vr,{keyPath:"modelPath"})}class vi{constructor(e){if(this.indexedDB=rS(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((s,o)=>{const r=this.indexedDB.open(cy,dy);r.onupgradeneeded=()=>hy(r),r.onsuccess=()=>{const i=r.result;if(t==null){const a=i.transaction(hi,"readonly"),d=a.objectStore(hi).get(this.modelPath);d.onsuccess=()=>{if(d.result==null)return i.close(),o(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(d.result.modelArtifacts)},d.onerror=h=>(i.close(),o(d.error)),a.oncomplete=()=>i.close()}else{t.weightData=Ua.join(t.weightData);const a=oS(t),u=i.transaction(vr,"readwrite");let d=u.objectStore(vr),h;try{h=d.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(f){return o(f)}let p;h.onsuccess=()=>{p=i.transaction(hi,"readwrite");const f=p.objectStore(hi);let g;try{g=f.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:a})}catch(y){return o(y)}g.onsuccess=()=>s({modelArtifactsInfo:a}),g.onerror=y=>{d=u.objectStore(vr);const b=d.delete(this.modelPath);b.onsuccess=()=>(i.close(),o(g.error)),b.onerror=v=>(i.close(),o(g.error))}},h.onerror=f=>(i.close(),o(h.error)),u.oncomplete=()=>{p==null?i.close():p.oncomplete=()=>i.close()}}},r.onerror=i=>o(r.error)})}}vi.URL_SCHEME="indexeddb://";const iS=n=>ae().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(vi.URL_SCHEME)?L_(n.slice(vi.URL_SCHEME.length)):null;Tn.registerSaveRouter(iS);Tn.registerLoadRouter(iS);function L_(n){return new vi(n)}function M_(n){return n.startsWith(vi.URL_SCHEME)?n.slice(vi.URL_SCHEME.length):n}class P_{constructor(){this.indexedDB=rS()}async listModels(){return new Promise((e,t)=>{const s=this.indexedDB.open(cy,dy);s.onupgradeneeded=()=>hy(s),s.onsuccess=()=>{const o=s.result,r=o.transaction(vr,"readonly"),a=r.objectStore(vr).getAll();a.onsuccess=()=>{const u={};for(const d of a.result)u[d.modelPath]=d.modelArtifactsInfo;e(u)},a.onerror=u=>(o.close(),t(a.error)),r.oncomplete=()=>o.close()},s.onerror=o=>t(s.error)})}async removeModel(e){return e=M_(e),new Promise((t,s)=>{const o=this.indexedDB.open(cy,dy);o.onupgradeneeded=()=>hy(o),o.onsuccess=()=>{const r=o.result,i=r.transaction(vr,"readwrite"),a=i.objectStore(vr),u=a.get(e);let d;u.onsuccess=()=>{if(u.result==null)return r.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const h=a.delete(e),p=()=>{d=r.transaction(hi,"readwrite");const g=d.objectStore(hi).delete(e);g.onsuccess=()=>t(u.result.modelArtifactsInfo),g.onerror=y=>s(u.error)};h.onsuccess=p,h.onerror=f=>(p(),r.close(),s(u.error))}},u.onerror=h=>(r.close(),s(u.error)),i.oncomplete=()=>{d==null?r.close():d.oncomplete=()=>r.close()}},o.onerror=r=>s(o.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Po="/",va="tensorflowjs_models",aS="info",z_="model_topology",B_="weight_specs",W_="weight_data",V_="model_metadata";function lS(n){return{info:[va,n,aS].join(Po),topology:[va,n,z_].join(Po),weightSpecs:[va,n,B_].join(Po),weightData:[va,n,W_].join(Po),modelMetadata:[va,n,V_].join(Po)}}function uS(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function U_(n){const e=n.split(Po);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(Po)}function G_(n){return n.startsWith(wi.URL_SCHEME)?n.slice(wi.URL_SCHEME.length):n}class wi{constructor(e){if(!ae().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=lS(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),o=oS(e),r=Ua.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,D_(r));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:o}}catch{throw uS(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${o.modelTopologyBytes}, weightSpecsBytes=${o.weightSpecsBytes}, weightDataBytes=${o.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=s;const o=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(o==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=o;const r=this.LS.getItem(this.keys.modelMetadata);if(r!=null){const a=JSON.parse(r);t.format=a.format,t.generatedBy=a.generatedBy,t.convertedBy=a.convertedBy,a.signature!=null&&(t.signature=a.signature),a.userDefinedMetadata!=null&&(t.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(t.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(t.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(t.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=F_(i),t}}wi.URL_SCHEME="localstorage://";const cS=n=>ae().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(wi.URL_SCHEME)?j_(n.slice(wi.URL_SCHEME.length)):null;Tn.registerSaveRouter(cS);Tn.registerLoadRouter(cS);function j_(n){return new wi(n)}class H_{constructor(){_(ae().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),_(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=va+Po,s=Po+aS;for(let o=0;o<this.LS.length;++o){const r=this.LS.key(o);if(r.startsWith(t)&&r.endsWith(s)){const i=U_(r);e[i]=JSON.parse(this.LS.getItem(r))}}return e}async removeModel(e){e=G_(e);const t=lS(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(t.info));return uS(t),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tk="://";class lo{constructor(){this.managers={}}static getInstance(){return lo.instance==null&&(lo.instance=new lo),lo.instance}static registerManager(e,t){_(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(tk)&&(e=e.slice(0,e.indexOf(tk))),_(e.length>0,()=>"scheme must not be an empty string.");const s=lo.getInstance();_(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=t}static getManager(e){const t=lo.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(lo.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q_{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!ae().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const o=this.functionRefs[s.data.index];o(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return WI(e)}}if(ae().get("IS_BROWSER")){ae().setPlatform("browser",new q_);try{lo.registerManager(wi.URL_SCHEME,new H_)}catch{}try{lo.registerManager(vi.URL_SCHEME,new P_)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K_={importFetch:()=>require("node-fetch")};let Dg;class X_{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return ae().global.fetch!=null?ae().global.fetch(e,t):(Dg==null&&(Dg=K_.importFetch()),Dg(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}ae().get("IS_NODE")&&!ae().get("IS_BROWSER")&&ae().setPlatform("node",new X_);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qe(n,e="float32",t){return e=e||"float32",Ko(n),new dn(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y_(n,e){const t=z(n,"x","cast");if(!UF(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:t},o={dtype:e};return q.runKernel(Cu,s,o)}const $e=ee({cast_:Y_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_(n){const t={x:z(n,"x","clone","string_or_numeric")};return q.runKernel(Lu,t)}const mi=ee({clone_:Q_});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */QI();const Z_={buffer:qe,cast:$e,clone:mi,print:J_};w_(Z_);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eO(n,e){let t=z(n,"a","add"),s=z(e,"b","add");[t,s]=Pt(t,s);const o={a:t,b:s};return q.runKernel(Va,o)}const xe=ee({add_:eO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tO(n,e){let t=z(n,"a","floorDiv"),s=z(e,"b","floorDiv");[t,s]=Pt(t,s);const o={a:t,b:s};return q.runKernel(_u,o)}const dS=ee({floorDiv_:tO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nO(n,e){let t=z(n,"a","div"),s=z(e,"b","div");if([t,s]=Pt(t,s),t.dtype==="int32"&&s.dtype==="int32")return dS(t,s);const o={a:t,b:s},r={};return q.runKernel(Tu,o,r)}const Me=ee({div_:nO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sO(n,e){let t=z(n,"a","mul"),s=z(e,"b","mul");[t,s]=Pt(t,s);const o={a:t,b:s};return q.runKernel(ju,o)}const j=ee({mul_:sO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oO(n){const e=z(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return q.runKernel(ep,t)}else{const t={x:e};return q.runKernel(qh,t)}}const En=ee({abs_:oO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rO(n){const t={x:z(n,"x","acos")};return q.runKernel(gu,t)}const iO=ee({acos_:rO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aO(n){const t={x:z(n,"x","acosh")};return q.runKernel(yu,t)}const lO=ee({acosh_:aO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uO(n,e=null,t=!1){const o={x:z(n,"x","all","bool")},r={axis:e,keepDims:t};return q.runKernel(nx,o,r)}const hS=ee({all_:uO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cO(n,e=null,t=!1){const o={x:z(n,"x","any","bool")},r={axis:e,keepDims:t};return q.runKernel(sx,o,r)}const py=ee({any_:cO});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dO(n,e=0){const s={x:z(n,"x","argMax")},o={axis:e};return q.runKernel(Kh,s,o)}const tu=ee({argMax_:dO});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hO(n,e=0){const s={x:z(n,"x","argMin")},o={axis:e};return q.runKernel(Xh,s,o)}const pO=ee({argMin_:hO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fO(n){const t={x:z(n,"x","asin")};return q.runKernel(xu,t)}const mO=ee({asin_:fO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gO(n){const t={x:z(n,"x","asinh")};return q.runKernel(bu,t)}const yO=ee({asinh_:gO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xO(n){const t={x:z(n,"x","atan")};return q.runKernel(vu,t)}const bO=ee({atan_:xO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vO(n,e){let t=z(n,"a","atan2"),s=z(e,"b","atan2");[t,s]=Pt(t,s);const o={a:t,b:s};return q.runKernel(ku,o)}const wO=ee({atan2_:vO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kO(n){const t={x:z(n,"x","atanh")};return q.runKernel(wu,t)}const CO=ee({atanh_:kO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dc(n,e,t,s,o="NHWC",r){const i=n[3],a=[...e,i],u=Yo(o);return hn(n,a,t,r,s,null,null,u)}function Ds(n,e,t,s,o,r,i="channelsLast"){const[a,u]=nu(e);let d;if(i==="channelsLast")d=[a,u,n[3],n[3]];else if(i==="channelsFirst")d=[a,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return hn(n,d,t,s,o,r,!1,i)}function Xo(n,e,t,s,o,r,i="NDHWC"){const[a,u,d]=fy(e);let h,p;if(i==="NDHWC")p="channelsLast",h=[a,u,d,n[4],n[4]];else if(i==="NCDHW")p="channelsFirst",h=[a,u,d,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return Or(n,h,t,s,o,!1,p,r)}function hn(n,e,t,s,o,r,i=!1,a="channelsLast"){let[u,d,h,p]=[-1,-1,-1,-1];if(a==="channelsLast")[u,d,h,p]=n;else if(a==="channelsFirst")[u,p,d,h]=n;else throw new Error(`Unknown dataFormat ${a}`);const[f,g,,y]=e,[b,v]=nu(t),[w,C]=nu(s),$=Ia(f,w),S=Ia(g,C),{padInfo:N,outHeight:R,outWidth:F}=$O(o,d,h,b,v,$,S,r,a),O=i?y*p:y;let D;return a==="channelsFirst"?D=[u,O,R,F]:a==="channelsLast"&&(D=[u,R,F,O]),{batchSize:u,dataFormat:a,inHeight:d,inWidth:h,inChannels:p,outHeight:R,outWidth:F,outChannels:O,padInfo:N,strideHeight:b,strideWidth:v,filterHeight:f,filterWidth:g,effectiveFilterHeight:$,effectiveFilterWidth:S,dilationHeight:w,dilationWidth:C,inShape:n,outShape:D,filterShape:e}}function Or(n,e,t,s,o,r=!1,i="channelsLast",a){let[u,d,h,p,f]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[u,d,h,p,f]=n;else if(i==="channelsFirst")[u,f,d,h,p]=n;else throw new Error(`Unknown dataFormat ${i}`);const[g,y,b,,v]=e,[w,C,$]=fy(t),[S,N,R]=fy(s),F=Ia(g,S),O=Ia(y,N),D=Ia(b,R),{padInfo:A,outDepth:T,outHeight:B,outWidth:U}=NO(o,d,h,p,w,C,$,F,O,D,a),Q=r?v*f:v;let K;return i==="channelsFirst"?K=[u,Q,T,B,U]:i==="channelsLast"&&(K=[u,T,B,U,Q]),{batchSize:u,dataFormat:i,inDepth:d,inHeight:h,inWidth:p,inChannels:f,outDepth:T,outHeight:B,outWidth:U,outChannels:Q,padInfo:A,strideDepth:w,strideHeight:C,strideWidth:$,filterDepth:g,filterHeight:y,filterWidth:b,effectiveFilterDepth:F,effectiveFilterHeight:O,effectiveFilterWidth:D,dilationDepth:S,dilationHeight:N,dilationWidth:R,inShape:n,outShape:K,filterShape:e}}function IO(n,e,t,s,o){s==null&&(s=Gx(n,e,t));const r=n[0],i=n[1],a=su((r-e+2*s)/t+1,o),u=su((i-e+2*s)/t+1,o);return[a,u]}function SO(n,e,t,s,o,r){o==null&&(o=Gx(n,e[0],s[0]));const i=[0,0,0,t];for(let a=0;a<3;a++)n[a]+2*o>=e[a]&&(i[a]=su((n[a]-e[a]+2*o)/s[a]+1,r));return i}function Gx(n,e,t,s=1){const o=Ia(e,s);return Math.floor((n[0]*(t-1)-t+o)/2)}function nu(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function fy(n){return typeof n=="number"?[n,n,n]:n}function Ia(n,e){return e<=1?n:n+(n-1)*(e-1)}function $O(n,e,t,s,o,r,i,a,u){let d,h,p;if(typeof n=="number"){d={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const g=IO([e,t],r,s,n,a);h=g[0],p=g[1]}else if(n==="same"){h=Math.ceil(e/s),p=Math.ceil(t/o);const f=Math.max(0,(h-1)*s+r-e),g=Math.max(0,(p-1)*o+i-t),y=Math.floor(f/2),b=f-y,v=Math.floor(g/2),w=g-v;d={top:y,bottom:b,left:v,right:w,type:"SAME"}}else if(n==="valid")d={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((e-r+1)/s),p=Math.ceil((t-i+1)/o);else if(typeof n=="object"){const f=u==="channelsLast"?n[1][0]:n[2][0],g=u==="channelsLast"?n[1][1]:n[2][1],y=u==="channelsLast"?n[2][0]:n[3][0],b=u==="channelsLast"?n[2][1]:n[3][1];d={top:f,bottom:g,left:y,right:b,type:f===0&&g===0&&y===0&&b===0?"VALID":"EXPLICIT"},h=su((e-r+f+g)/s+1,a),p=su((t-i+y+b)/o+1,a)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:d,outHeight:h,outWidth:p}}function NO(n,e,t,s,o,r,i,a,u,d,h){let p,f,g,y;if(n==="valid"&&(n=0),typeof n=="number"){p={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const v=SO([e,t,s,1],[a,u,d],1,[o,r,i],n,h);f=v[0],g=v[1],y=v[2]}else if(n==="same"){f=Math.ceil(e/o),g=Math.ceil(t/r),y=Math.ceil(s/i);const b=(f-1)*o+a-e,v=(g-1)*r+u-t,w=(y-1)*i+d-s,C=Math.floor(b/2),$=b-C,S=Math.floor(v/2),N=v-S,R=Math.floor(w/2),F=w-R;p={top:S,bottom:N,left:R,right:F,front:C,back:$,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:p,outDepth:f,outHeight:g,outWidth:y}}function su(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function ki(n){const[e,t,s]=nu(n);return e===1&&t===1&&s===1}function wn(n,e){return ki(n)||ki(e)}function Ci(n){return nu(n).every(e=>e>0)}function Yo(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function Gn(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")_(Ta(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(o=>{_(Ta(o),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${o}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TO(n,e){const s={x:z(n,"x","reshape","string_or_numeric")},o={shape:e};return q.runKernel(_p,s,o)}const Z=ee({reshape_:TO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EO(n,e,t,s,o){const r=z(n,"x","avgPool","float32"),i=1;_(wn(t,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);let a=r,u=!1;r.rank===3&&(u=!0,a=Z(r,[1,r.shape[0],r.shape[1],r.shape[2]])),_(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Gn("avgPool",s,o);const d={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:o};let p=q.runKernel(Yh,d,h);return p=$e(p,r.dtype),u?Z(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const jx=ee({avgPool_:EO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RO(n,e,t,s,o,r="NDHWC"){const i=z(n,"x","avgPool3d","float32");let a=i,u=!1;i.rank===4&&(u=!0,a=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),_(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),_(r==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),_(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),Gn("avgPool3d",s,o);const d={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:o,dataFormat:r};let p=q.runKernel(Qh,d,h);return p=$e(p,a.dtype),u?Z(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const AO=ee({avgPool3d_:RO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DO(n,e=0){_(n.length>=1,()=>"Pass at least one tensor to concat");const t=tS(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(r=>{if(r.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${r.dtype}. `)}),t.length===1)return mi(t[0]);const s=t,o={axis:e};return q.runKernel(tp,s,o)}const Wn=ee({concat_:DO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FO(n,e,t=!1,s=!1){let o=z(n,"a","matMul"),r=z(e,"b","matMul");[o,r]=Pt(o,r);const i={a:o,b:r},a={transposeA:t,transposeB:s};return q.runKernel(Jh,i,a)}const ct=ee({matMul_:FO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _O(n){const t={x:z(n,"x","sigmoid","float32")};return q.runKernel(nc,t)}const Ga=ee({sigmoid_:_O});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OO(n,e,t){const s=z(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const o={x:s},r={begin:e,size:t};return q.runKernel(zp,o,r)}const wt=ee({slice_:OO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LO(n){const t={x:z(n,"x","tanh","float32")};return q.runKernel(lc,t)}const Yp=ee({tanh_:LO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MO(n,e,t){const s=z(n,"x","batchToSpaceND"),o=e.reduce((a,u)=>a*u);_(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),_(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),_(s.shape[0]%o===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${o}`);const r={x:s},i={blockShape:e,crops:t};return q.runKernel(Zh,r,i)}const Hx=ee({batchToSpaceND_:MO});function PO(n){let e;return n.rank===0||n.rank===1?e=Z(n,[1,1,1,n.size]):n.rank===2?e=Z(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=Z(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zO(n,e,t,s,o,r){r==null&&(r=.001);const i=z(n,"x","batchNorm"),a=z(e,"mean","batchNorm"),u=z(t,"variance","batchNorm");let d;o!=null&&(d=z(o,"scale","batchNorm"));let h;s!=null&&(h=z(s,"offset","batchNorm")),_(a.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),_(h==null||a.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),_(d==null||a.rank===d.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const f={x:PO(i),scale:d,offset:h,mean:a,variance:u},g={varianceEpsilon:r},y=q.runKernel(cp,f,g);return Z(y,i.shape)}const Qp=ee({batchNorm_:zO});function BO(n,e,t,s,o,r){const i=z(n,"x","batchNorm"),a=z(e,"mean","batchNorm"),u=z(t,"variance","batchNorm");let d;o!=null&&(d=z(o,"scale","batchNorm"));let h;return s!=null&&(h=z(s,"offset","batchNorm")),_(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),_(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),_(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),d!=null&&_(d.rank===2||d.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${d.rank}.`),h!=null&&_(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`),Qp(i,a,u,h,d,r)}const WO=ee({batchNorm2d_:BO});function VO(n,e,t,s,o,r){const i=z(n,"x","batchNorm"),a=z(e,"mean","batchNorm"),u=z(t,"variance","batchNorm");let d;o!=null&&(d=z(o,"scale","batchNorm"));let h;return s!=null&&(h=z(s,"offset","batchNorm")),_(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),_(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),_(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),d!=null&&_(d.rank===3||d.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${d.rank}.`),h!=null&&_(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`),Qp(i,a,u,h,d,r)}const UO=ee({batchNorm3d_:VO});function GO(n,e,t,s,o,r){const i=z(n,"x","batchNorm"),a=z(e,"mean","batchNorm"),u=z(t,"variance","batchNorm");let d;o!=null&&(d=z(o,"scale","batchNorm"));let h;return s!=null&&(h=z(s,"offset","batchNorm")),_(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),_(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),_(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),d!=null&&_(d.rank===4||d.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${d.rank}.`),h!=null&&_(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`),Qp(i,a,u,h,d,r)}const jO=ee({batchNorm4d_:GO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HO(n,e,t){const s=z(n,"x","bincount"),o=z(e,"weights","bincount");_(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),_(t>=0,()=>`size must be non-negative, but got ${t}.`),_(o.size===s.size||o.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${o.shape}.`);const r={x:s,weights:o},i={size:t};return q.runKernel(ix,r,i)}const qO=ee({bincount_:HO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KO(n,e){let t=z(n,"broadcastTo","x");const s=t.shape;if(Ko(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const d=t.shape.slice();for(;d.length<e.length;)d.unshift(1);t=Z(t,d)}const o=t.shape,r=Array.from(e);for(let d=e.length-1;d>=0;d--)if(o[d]===e[d])r[d]=1;else if(t.shape[d]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(r.map((d,h)=>d>1?h:-1).filter(d=>d>=0).length===0)return mi(t);const a={x:t},u={reps:r};return q.runKernel(uc,a,u)}const Jl=ee({broadcastTo_:KO});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XO(n){const t={x:z(n,"x","ceil","float32")};return q.runKernel(Iu,t)}const YO=ee({ceil_:XO});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jp(n,e,t){Ko(n),t=t||Ba(e);const s={shape:n,value:e,dtype:t};return q.runKernel(wx,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QO(n,e,t){const s=z(n,"x","clipByValue");if(_(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return Jp(s.shape,e,s.dtype);const o={x:s},r={clipValueMin:e,clipValueMax:t};return q.runKernel(Su,o,r)}const ps=ee({clipByValue_:QO});function JO(n){return Wn(n,0)}const ZO=ee({concat1d_:JO});function eL(n,e){return Wn(n,e)}const tL=ee({concat2d_:eL});function nL(n,e){return Wn(n,e)}const sL=ee({concat3d_:nL});function oL(n,e){return Wn(n,e)}const rL=ee({concat4d_:oL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iL(n,e,t,s,o="NHWC",r=[1,1],i){const a=z(n,"x","conv2d","float32"),u=z(e,"filter","conv2d","float32");let d=a,h=!1;a.rank===3&&(h=!0,d=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),_(d.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${d.rank}.`),_(u.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),Gn("conv2d",s,i);const p=o==="NHWC"?d.shape[3]:d.shape[1];_(p===u.shape[2],()=>`Error in conv2d: depth of input (${p}) must match input depth for filter ${u.shape[2]}.`),_(wn(t,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${r}'`),_(Ci(r),()=>"Error in conv2D: Dilated rates should be larger than 0."),_(Ci(t),()=>"Error in conv2D: Strides should be larger than 0.");const f={x:d,filter:u},g={strides:t,pad:s,dataFormat:o,dilations:r,dimRoundingMode:i},y=q.runKernel(np,f,g);return h?Z(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Ii=ee({conv2d_:iL});function aL(n,e,t,s,o="NWC",r=1,i){const a=z(n,"x","conv1d"),u=z(e,"filter","conv1d");let d=a,h=!1;a.rank===2&&(h=!0,d=Z(a,[1,a.shape[0],a.shape[1]])),_(d.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${d.rank}.`),_(u.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),Gn("conv1d",s,i),_(d.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${d.shape[2]}) must match input depth for filter ${u.shape[1]}.`),_(wn(t,r),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${r}'`),_(Ci(r),()=>"Error in conv1D: Dilated rates should be larger than 0."),_(Ci(t),()=>"Error in conv1D: Stride should be larger than 0."),_(o==="NWC",()=>`Error in conv1d: got dataFormat of ${o} but only NWC is currently supported.`);const p=Z(u,[1,u.shape[0],u.shape[1],u.shape[2]]),f=Z(d,[d.shape[0],1,d.shape[1],d.shape[2]]),v=Ii(f,p,[1,t],s,"NHWC",[1,r],i);return h?Z(v,[v.shape[2],v.shape[3]]):Z(v,[v.shape[0],v.shape[2],v.shape[3]])}const pS=ee({conv1d_:aL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lL(n,e,t,s,o,r="NHWC",i){_(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,u=e,d=!1;e.rank===3&&(d=!0,u=Z(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,n[0],n[1],n[2]]),_(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),_(u.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),_(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const h=r==="NHWC"?a[3]:a[1],p=r==="NHWC"?u.shape[3]:u.shape[1];_(h===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${t.shape[2]}.`),_(p===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${p}) must match output depth for filter ${t.shape[3]}.`),Gn("conv2dDerInput",o,i);const f={dy:u,filter:t},g={strides:s,pad:o,dataFormat:r,dimRoundingMode:i,inputShape:a},y=q.runKernel(sp,f,g);return d?Z(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const qx=ee({conv2DBackpropInput_:lL});function uL(n,e,t,s,o,r){const i=z(n,"x","conv2dTranspose"),a=z(e,"filter","conv2dTranspose");return qx(t,i,a,s,o,"NHWC",r)}const fS=ee({conv2dTranspose_:uL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cL(n,e,t,s,o="NDHWC",r=[1,1,1]){const i=z(n,"x","conv3d"),a=z(e,"filter","conv3d");let u=i,d=!1;i.rank===4&&(d=!0,u=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),_(u.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),_(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),_(u.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${a.shape[3]}.`),_(wn(t,r),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${r}'`),_(o==="NDHWC",()=>`Error in conv3d: got dataFormat of ${o} but only NDHWC is currently supported.`),_(Ci(r),()=>"Error in conv3D: Dilated rates should be larger than 0."),_(Ci(t),()=>"Error in conv3D: Strides should be larger than 0.");const h={x:u,filter:a},p={strides:t,pad:s,dataFormat:o,dilations:r},f=q.runKernel(op,h,p);return d?Z(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const dL=ee({conv3d_:cL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hL(n,e,t,s,o){_(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let r=n,i=e,a=!1;e.rank===4&&(a=!0,i=Z(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),r=[1,n[0],n[1],n[2],n[3]]);const u=r[4],d=i.shape[4];_(r.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${r.length}.`),_(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),_(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),_(u===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${t.shape[3]}.`),_(d===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${d}) must match output depth for filter ${t.shape[4]}.`);const h={dy:i,filter:t},p={pad:o,strides:s,inputShape:r},f=q.runKernel(dx,h,p);return a?Z(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const mS=ee({conv3DBackpropInput_:hL});function pL(n,e,t,s,o){const r=z(n,"x","conv3dTranspose"),i=z(e,"filter","conv3dTranspose");return mS(t,r,i,s,o)}const fL=ee({conv3dTranspose_:pL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mL(n){const t={x:z(n,"x","cos","float32")};return q.runKernel($u,t)}const Kx=ee({cos_:mL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gL(n){const t={x:z(n,"x","cosh","float32")};return q.runKernel(Nu,t)}const gS=ee({cosh_:gL});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yL(n,e=0,t=!1,s=!1){const r={x:z(n,"x","cumprod")},i={axis:e,exclusive:t,reverse:s};return q.runKernel(hx,r,i)}const my=ee({cumprod_:yL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xL(n,e=0,t=!1,s=!1){const r={x:z(n,"x","cumsum")},i={axis:e,exclusive:t,reverse:s};return q.runKernel(rp,r,i)}const yS=ee({cumsum_:xL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bL(n,e,t,s=!1){const o=z(n,"x","denseBincount"),r=z(e,"weights","denseBincount");_(o.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${o.dtype}`),_(o.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${o.rank}.`),_(t>=0,()=>`size must be non-negative, but got ${t}.`),_(r.size===o.size||r.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${o.shape}, weights shape: ${r.shape}.`);const i={x:o,weights:r},a={size:t,binaryOutput:s};return q.runKernel(fx,i,a)}const nk=ee({denseBincount_:bL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vL(n,e,t="NHWC"){const s=z(n,"x","depthToSpace","float32"),o=t==="NHWC"?s.shape[1]:s.shape[2],r=t==="NHWC"?s.shape[2]:s.shape[3],i=t==="NHWC"?s.shape[3]:s.shape[1];_(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),_(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e}  for depthToSpace with input shape
    ${s.shape}`),_(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e} for depthToSpace with input shape
        ${s.shape}`),_(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const a={x:s},u={blockSize:e,dataFormat:t};return q.runKernel(mx,a,u)}const wL=ee({depthToSpace_:vL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kL(n,e,t,s,o="NHWC",r=[1,1],i){const a=z(n,"x","depthwiseConv2d","float32"),u=z(e,"filter","depthwiseConv2d","float32");let d=a,h=!1;a.rank===3&&(h=!0,d=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),_(d.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${d.rank}.`),_(u.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);const p=o==="NHWC"?d.shape[3]:d.shape[1];_(p===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${p}) must match the inChannels dimension in filter ${u.shape[2]}.`),Gn("depthwiseConv2d",s,i);const f={x:d,filter:u},g={strides:t,pad:s,dataFormat:o,dilations:r,dimRoundingMode:i},y=q.runKernel(ip,f,g);return h?Z(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Xx=ee({depthwiseConv2d_:kL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CL(n,e,t,s,o=[1,1],r="NHWC"){const i=z(n,"x","dilation2d"),a=z(e,"filter","dilation2d");_(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),_(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),_(r==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${r}`);let u=i,d=!1;i.rank===3&&(u=Z(i,[1,i.shape[0],i.shape[1],i.shape[2]]),d=!0),_(u.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${a.shape[2]}`);const h={x:u,filter:a},p={strides:t,pad:s,dilations:o},f=q.runKernel(ap,h,p);return d?Z(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const IL=ee({dilation2d_:CL});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aa(n,e){const t=n.length,s=[];for(let o=0;o<t;o++){const r=t-1-o,i=n[r]||1;(e[e.length-1-o]||1)>1&&i===1&&s.unshift(r)}return s}function Jt(n,e){const t=[];for(let s=0;s<e.length;s++){const o=n[n.length-s-1],r=e.length-s-1,i=e[r];(o==null||o===1&&i>1)&&t.unshift(r)}return t}function je(n,e){const t=Math.max(n.length,e.length),s=new Array(t);for(let o=0;o<t;o++){let r=n[n.length-o-1];r==null&&(r=1);let i=e[e.length-o-1];if(i==null&&(i=1),r===1)s[t-o-1]=i;else if(i===1)s[t-o-1]=r;else if(r!==i){const a=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(a)}else s[t-o-1]=r}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SL(n,e){let t=z(n,"a","equal","string_or_numeric"),s=z(e,"b","equal","string_or_numeric");[t,s]=Pt(t,s),je(t.shape,s.shape);const o={a:t,b:s};return q.runKernel(lp,o)}const wo=ee({equal_:SL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $L(n,e,t){const s=z(e,"a","where"),o=z(t,"b","where"),r=z(n,"condition","where","bool"),i=je(je(r.shape,s.shape),o.shape),a=Jl(r,i),u=Jl(s,i),d=Jl(o,i),h={condition:a,t:u,e:d};return q.runKernel(Pp,h)}const Dn=ee({where_:$L});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NL(n){const t={x:z(n,"x","zerosLike")};return q.runKernel(Hp,t)}const st=ee({zerosLike_:NL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TL(n,e){let t=z(n,"a","div"),s=z(e,"b","div");[t,s]=Pt(t,s);const o=Me(t,s),r=st(o),i=wo(s,r);return Dn(i,r,o)}const EL=ee({divNoNan_:TL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RL(n,e){const t=z(n,"t1","dot"),s=z(e,"t2","dot");_((t.rank===1||t.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${s.rank}.`);const o=t.rank===1?t.size:t.shape[1],r=s.rank===1?s.size:s.shape[0];if(_(o===r,()=>`Error in dot: inner dimensions of inputs must match, but got ${o} and ${r}.`),t.rank===1&&s.rank===1){const i=Z(t,[1,-1]),a=Z(s,[-1,1]),u=ct(i,a);return Z(u,[])}else if(t.rank===1&&s.rank===2){const i=Z(t,[1,-1]),a=Z(s,[s.shape[0],s.shape[1]]),u=ct(i,a);return Z(u,[u.size])}else if(t.rank===2&&s.rank===1){const i=Z(s,[-1,1]),a=ct(t,i);return Z(a,[a.size])}else{const i=Z(s,[s.shape[0],s.shape[1]]);return ct(t,i)}}const AL=ee({dot_:RL});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DL(n,...e){const t=e.map((o,r)=>z(o,`tensors${r}`,"einsum")),s={equation:n};return q.runKernel(xx,t,s)}const Vl=ee({einsum_:DL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FL(n){const t={x:z(n,"x","elu","float32")};return q.runKernel(Eu,t)}const Zp=ee({elu_:FL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _L(n){let e=z(n,"x","erf");_(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=$e(e,"float32"));const t={x:e};return q.runKernel(Ru,t)}const xS=ee({erf_:_L});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yx(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function bS(n,e,t){const s=n.length+e.length,o=[];let r=0,i=0;for(let a=0;a<s;a++)t.indexOf(a)===-1?o.push(n[r++]):o.push(e[i++]);return o}function rn(n,e){const t=[],s=n.length;for(let r=0;r<s;r++)e.indexOf(r)===-1&&t.push(n[r]);const o=e.map(r=>n[r]);return[t,o]}function jt(n,e){const t=e.map(s=>1);return bS(n,t,e)}function pn(n,e,t){_(Yx(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function Dt(n,e){if(Yx(n,e))return null;const t=[];for(let s=0;s<e;++s)n.indexOf(s)===-1&&t.push(s);return n.forEach(s=>t.push(s)),t}function Lr(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function zt(n,e){const t=[];for(let s=e-n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OL(n,e=null,t=!1){const o={x:z(n,"x","max")},r={reductionIndices:e,keepDims:t};return q.runKernel(vp,o,r)}const Xs=ee({max_:OL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LL(n,e=null,t=!1){const o={x:z(n,"x","min")},r={axis:e,keepDims:t};return q.runKernel(Ip,o,r)}const kh=ee({min_:LL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ML(n,e){let t=z(n,"base","pow"),s=z(e,"exp","pow");[t,s]=Pt(t,s);const o={a:t,b:s};return q.runKernel(Hu,o)}const Si=ee({pow_:ML});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dt(n,e){if((Rs(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Rs(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Xp(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PL(n){const t={x:z(n,"x","sqrt","float32")};return q.runKernel(oc,t)}const vn=ee({sqrt_:PL});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zL(n){const e=z(n,"x","square"),t={};return q.runKernel("Square",{x:e},t)}const It=ee({square_:zL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BL(n,e=null,t=!1){let s=z(n,"x","sum");s.dtype==="bool"&&(s=$e(s,"int32"));const o={x:s},r={axis:e,keepDims:t};return q.runKernel(Bp,o,r)}const Le=ee({sum_:BL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WL(n,e="euclidean",t=null,s=!1){n=z(n,"x","norm");const o=vS(n,e,t);let r=o.shape;if(s){const i=Ke(t,n.shape);r=jt(o.shape,i)}return Z(o,r)}function vS(n,e,t=null){if(n.rank===0)return En(n);if(n.rank!==1&&t===null)return vS(Z(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Le(En(n),t);if(e===1/0)return Xs(En(n),t);if(e===-1/0)return kh(En(n),t);if(e==="euclidean"||e===2)return vn(Le(Si(En(n),dt(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return Xs(Le(En(n),t[0]),t[1]-1);if(e===1/0)return Xs(Le(En(n),t[1]),t[0]);if(e===-1/0)return kh(Le(En(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return vn(Le(It(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const ef=ee({norm_:WL});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VL(n,e=null,t=!1){return ef(n,"euclidean",e,t)}const UL=ee({euclideanNorm_:VL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GL(n){const t={x:z(n,"x","exp")};return q.runKernel(Au,t)}const ko=ee({exp_:GL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jL(n,e=0){const t=z(n,"x","expandDims","string_or_numeric");_(e<=t.rank,()=>"Axis must be <= rank of the tensor");const s={input:t},o={dim:e};return q.runKernel(up,s,o)}const zn=ee({expandDims_:jL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HL(n){const t={x:z(n,"x","expm1")};return q.runKernel(Du,t)}const qL=ee({expm1_:HL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KL(n,e){const t=z(n,"x","tile","string_or_numeric");_(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const s={x:t},o={reps:e};return q.runKernel(uc,s,o)}const qs=ee({tile_:KL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XL(n,e,t,s="float32"){e==null&&(e=n);const o=qe([n,e],s),r=n<=e?n:e;for(let a=0;a<r;++a)o.set(1,a,a);const i=Z(o.toTensor(),[n,e]);if(t==null)return i;if(t.length===1)return qs(zn(i,0),[t[0],1,1]);if(t.length===2)return qs(zn(zn(i,0),0),[t[0],t[1],1,1]);if(t.length===3)return qs(zn(zn(zn(i,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const wS=ee({eye_:XL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YL(n){const t={x:z(n,"x","floor","float32")};return q.runKernel(Fu,t)}const tf=ee({floor_:YL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QL(n,e,t=0,s=0){const o=z(n,"x","gather"),r=z(e,"indices","gather","int32"),i={x:o,indices:r},a={axis:t,batchDims:s};return q.runKernel(dp,i,a)}const Qx=ee({gather_:QL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JL(n,e){let t=z(n,"a","greater","string_or_numeric"),s=z(e,"b","greater","string_or_numeric");[t,s]=Pt(t,s),je(t.shape,s.shape);const o={a:t,b:s};return q.runKernel(hp,o)}const fs=ee({greater_:JL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZL(n,e){let t=z(n,"a","greaterEqual","string_or_numeric"),s=z(e,"b","greaterEqual","string_or_numeric");[t,s]=Pt(t,s),je(t.shape,s.shape);const o={a:t,b:s};return q.runKernel(Ou,o)}const Fi=ee({greaterEqual_:ZL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eM(n){const t={input:z(n,"input","imag")};return q.runKernel(Ix,t)}const Jx=ee({imag_:eM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tM(n){const t={x:z(n,"x","isFinite")};return q.runKernel(Mu,t)}const nM=ee({isFinite_:tM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sM(n){const t={x:z(n,"x","isInf")};return q.runKernel(Pu,t)}const oM=ee({isInf_:sM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rM(n){const t={x:z(n,"x","isNaN")};return q.runKernel(zu,t)}const iM=ee({isNaN_:rM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aM(n,e=.2){const s={x:z(n,"x","leakyRelu")},o={alpha:e};return q.runKernel(pp,s,o)}const Zx=ee({leakyRelu_:aM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lM(n,e){let t=z(n,"a","less","string_or_numeric"),s=z(e,"b","less","string_or_numeric");[t,s]=Pt(t,s),je(t.shape,s.shape);const o={a:t,b:s};return q.runKernel(fp,o)}const Ch=ee({less_:lM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uM(n,e){let t=z(n,"a","lessEqual","string_or_numeric"),s=z(e,"b","lessEqual","string_or_numeric");[t,s]=Pt(t,s),je(t.shape,s.shape);const o={a:t,b:s};return q.runKernel(mp,o)}const ja=ee({lessEqual_:uM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cM(n,e=5,t=1,s=1,o=.5){const r=z(n,"x","localResponseNormalization");_(r.rank===4||r.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${r.rank}.`),_(Ta(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=r,a=!1;r.rank===3&&(a=!0,i=Z(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const u={x:i},d={depthRadius:e,bias:t,alpha:s,beta:o},h=q.runKernel(bp,u,d);return a?Z(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const dM=ee({localResponseNormalization_:cM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hM(n){const t={x:z(n,"x","log","float32")};return q.runKernel(Bu,t)}const Co=ee({log_:hM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pM(n){const t={x:z(n,"x","log1p")};return q.runKernel(Wu,t)}const kS=ee({log1p_:pM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fM(n,e){_(ey(n),()=>"The f passed in variableGrads(f) must be a function"),_(e==null||Array.isArray(e)&&e.every(d=>d instanceof wh),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const d in q.registeredVariables)e.push(q.registeredVariables[d])}const s=t?e.filter(d=>!d.trainable):null,o=e.length;e=e.filter(d=>d.trainable),_(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${o} variables is trainable.`);const r=!0,{value:i,grads:a}=q.gradients(n,e,null,r);_(a.some(d=>d!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),_(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const u={};return e.forEach((d,h)=>{a[h]!=null&&(u[d.name]=a[h])}),s!=null&&s.forEach(d=>u[d.name]=null),{value:i,grads:u}}function Da(n){return q.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mM(n){const t={x:z(n,"x","neg")};return q.runKernel($p,t)}const Mt=ee({neg_:mM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gM(n){const t={x:z(n,"x","softplus")};return q.runKernel(sc,t)}const hc=ee({softplus_:gM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yM(n){const e=z(n,"x","logSigmoid");return Da(s=>({value:Mt(hc(Mt(s))),gradFunc:i=>j(i,Ga(Mt(s)))}))(e)}const xM=ee({logSigmoid_:yM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bM(n,e){let t=z(n,"a","sub"),s=z(e,"b","sub");[t,s]=Pt(t,s);const o={a:t,b:s};return q.runKernel(ic,o)}const We=ee({sub_:bM});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vM(n,e=-1){const t=z(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Da((o,r)=>{const a=Xs(o,e,!0),u=We(o,a),d=We($e(u,"float32"),Co(Le(ko(u),e,!0)));return r([d]),{value:d,gradFunc:(p,f)=>{const[g]=f,y=!0,b=ko(g);return We(p,j(Le(p,e,y),b))}}})(t)}const CS=ee({logSoftmax_:vM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wM(n,e=null,t=!1){const s=z(n,"x","logSumExp"),o=Ke(e,s.shape),r=Xs(s,o,!0),i=We(s,r),a=ko(i),u=Le(a,o),d=Co(u),h=xe(Z(r,d.shape),d);if(t){const p=jt(h.shape,o);return Z(h,p)}return h}const IS=ee({logSumExp_:wM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kM(n,e){const t=z(n,"a","logicalAnd","bool"),s=z(e,"b","logicalAnd","bool");je(t.shape,s.shape);const o={a:t,b:s};return q.runKernel(gp,o)}const Uo=ee({logicalAnd_:kM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CM(n){const t={x:z(n,"x","logicalNot","bool")};return q.runKernel(yp,t)}const e0=ee({logicalNot_:CM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IM(n,e){const t=z(n,"a","logicalOr","bool"),s=z(e,"b","logicalOr","bool");je(t.shape,s.shape);const o={a:t,b:s};return q.runKernel(xp,o)}const SS=ee({logicalOr_:IM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SM(n,e){const t=z(n,"a","logicalXor","bool"),s=z(e,"b","logicalXor","bool");return je(t.shape,s.shape),Uo(SS(n,e),e0(Uo(n,e)))}const $M=ee({logicalXor_:SM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NM(n,e,t,s,o){const r=z(n,"x","maxPool"),i=1;let a=r,u=!1;r.rank===3&&(u=!0,a=Z(r,[1,r.shape[0],r.shape[1],r.shape[2]])),_(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),_(wn(t,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),Gn("maxPool",s,o);const d={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:o},p=q.runKernel(wp,d,h);return u?Z(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const t0=ee({maxPool_:NM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TM(n,e=[1,1,1],t,s,o,r="NDHWC"){const i=z(n,"x","maxPool3d");let a=i,u=!1;i.rank===4&&(u=!0,a=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),_(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),_(r==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),Gn("maxPool3d",s,o);const d={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:o,dataFormat:r},p=q.runKernel(kp,d,h);return u?Z(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const EM=ee({maxPool3d_:TM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RM(n,e){let t=z(n,"a","maximum"),s=z(e,"b","maximum");[t,s]=Pt(t,s),t.dtype==="bool"&&(t=$e(t,"int32"),s=$e(s,"int32")),je(t.shape,s.shape);const o={a:t,b:s};return q.runKernel(Vu,o)}const Mr=ee({maximum_:RM});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AM(n,e=null,t=!1){const o={x:z(n,"x","mean")},r={axis:e,keepDims:t};return q.runKernel(Cp,o,r)}const Gt=ee({mean_:AM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sn(n,e="float32"){if(Ko(n),e==="complex64"){const s=sn(n,"float32"),o=sn(n,"float32");return Ra(s,o)}const t=bn(de(n),e);return q.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pr(n,e="float32"){if(Ko(n),e==="complex64"){const s=Pr(n,"float32"),o=sn(n,"float32");return Ra(s,o)}const t=Jy(de(n),e);return q.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DM(n,e){let t=z(n,"a","minimum"),s=z(e,"b","minimum");[t,s]=Pt(t,s),t.dtype==="bool"&&(t=$e(t,"int32"),s=$e(s,"int32")),je(t.shape,s.shape);const o={a:t,b:s};return q.runKernel(Uu,o)}const ou=ee({minimum_:DM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FM(n,e,t){_(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const s=z(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");_(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const o=t==="reflect"?1:0;for(let a=0;a<s.rank;a++)_(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),_(e[a][0]>=0&&e[a][0]<=s.shape[a]-o&&e[a][1]>=0&&e[a][1]<=s.shape[a]-o,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-o} or less than 0 for input of shape ${s.shape}`);const r={paddings:e,mode:t},i={x:s};return q.runKernel(Sp,i,r)}const _M=ee({mirrorPad_:FM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OM(n,e){let t=z(n,"a","mod"),s=z(e,"b","mod");[t,s]=Pt(t,s);const o={a:t,b:s};return q.runKernel(Gu,o)}const LM=ee({mod_:OM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MM(n,e=null,t=!1){n=z(n,"x","moments");const s=Ke(e,n.shape),o=Gt(n,s,t);let r=o.shape;t||(r=jt(o.shape,s));const i=It(We($e(n,"float32"),Z(o,r))),a=Gt(i,s,t);return{mean:o,variance:a}}const n0=ee({moments_:MM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PM(n,e){let t=z(n,"a","notEqual","string_or_numeric"),s=z(e,"b","notEqual","string_or_numeric");[t,s]=Pt(t,s),je(t.shape,s.shape);const o={a:t,b:s};return q.runKernel(Np,o)}const Ih=ee({notEqual_:PM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zM(n,e,t=1,s=0,o="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:z(n,"indices","oneHot","int32")},a={dtype:o,depth:e,onValue:t,offValue:s};return q.runKernel(Ep,i,a)}const $S=ee({oneHot_:zM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BM(n){const t={x:z(n,"x","onesLike")};return q.runKernel(Tp,t)}const As=ee({onesLike_:BM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WM(n,e,t=0){const s=z(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const o={paddings:e,constantValue:t},r={x:s};return q.runKernel(Ap,r,o)}const s0=ee({pad_:WM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VM(n,e,t){const s=z(n,"x","spaceToBatchND");_(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),_(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),_(s.shape.reduce((i,a,u)=>u>0&&u<=e.length?i&&(a+t[u-1][0]+t[u-1][1])%e[u-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const o={x:s},r={blockShape:e,paddings:t};return q.runKernel(Wp,o,r)}const o0=ee({spaceToBatchND_:VM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UM(n,e,t,s,o,r,i){o==null&&(o=[1,1]),r==null&&(r=1),s===0&&(s="valid");const a=z(n,"x","maxPool");let u=a,d=!1;a.rank===3&&(d=!0,u=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),_(wn(r,o),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${r} and dilations '${o}'`);const h=Ds(u.shape,e,r,o,s),p=[h.dilationHeight,h.dilationWidth];let f;s==="same"?f=jM([h.filterHeight,h.filterWidth],p):f=[[0,0],[0,0]];const g=p[0]===1&&p[1]===1,[y,b]=GM([h.inHeight,h.inWidth],p,f),v=g?s:"valid",w=g?u:o0(u,p,y),$=(t==="avg"?()=>jx(w,e,r,v,i):()=>t0(w,e,r,v,i))(),S=g?$:Hx($,p,b);return d?Z(S,[S.shape[1],S.shape[2],S.shape[3]]):S}function GM(n,e,t){const s=t.map(h=>h[0]),o=t.map(h=>h[1]),r=n.concat(s,o),i=e.map((h,p)=>(h-r[p]%h)%h),a=o.map((h,p)=>h+i[p]),u=e.map((h,p)=>[s[p],a[p]]),d=e.map((h,p)=>[0,i[p]]);return[u,d]}function jM(n,e){const s=n.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),o=s.map(i=>Math.floor(i/2)),r=s.map((i,a)=>i-o[a]);return s.map((i,a)=>[o[a],r[a]])}const HM=ee({pool_:UM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qM(n,e){const t=z(n,"x","prelu"),s=z(e,"alpha","prelu"),o={x:t,alpha:s};return q.runKernel(Dp,o)}const r0=ee({prelu_:qM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KM(n,e=null,t=!1){let s=z(n,"x","prod");s.dtype==="bool"&&(s=$e(s,"int32"));const o={x:s},r={axis:e,keepDims:t};return q.runKernel(Fp,o,r)}const XM=ee({prod_:KM});var oh={exports:{}},YM=oh.exports,sk;function QM(){return sk||(sk=1,function(n){(function(e,t,s){function o(u){var d=this,h=a();d.next=function(){var p=2091639*d.s0+d.c*23283064365386963e-26;return d.s0=d.s1,d.s1=d.s2,d.s2=p-(d.c=p|0)},d.c=1,d.s0=h(" "),d.s1=h(" "),d.s2=h(" "),d.s0-=h(u),d.s0<0&&(d.s0+=1),d.s1-=h(u),d.s1<0&&(d.s1+=1),d.s2-=h(u),d.s2<0&&(d.s2+=1),h=null}function r(u,d){return d.c=u.c,d.s0=u.s0,d.s1=u.s1,d.s2=u.s2,d}function i(u,d){var h=new o(u),p=d&&d.state,f=h.next;return f.int32=function(){return h.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,p&&(typeof p=="object"&&r(p,h),f.state=function(){return r(h,{})}),f}function a(){var u=4022871197,d=function(h){h=String(h);for(var p=0;p<h.length;p++){u+=h.charCodeAt(p);var f=.02519603282416938*u;u=f>>>0,f-=u,f*=u,u=f>>>0,f-=u,u+=f*4294967296}return(u>>>0)*23283064365386963e-26};return d}t&&t.exports?t.exports=i:this.alea=i})(YM,n)}(oh)),oh.exports}var rh={exports:{}},JM=rh.exports,ok;function ZM(){return ok||(ok=1,function(n){(function(e,t,s){function o(a){var u=this,d="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var p=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^p^p>>>8},a===(a|0)?u.x=a:d+=a;for(var h=0;h<d.length+64;h++)u.x^=d.charCodeAt(h)|0,u.next()}function r(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u}function i(a,u){var d=new o(a),h=u&&u.state,p=function(){return(d.next()>>>0)/4294967296};return p.double=function(){do var f=d.next()>>>11,g=(d.next()>>>0)/4294967296,y=(f+g)/(1<<21);while(y===0);return y},p.int32=d.next,p.quick=p,h&&(typeof h=="object"&&r(h,d),p.state=function(){return r(d,{})}),p}t&&t.exports?t.exports=i:this.xor128=i})(JM,n)}(rh)),rh.exports}var ih={exports:{}},eP=ih.exports,rk;function tP(){return rk||(rk=1,function(n){(function(e,t,s){function o(a){var u=this,d="";u.next=function(){var p=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(p^p<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,a===(a|0)?u.x=a:d+=a;for(var h=0;h<d.length+64;h++)u.x^=d.charCodeAt(h)|0,h==d.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function r(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u.v=a.v,u.d=a.d,u}function i(a,u){var d=new o(a),h=u&&u.state,p=function(){return(d.next()>>>0)/4294967296};return p.double=function(){do var f=d.next()>>>11,g=(d.next()>>>0)/4294967296,y=(f+g)/(1<<21);while(y===0);return y},p.int32=d.next,p.quick=p,h&&(typeof h=="object"&&r(h,d),p.state=function(){return r(d,{})}),p}t&&t.exports?t.exports=i:this.xorwow=i})(eP,n)}(ih)),ih.exports}var ah={exports:{}},nP=ah.exports,ik;function sP(){return ik||(ik=1,function(n){(function(e,t,s){function o(a){var u=this;u.next=function(){var h=u.x,p=u.i,f,g;return f=h[p],f^=f>>>7,g=f^f<<24,f=h[p+1&7],g^=f^f>>>10,f=h[p+3&7],g^=f^f>>>3,f=h[p+4&7],g^=f^f<<7,f=h[p+7&7],f=f^f<<13,g^=f^f<<9,h[p]=g,u.i=p+1&7,g};function d(h,p){var f,g=[];if(p===(p|0))g[0]=p;else for(p=""+p,f=0;f<p.length;++f)g[f&7]=g[f&7]<<15^p.charCodeAt(f)+g[f+1&7]<<13;for(;g.length<8;)g.push(0);for(f=0;f<8&&g[f]===0;++f);for(f==8?g[7]=-1:g[f],h.x=g,h.i=0,f=256;f>0;--f)h.next()}d(u,a)}function r(a,u){return u.x=a.x.slice(),u.i=a.i,u}function i(a,u){a==null&&(a=+new Date);var d=new o(a),h=u&&u.state,p=function(){return(d.next()>>>0)/4294967296};return p.double=function(){do var f=d.next()>>>11,g=(d.next()>>>0)/4294967296,y=(f+g)/(1<<21);while(y===0);return y},p.int32=d.next,p.quick=p,h&&(h.x&&r(h,d),p.state=function(){return r(d,{})}),p}t&&t.exports?t.exports=i:this.xorshift7=i})(nP,n)}(ah)),ah.exports}var lh={exports:{}},oP=lh.exports,ak;function rP(){return ak||(ak=1,function(n){(function(e,t,s){function o(a){var u=this;u.next=function(){var h=u.w,p=u.X,f=u.i,g,y;return u.w=h=h+1640531527|0,y=p[f+34&127],g=p[f=f+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=p[f]=y^g,u.i=f,y+(h^h>>>16)|0};function d(h,p){var f,g,y,b,v,w=[],C=128;for(p===(p|0)?(g=p,p=null):(p=p+"\0",g=0,C=Math.max(C,p.length)),y=0,b=-32;b<C;++b)p&&(g^=p.charCodeAt((b+32)%p.length)),b===0&&(v=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,b>=0&&(v=v+1640531527|0,f=w[b&127]^=g+v,y=f==0?y+1:0);for(y>=128&&(w[(p&&p.length||0)&127]=-1),y=127,b=4*128;b>0;--b)g=w[y+34&127],f=w[y=y+1&127],g^=g<<13,f^=f<<17,g^=g>>>15,f^=f>>>12,w[y]=g^f;h.w=v,h.X=w,h.i=y}d(u,a)}function r(a,u){return u.i=a.i,u.w=a.w,u.X=a.X.slice(),u}function i(a,u){a==null&&(a=+new Date);var d=new o(a),h=u&&u.state,p=function(){return(d.next()>>>0)/4294967296};return p.double=function(){do var f=d.next()>>>11,g=(d.next()>>>0)/4294967296,y=(f+g)/(1<<21);while(y===0);return y},p.int32=d.next,p.quick=p,h&&(h.X&&r(h,d),p.state=function(){return r(d,{})}),p}t&&t.exports?t.exports=i:this.xor4096=i})(oP,n)}(lh)),lh.exports}var uh={exports:{}},iP=uh.exports,lk;function aP(){return lk||(lk=1,function(n){(function(e,t,s){function o(a){var u=this,d="";u.next=function(){var p=u.b,f=u.c,g=u.d,y=u.a;return p=p<<25^p>>>7^f,f=f-g|0,g=g<<24^g>>>8^y,y=y-p|0,u.b=p=p<<20^p>>>12^f,u.c=f=f-g|0,u.d=g<<16^f>>>16^y,u.a=y-p|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,a===Math.floor(a)?(u.a=a/4294967296|0,u.b=a|0):d+=a;for(var h=0;h<d.length+20;h++)u.b^=d.charCodeAt(h)|0,u.next()}function r(a,u){return u.a=a.a,u.b=a.b,u.c=a.c,u.d=a.d,u}function i(a,u){var d=new o(a),h=u&&u.state,p=function(){return(d.next()>>>0)/4294967296};return p.double=function(){do var f=d.next()>>>11,g=(d.next()>>>0)/4294967296,y=(f+g)/(1<<21);while(y===0);return y},p.int32=d.next,p.quick=p,h&&(typeof h=="object"&&r(h,d),p.state=function(){return r(d,{})}),p}t&&t.exports?t.exports=i:this.tychei=i})(iP,n)}(uh)),uh.exports}var ch={exports:{}};const lP={},uP=Object.freeze(Object.defineProperty({__proto__:null,default:lP},Symbol.toStringTag,{value:"Module"})),cP=UA(uP);var dP=ch.exports,uk;function hP(){return uk||(uk=1,function(n){(function(e,t,s){var o=256,r=6,i=52,a="random",u=s.pow(o,r),d=s.pow(2,i),h=d*2,p=o-1,f;function g(S,N,R){var F=[];N=N==!0?{entropy:!0}:N||{};var O=w(v(N.entropy?[S,$(t)]:S??C(),3),F),D=new y(F),A=function(){for(var T=D.g(r),B=u,U=0;T<d;)T=(T+U)*o,B*=o,U=D.g(1);for(;T>=h;)T/=2,B/=2,U>>>=1;return(T+U)/B};return A.int32=function(){return D.g(4)|0},A.quick=function(){return D.g(4)/4294967296},A.double=A,w($(D.S),t),(N.pass||R||function(T,B,U,Q){return Q&&(Q.S&&b(Q,D),T.state=function(){return b(D,{})}),U?(s[a]=T,B):T})(A,O,"global"in N?N.global:this==s,N.state)}function y(S){var N,R=S.length,F=this,O=0,D=F.i=F.j=0,A=F.S=[];for(R||(S=[R++]);O<o;)A[O]=O++;for(O=0;O<o;O++)A[O]=A[D=p&D+S[O%R]+(N=A[O])],A[D]=N;(F.g=function(T){for(var B,U=0,Q=F.i,K=F.j,J=F.S;T--;)B=J[Q=p&Q+1],U=U*o+J[p&(J[Q]=J[K=p&K+B])+(J[K]=B)];return F.i=Q,F.j=K,U})(o)}function b(S,N){return N.i=S.i,N.j=S.j,N.S=S.S.slice(),N}function v(S,N){var R=[],F=typeof S,O;if(N&&F=="object")for(O in S)try{R.push(v(S[O],N-1))}catch{}return R.length?R:F=="string"?S:S+"\0"}function w(S,N){for(var R=S+"",F,O=0;O<R.length;)N[p&O]=p&(F^=N[p&O]*19)+R.charCodeAt(O++);return $(N)}function C(){try{var S;return f&&(S=f.randomBytes)?S=S(o):(S=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(S)),$(S)}catch{var N=e.navigator,R=N&&N.plugins;return[+new Date,e,R,e.screen,$(t)]}}function $(S){return String.fromCharCode.apply(0,S)}if(w(s.random(),t),n.exports){n.exports=g;try{f=cP}catch{}}else s["seed"+a]=g})(typeof self<"u"?self:dP,[],Math)}(ch)),ch.exports}var Fg,ck;function pP(){if(ck)return Fg;ck=1;var n=QM(),e=ZM(),t=tP(),s=sP(),o=rP(),r=aP(),i=hP();return i.alea=n,i.xor128=e,i.xorwow=t,i.xorshift7=s,i.xor4096=o,i.tychei=r,Fg=i,Fg}var i0=pP();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NS{constructor(e,t,s,o,r){this.mean=e,this.stdDev=t,this.dtype=s,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=r||Math.random();this.random=i0.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const o=this.nextVal;return this.nextVal=NaN,o}let e,t,s=!1;for(;!s;){let o,r,i;do o=2*this.random()-1,r=2*this.random()-1,i=o*o+r*r;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*o*a,t=this.mean+this.stdDev*r*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class fP{constructor(e=0,t=1,s,o){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=s,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=i0.alea(o)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mP(n,e=0,t=1,s,o){if(Ko(n),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const r=new NS(e,t,s,!1,o),i=qe(n,s);for(let a=0;a<i.values.length;a++)i.values[a]=r.nextValue();return i.toTensor()}const gP=ee({randomNormal_:mP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yP(n,e=0,t=1,s="float32",o){Ko(n);const r=qe(n,s),i=new fP(e,t,null,o);for(let a=0;a<r.values.length;a++)r.values[a]=i.nextValue();return r.toTensor()}const pc=ee({randomUniform_:yP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ru(n,e,t=1,s="float32"){if(t===0)throw new Error("Cannot have a step of zero");const o={start:n,stop:e,step:t,dtype:s};return q.runKernel(Ax,{},o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xP(n){const t={input:z(n,"input","real")};return q.runKernel(Dx,t)}const Sh=ee({real_:xP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bP(n){const t={x:z(n,"x","reciprocal")};return q.runKernel(qu,t)}const vP=ee({reciprocal_:bP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wP(n){const t={x:z(n,"x","relu")};return q.runKernel(Ku,t)}const _i=ee({relu_:wP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kP(n){const t={x:z(n,"x","relu6")};return q.runKernel(Xu,t)}const TS=ee({relu6_:kP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CP(n,e){const s={x:z(n,"x","reverse")},o={dims:e};return q.runKernel(Mp,s,o)}const $i=ee({reverse_:CP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IP(n){const t={x:z(n,"x","round")};return q.runKernel(Yu,t)}const ES=ee({round_:IP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SP(n){const t={x:z(n,"x","rsqrt","float32")};return q.runKernel(Qu,t)}const RS=ee({rsqrt_:SP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $P(n){const t={x:z(n,"x","selu")};return q.runKernel(Ju,t)}const AS=ee({selu_:$P});function NP(n,e,t,s,o,r=[1,1],i="NHWC"){const a=z(n,"x","separableConv2d"),u=z(e,"depthwiseFilter","separableConv2d"),d=z(t,"pointwiseFilter","separableConv2d");let h=a,p=!1;if(a.rank===3&&(p=!0,h=Z(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");_(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),_(u.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),_(d.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),_(d.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${d.shape[0]}.`),_(d.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${d.shape[1]}.`);const f=u.shape[2],g=u.shape[3];_(d.shape[2]===f*g,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${f*g}, but got ${d.shape[2]}.`);const y=Xx(h,u,s,o,i,r),v=Ii(y,d,1,"valid",i);return p?Z(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const DS=ee({separableConv2d_:NP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TP(n){const t={x:z(n,"x","sign")};return q.runKernel(tc,t)}const EP=ee({sign_:TP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RP(n){const t={x:z(n,"x","sin","float32")};return q.runKernel(Zu,t)}const FS=ee({sin_:RP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AP(n){const t={x:z(n,"x","sinh")};return q.runKernel(ec,t)}const _S=ee({sinh_:AP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DP(n,e,t){const s=z(n,"x","slice1d");return _(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),wt(s,[e],[t])}const a0=ee({slice1d_:DP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FP(n,e,t){const s=z(n,"x","slice2d");return _(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),wt(s,e,t)}const OS=ee({slice2d_:FP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _P(n,e,t){const s=z(n,"x","slice3d");return _(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),wt(s,e,t)}const l0=ee({slice3d_:_P});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OP(n,e,t){const s=z(n,"x","slice4d");return _(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),wt(s,e,t)}const $h=ee({slice4d_:OP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LP(n,e=-1){const t=z(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const s={logits:t},o={dim:e};return q.runKernel(Up,s,o)}const u0=ee({softmax_:LP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MP(n){_(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return q.runKernel(vx,e)}const LS=ee({fft_:MP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PP(n){_(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return q.runKernel(Cx,e)}const gy=ee({ifft_:PP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zP(n){const e=n.shape[n.shape.length-1],t=n.size/e;let s;if(e<=2){const o=Z(n,[t,e]);s=gy(o)}else{const o=[t,2*(e-1)],r=Z(Sh(n),[t,e]),i=Z(Jx(n),[t,e]),a=$i(wt(r,[0,1],[t,e-2]),1),u=j($i(wt(i,[0,1],[t,e-2]),1),dt(-1)),d=Wn([r,a],1),h=Wn([i,u],1),p=Z(Ra(d,h),[o[0],o[1]]);s=gy(p)}if(s=Sh(s),n.rank===3&&n.shape[0]!==0){const o=s,r=n.shape[0];s=Z(s,[r,s.shape[0]/r,s.shape[1]]),o.dispose()}return s}const BP=ee({irfft_:zP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WP(n,e,t=0){const o={x:z(n,"x","split")},r={numOrSizeSplits:e,axis:t};return q.runKernel(Vp,o,r)}const hs=ee({split_:WP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VP(n,e){_(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const s=n.size/t;let o;if(e!=null&&e<t){const y=n.shape.map(v=>0),b=n.shape.map(v=>v);b[n.shape.length-1]=e,o=wt(n,y,b),t=e}else if(e!=null&&e>t){const y=n.shape.map(b=>b);y[n.shape.length-1]=e-t,o=Wn([n,sn(y)],n.shape.length-1),t=e}else o=n;const r=st(o),i=Z(Ra(o,r),[s,t]),a=LS(i),u=Math.floor(t/2)+1,d=Sh(a),h=Jx(a),p=hs(d,[u,t-u],d.shape.length-1),f=hs(h,[u,t-u],h.shape.length-1),g=o.shape.slice();return g[o.shape.length-1]=u,Z(Ra(p[0],f[0]),g)}const UP=ee({rfft_:VP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GP(n,e){let t=z(n,"a","squaredDifference"),s=z(e,"b","squaredDifference");[t,s]=Pt(t,s),je(t.shape,s.shape);const o={a:t,b:s},r={};return q.runKernel(rc,o,r)}const jP=ee({squaredDifference_:GP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HP(n,e){const t=z(n,"x","squeeze","string_or_numeric");return Z(t,Fr(t.shape,e).newShape)}const fc=ee({squeeze_:HP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qP(n,e=0){const t=tS(n,"tensors","stack","string_or_numeric");_(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&_(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const s=t,o={axis:e};return q.runKernel(Rp,s,o)}const Go=ee({stack_:qP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KP(n,e=0){const s={x:z(n,"x","step")},o={alpha:e};return q.runKernel(cc,s,o)}const mc=ee({step_:KP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XP(n,e,t,s,o=0,r=0,i=0,a=0,u=0){const h={x:z(n,"x","stridedSlice","string_or_numeric")},p={begin:e,end:t,strides:s,beginMask:o,endMask:r,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:u};return q.runKernel(Mx,h,p)}const YP=ee({stridedSlice_:XP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QP(n){const t={x:z(n,"x","tan","float32")};return q.runKernel(ac,t)}const JP=ee({tan_:QP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function es(n,e){dI(n);const t=Kp(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Xp(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sa(n,e,t){if(dI(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Kp(n,t);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Xp(n,e,s,t)}function MS(n,e,t){const s=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,r=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${o}.`;if(t.rank<o)throw new Error(r+` update.rank < ${o}. `);if(n.length<s+(t.rank-o))throw new Error(r+` Output shape length < ${s+(t.rank-o)}`);if(t.rank!==o+n.length-s)throw new Error(r+` update.rank != ${o+n.length-s}`);for(let i=0;i<o;++i)if(t.shape[i]!==e.shape[i])throw new Error(r+` updates.shape[${i}] (${t.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<t.rank-o;++i)if(t.shape[i+o]!==n[i+s])throw new Error(r+` updates.shape[${i+o}] (${t.shape[i+o]}) != shape[${i+o}] (${n[i+o]})`)}function ZP(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}MS(t,e,n)}function Oi(n,e,t){const s=e.shape.length,o=s>1?e.shape[s-1]:1,r=t.length;let i=1;for(let p=o;p<r;++p)i*=t[p];const a=o<1?1:o,u=de(e.shape)/a,d=[...Oe(t.slice(0,o)),1],h=de(t);return{sliceRank:o,numUpdates:u,sliceSize:i,strides:d,outputSize:h}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3(n,e=1,t=!0){const s=z(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const o=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>o)throw new Error(`'k' passed to topk() must be <= the last dimension (${o}) but got ${e}`);const r={x:s},i={k:e,sorted:t},[a,u]=q.runKernel(Px,r,i);return{values:a,indices:u}}const t3=ee({topk_:e3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n3(n,e=0,t=1,s,o){if(Ko(n),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const r=new NS(e,t,s,!0,o),i=qe(n,s);for(let a=0;a<i.values.length;a++)i.values[a]=r.nextValue();return i.toTensor()}const PS=ee({truncatedNormal_:n3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3(n,e=0){const t=z(n,"x","unique","string_or_numeric");_(t.rank>0,()=>"The input tensor must be at least 1D");const s={x:t},o={axis:e},[r,i]=q.runKernel(Bx,s,o);return{values:r,indices:i}}const o3=ee({unique_:s3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r3(n,e,t){const s=z(n,"x","unsortedSegmentSum"),o=z(e,"segmentIds","unsortedSegmentSum","int32");_(Ta(t),()=>"numSegments must be of dtype int");const r={x:s,segmentIds:o},i={numSegments:t};return q.runKernel(jp,r,i)}const zS=ee({unsortedSegmentSum_:r3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3(n,e=0){const t=z(n,"x","unstack","string_or_numeric");_(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const s={value:t},o={axis:e};return q.runKernel(Gp,s,o)}const Ni=ee({unstack_:i3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3(n,e=!0,t,s){return q.makeVariable(n,e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BS(n,e){const t=[];for(let r=0;r<e.length;r++)e[r]&&t.push(r);const s=qe(n,"int32"),o=qe([t.length,n.length],"int32");for(let r=0;r<t.length;r++){const i=s.indexToLoc(t[r]),a=r*n.length;o.values.set(i,a)}return o.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l3(n,e,t){const s=z(n,"x","transpose");if(e==null&&(e=s.shape.map((i,a)=>a).reverse()),_(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{_(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const o={x:s},r={perm:e};return s.dtype==="complex64"?se(()=>{let i=Sh(s),a=Jx(s);return i=q.runKernel(Ca,{x:i},r),a=q.runKernel(Ca,{x:a},r),t&&(a=Mt(a)),Ra(i,a)}):q.runKernel(Ca,o,r)}const nt=ee({transpose_:l3});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3(n,e){if(e==null)return n.shape.slice();if(ht(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let s=0;s<n.shape.length;s++)e[s]==null&&n.shape[s]!=null?t.push(n.shape[s]):t.push(e[s]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c3(n,e,t,s){const o=z(n,"x","dropout");if(_(o.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${o.dtype} tensor instead.`),_(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof qt?o.clone():o;const r=u3(o,t),i=1-e,a=Me(tf(xe(pc(r,0,1,"float32",s),i)),i);return j(o,a)}const d3=ee({dropout_:c3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h3(n,e,t,s,o,r="NHWC",i){let a=n;n.rank===3&&(a=Z(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let u=e;u.rank===3&&(u=Z(e,[1,e.shape[0],e.shape[1],e.shape[2]])),_(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),_(u.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),_(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const d=r==="NHWC"?a.shape[3]:a.shape[1],h=r==="NHWC"?u.shape[3]:u.shape[1];_(d===t[2],()=>`Error in conv2dDerFilter: depth of input ${d}) must match input depth in filter (${t[2]}.`),_(h===t[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${t[3]}).`),Gn("conv2dDerFilter",o,i);const p={x:a,dy:u},f={strides:s,pad:o,dataFormat:r,dimRoundingMode:i,filterShape:t};return q.runKernel(ux,p,f)}const c0=ee({conv2DBackpropFilter_:h3});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return j(n,mc(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function h0(n,e){let t=e;const s=Jt(n.shape,e.shape);return s.length>0&&(t=Le(t,s)),Z(t,n.shape)}function p0(n,e,t,s){if(e==="linear")return n;if(e==="relu")return _i(n);if(e==="elu")return Zp(n);if(e==="relu6")return TS(n);if(e==="prelu")return r0(n,t);if(e==="leakyrelu")return Zx(n,s);if(e==="sigmoid")return Ga(n);throw new Error(`Unknown fused activation ${e}.`)}const f0=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3({x:n,filter:e,strides:t,pad:s,dataFormat:o="NHWC",dilations:r=[1,1],dimRoundingMode:i,bias:a,activation:u="linear",preluActivationWeights:d,leakyreluAlpha:h}){if(u=u||"linear",f0(q.state.gradientDepth,u)===!1){_(o==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${o} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let R=Ii(n,e,t,s,o,r,i);return a!=null&&(R=xe(R,a)),p0(R,u,d,h)}const p=z(n,"x","conv2d","float32"),f=z(e,"filter","conv2d","float32");let g=p,y=!1;p.rank===3&&(y=!0,g=Z(p,[1,p.shape[0],p.shape[1],p.shape[2]])),_(g.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${g.rank}.`),_(f.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${f.rank}.`),Gn("fused conv2d",s,i);const b=o==="NHWC"?g.shape[3]:g.shape[1];_(f.shape[2]===b,()=>`Error in conv2d: depth of input (${b}) must match input depth for filter ${f.shape[2]}.`),_(wn(t,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${r}'`);const v=hn(g.shape,f.shape,t,r,s,i);let w;a!=null&&(w=z(a,"bias","fused conv2d"),[w]=Pt(w,p),o==="NHWC"?je(v.outShape,w.shape):(_(w.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`),_(w.shape.length===0||w.shape[0]===v.outChannels||w.shape[0]===1,()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let C;if(d!=null){const R=d.shape;if(_(R.length<=1||R.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${R.length}.`),R.length===1)_(R[0]===1||R[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${R}) is not compatible with the number of output channels (${v.outChannels}).`);else if(R.length===3)try{je(R,v.outShape)}catch{const O=`Error in fused conv2d: PReLU activation weights (${R}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(O)}C=z(d,"prelu weights","fused conv2d")}const $=(R,F)=>{_(o==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${o} but only NHWC is currently supported.`);const[O,D,A,T]=F,B=d0(R,A,u);_(ki(r),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const U=qx(D.shape,B,O,t,s),Q=c0(D,B,O.shape,t,s),K=[U,Q];if(T!=null){const J=h0(T,B);K.push(J)}return K},S={x:g,filter:f,bias:w,preluActivationWeights:C},N={strides:t,pad:s,dataFormat:o,dilations:r,dimRoundingMode:i,activation:u,leakyreluAlpha:h};return a==null?Da((F,O,D)=>{let A=q.runKernel(bh,S,N);return D([O,F,A]),y&&(A=Z(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:$}})(g,f):Da((F,O,D,A)=>{let T=q.runKernel(bh,S,N);return A([O,F,T,D]),y&&(T=Z(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:$}})(g,f,w)}const f3=ee({fusedConv2d_:p3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m3(n,e,t,s,o,r=[1,1],i){let a=n;n.rank===3&&(a=Z(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let u=e;u.rank===3&&(u=Z(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const d={x:a,dy:u},h={strides:s,pad:o,dimRoundingMode:i,dilations:r,filterShape:t};return q.runKernel(gx,d,h)}const g3=ee({depthwiseConv2dNativeBackpropFilter_:m3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y3(n,e,t,s,o,r=[1,1],i){let a=e,u=!1;e.rank===3&&(u=!0,a=Z(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const d={dy:a,filter:t},h={strides:s,pad:o,dimRoundingMode:i,dilations:r,inputShape:n},p=q.runKernel(yx,d,h);return u?Z(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const x3=ee({depthwiseConv2dNativeBackpropInput_:y3});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3({a:n,b:e,transposeA:t=!1,transposeB:s=!1,bias:o,activation:r="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(f0(q.state.gradientDepth,r)===!1){let T=ct(n,e,t,s);return o!=null&&(T=xe(T,o)),p0(T,r,i,a)}let u=z(n,"a","fused matMul"),d=z(e,"b","fused matMul");[u,d]=Pt(u,d);const h=t?u.shape[u.rank-2]:u.shape[u.rank-1],p=s?d.shape[d.rank-1]:d.shape[d.rank-2],f=t?u.shape[u.rank-1]:u.shape[u.rank-2],g=s?d.shape[d.rank-2]:d.shape[d.rank-1],y=u.shape.slice(0,-2),b=d.shape.slice(0,-2),v=de(y),w=de(b);_(h===p,()=>`Error in fused matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${u.shape} and ${d.shape} and transposeA=${t} and transposeB=${s} must match.`);const $=je(u.shape.slice(0,-2),d.shape.slice(0,-2)).concat([f,g]),S=t?Z(u,[v,h,f]):Z(u,[v,f,h]),N=s?Z(d,[w,g,p]):Z(d,[w,p,g]);let R;o!=null&&(R=z(o,"bias","fused matMul"),[R]=Pt(R,u),je($,R.shape));let F;i!=null&&(F=z(i,"prelu weights","fused matMul"));const O=(T,B)=>{const[U,Q,K,J]=B,te=d0(Z(T,K.shape),K,r);let P,X;if(!t&&!s?(P=ct(te,Q,!1,!0),X=ct(U,te,!0,!1)):!t&&s?(P=ct(te,Q,!1,!1),X=ct(te,U,!0,!1)):t&&!s?(P=ct(Q,te,!1,!0),X=ct(U,te,!1,!1)):(P=ct(Q,te,!0,!0),X=ct(te,U,!0,!0)),o!=null){const Y=h0(J,te);return[P,X,Y]}else return[P,X]},D={a:S,b:N,bias:R,preluActivationWeights:F},A={transposeA:t,transposeB:s,activation:r,leakyreluAlpha:a};return o==null?Da((B,U,Q)=>{const K=q.runKernel(xh,D,A);return Q([B,U,K]),{value:Z(K,$),gradFunc:O}})(S,N):Da((B,U,Q,K)=>{const J=q.runKernel(xh,D,A);return K([B,U,J,Q]),{value:Z(J,$),gradFunc:O}})(S,N,R)}const dk=ee({fusedMatMul_:b3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3(n,e,t,s,o="bilinear",r=0){const i=z(n,"image","cropAndResize"),a=z(e,"boxes","cropAndResize","float32"),u=z(t,"boxInd","cropAndResize","int32"),d=a.shape[0];_(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),_(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${d},4] but had shape ${a.shape}.`),_(u.rank===1&&u.shape[0]===d,()=>`Error in cropAndResize: boxInd must be have size [${d}] but had shape ${a.shape}.`),_(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),_(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),_(o==="bilinear"||o==="nearest",()=>`method must be bilinear or nearest, but was ${o}`);const h={image:i,boxes:a,boxInd:u},p={method:o,extrapolationValue:r,cropSize:s};return q.runKernel(px,h,p)}const w3=ee({cropAndResize_:v3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k3(n){const e=z(n,"image","flipLeftRight","float32");_(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return q.runKernel(kx,t,{})}const C3=ee({flipLeftRight_:k3});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I3(n){const e=z(n,"image","grayscaleToRGB"),t=e.rank-1,s=e.shape[t];_(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),_(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const o=new Array(e.rank);return o.fill(1,0,t),o[t]=3,qs(e,o)}const S3=ee({grayscaleToRGB_:I3});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3(n){const e=z(n,"image","RGBToGrayscale"),t=e.rank-1,s=e.shape[t];_(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),_(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const o=e.dtype,r=$e(e,"float32"),i=es([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Vl("ij,j->i",r,i);break;case 3:a=Vl("ijk,k->ij",r,i);break;case 4:a=Vl("ijkl,l->ijk",r,i);break;case 5:a=Vl("ijklm,m->ijkl",r,i);break;case 6:a=Vl("ijklmn,n->ijklm",r,i);break;default:throw new Error("Not a valid tensor rank.")}return a=zn(a,-1),$e(a,o)}const N3=ee({rgbToGrayscale_:$3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T3(n,e,t=0,s=.5){const o=z(n,"image","rotateWithOffset","float32");_(o.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${o.rank}.`);const r={image:o},i={radians:e,fillValue:t,center:s};return q.runKernel(Wx,r,i)}const E3=ee({rotateWithOffset_:T3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ha(n,e,t,s,o,r){s==null&&(s=.5),o==null&&(o=Number.NEGATIVE_INFINITY),r==null&&(r=0);const i=n.shape[0];return t=Math.min(t,i),_(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),_(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),_(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),_(e.rank===1,()=>"scores must be a 1D tensor"),_(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),_(0<=r&&r<=1,()=>`softNmsSigma must be in [0, 1], but was '${r}'`),{maxOutputSize:t,iouThreshold:s,scoreThreshold:o,softNmsSigma:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R3(n,e,t,s=.5,o=Number.NEGATIVE_INFINITY){const r=z(n,"boxes","nonMaxSuppression","float32"),i=z(e,"scores","nonMaxSuppression","float32"),a=Ha(r,i,t,s,o);t=a.maxOutputSize,s=a.iouThreshold,o=a.scoreThreshold;const u={maxOutputSize:t,iouThreshold:s,scoreThreshold:o};return q.runKernel(Tx,{boxes:r,scores:i},u)}const A3=ee({nonMaxSuppression_:R3});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D3(n,e,t){const s=F3(n,e,t),o=s<0?-(s+1):s;n.splice(o,0,e)}function F3(n,e,t){return O3(n,e,t||_3)}function _3(n,e){return n>e?1:n<e?-1:0}function O3(n,e,t){let s=0,o=n.length,r=0,i=!1;for(;s<o;){r=s+(o-s>>>1);const a=t(e,n[r]);a>0?s=r+1:(o=r,i=!a)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m0(n,e,t,s,o){return x0(n,e,t,s,o,0)}function g0(n,e,t,s,o,r){return x0(n,e,t,s,o,0,!1,r,!0)}function y0(n,e,t,s,o,r){return x0(n,e,t,s,o,r,!0)}function x0(n,e,t,s,o,r,i=!1,a=!1,u=!1){const d=[];for(let v=0;v<e.length;v++)e[v]>o&&d.push({score:e[v],boxIndex:v,suppressBeginIndex:0});d.sort(hk);const h=r>0?-.5/r:0,p=[],f=[];for(;p.length<t&&d.length>0;){const v=d.pop(),{score:w,boxIndex:C,suppressBeginIndex:$}=v;if(w<o)break;let S=!1;for(let N=p.length-1;N>=$;--N){const R=L3(n,C,p[N]);if(R>=s){S=!0;break}if(v.score=v.score*M3(s,h,R),v.score<=o)break}v.suppressBeginIndex=p.length,S||(v.score===w?(p.push(C),f.push(v.score)):v.score>o&&D3(d,v,hk))}const g=p.length,y=t-g;a&&y>0&&(p.push(...new Array(y).fill(0)),f.push(...new Array(y).fill(0)));const b={selectedIndices:p};return i&&(b.selectedScores=f),u&&(b.validOutputs=g),b}function L3(n,e,t){const s=n.subarray(e*4,e*4+4),o=n.subarray(t*4,t*4+4),r=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),u=Math.max(s[1],s[3]),d=Math.min(o[0],o[2]),h=Math.min(o[1],o[3]),p=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),g=(a-r)*(u-i),y=(p-d)*(f-h);if(g<=0||y<=0)return 0;const b=Math.max(r,d),v=Math.max(i,h),w=Math.min(a,p),C=Math.min(u,f),$=Math.max(w-b,0)*Math.max(C-v,0);return $/(g+y-$)}function M3(n,e,t){const s=Math.exp(e*t*t);return t<=n?s:0}function hk(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function P3(n,e,t,s=.5,o=Number.NEGATIVE_INFINITY){const r=z(n,"boxes","nonMaxSuppressionAsync"),i=z(e,"scores","nonMaxSuppressionAsync"),a=Ha(r,i,t,s,o);t=a.maxOutputSize,s=a.iouThreshold,o=a.scoreThreshold;const u=await Promise.all([r.data(),i.data()]),d=u[0],h=u[1],{selectedIndices:p}=m0(d,h,t,s,o);return r!==n&&r.dispose(),i!==e&&i.dispose(),es(p,"int32")}const z3=P3;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3(n,e,t,s=.5,o=Number.NEGATIVE_INFINITY,r=0){const i=z(n,"boxes","nonMaxSuppression"),a=z(e,"scores","nonMaxSuppression"),u=Ha(i,a,t,s,o,r);t=u.maxOutputSize,s=u.iouThreshold,o=u.scoreThreshold,r=u.softNmsSigma;const d={boxes:i,scores:a},h={maxOutputSize:t,iouThreshold:s,scoreThreshold:o,softNmsSigma:r},p=q.runKernel(Rx,d,h);return{selectedIndices:p[0],selectedScores:p[1]}}const W3=ee({nonMaxSuppressionWithScore_:B3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function V3(n,e,t,s=.5,o=Number.NEGATIVE_INFINITY,r=0){const i=z(n,"boxes","nonMaxSuppressionAsync"),a=z(e,"scores","nonMaxSuppressionAsync"),u=Ha(i,a,t,s,o,r);t=u.maxOutputSize,s=u.iouThreshold,o=u.scoreThreshold,r=u.softNmsSigma;const d=await Promise.all([i.data(),a.data()]),h=d[0],p=d[1],{selectedIndices:f,selectedScores:g}=y0(h,p,t,s,o,r);return i!==n&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:es(f,"int32"),selectedScores:es(g)}}const U3=V3;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G3(n,e,t,s=.5,o=Number.NEGATIVE_INFINITY,r=!1){const i=z(n,"boxes","nonMaxSuppression"),a=z(e,"scores","nonMaxSuppression"),u=Ha(i,a,t,s,o,null),d=u.maxOutputSize,h=u.iouThreshold,p=u.scoreThreshold,f={boxes:i,scores:a},g={maxOutputSize:d,iouThreshold:h,scoreThreshold:p,padToMaxOutputSize:r},y=q.runKernel(Ex,f,g);return{selectedIndices:y[0],validOutputs:y[1]}}const j3=ee({nonMaxSuppressionPadded_:G3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function H3(n,e,t,s=.5,o=Number.NEGATIVE_INFINITY,r=!1){const i=z(n,"boxes","nonMaxSuppressionAsync"),a=z(e,"scores","nonMaxSuppressionAsync"),u=Ha(i,a,t,s,o,null),d=u.maxOutputSize,h=u.iouThreshold,p=u.scoreThreshold,[f,g]=await Promise.all([i.data(),a.data()]),{selectedIndices:y,validOutputs:b}=g0(f,g,d,h,p,r);return i!==n&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:es(y,"int32"),validOutputs:dt(b,"int32")}}const q3=H3;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3(n,e,t=!1,s=!1){const o=z(n,"images","resizeBilinear");_(o.rank===3||o.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${o.rank}.`),_(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),_(s===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let r=o,i=!1;o.rank===3&&(i=!0,r=Z(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const a={images:r},u={alignCorners:t,halfPixelCenters:s,size:e},d=q.runKernel(Lp,a,u);return i?Z(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const WS=ee({resizeBilinear_:K3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X3(n,e,t=!1,s=!1){const o=z(n,"images","resizeNearestNeighbor");_(o.rank===3||o.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${o.rank}.`),_(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),_(o.dtype==="float32"||o.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),_(s===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let r=o,i=!1;o.rank===3&&(i=!0,r=Z(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const a={images:r},u={alignCorners:t,halfPixelCenters:s,size:e},d=q.runKernel(Op,a,u);return i?Z(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const VS=ee({resizeNearestNeighbor_:X3});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y3(n,e="binary",t=!1,s=.5){const o=z(n,"image","threshold"),r=.2989,i=.587,a=.114,u=o.shape[0]*o.shape[1];let d=j(es([s]),255),h,p,f,g;if(_(o.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${o.rank}.`),_(o.shape[2]===3||o.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${o.shape[2]}.`),_(o.dtype==="int32"||o.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${o.dtype}.`),_(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),o.shape[2]===3){[h,p,f]=hs(o,[1,1,1],-1);const v=j(h,r),w=j(p,i),C=j(f,a);g=xe(xe(v,w),C)}else g=n;if(e==="otsu"){const v=qO($e(ES(g),"int32"),nS([]),256);d=Q3(v,u)}const y=t?ja(g,d):fs(g,d);return $e(j(y,255),"int32")}function Q3(n,e){let t=es([-1]),s=es([0]),o=es([0]),r,i,a,u,d,h;for(let p=0;p<n.size-1;p++){r=wt(n,0,p+1),i=wt(n,p+1),d=Me(Le(r),e),h=Me(Le(i),e);const f=Le(j(r,ru(0,r.size)));a=Me(f,Le(r));const g=Jp(i.shape,r.size),y=xe(ru(0,i.size),g),b=j(i,y);u=Me(Le(b),Le(i));const v=We(a,u),w=We(a,u),C=j(d,h);o=j(j(C,v),w);const $=fs(o,s);s=Dn($,o,s),t=Dn($,es([p]),t)}return t}const J3=ee({threshold_:Y3});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z3(n,e,t="nearest",s="constant",o=0,r){const i=z(n,"image","transform","float32"),a=z(e,"transforms","transform","float32");_(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),_(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),_(r==null||r.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${r}.`);const u={image:i,transforms:a},d={interpolation:t,fillMode:s,fillValue:o,outputShape:r};return q.runKernel(zx,u,d)}const ez=ee({transform_:Z3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(n,e,t){const s=z(n,"a","bandPart");_(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const o=s.shape,[r,i]=s.shape.slice(-2);let a,u;typeof e=="number"?(_(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),_(e<=r,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${r}).`),a=z(e<0?r:e,"numLower","bandPart")):(_(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Dn(Ch(e,0),r,ou(e,r))),typeof t=="number"?(_(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),_(t<=i,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${i}).`),u=z(t<0?i:t,"numUpper","bandPart")):(_(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=Dn(Ch(t,0),i,ou(t,i)));const d=Z(ru(0,r,1,"int32"),[-1,1]),h=ru(0,i,1,"int32"),p=We(d,h),f=Uo(ja(p,a),Fi(p,Mt(u))),g=sn([r,i],s.dtype);return Z(Go(Ni(Z(s,[-1,r,i])).map(y=>Dn(f,y,g))),o)}const nz=ee({bandPart_:tz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sz(n){let e;if(Array.isArray(n)){e=!1,_(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const o=n[0].shape[0];for(let r=1;r<n.length;++r)_(n[r].shape[0]===o,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[r].shape[0]} vs. ${o})`)}else e=!0,n=hs(n,n.shape[0],0).map(o=>fc(o,[0]));_(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],s=n;for(let o=0;o<n.length;++o)t.push(q.tidy(()=>{let r=s[o];if(o>0)for(let i=0;i<o;++i){const a=j(Le(j(t[i],r)),t[i]);r=We(r,a)}return Me(r,ef(r,"euclidean"))}));return e?Go(t,0):t}const oz=ee({gramSchmidt_:sz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(n,e=!1){if(_(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return pk(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((u,d)=>u*d),s=Ni(Z(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),o=[],r=[];s.forEach(u=>{const[d,h]=pk(u,e);o.push(d),r.push(h)});const i=Z(Go(o,0),n.shape),a=Z(Go(r,0),n.shape);return[i,a]}}function pk(n,e=!1){return q.tidy(()=>{_(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],s=n.shape[1];let o=wS(t),r=mi(n);const i=Sa([[1]],[1,1]);let a=mi(i);const u=t>=s?s:t;for(let d=0;d<u;++d){const h=r,p=a,f=o;[a,r,o]=q.tidy(()=>{const g=wt(r,[d,d],[t-d,1]),y=ef(g),b=wt(r,[d,d],[1,1]),v=Dn(fs(b,0),Sa([[-1]]),Sa([[1]])),w=We(b,j(v,y)),C=Me(g,w);C.shape[0]===1?a=mi(i):a=Wn([i,wt(C,[1,0],[C.shape[0]-1,C.shape[1]])],0);const $=Mt(Me(ct(v,w),y)),S=wt(r,[d,0],[t-d,s]),N=j($,a),R=nt(a);if(d===0)r=We(S,ct(N,ct(R,S)));else{const D=We(S,ct(N,ct(R,S)));r=Wn([wt(r,[0,0],[d,s]),D],0)}const F=nt(N),O=wt(o,[0,d],[t,o.shape[1]-d]);if(d===0)o=We(O,ct(ct(O,a),F));else{const D=We(O,ct(ct(O,a),F));o=Wn([wt(o,[0,0],[t,d]),D],1)}return[a,r,o]}),Ye([h,p,f])}return!e&&t>s&&(o=wt(o,[0,0],[t,s]),r=wt(r,[0,0],[s,s])),[o,r]})}const iz=ee({qr_:rz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zo={flipLeftRight:C3,grayscaleToRGB:S3,resizeNearestNeighbor:VS,resizeBilinear:WS,rgbToGrayscale:N3,rotateWithOffset:E3,cropAndResize:w3,nonMaxSuppression:A3,nonMaxSuppressionAsync:z3,nonMaxSuppressionWithScore:W3,nonMaxSuppressionWithScoreAsync:U3,nonMaxSuppressionPadded:j3,nonMaxSuppressionPaddedAsync:q3,threshold:J3,transform:ez},az={bandPart:nz,gramSchmidt:oz,qr:iz};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lz=new Map,uz=new Map;class qa{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class Ns{constructor(){this.classNameMap={}}static getMap(){return Ns.instance==null&&(Ns.instance=new Ns),Ns.instance}static register(e){Ns.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function fe(n,e,t){_(n.className!=null,()=>"Class being registered does not have the static className property defined."),_(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),_(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const s=t,o=e+">"+s;return Ns.register(n),lz.set(o,n),uz.set(n,o),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zr extends qa{minimize(e,t=!1,s){const{value:o,grads:r}=this.computeGradients(e,s);if(s!=null){const i=s.map(a=>({name:a.name,tensor:r[a.name]}));this.applyGradients(i)}else this.applyGradients(r);return Ye(r),t?o:(o.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return fM(e,t)}dispose(){this.iterations_!=null&&Ye(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:dt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(zr,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class US extends zr{static get className(){return"Adadelta"}constructor(e,t,s=null){super(),this.learningRate=e,this.rho=t,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=q.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,o)=>{const r=q.registeredVariables[s],i=!1;this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${s}/accum_grad`,variable:se(()=>st(r).variable(i))}),this.accumulatedUpdates[o]==null&&(this.accumulatedUpdates[o]={originalName:`${s}/accum_var`,variable:se(()=>st(r).variable(i))});const a=Array.isArray(e)?e[o].tensor:e[s];if(a==null)return;const u=this.accumulatedGrads[o].variable,d=this.accumulatedUpdates[o].variable;se(()=>{const h=xe(j(u,this.rho),j(It(a),1-this.rho)),p=j(Me(vn(xe(d,this.epsilon)),vn(xe(u,this.epsilon))),a),f=xe(j(d,this.rho),j(It(p),1-this.rho));u.assign(h),d.assign(f);const g=xe(j(p,-this.learningRate),r);r.assign(g)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ye(this.accumulatedGrads.map(e=>e.variable)),Ye(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,t).map(o=>({originalName:o.name,variable:o.tensor.variable(s)})),this.accumulatedUpdates=e.slice(t,t*2).map(o=>({originalName:o.name,variable:o.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GS extends zr{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,o)=>{const r=q.registeredVariables[s];this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${s}/accumulator`,variable:se(()=>Jp(r.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[o].tensor:e[s];if(i==null)return;const a=this.accumulatedGrads[o].variable;se(()=>{const u=xe(a,It(i));a.assign(u);const d=xe(j(Me(i,vn(xe(u,q.backend.epsilon()))),-this.learningRate),r);r.assign(d)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ye(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jS extends zr{static get className(){return"Adam"}constructor(e,t,s,o=null){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=o,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],se(()=>{this.accBeta1=dt(t).variable(),this.accBeta2=dt(s).variable()}),o==null&&(this.epsilon=q.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);se(()=>{const s=We(1,this.accBeta1),o=We(1,this.accBeta2);t.forEach((r,i)=>{const a=q.registeredVariables[r],u=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${r}/m`,variable:se(()=>st(a).variable(u))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${r}/v`,variable:se(()=>st(a).variable(u))});const d=Array.isArray(e)?e[i].tensor:e[r];if(d==null)return;const h=this.accumulatedFirstMoment[i].variable,p=this.accumulatedSecondMoment[i].variable,f=xe(j(h,this.beta1),j(d,1-this.beta1)),g=xe(j(p,this.beta2),j(It(d),1-this.beta2)),y=Me(f,s),b=Me(g,o);h.assign(f),p.assign(g);const v=xe(j(Me(y,xe(vn(b),this.epsilon)),-this.learningRate),a);a.assign(v)}),this.accBeta1.assign(j(this.accBeta1,this.beta1)),this.accBeta2.assign(j(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ye(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Ye(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),se(()=>{this.accBeta1.assign(Si(this.beta1,this.iterations_+1)),this.accBeta2.assign(Si(this.beta2,this.iterations_+1))});const t=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,t).map(o=>({originalName:o.name,variable:o.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(o=>({originalName:o.name,variable:o.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HS extends zr{static get className(){return"Adamax"}constructor(e,t,s,o=null,r=0){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=o,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],se(()=>{this.iteration=dt(0).variable(),this.accBeta1=dt(t).variable()}),o==null&&(this.epsilon=q.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);se(()=>{const s=We(1,this.accBeta1),o=Me(-this.learningRate,xe(j(this.iteration,this.decay),1));t.forEach((r,i)=>{const a=q.registeredVariables[r],u=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${r}/m`,variable:st(a).variable(u)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${r}/v`,variable:st(a).variable(u)});const d=Array.isArray(e)?e[i].tensor:e[r];if(d==null)return;const h=this.accumulatedFirstMoment[i].variable,p=this.accumulatedWeightedInfNorm[i].variable,f=xe(j(h,this.beta1),j(d,1-this.beta1)),g=j(p,this.beta2),y=En(d),b=Mr(g,y);h.assign(f),p.assign(b);const v=xe(j(Me(o,s),Me(f,xe(b,this.epsilon))),a);a.assign(v)}),this.iteration.assign(xe(this.iteration,1)),this.accBeta1.assign(j(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ye(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Ye(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b0 extends zr{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,o)=>{const r=Array.isArray(e)?e[o].tensor:e[s];if(r==null)return;const i=q.registeredVariables[s];se(()=>{const a=xe(j(this.c,r),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=yo(dt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qS extends b0{static get className(){return"Momentum"}constructor(e,t,s=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=s,this.accumulations=[],this.m=dt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,o)=>{const r=q.registeredVariables[s];this.accumulations[o]==null&&(this.accumulations[o]={originalName:`${s}/momentum`,variable:se(()=>st(r).variable(!1))});const i=this.accumulations[o].variable,a=Array.isArray(e)?e[o].tensor:e[s];a!=null&&se(()=>{let u;const d=xe(j(this.m,i),a);this.useNesterov?u=xe(j(this.c,xe(a,j(d,this.m))),r):u=xe(j(this.c,d),r),i.assign(d),r.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ye(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KS extends zr{static get className(){return"RMSProp"}constructor(e,t=.9,s=0,o=null,r=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=s,this.epsilon=o,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,o==null&&(this.epsilon=q.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,o)=>{const r=q.registeredVariables[s],i=!1;this.accumulatedMeanSquares[o]==null&&(this.accumulatedMeanSquares[o]={originalName:`${s}/rms`,variable:se(()=>st(r).variable(i))}),this.accumulatedMoments[o]==null&&(this.accumulatedMoments[o]={originalName:`${s}/momentum`,variable:se(()=>st(r).variable(i))}),this.accumulatedMeanGrads[o]==null&&this.centered&&(this.accumulatedMeanGrads[o]={originalName:`${s}/mg`,variable:se(()=>st(r).variable(i))});const a=Array.isArray(e)?e[o].tensor:e[s];if(a==null)return;const u=this.accumulatedMeanSquares[o].variable,d=this.accumulatedMoments[o].variable;se(()=>{const h=xe(j(u,this.decay),j(It(a),1-this.decay));if(this.centered){const p=this.accumulatedMeanGrads[o].variable,f=xe(j(p,this.decay),j(a,1-this.decay)),g=Me(j(a,this.learningRate),vn(We(h,xe(It(f),this.epsilon)))),y=xe(j(d,this.momentum),g);u.assign(h),p.assign(f),d.assign(y);const b=We(r,y);r.assign(b)}else{const p=xe(j(u,this.decay),j(It(a),1-this.decay)),f=xe(j(d,this.momentum),Me(j(a,this.learningRate),vn(xe(p,this.epsilon))));u.assign(p),d.assign(f);const g=We(r,f);r.assign(g)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ye(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ye(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Ye(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,t).map(o=>({originalName:o.name,variable:o.tensor.variable(s)})),this.accumulatedMoments=e.slice(t,t*2).map(o=>({originalName:o.name,variable:o.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(o=>({originalName:o.name,variable:o.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cz=[US,GS,jS,HS,qS,KS,b0];function dz(){for(const n of cz)fe(n)}function v0(n,e){const t=n.shape.length,s=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${t}`);if(de(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const o=e.shape,r=o[o.length-1];let i=1;for(let p=0;p<o.length-1;++p)i*=o[p];const a=n.shape,u=o.slice();u.pop();let d=1;for(let p=r;p<t;++p)d*=a[p],u.push(a[p]);const h=[...Oe(n.shape).map(p=>p/d),1].slice(0,r);return[u,i,d,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yy=-2,hz=-1;function w0(n,e,t){const s=n.shape.length;_(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),_(s===t.length,()=>`Error in slice${s}D: Length of size ${t} must match the rank of the array (${s}).`);for(let o=0;o<s;++o)_(e[o]+t[o]<=n.shape[o],()=>`Error in slice${s}D: begin[${o}] + size[${o}] (${e[o]+t[o]}) would overflow input.shape[${o}] (${n.shape[o]})`)}function pz(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function k0(n,e,t){const s=[];for(let o=0;o<n.length;o++)s[o]=Math.ceil((e[o]-n[o])/t[o]);return s}function XS(n,e,t,s){const o=[...n];for(let r=o.length;r<s.length;r++)o.push(1);for(let r=0;r<t;r++)r===0?o[e]=1:(o.splice(e,0,1),o.pop());return o}function YS(n,e,t){return t<=n?t:t-(e-1)}function QS(n,e){const t=[];for(let s=0;s<n;s++)t.push(e+s);return t}function fz(n,e,t,s,o,r,i,a,u){const d=n.length;let h=new Array(d),p=new Array(d),f=new Array(d);if(e.length&&t>0){const g=e[0],y=t+1;h=JS(i,g,y,s,n),p=ZS(a,g,y,o,n),f=XS(r,g,y,n)}else for(let g=0;g<d;g++)h[g]=t$(i,s,r,n,g,u),p[g]=n$(a,o,r,n,g,u),f[g]=e$(r,g,u);return{begin:h,end:p,strides:f}}function JS(n,e,t,s,o){const r=[...o],i=QS(t,e);for(let a=0;a<r.length;a++)if(i.indexOf(a)>-1)r[a]=0;else{const u=YS(e,t,a);let d=s[u];n&1<<u&&(d=0),r[a]=d}return r}function ZS(n,e,t,s,o){const r=[...o],i=QS(t,e);for(let a=0;a<r.length;a++)if(i.indexOf(a)>-1)r[a]=Number.MAX_SAFE_INTEGER;else{const u=YS(e,t,a);let d=s[u];n&1<<u&&(d=Number.MAX_SAFE_INTEGER),r[a]=d}for(let a=0;a<r.length;a++){const u=o[a];r[a]<0&&(r[a]+=u),r[a]=xi(0,r[a],o[a])}return r}function e$(n,e,t){let s=n[e];return(t&1<<e||s==null)&&(s=1),s}function t$(n,e,t,s,o,r){let i=e[o];const a=t[o]||1;(n&1<<o||r&1<<o||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const u=s[o];return i<0&&(i+=u),i=xi(0,i,u-1),i}function n$(n,e,t,s,o,r){let i=e[o];const a=t[o]||1;(n&1<<o||r&1<<o||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const u=s[o];return i<0&&(i+=u),a>0?i=xi(0,i,u):i=xi(-1,i,u-1),i}function C0(n,e,t){let s=t.length;for(let o=0;o<t.length;o++)if(t[o]>1){s=o;break}for(let o=s+1;o<t.length;o++)if(e[o]>0||t[o]!==n[o])return!1;return!0}function I0(n,e){let t=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)t+=n[s]*e[s];return t}function nf(n,e,t){let s;const o=n.shape.length;typeof e=="number"?s=[e,...new Array(o-1).fill(0)]:e.length<o?s=e.concat(new Array(o-e.length).fill(0)):s=e.slice(),s.forEach(i=>{_(i!==-1,()=>"slice() does not support negative begin indexing.")});let r;return t==null?r=new Array(o).fill(-1):typeof t=="number"?r=[t,...new Array(o-1).fill(-1)]:t.length<o?r=t.concat(new Array(o-t.length).fill(-1)):r=t,r=r.map((i,a)=>i>=0?i:(_(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),n.shape[a]-s[a])),[s,r]}function S0(n,e,t,s,o,r,i,a,u){let d;if(s==null?(d=new Array(e.length),d.fill(1)):d=s,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const p={dims:d.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:d.slice(),beginMask:o,endMask:r,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:u};for(let $=0;$<p.dims;$++)h&&1<<$&a&&p.numAddAxisAfterEllipsis++,1<<$&i&&(h=!0);h||(p.ellipsisMask|=1<<p.dims,p.dims++);const f={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};mz(p,f);let g=!0,y=!0,b=!0;const v=[],w=[];for(let $=0;$<n.length;++$){if(f.strides[$]===0)throw Error(`strides[${$}] must be non-zero`);const S=!!(f.shrinkAxisMask&1<<$),N=n[$];if(N===-1){v.push(S?1:-1);continue}const R=[f.beginMask&1<<$,f.endMask&1<<$],F=[f.strides[$]>0?0:-1,f.strides[$]>0?N:N-1];if(S&&f.strides[$]<=0)throw Error("only stride 1 allowed on non-range indexing.");b=b&&f.strides[$]===1;const O=!!(f.beginMask&1<<$&&f.endMask&1<<$);if(f.beginValid&&f.endValid){if(S){const B=f.begin[$]<0?N+f.begin[$]:f.begin[$];if(f.begin[$]=B,f.end[$]=f.begin[$]+1,B<0||B>=N)throw Error(`slice index ${f.begin[$]} of dimension ${$} out of bounds.`)}else f.begin[$]=fk(f.begin[$],0,f.strides[$],N,R,F),f.end[$]=fk(f.end[$],1,f.strides[$],N,R,F);const T=f.strides[$]===1&&f.begin[$]===0&&f.end[$]===N;g=g&&T,y=y&&($===0&&f.strides[$]===1||T)}else g=g&&f.strides[$]===1&&O,y=y&&($===0&&f.strides[$]===1||O);let D,A=!1;if(f.beginValid&&f.endValid?(D=f.end[$]-f.begin[$],A=!0):S?(D=1,A=!0):O&&N>=0&&(f.strides[$]<0?D=-N:D=N,A=!0),A){let T;D===0||D<0!=f.strides[$]<0?T=0:T=Math.trunc(D/f.strides[$])+(D%f.strides[$]!==0?1:0),v.push(T)}else v.push(-1)}for(let $=0;$<f.finalShapeGatherIndices.length;++$){const S=f.finalShapeGatherIndices[$];S>=0?w.push(v[S]):S===yy&&w.push(1)}return{finalShapeSparse:w.filter(($,S)=>f.finalShapeGatherIndices[S]!==yy),finalShape:w,isIdentity:g,sliceDim0:y,isSimpleSlice:b,begin:f.begin,end:f.end,strides:f.strides}}function mz(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const o=Math.min(e.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<o;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=s}else if(1<<s&n.newAxisMask)e.finalShapeGatherIndices.push(yy),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[s]),n.end!=null&&(e.end[t]=n.end[s]),e.strides[t]=n.strides[s],n.beginMask&1<<s&&(e.beginMask|=1<<t),n.endMask&1<<s&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(hz),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[t]=s,t++}}function fk(n,e,t,s,o,r){if(o[e])return t>0?r[e]:r[e+1&1];{const i=n<0?s+n:n;return i<r[0]?r[0]:i>r[1]?r[1]:i}}const gz=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:w0,computeFlatOffset:I0,computeOutShape:k0,getNormalizedAxes:fz,isSliceContinous:C0,maskToAxes:pz,parseSliceParams:nf,sliceInfo:S0,startForAxis:t$,startIndicesWithElidedDims:JS,stopForAxis:n$,stopIndicesWithElidedDims:ZS,stridesForAxis:e$,stridesWithElidedDims:XS},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yz{static sgd(e){return new b0(e)}static momentum(e,t,s=!1){return new qS(e,t,s)}static rmsprop(e,t=.9,s=0,o=null,r=!1){return new KS(e,t,s,o,r)}static adam(e=.001,t=.9,s=.999,o=null){return new jS(e,t,s,o)}static adadelta(e=.001,t=.95,s=null){return new US(e,t,s)}static adamax(e=.002,t=.9,s=.999,o=null,r=0){return new HS(e,t,s,o,r)}static adagrad(e,t=.1){return new GS(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ma=yz;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xz=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function s$(){return new Promise(n=>xz(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $0(n,e){const t=n[0].length;n.forEach((o,r)=>{_(o.length===t,()=>`Error in concat${t}D: rank of tensors[${r}] must be the same as the rank of the rest (${t})`)}),_(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const s=n[0];n.forEach((o,r)=>{for(let i=0;i<t;i++)_(i===e||o[i]===s[i],()=>`Error in concat${t}D: Shape of tensors[${r}] (${o}) does not match the shape of the rest (${s}) along the non-concatenated axis ${r}.`)})}function xo(n,e){const t=n[0].slice();for(let s=1;s<n.length;s++)t[e]+=n[s][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Hs;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Hs||(Hs={}));function o$(n,e,t){let s=new Array;if(t==null&&e==null)return s;if(e==null)for(;s.length<n+t.length;)s.push(-1);else s=e.slice();if(t==null)return s;if(n+t.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${s.length}`);for(let o=1;o<t.length;++o){const r=t[o],i=s[s.length-t.length+o],a=s[i];if(r>=0)if(a>=0){if(a!==r)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${o+n}] = ${r} but shape[${o+n}] = ${a}`)}else s[i]=r}return s}function r$(n){const e={FIRST_DIM_SIZE:Hs.FIRST_DIM_SIZE,VALUE_ROWIDS:Hs.VALUE_ROWIDS,ROW_LENGTHS:Hs.ROW_LENGTHS,ROW_SPLITS:Hs.ROW_SPLITS,ROW_LIMITS:Hs.ROW_LIMITS,ROW_STARTS:Hs.ROW_STARTS},t=[];for(const s of n)if(s in e)t.push(e[s]);else break;return t}function i$(n){return n.length===0?0:n[0]===Hs.FIRST_DIM_SIZE?n.length-1:n.length}function a$(n,e){if(n==null||e==null)return;const t=n.length,s=e.length;if(t>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${s})`);for(let o=0;o<Math.min(t,s-1);++o){const r=n[o],i=e[o+1];if(r>=0&&i>=0&&r!==1&&r!==i)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${o-n.length}] = ${r} but ragged tensor input.flatValues.shape[${o-n.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N0=30;function sf(n){return n<=N0?n:ty(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T0(n,e,t){const s=t*(typeof n=="number"?n:n[0]),o=e*(typeof n=="number"?n:n[1]);return[s,o]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gc(n,e,t,s=!0){let o=[];if(s)o=o.concat(e.slice(0)),o.push(n[0]/t),o=o.concat(n.slice(1));else{o=o.concat(n[0]);const r=e.length;for(let i=0;i<r;++i)o=o.concat([n[i+1]/e[i],e[i]]);o=o.concat(n.slice(r+1))}return o}function yc(n,e,t=!0){const s=[];if(t){s.push(e);for(let o=e+1;o<n;++o)o<=2*e?(s.push(o),s.push(o-(e+1))):s.push(o)}else{const o=[],r=[];for(let i=1;i<n;++i)i>=e*2+1||i%2===1?r.push(i):o.push(i);s.push(...o),s.push(0),s.push(...r)}return s}function xc(n,e,t,s=!0){const o=[];s?o.push(n[0]/t):o.push(n[0]*t);for(let r=1;r<n.length;++r)r<=e.length?s?o.push(e[r-1]*n[r]):o.push(n[r]/e[r-1]):o.push(n[r]);return o}function E0(n,e){const t=[0];for(let s=0;s<e;++s)t.push(n[s][0]);return t}function R0(n,e,t){const s=n.slice(0,1);for(let o=0;o<t;++o)s.push(n[o+1]-e[o][0]-e[o][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const of=1.7580993408473768,rf=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A0=.3275911,D0=.254829592,F0=-.284496736,_0=1.421413741,O0=-1.453152027,L0=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jo(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let s=0;s<t.length;s+=2)t[s]=n[s/2],t[s+1]=e[s/2];return t}function l$(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)e[s/2]=n[s],t[s/2]=n[s+1];return{real:e,imag:t}}function u$(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let o=0;o<n.length;o+=4)t[Math.floor(o/4)]=n[o],s[Math.floor(o/4)]=n[o+1];return{real:t,imag:s}}function c$(n){const e=Math.floor(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let o=2;o<n.length;o+=4)t[Math.floor(o/4)]=n[o],s[Math.floor(o/4)]=n[o+1];return{real:t,imag:s}}function M0(n,e){const t=n[e*2],s=n[e*2+1];return{real:t,imag:s}}function d$(n,e,t,s){n[s*2]=e,n[s*2+1]=t}function h$(n,e){const t=new Float32Array(n/2),s=new Float32Array(n/2);for(let o=0;o<Math.ceil(n/2);o++){const r=(e?2:-2)*Math.PI*(o/n);t[o]=Math.cos(r),s[o]=Math.sin(r)}return{real:t,imag:s}}function p$(n,e,t){const s=(t?2:-2)*Math.PI*(n/e),o=Math.cos(s),r=Math.sin(s);return{real:o,imag:r}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _g="->",bz=/->/g,mk=",",gk="...";function P0(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(bz,"").length)/_g.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${_g}").`);const[s,o]=n.split(_g);_(s.indexOf(gk)===-1,()=>`The ellipsis notation ("${gk}") is not supported yet.`);const r=s.split(mk),i=r.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let f=0;f<o.length;++f){const g=o[f];if(!r.some(y=>y.indexOf(g)!==-1))throw new Error(`Output subscripts contain the label ${g} not present in the input subscripts.`);a.indexOf(g)===-1&&a.push(g)}for(let f=0;f<s.length;++f){const g=s[f];a.indexOf(g)===-1&&g!==mk&&a.push(g)}const u=new Array(r.length);for(let f=0;f<i;++f){if(new Set(r[f].split("")).size!==r[f].length)throw new Error(`Found duplicate axes in input component ${r[f]}. Support for duplicate axes in input is not implemented yet.`);u[f]=[];for(let g=0;g<r[f].length;++g)u[f].push(a.indexOf(r[f][g]))}const d=a.length,h=o.length,p=[];for(let f=h;f<d;++f)p.push(f);return{allDims:a,summedDims:p,idDims:u}}function z0(n,e){let t=new Array(n);t.fill(-1);for(let o=0;o<e.length;++o)t[e[o]]=o;const s=[];for(let o=0;o<n;++o)t[o]===-1&&s.push(o);return t=t.filter(o=>o!==-1),{permutationIndices:t,expandDims:s}}function B0(n,e,t){const s=new Array(n);for(let o=0;o<t.length;++o){const r=t[o].shape;for(let i=0;i<e[o].length;++i)s[e[o][i]]===void 0?s[e[o][i]]=r[i]:_(s[e[o][i]]===r[i],()=>`Expected dimension ${s[e[o][i]]} at axis ${i} of input shaped ${JSON.stringify(r)}, but got dimension ${r[i]}`)}}function W0(n,e){const t=n,s=[];let o=0;n.length===0&&t.push(-1),o=n.length+1;for(let i=0;i<o;++i)s.push([]);const r=[];for(let i=0;i<t.length;++i){const a=t[i],u=vz(e,a);for(const d of u)r.indexOf(d)===-1&&(s[i].push(d),r.push(d))}return{path:t,steps:s}}function V0(n){return n.every((e,t)=>e===t)}function vz(n,e){const t=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(e)!==-1||e===-1)&&t.push(s);return t}function U0(n,e,t=0){let s=[];if(typeof e=="number")_(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(n.shape[t]/e);else{const o=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);_(o<=1,()=>"There should be only one negative value in split array.");const r=e.indexOf(-1);if(r!==-1){const i=e.reduce((a,u)=>u>0?a+u:a);e[r]=n.shape[t]-i}_(n.shape[t]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f$(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function m$(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function g$(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y$(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function x$(n,e){return`size ${n} must be non-negative, not ${e}`}function b$(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function v$(n,e){const t=de(n),s=de(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${e}`}function w$(n,e){const t=de(n),s=de(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xy(){return"segment ids must be >= 0"}function k$(){return"segment ids are not increasing"}function C$(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function I$(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S$(n,e){let t=!1,s;for(n<=N0?(s=n,t=!0):s=ty(n,Math.floor(Math.sqrt(n)));!t;)s>e||s===n?t=!0:s=ty(n,s+1);return s}function $$(n,e,t){const s=[],o=n.length;for(let r=0;r<o;r++)r!==e?s.push(n[r]):s.push(t);return s}function G0(n,e,t,s){const o=e.shape.length,r=n.shape.length;if(s!==0&&(s<-o||s>o))throw new Error(`Expect batchDims in the range of [-${o}, ${o}], but got ${s}`);if(s<0&&(s+=o),s>r)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${r}).`);if(t<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${t}).`);for(let p=0;p<s;++p)if(n.shape[p]!==e.shape[p])throw new Error(`x.shape[${p}]: ${n.shape[p]} should be equal to indices.shape[${p}]: ${e.shape[p]}.`);const i=n.shape[t],a=[];let u=1,d=1,h=1;for(let p=0;p<s;++p)a.push(n.shape[p]),u*=n.shape[p];for(let p=s;p<t;p++)a.push(n.shape[p]),d*=n.shape[p];for(let p=s;p<o;p++)a.push(e.shape[p]);for(let p=t+1;p<r;p++)a.push(n.shape[p]),h*=n.shape[p];return{batchSize:u,sliceSize:h,outerSize:d,dimSize:i,outputShape:a}}const wz=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:G0,computeOutShape:$$,segOpComputeOptimalWindowSize:S$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ho(n){try{return n.map(e=>Nr(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function N$(n){return n.map(e=>Ir(e))}const kz=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:D0,ERF_A2:F0,ERF_A3:_0,ERF_A4:O0,ERF_A5:L0,ERF_P:A0,PARALLELIZE_THRESHOLD:N0,get RowPartitionType(){return Hs},SELU_SCALE:rf,SELU_SCALEALPHA:of,applyActivation:p0,assertAndGetBroadcastShape:je,assertAxesAreInnerMostDims:pn,assertParamsConsistent:$0,assignToTypedArray:d$,axesAreInnerMostDims:Yx,calculateShapes:Oi,checkEinsumDimSizes:B0,checkPadOnDimRoundingMode:Gn,combineLocations:bS,combineRaggedTensorToTensorShapes:o$,complexWithEvenIndex:u$,complexWithOddIndex:c$,computeConv2DInfo:hn,computeConv3DInfo:Or,computeDefaultPad:Gx,computeDilation2DInfo:dc,computeOptimalWindowSize:sf,computeOutAndReduceShapes:rn,computeOutShape:xo,computePool2DInfo:Ds,computePool3DInfo:Xo,convertConv2DDataFormat:Yo,decodeEinsumEquation:P0,eitherStridesOrDilationsAreOne:wn,expandShapeToKeepDim:jt,exponent:p$,exponents:h$,fromStringArrayToUint8:N$,fromUint8ToStringArray:Ho,getAxesPermutation:Dt,getBroadcastDims:Aa,getComplexWithIndex:M0,getEinsumComputePath:W0,getEinsumPermutation:z0,getFusedBiasGradient:h0,getFusedDyActivation:d0,getImageCenter:T0,getInnerMostAxes:zt,getPermuted:yc,getRaggedRank:i$,getReductionAxes:Jt,getReshaped:gc,getReshapedPermuted:xc,getRowPartitionTypesHelper:r$,getSliceBeginCoords:E0,getSliceSize:R0,getSparseFillEmptyRowsIndicesDenseShapeMismatch:f$,getSparseFillEmptyRowsNegativeIndexErrorMessage:m$,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:g$,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:b$,getSparseReshapeInputOutputMismatchErrorMessage:w$,getSparseReshapeInputOutputMultipleErrorMessage:v$,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:y$,getSparseReshapeNegativeOutputDimErrorMessage:x$,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:I$,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:xy,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:k$,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:C$,getUndoAxesPermutation:Lr,isIdentityPermutation:V0,log:s_,mergeRealAndImagArrays:jo,prepareAndValidate:v0,prepareSplitSize:U0,segment_util:wz,shouldFuse:f0,slice_util:gz,splitRealAndImagArrays:l$,stridesOrDilationsArePositive:Ci,tupleValuesAreOne:ki,upcastType:ts,validateDefaultValueShape:a$,validateInput:ZP,validateUpdateShape:MS,warn:cs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */dz();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T$={kernelName:qh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,mc($e(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cz={kernelName:gu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=It($e(t,"float32")),o=vn(We(dt(1),s));return Mt(Me(n,o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iz={kernelName:yu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=vn(We(It($e(t,"float32")),1));return Me(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sz={kernelName:Va,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,o=je(t.shape,s.shape);return{a:()=>{let a=n;const u=Jt(t.shape,o);return u.length>0&&(a=Le(a,u)),Z(a,t.shape)},b:()=>{let a=n;const u=Jt(s.shape,o);return u.length>0&&(a=Le(a,u)),Z(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $z={kernelName:tx,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((s,o)=>{t[o]=()=>n.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nz={kernelName:Kh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>st(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tz={kernelName:Xh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>st(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ez={kernelName:xu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Me(n,vn(We(dt(1),It($e(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rz={kernelName:bu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=vn(xe(dt(1),It($e(t,"float32"))));return Me(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Az={kernelName:ku,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,o=je(t.shape,s.shape);return{a:()=>{const a=xe(It(t),It(s));let u=j(n,Me(s,a));const d=Jt(t.shape,o);return d.length>0&&(u=Le(u,d)),Z(u,t.shape)},b:()=>{const a=xe(It(t),It(s));let u=Mt(j(n,Me(t,a)));const d=Jt(s.shape,o);return d.length>0&&(u=Le(u,d)),Z(u,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dz={kernelName:vu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Me(n,xe(It($e(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fz={kernelName:wu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Me(n,We(dt(1),It($e(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _z(n,e,t,s,o,r){const i=z(n,"dy","avgPool3dGrad"),a=z(e,"input","avgPool3dGrad");let u=i,d=a,h=!1;a.rank===4&&(h=!0,u=Z(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),d=Z(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),_(u.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),_(d.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),Gn("avgPool3dGrad",o,r);const p={dy:u,input:d},f={filterSize:t,strides:s,pad:o,dimRoundingMode:r},g=q.runKernel(rx,p,f);return h?Z(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Oz=ee({avgPool3dGrad_:_z});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lz={kernelName:Qh,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:o,strides:r,pad:i,dimRoundingMode:a}=t;return{x:()=>Oz(n,s,o,r,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mz(n,e,t,s,o){const r=z(n,"dy","avgPoolGrad"),i=z(e,"input","avgPoolGrad");_(i.rank===r.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${r.rank})`);let a=i,u=r,d=!1;i.rank===3&&(d=!0,a=Z(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=Z(r,[1,r.shape[0],r.shape[1],r.shape[2]])),_(u.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${u.rank}.`),_(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const h={dy:u,input:a},p={filterSize:t,strides:s,pad:o},f=q.runKernel(ox,h,p);return d?Z(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Pz=ee({avgPoolGrad_:Mz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zz={kernelName:Yh,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:o,strides:r,pad:i}=t;return{x:()=>Pz(n,s,o,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bz={kernelName:Jh,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[s,o]=e,{transposeA:r,transposeB:i}=t;return!r&&!i?{a:()=>ct(n,o,!1,!0),b:()=>ct(s,n,!0,!1)}:!r&&i?{a:()=>ct(n,o,!1,!1),b:()=>ct(n,s,!0,!1)}:r&&!i?{a:()=>ct(o,n,!1,!0),b:()=>ct(s,n,!1,!1)}:{a:()=>ct(o,n,!0,!0),b:()=>ct(n,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wz={kernelName:Zh,gradFunc:(n,e,t)=>{const{blockShape:s,crops:o}=t;return{x:()=>o0(n,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vz={kernelName:ZF,gradFunc:(n,e,t)=>{const s=t,o=s.inputShape,r=s.shape,i=Array.from(r);for(let u=o.length-1;u>=0;u--)if(o[u]===r[u])i[u]=1;else if(o[u]!==1)throw new Error(`broadcastTo(): [${o}] cannot be broadcast to [${r}].`);const a=[];for(let u=0;u<i.length;u++)i[u]>1&&a.push(u);return{x:()=>Le(n,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uz={kernelName:Cu,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gz={kernelName:Iu,gradFunc:n=>({x:()=>st(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jz={kernelName:Su,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{clipValueMin:o,clipValueMax:r}=t;return{x:()=>Dn(Uo(Fi(s,o),ja(s,r)),n,st(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hz={kernelName:ep,inputsToSave:["x"],gradFunc:T$.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qz={kernelName:tp,saveAllInputs:!0,gradFunc:(n,e,t)=>{const s=e.map(u=>u.shape),{axis:o}=t,r=Ke(o,e[0].shape)[0],i=s.map(u=>u[r]);return hs(n,i,r).map(u=>()=>u)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kz={kernelName:np,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,o]=e,{dilations:r,strides:i,pad:a,dataFormat:u}=t;return _(ki(r),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`),{x:()=>qx(s.shape,n,o,i,a,u),filter:()=>c0(s,n,o.shape,i,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xz={kernelName:sp,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[s,o]=e,{strides:r,pad:i,dataFormat:a,dimRoundingMode:u}=t;return{dy:()=>Ii(n,o,r,i,a,1,u),filter:()=>c0(n,s,o.shape,r,i,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yz(n,e,t,s,o){let r=n;n.rank===4&&(r=Z(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let i=e;i.rank===4&&(i=Z(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),_(r.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${r.shape}.`),_(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),_(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),_(r.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${r.shape[4]}) must match input depth in filter (${t[3]}.`),_(i.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${t[4]}).`);const a={x:r,dy:i},u={strides:s,pad:o,filterShape:t};return q.runKernel(cx,a,u)}const Qz=ee({conv3DBackpropFilter_:Yz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jz={kernelName:op,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:o,pad:r}=t;_(ki(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,a]=e;return{x:()=>mS(i.shape,n,a,o,r),filter:()=>Qz(i,n,a.shape,o,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zz={kernelName:$u,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(Mt(FS($e(t,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eB={kernelName:Nu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(_S($e(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tB={kernelName:rp,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:o,exclusive:r,reverse:i}=t;return{x:()=>{const a=Dt([o],s.rank);let u=yS(n,o,r,!i);return a!=null&&(u=nt(u,a)),u}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nB={kernelName:ip,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:o,pad:r,dimRoundingMode:i}=t,a=s??[1,1];_(ki(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[u,d]=e;return _(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`),_(d.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${d.rank}.`),_(u.shape[3]===d.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),_(wn(o,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${o} and dilations '${a}'.`),Gn("depthwiseConv2d",r,i),{x:()=>x3(u.shape,n,d,o,r,a,i),filter:()=>g3(u,n,d.shape,o,r,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sB={kernelName:ap,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,o]=e,r={x:s,filter:o,dy:n},i={x:s,filter:o,dy:n};return{x:()=>q.runKernel(ny,r,t),filter:()=>q.runKernel(sy,i,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oB={kernelName:Eu,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,s={dy:n,y:t};return{x:()=>q.runKernel(bx,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rB={kernelName:Ru,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=j(ko(Mt(It(t))),2/Math.sqrt(Math.PI));return{x:()=>j(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iB={kernelName:Au,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aB={kernelName:up,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>Z(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lB={kernelName:Du,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,ko(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uB={kernelName:Fu,gradFunc:n=>({x:()=>st(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cB={kernelName:_u,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,o=je(t.shape,s.shape);return{a:()=>{const a=Me(n,$e(s,"float32")),u=Jt(t.shape,o);return u.length>0?Z(Le(a,u),t.shape):a},b:()=>{let a=j(n,$e(t,"float32"));const u=Jt(s.shape,o);u.length>0&&(a=Z(Le(a,u),s.shape));const d=It(s);return Mt(Me(a,$e(d,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dB={kernelName:cp,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:s}=t,[o,r,i,a]=e,u=a??dt(1),d=Jt(r.shape,o.shape),h=[];if(r.rank===1){for(let S=0;S<o.shape.length-1;++S)h.push(o.shape[S]);h.push(1)}const p=We(o,r),f=j(n,u),g=RS(xe(i,dt(s))),y=j(j(j(g,g),g),dt(-.5));return{x:()=>r.rank===1?Z(j(j(n,qs(Z(g,[1,1,1,r.shape[0]]),h)),u),o.shape):Z(j(j(n,g),u),o.shape),mean:()=>{let S=j(j(g,dt(-1)),f);return r.rank===1&&(S=Le(S,d)),Z(S,r.shape)},variance:()=>{let S=j(j(y,p),f);return r.rank===1&&(S=Le(S,d)),Z(S,r.shape)},scale:()=>{const S=j(p,g);let N=j(n,S);return r.rank===1&&(N=Le(N,d)),Z(N,r.shape)},offset:()=>{let S=n;return r.rank===1&&(S=Le(S,d)),Z(S,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hB={kernelName:dp,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[s,o]=e,{axis:r,batchDims:i}=t,a=Ke(r,s.shape)[0],u=(d,h,p)=>()=>{const f=d.shape,g=h.size,y=f.slice(0,a),b=y.length,v=f.slice(r,f.length).slice(1),w=v.length,C=yk(0,b),$=yk(b+1,b+1+w),S=xk([y,[g],v]),N=Z(p,S),R=Z(h,[g]),F=xk([[b],C,$]),O=nt(N,F);let D=zS(O,R,d.shape[a]);const A=Lr(F);return D=nt(D,A),D};if(i===1){const d=s.shape[0],h=s.split(d,0);return{x:()=>Go(h.map((g,y)=>u(g,o.slice(y,1),n.slice(y,1))())).reshape(s.shape),indices:()=>o}}else return{x:u(s,o,n),indices:()=>o}}};function yk(n,e){const t=[];for(let s=n;s<e;++s)t.push(s);return t}function xk(n){const e=[];for(let t=0;t<n.length;++t)for(let s=0;s<n[t].length;++s)e.push(n[t][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pB={kernelName:Ou,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>st(t),b:()=>st(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fB={kernelName:Lu,gradFunc:n=>({x:()=>$e(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mB={kernelName:Mu,gradFunc:n=>({x:()=>st(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gB={kernelName:Pu,gradFunc:n=>({x:()=>st(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yB={kernelName:zu,gradFunc:n=>({x:()=>st(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xB={kernelName:pp,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{alpha:o}=t,r=fs(s,0);return{x:()=>Dn(r,n,j(n,o))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bB={kernelName:Wu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Me(n,xe(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vB={kernelName:Bu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Me(n,$e(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wB={kernelName:t_,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{axis:o}=t;return{logits:()=>{const i=ko(s);return We(n,j(Le(n,o,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kB(n,e,t,s=5,o=1,r=1,i=.5){const a={x:n,y:e,dy:t},u={depthRadius:s,bias:o,alpha:r,beta:i};return q.runKernel(Sx,a,u)}const CB=ee({localResponseNormalizationBackprop_:kB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IB={kernelName:bp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,o]=e,{depthRadius:r,bias:i,alpha:a,beta:u}=t;return{x:()=>CB(s,o,n,r,i,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E$(n,e,t,s){return e.rank<t.rank&&(e=Z(e,jt(e.shape,s))),n.rank<t.rank&&(n=Z(n,jt(n.shape,s))),{x:()=>j(n,$e(wo(t,e),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bk={kernelName:vp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{reductionIndices:o}=s,r=e[0],i=e[1],a=Ke(o,r.shape),u=E$(n,i,r,a);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SB={kernelName:Vu,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>j(n,$e(Fi(t,s),"float32")),b:()=>j(n,$e(Ch(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $B(n,e,t,s,o,r,i){const a=z(n,"dy","maxPool3dGrad"),u=z(e,"input","maxPool3dGrad"),d=z(t,"output","maxPool3dGrad");let h=a,p=u,f=d,g=!1;u.rank===4&&(g=!0,h=Z(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),p=Z(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),f=Z(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),_(h.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${h.rank}.`),_(p.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${p.rank}.`),_(f.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${f.rank}.`),Gn("maxPool3dGrad",r,i);const y={dy:h,input:p,output:f},b={filterSize:s,strides:o,pad:r,dimRoundingMode:i},v=q.runKernel(Nx,y,b);return g?Z(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const NB=ee({maxPool3dGrad_:$B});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TB={kernelName:kp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,o]=e,{filterSize:r,strides:i,pad:a,dimRoundingMode:u}=t;return{x:()=>NB(n,s,o,r,i,a,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EB(n,e,t,s,o,r,i){const a=z(n,"dy","maxPoolGrad"),u=z(e,"input","maxPoolGrad"),d=z(t,"output","maxPoolGrad");_(u.rank===a.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${a.rank})`),_(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),_(u.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${u.rank}.`),Gn("maxPoolGrad",r,i);const h={dy:a,input:u,output:d},p={filterSize:s,strides:o,pad:r,dimRoundingMode:i};return q.runKernel($x,h,p)}const RB=ee({maxPoolGrad_:EB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AB={kernelName:wp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,o]=e,{filterSize:r,strides:i,pad:a}=t;return{x:()=>RB(n,s,o,r,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DB={kernelName:Cp,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:o}=t,r=Ke(o,s.shape),a=rn(s.shape,r)[1],u=de(a);return{x:()=>{const h=s.shape.slice();r.forEach(g=>{h[g]=1});const p=Z(n,h);return Me(j(p,Pr(s.shape,"float32")),u)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FB={kernelName:Ip,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{axis:o}=s,[r,i]=e,a=Ke(o,r.shape),u=E$(n,i,r,a);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _B={kernelName:Uu,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>j(n,$e(ja(t,s),"float32")),b:()=>j(n,$e(fs(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OB={kernelName:Sp,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:o}=t,r=o.map(i=>i[0]);return{x:()=>wt(n,r,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LB={kernelName:Gu,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,o=je(t.shape,s.shape);return{a:()=>{const a=Jt(t.shape,o);return a.length>0?Z(Le(n,a),t.shape):n},b:()=>{const a=j(n,Mt(tf(Me(t,s)))),u=Jt(s.shape,o);return u.length>0?Z(Le(a,u),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MB={kernelName:ju,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,o=je(t.shape,s.shape);return{a:()=>{const a=j(n,$e(s,"float32")),u=Jt(t.shape,o);return u.length>0?Z(Le(a,u),t.shape):a},b:()=>{const a=j(n,$e(t,"float32")),u=Jt(s.shape,o);return u.length>0?Z(Le(a,u),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PB={kernelName:$p,gradFunc:n=>({x:()=>Mt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zB={kernelName:Ep,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>sn(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BB={kernelName:Tp,gradFunc:n=>({x:()=>st(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WB={kernelName:Rp,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:s}=t;return Ni(n,s).map(r=>()=>r)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vk={kernelName:Ap,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:o}=t,r=o.map(i=>i[0]);return{x:()=>wt(n,r,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VB={kernelName:Hu,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,s,o]=e,r=t,i=s,a=je(r.shape,i.shape);return{a:()=>{const h=$e(i,"float32");let p=j(n,j(h,Si(r,We(h,dt(1)))));const f=Jt(r.shape,a);return f.length>0&&(p=Le(p,f)),Z(p,r.shape)},b:()=>{const h=fs(r,0),p=Dn(h,Co(r),st(r));let f=j(n,j(o,p));const g=Jt(i.shape,a);return g.length>0&&(f=Le(f,g)),Z(f,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UB={kernelName:Dp,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,s]=e,o=fs(t,0);return{x:()=>Dn(o,n,j(n,s)),alpha:()=>{let r=Dn(o,st(n),j(n,t));const i=Jt(s.shape,n.shape);return i.length>0&&(r=Le(r,i)),Z(r,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GB(n,e,t){const s=n.shape.slice();s[t]=1;const o=Z(e,s),r=my(n,t,!0,!1),i=my(n,t,!0,!0),a=j(r,i);return j(o,a)}function jB(n,e,t){const s=n.shape.length,o=s-t.length,r=Dt(t,s);let i=n;r!=null&&(i=nt(n,r));const a=i.shape.slice(),d=a.splice(s-t.length,t.length).reduce((f,g)=>f*g,1);a.push(d);const h=i.reshape(a);let p=GB(h,e,o);if(p=p.reshape(i.shape),r!=null){const f=Lr(r);p=nt(p,f)}return p}const HB={kernelName:Fp,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:o}=t;let r=[];return o==null?r=s.shape.map((i,a)=>a):typeof o=="number"?r=[o]:r=o,{x:()=>jB(s,n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qB={kernelName:Tu,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,o=je(t.shape,s.shape);return{a:()=>{const a=Me(n,$e(s,"float32")),u=Jt(t.shape,o);return u.length>0?Z(Le(a,u),t.shape):a},b:()=>{let a=j(n,$e(t,"float32"));const u=Jt(s.shape,o);u.length>0&&(a=Z(Le(a,u),s.shape));const d=It(s);return Mt(Me(a,$e(d,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KB={kernelName:qu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Me(n,Mt(It(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XB={kernelName:Xu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=j(ja(t,6),mc(t));return{x:()=>j(n,$e(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YB={kernelName:Ku,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,$e(mc(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QB={kernelName:_p,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Z(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JB={kernelName:Lp,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,o={dy:n,images:s};return{images:()=>q.runKernel(_x,o,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZB={kernelName:Op,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,o={dy:n,images:s};return{images:()=>q.runKernel(Fx,o,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e4={kernelName:Mp,gradFunc:(n,e,t)=>{const{dims:s}=t,o=Ke(s,n.shape);return{x:()=>$i(n,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t4={kernelName:Yu,gradFunc:n=>({x:()=>st(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n4={kernelName:Qu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Mt(Me(n,j(Si(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s4={kernelName:Pp,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>$e(st(t),"float32"),t:()=>j(n,$e(t,n.dtype)),e:()=>j(n,$e(e0(t),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o4={kernelName:Ju,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=fs(t,dt(0)),o=dt(of),r=dt(rf),i=j(n,r),a=j(j(n,o),ko($e(t,"float32")));return Dn(s,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r4={kernelName:nc,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,j(t,We(dt(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i4={kernelName:tc,gradFunc:n=>({x:()=>st(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a4={kernelName:Zu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(Kx($e(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l4={kernelName:ec,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(gS($e(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u4={kernelName:zp,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{begin:o,size:r}=t,i=s.shape,[a,u]=nf(s,o,r),d=[];for(let h=0;h<n.rank;h++)d.push([a[h],i[h]-a[h]-u[h]]);return{x:()=>s0(n,d)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c4={kernelName:Up,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{dim:o}=t,r=!0,i=j(n,s);return{logits:()=>We(i,j(Le(i,[o],r),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d4={kernelName:sc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,Ga(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wk={kernelName:Wp,gradFunc:(n,e,t)=>{const{blockShape:s,paddings:o}=t;return{x:()=>Hx(n,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kk={kernelName:Vp,gradFunc:(n,e,t)=>{const{axis:s}=t;return{x:()=>Wn(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h4={kernelName:oc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Me(n,j(vn($e(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p4={kernelName:Ox,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,j($e(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f4={kernelName:rc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,o=dt(2);return{a:()=>j(n,j(o,We(t,s))),b:()=>j(n,j(o,We(s,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m4={kernelName:cc,gradFunc:n=>({x:()=>st(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g4={kernelName:ic,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,o=je(t.shape,s.shape);return{a:()=>{let a=n;const u=Jt(t.shape,o);return u.length>0&&(a=Le(a,u)),Z(a,t.shape)},b:()=>{let a=n;const u=Jt(s.shape,o);return u.length>0&&(a=Le(a,u)),Z(Mt(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y4={kernelName:Bp,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,o=s.shape.slice(),{axis:r}=t;Ke(r,s.shape).forEach(d=>{o[d]=1});const a=Z(n,o),u=j(a,Pr(s.shape,"float32"));return{x:()=>u}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x4={kernelName:ac,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Me(n,It(Kx(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b4={kernelName:lc,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(We(dt(1),It(t)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v4={kernelName:uc,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{reps:o}=t;return{x:()=>{let i=st(s);if(s.rank===1)for(let a=0;a<o[0];++a)i=xe(i,wt(n,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<o[0];++a)for(let u=0;u<o[1];++u)i=xe(i,wt(n,[a*s.shape[0],u*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<o[0];++a)for(let u=0;u<o[1];++u)for(let d=0;d<o[2];++d)i=xe(i,wt(n,[a*s.shape[0],u*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<o[0];++a)for(let u=0;u<o[1];++u)for(let d=0;d<o[2];++d)for(let h=0;h<o[3];++h)i=xe(i,wt(n,[a*s.shape[0],u*s.shape[1],d*s.shape[2],h*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w4={kernelName:Ca,gradFunc:(n,e,t)=>{const s=t,{perm:o}=s,r=Lr(o);return{x:()=>nt(n,r)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k4={kernelName:Gp,gradFunc:(n,e,t)=>{const s=t,{axis:o}=s;return{value:()=>Go(n,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C4={kernelName:jp,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>I4(n,t)}}};function I4(n,e){const t=Mr(e,st(e)),s=Qx(n,t);let o=Fi(e,dt(0,"int32"));const r=s.rank-o.rank;for(let a=0;a<r;++a)o=zn(o,a+1);o=Uo(o,Pr(s.shape,"bool"));const i=st(s);return Dn(o,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S4={kernelName:Hp,gradFunc:n=>({x:()=>st(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $4=[T$,Cz,Iz,Sz,$z,Nz,Tz,Ez,Rz,Az,Dz,Fz,Lz,zz,Bz,Wz,Vz,Uz,Gz,jz,Hz,qz,Xz,Kz,Jz,Zz,eB,tB,nB,sB,qB,oB,rB,iB,aB,lB,cB,uB,dB,hB,pB,fB,mB,gB,yB,xB,bB,vB,wB,IB,bk,bk,SB,TB,AB,DB,FB,_B,OB,LB,MB,PB,zB,BB,WB,vk,vk,VB,UB,HB,KB,XB,YB,QB,JB,ZB,e4,t4,n4,s4,o4,r4,i4,a4,l4,u4,c4,d4,wk,wk,kk,kk,h4,f4,p4,m4,g4,y4,x4,b4,v4,w4,k4,C4,S4];for(const n of $4)o_(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.abs=function(){return this.throwIfDisposed(),En(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.acos=function(){return this.throwIfDisposed(),iO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.acosh=function(){return this.throwIfDisposed(),lO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.add=function(n){return this.throwIfDisposed(),xe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.all=function(n,e){return this.throwIfDisposed(),hS(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.any=function(n,e){return this.throwIfDisposed(),py(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.argMax=function(n){return this.throwIfDisposed(),tu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.argMin=function(n){return this.throwIfDisposed(),pO(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asScalar=function(){return this.throwIfDisposed(),_(this.size===1,()=>"The array must have only 1 element."),Z(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asType=function(n){return this.throwIfDisposed(),$e(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as1D=function(){return this.throwIfDisposed(),Z(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as2D=function(n,e){return this.throwIfDisposed(),Z(this,[n,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),Z(this,[n,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as4D=function(n,e,t,s){return this.throwIfDisposed(),Z(this,[n,e,t,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as5D=function(n,e,t,s,o){return this.throwIfDisposed(),Z(this,[n,e,t,s,o])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asin=function(){return this.throwIfDisposed(),mO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asinh=function(){return this.throwIfDisposed(),yO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atan=function(){return this.throwIfDisposed(),bO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atan2=function(n){return this.throwIfDisposed(),wO(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atanh=function(){return this.throwIfDisposed(),CO(this)};ce().prototype.avgPool=function(n,e,t,s){return this.throwIfDisposed(),jx(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),Hx(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.batchNorm=function(n,e,t,s,o){return this.throwIfDisposed(),Qp(this,n,e,t,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.broadcastTo=function(n){return this.throwIfDisposed(),Jl(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cast=function(n){return this.throwIfDisposed(),$e(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.ceil=function(){return this.throwIfDisposed(),YO(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),ps(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof qt&&(n=[n]),Wn([this,...n],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv1d=function(n,e,t,s,o,r){return this.throwIfDisposed(),pS(this,n,e,t,s,o,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv2dTranspose=function(n,e,t,s,o){return this.throwIfDisposed(),fS(this,n,e,t,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv2d=function(n,e,t,s,o,r){return this.throwIfDisposed(),Ii(this,n,e,t,s,o,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cos=function(){return this.throwIfDisposed(),Kx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cosh=function(){return this.throwIfDisposed(),gS(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),my(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),yS(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),wL(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.depthwiseConv2d=function(n,e,t,s,o,r){return this.throwIfDisposed(),Xx(this,n,e,t,s,o,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.dilation2d=function(n,e,t,s,o){return this.throwIfDisposed(),IL(this,n,e,t,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.divNoNan=function(n){return this.throwIfDisposed(),EL(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.div=function(n){return this.throwIfDisposed(),Me(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.dot=function(n){return this.throwIfDisposed(),AL(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.elu=function(){return this.throwIfDisposed(),Zp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.equal=function(n){return this.throwIfDisposed(),wo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.erf=function(){return this.throwIfDisposed(),xS(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),UL(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.exp=function(){return this.throwIfDisposed(),ko(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.expandDims=function(n){return this.throwIfDisposed(),zn(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.expm1=function(){return this.throwIfDisposed(),qL(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.fft=function(){return this.throwIfDisposed(),LS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.flatten=function(){return this.throwIfDisposed(),Z(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.floor=function(){return this.throwIfDisposed(),tf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.floorDiv=function(n){return this.throwIfDisposed(),dS(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.gather=function(n,e,t){return this.throwIfDisposed(),Qx(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.greaterEqual=function(n){return this.throwIfDisposed(),Fi(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.greater=function(n){return this.throwIfDisposed(),fs(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.ifft=function(){return this.throwIfDisposed(),gy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.irfft=function(){return this.throwIfDisposed(),BP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isFinite=function(){return this.throwIfDisposed(),nM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isInf=function(){return this.throwIfDisposed(),oM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isNaN=function(){return this.throwIfDisposed(),iM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.leakyRelu=function(n){return this.throwIfDisposed(),Zx(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.lessEqual=function(n){return this.throwIfDisposed(),ja(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.less=function(n){return this.throwIfDisposed(),Ch(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.localResponseNormalization=function(n,e,t,s){return this.throwIfDisposed(),dM(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSigmoid=function(){return this.throwIfDisposed(),xM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSoftmax=function(n){return this.throwIfDisposed(),CS(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),IS(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.log=function(){return this.throwIfDisposed(),Co(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.log1p=function(){return this.throwIfDisposed(),kS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalAnd=function(n){return this.throwIfDisposed(),Uo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalNot=function(){return this.throwIfDisposed(),e0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalOr=function(n){return this.throwIfDisposed(),SS(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalXor=function(n){return this.throwIfDisposed(),$M(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),ct(this,n,e,t)};ce().prototype.maxPool=function(n,e,t,s){return this.throwIfDisposed(),t0(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.max=function(n,e){return this.throwIfDisposed(),Xs(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.maximum=function(n){return this.throwIfDisposed(),Mr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mean=function(n,e){return this.throwIfDisposed(),Gt(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.min=function(n,e){return this.throwIfDisposed(),kh(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.minimum=function(n){return this.throwIfDisposed(),ou(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),_M(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mod=function(n){return this.throwIfDisposed(),LM(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mul=function(n){return this.throwIfDisposed(),j(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.neg=function(){return this.throwIfDisposed(),Mt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.norm=function(n,e,t){return this.throwIfDisposed(),ef(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.notEqual=function(n){return this.throwIfDisposed(),Ih(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),$S(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.onesLike=function(){return this.throwIfDisposed(),As(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.pad=function(n,e){return this.throwIfDisposed(),s0(this,n,e)};ce().prototype.pool=function(n,e,t,s,o,r){return this.throwIfDisposed(),HM(this,n,e,t,s,o,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.pow=function(n){return this.throwIfDisposed(),Si(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.prelu=function(n){return this.throwIfDisposed(),r0(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.prod=function(n,e){return this.throwIfDisposed(),XM(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reciprocal=function(){return this.throwIfDisposed(),vP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.relu=function(){return this.throwIfDisposed(),_i(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.relu6=function(){return this.throwIfDisposed(),TS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reshapeAs=function(n){return this.throwIfDisposed(),Z(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reshape=function(n){return this.throwIfDisposed(),Z(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),WS(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),VS(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reverse=function(n){return this.throwIfDisposed(),$i(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.rfft=function(){return this.throwIfDisposed(),UP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.round=function(){return this.throwIfDisposed(),ES(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.rsqrt=function(){return this.throwIfDisposed(),RS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.selu=function(){return this.throwIfDisposed(),AS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.separableConv2d=function(n,e,t,s,o,r){return this.throwIfDisposed(),DS(this,n,e,t,s,o,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sigmoid=function(){return this.throwIfDisposed(),Ga(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sign=function(){return this.throwIfDisposed(),EP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sin=function(){return this.throwIfDisposed(),FS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sinh=function(){return this.throwIfDisposed(),_S(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.slice=function(n,e){return this.throwIfDisposed(),wt(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.softmax=function(n){return this.throwIfDisposed(),u0(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.softplus=function(){return this.throwIfDisposed(),hc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),o0(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.split=function(n,e){return this.throwIfDisposed(),hs(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sqrt=function(){return this.throwIfDisposed(),vn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.square=function(){return this.throwIfDisposed(),It(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.squaredDifference=function(n){return this.throwIfDisposed(),jP(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.squeeze=function(n){return this.throwIfDisposed(),fc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof qt?[this,n]:[this,...n];return Go(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.step=function(n){return this.throwIfDisposed(),mc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.stridedSlice=function(n,e,t,s,o,r,i,a){return this.throwIfDisposed(),YP(this,n,e,t,s,o,r,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sub=function(n){return this.throwIfDisposed(),We(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sum=function(n,e){return this.throwIfDisposed(),Le(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tan=function(){return this.throwIfDisposed(),JP(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tanh=function(){return this.throwIfDisposed(),Yp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tile=function(n){return this.throwIfDisposed(),qs(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toBool=function(){return this.throwIfDisposed(),$e(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toFloat=function(){return this.throwIfDisposed(),$e(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toInt=function(){return this.throwIfDisposed(),$e(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.topk=function(n,e){return this.throwIfDisposed(),t3(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.transpose=function(n){return this.throwIfDisposed(),nt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unique=function(n){return this.throwIfDisposed(),o3(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),zS(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unstack=function(n){return this.throwIfDisposed(),Ni(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.where=function(n,e){return this.throwIfDisposed(),Dn(n,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.zerosLike=function(){return this.throwIfDisposed(),st(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class co extends Error{constructor(e){super(e),Object.setPrototypeOf(this,co.prototype)}}class Ts extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ts.prototype)}}class G extends Error{constructor(e){super(e),Object.setPrototypeOf(this,G.prototype)}}class He extends Error{constructor(e){super(e),Object.setPrototypeOf(this,He.prototype)}}class j0 extends Error{constructor(e){super(e),Object.setPrototypeOf(this,j0.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class R${constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ti(n,e){if(Array.isArray(n)){let t=[];for(let s=0;s<e;s++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function ho(n,e){if(!n)throw new j0(e)}function Ck(n,e){let t=0;for(const s of n)s===e&&t++;return t}function Bn(n){return n.length===1?n[0]:n}function ft(n){return Array.isArray(n)?n:[n]}function Mo(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function ui(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let Is={};function H0(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function by(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>by(e));else{const e=Object.keys(n);for(const t of e){const s=n[t];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?n[t]=s.value:by(s))}}}function bc(n,e={},t={},s="object",o=!1){if(typeof n=="string"){const r=n;let i;if(r in t)i=t[r];else if(r in Is)i=Is[r];else if(i=e[r],i==null)throw new G(`Unknown ${s}: ${n}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const r=n;if(r.className==null||r.config==null)throw new G(`${s}: Improper config format: ${JSON.stringify(r)}.
'className' and 'config' must set.`);const i=r.className;let a,u;if(i in t?[a,u]=t[i]:i in Is?[a,u]=Is.className:i in e&&([a,u]=e[i]),a==null)throw new G(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(u!=null){const d={};for(const g of Object.keys(Is))d[g]=Is[g];for(const g of Object.keys(t))d[g]=t[g];const h=r.config;h.customObjects=d;const p=Object.assign({},Is);for(const g of Object.keys(t))Is[g]=t[g];by(r.config);const f=u(a,r.config,t,o);return Is=Object.assign({},p),f}else{const d=Object.assign({},Is);for(const p of Object.keys(t))Is[p]=t[p];const h=new a(r.config);return Is=Object.assign({},d),h}}}function N4(n,e){return n<e?-1:n>e?1:0}function jd(n,e){return-1*N4(n,e)}function Sr(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function T4(n){if(n==null)throw new G(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function Li(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new G(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function q0(n,e,t=0,s=1/0){return ho(t>=0),ho(s>=t),Array.isArray(n)&&n.length>=t&&n.length<=s&&n.every(o=>typeof o===e)}function on(n,e){Array.isArray(n)?(_(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,s)=>on(t,`element ${s+1} of ${e}`))):_(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${A$(n)}.`)}function A$(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>A$(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function E4(n,e,t){let s=t!=null?t():Pn(),o;return(...i)=>{const a=t!=null?t():Pn();return a-s<e||(s=a,o=n(...i)),o}}function D$(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let R4=0;function F$(){return R4++}const Hd={};function af(n=""){return n in Hd||(Hd[n]=0),Hd[n]+=1,n+Hd[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const A4=["channelsFirst","channelsLast"],D4=["nearest","bilinear"],F4=["valid","same","causal"],_4=["max","avg"],O4=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ga=new Map;function Bt(n){Li(A4,"DataFormat",n)}function L4(n){Li(D4,"InterpolationFormat",n)}function ms(n){Li(F4,"PaddingMode",n)}function _$(n){Li(_4,"PoolMode",n)}const Zl=[],Ik="/";function gi(n,e){Zl.push(n);try{const t=e();return Zl.pop(),t}catch(t){throw Zl.pop(),t}}function M4(){return Zl.length===0?"":Zl.join(Ik)+Ik}function O$(n){if(!M$(n))throw new Error("Not a valid tensor name: '"+n+"'");return M4()+n}function L$(n){if(!M$(n))throw new Error("Not a valid tensor name: '"+n+"'");ga.has(n)||ga.set(n,0);const e=ga.get(n);if(ga.set(n,ga.get(n)+1),e>0){const t=`${n}_${e}`;return ga.set(t,1),t}else return n}const P4=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function M$(n){return!!n.match(P4)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function z4(n){return n===parseInt(n.toString(),10)}function $r(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let s=1;for(let o=e;o<t;++o)s*=n[o];return s}function Fa(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s<e&&(e=s)}return e}function Tr(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s>e&&(e=s)}return e}function Qs(n,e){if(e<n)throw new G(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let s=n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Og;function Kt(){return Og==null&&(Og=R_().epsilon()),Og}function Js(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bo(n,e){return $e(n,e)}function vc(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),Z(n,t)}function B4(n,e){return se(()=>{if(n.shape.length!==2)throw new G(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=vc(n,1);return vy(t,[1,e,1])})}function W4(n){const e=[$r(n.shape)];return Z(n,e)}function V4(n){if(n.rank<=1)throw new G(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],$r(n.shape,1)];return Z(n,e)}function yi(n,e,t){return se(()=>{switch(n.rank){case 1:return a0(n,e,t);case 2:return OS(n,[e,0],[t,n.shape[1]]);case 3:return l0(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return $h(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return wt(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return wt(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new G(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function Lg(n,e,t){return se(()=>{switch(n.rank){case 1:return a0(n,e,t);case 2:return OS(n,[0,e],[n.shape[0],t]);case 3:return l0(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return $h(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new G(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function qd(n,e,t,s){return se(()=>{switch(n.rank){case 1:return a0(n,e,t);case 2:switch(s){case 1:return yi(n,e,t);case 2:return Lg(n,e,t);default:throw new G(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return yi(n,e,t);case 2:return l0(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return Lg(n,e,t);default:throw new G(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return yi(n,e,t);case 2:return $h(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return $h(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return Lg(n,e,t);default:throw new G(`The axis is not within the rank of the tensor ${s}`)}default:throw new G(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function K0(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),Wn(n,e)}function Sk(n,e){switch(n.rank){case 1:return ZO([n,e]);case 2:return tL([n,e],0);case 3:return sL([n,e],0);case 4:return rL([n,e],0);default:throw new G(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function vy(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new G(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return qs(n,e)}function lf(n,e=0,t=1,s,o){return gP(n,e,t,s,o)}function vo(n,e,t,s){if(n.rank<2||e.rank<2)throw new He(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const o=n.shape.slice(-1)[0],r=e.shape.slice(-2)[0];if(o!==r)throw new He(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return dk({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?wy(n.rank,s,Js()):null,activation:t});{const o=n.shape.slice(),r=o.pop();n=Z(n,[-1,r]);const i=e.shape.slice(),a=i.pop(),u=i.pop(),d=[...i,a],h=Array.from({length:e.rank},(y,b)=>b===0?e.rank-2:b<=e.rank-2?b-1:b);e=Z(nt(e,h),[u,-1]);const p=[...o,...d];return Z(dk({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?wy(n.rank,s,Js()):null,activation:t}),p)}}function P$(n,e,t){return se(()=>(Array.isArray(e)?e=es(e,"int32"):e=$e(e,"int32"),Qx(n,e,t)))}function wc(n){return j(n,n)}function wy(n,e,t){const s=e.shape;if(e.rank!==1&&e.rank!==n)throw new G(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return s.length===1?Z(e,[1,s[0],1,1,1]):Z(e,[1,s[3],s[0],s[1],s[2]]);if(t==="channelsLast")return s.length===1?Z(e,[1,1,1,1,s[0]]):Z(e,[1].concat(s))}else if(n===4){if(t==="channelsFirst")return s.length===1?Z(e,[1,s[0],1,1]):Z(e,[1,s[2],s[0],s[1]]);if(t==="channelsLast")return s.length===1?Z(e,[1,1,1,s[0]]):Z(e,[1].concat(s))}else if(n===3){if(t==="channelsFirst")return s.length===1?Z(e,[1,s[0],1]):Z(e,[1,s[1],s[0]]);if(t==="channelsLast")return s.length===1?Z(e,[1,1,s[0]]):Z(e,[1].concat(s))}else if(n<3)return e;throw new G(`Unsupported input rank by biasAdd: ${e.rank}`)}function eo(n,e,t){return se(()=>(t==null&&(t=Js()),Bt(t),xe(n,wy(n.rank,e,t))))}function U4(n,e=1){if(e!==1)throw new He(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Zp(n)}function G4(n){return se(()=>Me(n,xe(En(n),1)))}function z$(n,e,t,s){return se(()=>d3(n,e,t,s))}function j4(n){return se(()=>{const e=xe(.5,j(.2,n));return ps(e,0,1)})}function kc(n,e,t=!1){return t?n():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const H4=["fanIn","fanOut","fanAvg"],q4=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function K4(n){Li(H4,"FanMode",n)}function X4(n){Li(q4,"Distribution",n)}class Fs extends qa{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class B$ extends Fs{apply(e,t){return sn(e,t)}}B$.className="Zeros";fe(B$);class X0 extends Fs{apply(e,t){return Pr(e,t)}}X0.className="Ones";fe(X0);class W$ extends Fs{constructor(e){if(super(),typeof e!="object")throw new G(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new G(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return se(()=>j(dt(this.value),Pr(e,t)))}getConfig(){return{value:this.value}}}W$.className="Constant";fe(W$);class V$ extends Fs{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return pc(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}V$.className="RandomUniform";fe(V$);class U$ extends Fs{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new He(`randomNormal does not support dType ${t}.`);return lf(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}U$.className="RandomNormal";fe(U$);class G$ extends Fs{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new He(`truncatedNormal does not support dType ${t}.`);return PS(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}G$.className="TruncatedNormal";fe(G$);class j$ extends Fs{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return se(()=>{if(e.length!==2||e[0]!==e[1])throw new G("Identity matrix initializer can only be used for 2D square matrices.");return j(this.gain,wS(e[0]))})}getConfig(){return{gain:this.gain}}}j$.className="Identity";fe(j$);function Y4(n,e="channelsLast"){let t,s;if(Bt(e),n.length===2)t=n[0],s=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const o=$r(n,2);t=n[1]*o,s=n[0]*o}else if(e==="channelsLast"){const o=$r(n,0,n.length-2);t=n[n.length-2]*o,s=n[n.length-1]*o}}else{const o=$r(n);t=Math.sqrt(o),s=Math.sqrt(o)}return[t,s]}class ns extends Fs{constructor(e){if(super(),e.scale<0)throw new G(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,K4(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,X4(this.distribution),this.seed=e.seed}apply(e,t){const s=Y4(e),o=s[0],r=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,o):this.mode==="fanOut"?i/=Math.max(1,r):i/=Math.max(1,(o+r)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new He(`${this.getClassName()} does not support dType ${t}.`);return PS(e,0,a,t,this.seed)}else{const a=Math.sqrt(3*i);return pc(e,-a,a,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}ns.className="VarianceScaling";fe(ns);class Y0 extends ns{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ns.className}}Y0.className="GlorotUniform";fe(Y0);class Q0 extends ns{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ns.className}}Q0.className="GlorotNormal";fe(Q0);class J0 extends ns{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ns.className}}J0.className="HeNormal";fe(J0);class Z0 extends ns{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ns.className}}Z0.className="HeUniform";fe(Z0);class e1 extends ns{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return ns.className}}e1.className="LeCunNormal";fe(e1);class t1 extends ns{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return ns.className}}t1.className="LeCunUniform";fe(t1);class H$ extends Fs{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return se(()=>{if(e.length<2)throw new He("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const s=de(e.slice(0,-1)),o=e[e.length-1],r=s*o;r>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${r}) elements: Slowness may result.`);const i=[Math.max(o,s),Math.min(o,s)],a=lf(i,0,1,t,this.seed),u=az.qr(a,!1);let d=u[0];const p=u[1].flatten().stridedSlice([0],[Math.min(o,s)*Math.min(o,s)],[Math.min(o,s)+1]);return d=j(d,p.sign()),s<o&&(d=d.transpose()),j(dt(this.gain),d.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}H$.className="Orthogonal";fe(H$);const $k={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Nk(n,e={}){return bc(n,Ns.getMap().classNameMap,e,"initializer")}function At(n){return H0(n)}function Nt(n){if(typeof n=="string"){const e=n in $k?$k[n]:n;if(e==="GlorotNormal")return new Q0;if(e==="GlorotUniform")return new Y0;if(e==="HeNormal")return new J0;if(e==="HeUniform")return new Z0;if(e==="LeCunNormal")return new e1;if(e==="LeCunUniform")return new t1;{const t={};return t.className=e,t.config={},Nk(t)}}else return n instanceof Fs?n:Nk(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ky(n){return Array.isArray(n)&&Array.isArray(n[0])}function Nh(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function Ve(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new G(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function rt(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new G(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Th(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((s,o)=>s*o);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Tk="Variable";class Q4{constructor(e,t="float32",s=Tk,o=!0,r=null){this.dtype=t??"float32",this.shape=e.shape,this.id=F$(),s=s??Tk,this.originalName=O$(s),this.name=L$(this.originalName),this.trainable_=o,this.constraint=r,this.val=a3(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),J4(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function J4(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function Cy(n){return n.map(e=>e.read())}function n1(n){n.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Xt{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Io{constructor(e,t,s,o,r,i,a){this.dtype=e,this.shape=t,this.sourceLayer=s,this.inputs=o,this.callArgs=r,this.outputTensorIndex=a,this.id=F$(),i!=null&&(this.originalName=O$(i),this.name=L$(this.originalName)),this.rank=t.length}}let Z4=0;class uf{constructor(e,t){this.callArgs=t,this.id=Z4++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let eW=0;class Xe extends qa{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=eW++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const s=this.getClassName();t=Mo(s)+"_"+af(s)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let r=null;e.batchSize!=null&&(r=e.batchSize),s=[r].concat(e.inputShape)}this.batchInputShape=s;let o=e.dtype;o==null&&(o=e.inputDType),o==null&&(o="float32"),this.dtype=o}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new Ts(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new G(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Bn(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Bn(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new co(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new co(`Layer ${this.name} is not connected, no input to return.`);return Bn(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new co(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new co(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Bn(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=ft(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=ft(this.inputSpec);if(t.length!==s.length)throw new G(`Layer ${this.name} expects ${s.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let o=0;o<t.length;o++){const r=t[o],i=s[o];if(i==null)continue;const a=r.rank;if(i.ndim!=null&&a!==i.ndim)throw new G(`Input ${o} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new G(`Input ${o} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new G(`Input ${o} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&r.dtype!==i.dtype)throw new G(`Input ${o} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${r.dtype}.`);if(i.axes){const u=r.shape;for(const d in i.axes){const h=Number(d),p=i.axes[d],f=h>=0?u[h]:u[u.length+h];if(p!=null&&[p,null].indexOf(f)===-1)throw new G(`Input ${o} is incompatible with layer ${this.name}: expected axis ${h} of input shape to have value ${p} but got shape ${u}.`)}}if(i.shape!=null)for(let u=0;u<i.shape.length;++u){const d=i.shape[u],h=r.shape[u];if(d!=null&&h!=null&&d!==h)throw new G(`Input ${o} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${r.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const s=ft(e),o=sW(e),r=oW(e);if(o===r)throw new G("Arguments to apply() must be all SymbolicTensors or all Tensors");return gi(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of ft(e))i.push(a.shape);this.build(Bn(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&r&&(this._refCount=1)}if(this.assertInputCompatibility(e),r){let i=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,i);const a=ft(i),u=[];for(let d of a)s.indexOf(d)!==-1&&(d=d.clone()),u.push(d);if(i=Bn(u),this.activityRegularizer!=null)throw new He("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=tW(e),a=this.computeOutputShape(i);let u;const d=nW(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?u=a.map((h,p)=>new Io(d,h,this,ft(e),t,this.name,p)):u=new Io(d,a,this,ft(e),t,this.name),this.addInboundNode(e,u,null,null,i,a,t),this._refCount++,this.activityRegularizer!=null)throw new He("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return u}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((s,o)=>{s!=null&&e[o]!=null&&e[o]!==s&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new co(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const s=JSON.stringify(t.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new co(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Ts(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Th(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Cy(e?this.trainableWeights:this.weights)}setWeights(e){se(()=>{const t=this.weights;if(t.length!==e.length)throw new G(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const s=[],o=Cy(t);for(let r=0;r<o.length;++r){const i=o[r],a=t[r],u=e[r];if(!ht(i.shape,u.shape))throw new G(`Layer weight shape ${i.shape} not compatible with provided weight shape ${u.shape}`);s.push([a,u])}n1(s)})}addWeight(e,t,s,o,r,i,a,u){if(this._addedWeightNames.indexOf(e)!==-1)throw new G(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(o=u!=null?u():Nt("zeros"));const d=o.apply(t,s),h=new Q4(d,s,e,i,a);return d.dispose(),r!=null&&this.addLoss(()=>r.apply(h.read())),i==null&&(i=!0),i?this._trainableWeights.push(h):this._nonTrainableWeights.push(h),h}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=ft(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,s){if(!this.supportsMasking)return;const o=this.computeMask(e,s),r=ft(t),i=ft(o);if(r.length!==i.length)throw new Error(`${this.name} outputs ${r.length} tensors but ${r.length} masks for those tensors`);for(let a=0;a<r.length;a++)r[a].kerasMask=i[a]}addInboundNode(e,t,s,o,r,i,a=null){const u=ft(e);t=ft(t),s=ft(s),o=ft(o),r=Nh(r),i=Nh(i);const d=[],h=[],p=[];for(const f of u)d.push(f.sourceLayer),h.push(f.nodeIndex),p.push(f.tensorIndex);new uf({outboundLayer:this,inboundLayers:d,nodeIndices:h,tensorIndices:p,inputTensors:u,outputTensors:t,inputMasks:s,outputMasks:o,inputShapes:r,outputShapes:i},a);for(let f=0;f<t.length;f++)t[f].sourceLayer=this,t[f].nodeIndex=this.inboundNodes.length-1,t[f].tensorIndex=f}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function tW(n){n=ft(n);const e=[];for(const t of n)e.push(t.shape);return Bn(e)}function nW(n){return"float32"}function q$(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const s=e.inboundNodes[t];if(s.inboundLayers.length===0)return s.inputTensors;{const o=[];for(let r=0;r<s.inboundLayers.length;r++){const i=s.inputTensors[r],a=s.inboundLayers[r],u=s.nodeIndices[r],d=q$(i,a,u);for(const h of d)o.indexOf(h)===-1&&o.push(h)}return o}}}function sW(n){let e=!0;for(const t of ft(n))if(!(t instanceof Io)){e=!1;break}return e}function oW(n){let e=!0;for(const t of ft(n))if(t instanceof Io){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Cc extends Xe{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:af("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new G("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new G("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new G("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=t,this.dtype=s,this.inputSpec=[{shape:t}];const o=new Io(this.dtype,this.batchInputShape,this,[],{},this.name);o.nodeIndex=0,o.tensorIndex=0,new uf({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new G(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Cc.className="InputLayer";fe(Cc);function rW(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new G("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new Cc({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function iW(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return $e(e,n.dtype)}catch{throw new G(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class wr{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof wr)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=iW(e,t),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new G(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Io){if(this.id2Value[e.id]==null)throw new G(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new G(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof Io){if(this.id2Value[e.id]==null)throw new G(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new G(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&Ye(this.id2Mask)}}const Eh=new R$,Rh=new R$;function aW(n){Eh!=null&&Eh.setMaxEntries(n),Rh!=null&&Rh.setMaxEntries(n)}function Kl(n,e,t,s){const o=t==null?!1:t.training,r=Array.isArray(n),i=r?n:[n],a=i.map(y=>y.name),u=[],d=e.names();for(const y of a)d.indexOf(y)!==-1?u.push(e.getValue(y)):u.push(null);const h=a.join(",")+"|"+e.names().sort().join(",");let p=Eh.get(h),f;if(p==null){const y=lW(i,e);p=y.sorted,f=y.recipientCounts,Eh.put(h,p),Rh.put(h,f)}f={},o||Object.assign(f,Rh.get(h));const g=new wr(e);for(let y=0;y<p.length;++y){const b=p[y],v=b.sourceLayer;if(v instanceof Cc)continue;const w=[],C=[],$=[];let S=!1;for(const D of b.inputs){const A=g.getValue(D),T=g.getMask(D);w.push(A),C.push(T),T!=null&&(S=!0),o||(f[D.name]--,f[D.name]===0&&!e.hasKey(D)&&a.indexOf(D.name)===-1&&!A.isDisposed&&D.sourceLayer.stateful!==!0&&$.push(A))}S&&(t=t||{},t.mask=C[0]);const N=ft(v.apply(w,t));let R=null;v.supportsMasking&&(R=v.computeMask(w,C));const F=cW(b),O=Array.isArray(F)?F:[F];for(let D=0;D<O.length;++D){g.hasKey(O[D])||g.add(O[D],N[D],Array.isArray(R)?R[0]:R);const A=a.indexOf(O[D].name);A!==-1&&(u[A]=N[D])}o||Ye($)}return g.disposeMasks(),r?u:u[0]}function lW(n,e){_(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],s={};if(n.length===1){const o=Ek(n[0],e);t=o.sorted,s=o.recipientMap}else{const o=new Set;for(const r of n){const{sorted:i,recipientMap:a}=Ek(r,e);for(const u of i)o.has(u.name)||(t.push(u),o.add(u.name));for(const u in a)s[u]==null&&(s[u]=new Set),a[u].forEach(d=>s[u].add(d))}}return{sorted:t,recipientCounts:uW(s)}}function uW(n){const e={};for(const t in n)e[t]=n[t].size;return e}function Ek(n,e){const t=new Set,s=[],o={};for(const a of e.names())t.add(a);const r=[],i=[];for(r.push(n);r.length>0;){const a=r[r.length-1];if(t.has(a.name)){r.pop();continue}const u=i[i.length-1]===r.length-1;if(a.inputs.length===0||u)r.pop(),s.push(a),t.add(a.name),u&&i.pop();else{i.push(r.length-1);for(const d of a.inputs)o[d.name]==null&&(o[d.name]=new Set),o[d.name].add(a.name),!t.has(d.name)&&r.push(d)}}return{sorted:s,recipientMap:o}}function cW(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let s=0;s<n.sourceLayer.inboundNodes.length;++s)for(const o of n.sourceLayer.inboundNodes[s].outputTensors)if(o.id===n.id){t=s;break}e=n.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dW=ae();dW.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,aW);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function s1(n,e){return se(()=>vn(Le(j(n,n),e,!0)))}class Ic extends qa{getConfig(){return{}}}class K$ extends Ic{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return se(()=>{const t=s1(e,this.axis),s=ps(t,0,this.maxValue);return j(e,Me(s,xe(Kt(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}K$.className="MaxNorm";fe(K$);class X$ extends Ic{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return se(()=>Me(e,xe(Kt(),s1(e,this.axis))))}getConfig(){return{axis:this.axis}}}X$.className="UnitNorm";fe(X$);class Y$ extends Ic{apply(e){return _i(e)}}Y$.className="NonNeg";fe(Y$);class Q$ extends Ic{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return se(()=>{const t=s1(e,this.axis),s=xe(j(this.rate,ps(t,this.minValue,this.maxValue)),j(1-this.rate,t));return j(e,Me(s,xe(Kt(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Q$.className="MinMaxNorm";fe(Q$);const Rk={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Yt(n){return H0(n)}function Ak(n,e={}){return bc(n,Ns.getMap().classNameMap,e,"constraint")}function Qt(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in Rk?Rk[n]:n,config:{}};return Ak(t)}else return n instanceof Ic?n:Ak(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function si(n){if(n==null)return;const e=[],t=[],s=[];for(const o in n){const r=n[o];if(typeof r!="number"){const i=r;e.push(i.data()),t.push(o),s.push(i)}}if(e.length>0){const o=await Promise.all(e);for(let r=0;r<o.length;++r)n[t[r]]=o[r][0];Ye(s)}}function J$(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Dk;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(Dk||(Dk={}));const hW=125;class iu{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class pW{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class fW extends iu{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const s=t.size==null?0:t.size;this.seen+=s;for(const o in t){const r=t[o];if(typeof r=="number")this.totals.hasOwnProperty(o)||(this.totals[o]=0),this.totals[o]=this.totals[o]+r*s;else{let i;o in this.totals?i=this.totals[o]:this.totals[o]=0;const a=se(()=>xe(this.totals[o],j(r,s)));this.totals[o]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?t[s]=this.totals[s]/this.seen:se(()=>{const o=j(Me(1,this.seen),this.totals[s]);t[s]=o,this.totals[s].dispose(),yo(t[s])}))}}class mW extends iu{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const s in t)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(t[s])}async syncData(){const e=[],t=[],s=[];for(const r in this.history){const i=this.history[r];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const u=i[a];e.push(u.data()),t.push(r),s.push(a)}}const o=await Promise.all(e);for(let r=0;r<o.length;++r)this.history[t[r]][s[r]].dispose(),this.history[t[r]][s[r]]=o[r][0]}}class gW extends iu{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||s$,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=hW),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Zg(this.yieldEvery)&&(this.maybeWait=E4(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,s){const o=[];this.yield!=null&&(await si(s),o.push(this.yield(e,t,s))),o.push(this.nextFrameFunc()),await Promise.all(o)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await si(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const s=[];this.epochEnd!=null&&(await si(t),s.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,t){this.batchBegin!=null&&(await si(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const s=[];this.batchEnd!=null&&(await si(t),s.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Zg(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await si(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await si(e),await this.trainEnd(e))}}function Z$(n,e){return n==null&&(n={}),n instanceof iu?[n]:Array.isArray(n)&&n[0]instanceof iu?n:ft(n).map(s=>new gW(s,e))}class $s{constructor(){}static registerCallbackConstructor(e,t){_(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),$s.checkForDuplicate(t),$s.constructors[e]==null&&($s.constructors[e]=[]),$s.constructors[e].push(t)}static checkForDuplicate(e){for(const t in $s.constructors)$s.constructors[+t].forEach(o=>{if(o===e)throw new G("Duplicate callback constructor.")})}static clear(){$s.constructors={}}static createCallbacks(e){const t=[];for(const s in $s.constructors){const o=+s;e>=o&&t.push(...$s.constructors[o])}return t.map(s=>new s)}}$s.constructors={};function e2(n,e,t,s,o,r,i,a,u){const d=new mW,h=[new fW,...$s.createCallbacks(e)];n!=null&&h.push(...n),h.push(d);const p=new pW(h);return p.setParams({epochs:t,initialEpoch:s,samples:o,steps:r,batchSize:i,verbose:e,doValidation:a,metrics:u}),{callbackList:p,history:d}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wo(n,e={},t=!1){return bc(n,Ns.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ah(n,e){return se(()=>{n.dtype!=="float32"&&(n=$e(n,"float32"));const t=Le(wc(n),e,!0),s=Jp(t.shape,Kt()),o=vn(Mr(t,s));return Me(n,o)})}function cf(n,e){return se(()=>Gt(wc(We(e,n)),-1))}function o1(n,e){return se(()=>Gt(En(We(e,n)),-1))}function r1(n,e){return se(()=>{const t=We(n,e),s=ps(En(n),Kt(),Number.MAX_VALUE),o=En(Me(t,s));return j(100,Gt(o,-1))})}function yW(n,e){return se(()=>{const t=ps(e,Kt(),Number.MAX_VALUE),s=Co(xe(1,t)),o=ps(n,Kt(),Number.MAX_VALUE),r=Co(xe(1,o));return Gt(wc(We(s,r)),-1)})}function xW(n,e){return se(()=>{const t=Mr(0,We(1,j(n,e)));return Gt(wc(t),-1)})}function bW(n,e){return se(()=>{const t=Mr(0,We(1,j(n,e)));return Gt(t,-1)})}function vW(n,e){return se(()=>{const t=Le(j(n,e),-1),s=Xs(j(We(1,n),e),-1);return Mr(0,xe(1,We(s,t)))})}function wW(n,e){return se(()=>{const t=Math.log(2),s=We(e,n),o=We(xe(s,hc(j(-2,s))),t);return Gt(o,-1)})}function au(n,e,t=!1){return se(()=>{if(t)e=u0(e);else{const s=Le(e,e.shape.length-1,!0);e=Me(e,s)}return e=ps(e,Kt(),1-Kt()),Mt(Le(j($e(n,"float32"),Co(e)),e.shape.length-1))})}function Dh(n,e,t=!1){return se(()=>{const s=$e(tf(W4(n)),"int32");e=ps(e,Kt(),1-Kt());const o=e.shape,r=Z($S(s,o[o.length-1]),o);return au(r,e,t)})}function kW(n,e){if(!ht(n.shape,e.shape))throw new G(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return se(()=>{const t=_i(e),s=Mt(En(e));return xe(We(t,j(e,n)),kS(ko(s)))})}function df(n,e){return se(()=>{let t;return t=ps(e,Kt(),1-Kt()),t=Co(Me(t,We(1,t))),Gt(kW(n,t),-1)})}function CW(n,e){return se(()=>{const t=ps(n,Kt(),1),s=ps(e,Kt(),1);return Le(j(n,Co(Me(t,s))),-1)})}function IW(n,e){return se(()=>{const t=Co(xe(Kt(),e));return Gt(We(e,j(n,t)),-1)})}function t2(n,e){return se(()=>{const t=Ah(n,-1),s=Ah(e,-1),o=j(t,s);return Mt(Le(o,-1))})}const Fh={meanSquaredError:cf,meanAbsoluteError:o1,meanAbsolutePercentageError:r1,meanSquaredLogarithmicError:yW,squaredHinge:xW,hinge:bW,categoricalHinge:vW,logcosh:wW,categoricalCrossentropy:au,sparseCategoricalCrossentropy:Dh,binaryCrossentropy:df,kullbackLeiblerDivergence:CW,poisson:IW,cosineProximity:t2};function Mg(n){if(typeof n=="string"){if(n in Fh)return Fh[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new G(e)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function n2(n,e){return se(()=>{const t=j(.5,As(e)),s=bo(fs(e,t),n.dtype);return Gt(wo(n,s),-1)})}function s2(n,e){return se(()=>bo(wo(tu(n,-1),tu(e,-1)),"float32"))}function SW(n,e){return se(()=>$e(Le(Uo(wo(n,1),wo(e,1))),"float32"))}function $W(n,e){return se(()=>$e(Le(Uo(wo(n,0),wo(e,1))),"float32"))}function NW(n,e){return se(()=>{const t=SW(n,e),s=$W(n,e),o=xe(t,s);return $e(Dn(fs(o,0),Me(t,o),0),"float32")})}function TW(n,e){return df(n,e)}function EW(n,e){return n.rank===e.rank&&(n=fc(n,[n.rank-1])),e=tu(e,-1),e.dtype!==n.dtype&&(e=$e(e,n.dtype)),$e(wo(n,e),"float32")}const RW=cf,AW=cf,DW=o1,FW=o1,_W=r1,OW=r1,o2=au,LW=t2,r2=Dh,_h={binaryAccuracy:n2,categoricalAccuracy:s2,precision:NW,categoricalCrossentropy:o2,sparseCategoricalCrossentropy:r2,mse:RW,MSE:AW,mae:DW,MAE:FW,mape:_W,MAPE:OW,cosine:LW};function MW(n){if(typeof n=="string"&&n in _h)return _h[n];if(typeof n!="string"&&n!=null)return n;throw new G(`Unknown metric ${n}`)}function Kd(n){if(ho(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(Fh))if(Fh[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(_h))if(_h[t]===n){e=t;break}return e!==void 0?e:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function PW(n){const e={Adagrad:()=>ma.adagrad(.01),Adadelta:()=>ma.adadelta(1,.95,Kt()),Adam:()=>ma.adam(.001,.9,.999,Kt()),Adamax:()=>ma.adamax(.002,.9,.999,Kt(),0),RMSProp:()=>ma.rmsprop(.001,.9,0,Kt()),SGD:()=>ma.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new G(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Fk=1*1024*1024;function _k(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!Iy(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const s=JSON.stringify(n);s.length>Fk&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${Fk}.`)}}function Iy(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!Iy(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!Iy(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zW(n,e,t,s=console.log){const o=WW(n),r=["Layer (type)","Input Shape","Output shape","Param #"];o?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(h=>Math.floor(e*h)));let i;if(!o){r.push("Receives inputs"),i=[];for(const h in n.nodesByDepth)i.push(...n.nodesByDepth[h])}s("_".repeat(e)),Oh(r,t,s),s("=".repeat(e));const a=n.layers;for(let h=0;h<a.length;++h)o?VW(a[h],t,s):UW(a[h],t,i,s),s((h===a.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const u=BW(n),d=Th(n.nonTrainableWeights);s(`Total params: ${u+d}`),s(`Trainable params: ${u}`),s(`Non-trainable params: ${d}`),s("_".repeat(e))}function BW(n){let e;return n.collectedTrainableWeights!=null?e=Th(n.collectedTrainableWeights):e=Th(n.trainableWeights),e}function WW(n){let e=!0;const t=[],s=[];for(const o in n.nodesByDepth)t.push(n.nodesByDepth[o]);for(const o of t){if(o.length>1||o.length===1&&o[0].inboundLayers.length>1){e=!1;break}s.push(...o)}if(e)for(const o of n.layers){let r=!1;for(const i of o.inboundNodes)if(s.indexOf(i)!==-1)if(r){e=!1;break}else r=!0;if(!e)break}return e}function Oh(n,e,t=console.log){let s="";for(let o=0;o<n.length;++o)o>0&&(s=s.slice(0,s.length-1)+" "),s+=n[o],s=s.slice(0,e[o]),s+=" ".repeat(e[o]-s.length);t(s)}function VW(n,e,t){let s,o;try{o=n.inboundNodes.map(u=>JSON.stringify(u.inputShapes)).join(",")}catch{o="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const r=n.name,i=n.getClassName(),a=[`${r} (${i})`,o,s,n.countParams().toString()];Oh(a,e,t)}function UW(n,e,t,s){let o,r;try{r=n.inboundNodes.map(p=>JSON.stringify(p.inputShapes)).join(",")}catch{r="multiple"}try{o=JSON.stringify(n.outputShape)}catch{o="multiple"}const i=[];for(const p of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(p)===-1))for(let f=0;f<p.inboundLayers.length;++f){const g=p.inboundLayers[f].name,y=p.nodeIndices[f],b=p.tensorIndices[f];i.push(`${g}[${y}][${b}]`)}const a=n.name,u=n.getClassName(),d=i.length===0?"":i[0],h=[`${a} (${u})`,r,o,n.countParams().toString(),d];Oh(h,e,s);for(let p=1;p<i.length;++p)Oh(["","","","",i[p]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function i2(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function Sy(n,e){if(n===null)return null;if(typeof n=="string")return ui(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let o=0;o<s;++o){const r=n[o];i2(e,o,r)?t.push(r):t.push(Sy(r,e))}return t}else{const t={};for(const s of Object.keys(n)){const o=n[s];if(s==="name"&&typeof o=="string")t[s]=o;else{const r=ui(s);t[r]=Sy(o,r)}}return t}}function $y(n,e){if(n==null)return null;if(typeof n=="string")return Mo(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let o=0;o<s;++o){const r=n[o];i2(e,o,r)?t.push(r):t.push($y(r,e))}return t}else{const t={};for(const s of Object.keys(n)){const o=n[s],r=Mo(s);(s==="name"||s==="className")&&typeof o=="string"?t[r]=o:t[r]=$y(o,s)}return t}}/** @license See the LICENSE file. */const a2="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const GW=n=>{const e=Object.keys(n);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class Gs extends Xe{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const C=this.getClassName().toLowerCase();this.name=af(C)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Sr(this.inputs).length!==this.inputs.length)throw new G(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(C=>C.name)}`);Sr(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(C=>C.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const C of this.outputs){const $=C.sourceLayer,S=C.nodeIndex,N=C.tensorIndex;this.outputLayers.push($),this.outputLayersNodeIndices.push(S),this.outputLayersTensorIndices.push(N)}for(const C of this.inputs){const $=C.sourceLayer,S=C.nodeIndex,N=C.tensorIndex;ho(S===0,"input layer has >1 nodes"),ho(N===0,"input layer has >1 tensors"),this.inputLayers.push($),this.inputLayersNodeIndices.push(S),this.inputLayersTensorIndices.push(N)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let C=0;C<this.inputLayers.length;C++){const $=this.inputLayers[C];if(!($ instanceof Cc))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${C} (0-based) originates from layer type ${$.getClassName()}.`);this.inputNames.push($.name),this.feedInputShapes.push($.batchInputShape),this.feedInputNames.push($.name)}for(const C of this.outputLayers)this.outputNames.push(C.name);this.internalInputShapes=this.inputs.map(C=>C.shape),this.internalOutputShapes=this.outputs.map(C=>C.shape);const t={},s={},o={},r={},i={},a=[],u=(C,$,S,N,R,F)=>{(N==null||R==null||F==null)&&(N=C.sourceLayer,R=C.nodeIndex,F=C.tensorIndex);const O=N.inboundNodes[R];if(S.indexOf(O)!==-1)throw new Ts(`The tensor ${C.name} at layer "${N.name}" is part of a cycle.`);if($.indexOf(O)!==-1)return;this.containerNodes.add(Gs.nodeKey(N,R)),N.id in i||(i[N.id]=Object.keys(i).length),S.indexOf(O)===-1&&S.push(O);const D=O.inboundLayers.length;for(let A=0;A<D;A++){const T=O.inputTensors[A],B=O.inboundLayers[A],U=O.nodeIndices[A],Q=O.tensorIndices[A];u(T,$,S,B,U,Q)}for($.push(O);S.indexOf(O)>=0;)S.splice(S.indexOf(O),1);a.push(O)},d=[],h=[];for(const C of this.outputs)u(C,d,h);const p=a.slice().reverse();for(const C of p){s[C.id]=C,C.id in t||(t[C.id]=0);let $=t[C.id];const S=o[C.outboundLayer.id]==null?0:o[C.outboundLayer.id];$=Math.max($,S),o[C.outboundLayer.id]=$,r[C.outboundLayer.id]=C.outboundLayer,t[C.id]=$;for(let N=0;N<C.inboundLayers.length;N++){const R=C.inboundLayers[N],F=C.nodeIndices[N],O=R.inboundNodes[F],D=t[O.id]==null?0:t[O.id];t[O.id]=Math.max($+1,D),s[O.id]=O}}const f={};for(const C in t){const $=t[C];$ in f||(f[$]=[]),f[$].push(s[C])}const g={};for(const C in o){const $=o[C];$ in g||(g[$]=[]),g[$].push(r[C])}let y=Object.keys(g).map(C=>parseInt(C,10)).sort(jd);this.layers=[];for(const C of y){const $=g[C];$.sort((S,N)=>{const R=i[S.id],F=i[N.id];return R<F?-1:R>F?1:0});for(const S of $)S instanceof Gs&&this.internalContainerRefs.push(S),this.layers.push(S)}this.layersByDepth=g,y=Object.keys(f).map(C=>parseInt(C,10)).sort(jd);const b=this.inputs.slice(),v=[];for(const C of y)for(const $ of f[C]){const S=$.outboundLayer;if(S!=null){for(const N of $.inputTensors)if(b.indexOf(N)===-1)throw new Ts(`Graph disconnected: cannot obtain value for tensor ${N} at layer "${S.name}". The following previous layers were accessed without issue: ${v}`);for(const N of $.outputTensors)b.push(N);v.push(S.name)}}this.nodesByDepth=f;const w=this.layers.map(C=>C.name);for(const C of w){const $=w.filter(S=>S===C).length;if($!==1)throw new Ts(`The name "${C}" is used ${$} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new uf({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(C=>null),outputMasks:this.outputs.map(C=>null),inputShapes:this.inputs.map(C=>C.shape),outputShapes:this.outputs.map(C=>C.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new G("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.layers)t.push(...s.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const s={};let o=0;const r=GW(e);r&&this.parseWeights(e);for(const a of this.layers)for(const[u,d]of a.weights.entries()){const h=r?`${d.name.split("/").slice(0,-1).join("/")+"/"}${u}`:d.originalName;if(s[h]!=null)throw new G(`Duplicate weight name: ${h}`);s[h]=d,o++}const i=[];for(const a in e){let u=a;if(s[a]==null){const d=a.split("/");u=d.slice(0,-2).concat([d[d.length-1]]).join("/")}if(s[u]!=null)i.push([s[u],e[a]]);else if(t)throw new G(`Provided weight data has no target variable: ${a}`);delete s[u]}if(t){const a=[];for(const u in s)a.push(u);if(a.length>0)throw new G(`${a.length} of ${o} weights are not set: ${a}`)}n1(i)}parseWeights(e){for(const t in Object.keys(e)){const s=t.split("/"),o=["vars","layer_checkpoint_dependencies"],r=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!o.includes(i)).join("/");r!==t&&(e[r]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${a2}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const s=$y(this.updatedConfig());return t?JSON.stringify(s):s}call(e,t){return se(()=>{e=ft(e);const s=new wr;for(let o=0;o<this.inputs.length;++o)s.add(this.inputs[o],e[o]);return Kl(this.outputs,s,t)})}computeMask(e,t){return se(()=>{e=ft(e);let s;return t==null?s=Ti(null,e.length):s=ft(t),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const t=Nh(e);if(t.length!==this.inputLayers.length)throw new G(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<t.length;a++){const u=this.inputLayers[a],d=t[a],h=u.name+"_0_0";s[h]=d}const o=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(jd);if(o.length>1)for(const a of o){const u=this.nodesByDepth[a];for(const d of u){const h=d.outboundLayer;if(this.inputLayers.map(b=>b.id).indexOf(h.id)!==-1)continue;const p=[];for(let b=0;b<d.inboundLayers.length;b++){const v=d.inboundLayers[b],w=d.nodeIndices[b],C=d.tensorIndices[b],$=`${v.name}_${w}_${C}`,S=s[$];p.push(S)}const f=h.computeOutputShape(Bn(p)),g=Nh(f),y=h.inboundNodes.indexOf(d);for(let b=0;b<g.length;b++){const v=`${h.name}_${y}_${b}`;s[v]=g[b]}}}const r=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const u=this.outputLayers[a],d=this.outputLayersNodeIndices[a],h=this.outputLayersTensorIndices[a],p=`${u.name}_${d}_${h}`;i.push(p)}for(let a=0;a<i.length;a++){const u=i[a];ho(u in s),r.push(s[u])}return Bn(r)}runInternalGraph(e,t){t==null&&(t=Ti(null,e.length));const s={};for(let u=0;u<this.inputs.length;++u){const d=this.inputs[u],h=e[u],p=t[u];s[d.id]=[h,p]}const o=Object.keys(this.nodesByDepth).map(u=>parseInt(u,10)).sort(jd);for(const u of o){const d=this.nodesByDepth[u];for(const h of d){const p=h.outboundLayer,f=h.inputTensors,g=h.outputTensors,y=new Array;for(const b of f)b.id in s&&y.push(s[b.id]);if(y.length===f.length){let b={},v,w,C,$;if(h.callArgs!=null&&(b=h.callArgs),y.length===1){const[S,N]=y[0];b.mask==null&&(b.mask=N),C=ft(p.call(S,b)),$=ft(p.computeMask(S,N)),v=[S],w=[N]}else v=y.map(S=>S[0]),w=y.map(S=>S[1]),b.mask==null&&(b.mask=w),C=ft(p.call(v,b)),$=ft(p.computeMask(v,w));if(p.activityRegularizer)throw new He("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let S=0;S<g.length;++S){const N=g[S],R=C[S],F=$[S];s[N.id]=[R,F]}}}}const r=[],i=[],a=[];for(const u of this.outputs){ho(u.id in s,`Could not compute output ${u.name} : ${u.id}`);const[d,h]=s[u.id];a.push(d.shape),r.push(d),i.push(h)}return[r,i,a]}buildNodeConversionMap(e){const t={};let s;for(const o of this.layers){s=o instanceof Gs?1:0;for(let r=0;r<o.inboundNodes.length;r++){const i=Gs.nodeKey(o,r);this.containerNodes.has(i)&&(t[i]=s,s+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new G("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new G(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new G(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return se(()=>{const e=[];for(const t of this.layers)for(let s=0;s<t.inboundNodes.length;++s){const o=Gs.nodeKey(t,s);this.containerNodes.has(o)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const a=i.getClassName(),u=i.getConfig(),d=[];for(let p=0;p<i.inboundNodes.length;p++){const f=i.inboundNodes[p],g=Gs.nodeKey(i,p);let y={};if(this.containerNodes.has(g)){if(f.callArgs)try{JSON.stringify(f.callArgs),y=f.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${f.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),y={}}if(f.inboundLayers.length>0){const b=[];for(let v=0;v<f.inboundLayers.length;v++){const w=f.inboundLayers[v],C=f.nodeIndices[v],$=f.tensorIndices[v],S=Gs.nodeKey(w,C);let N=t[S];N==null&&(N=0),b.push([w.name,N,$,y])}d.push(b)}}}const h={};h.name=i.name,h.className=a,h.config=u,h.inboundNodes=d,s.push(h)}e.layers=s;const o=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],u=this.inputLayersNodeIndices[i],d=Gs.nodeKey(a,u);if(!this.containerNodes.has(d))continue;let h=t[d];h==null&&(h=0);const p=this.inputLayersTensorIndices[i];o.push([a.name,h,p])}e.inputLayers=o;const r=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],u=this.outputLayersNodeIndices[i],d=Gs.nodeKey(a,u);if(!this.containerNodes.has(d))continue;let h=t[d];h==null&&(h=0);const p=this.outputLayersTensorIndices[i];r.push([a.name,h,p])}return e.outputLayers=r,e}static fromConfig(e,t,s={},o=!1){const r={},i={};function a(v,w){v.name in i?i[v.name].push(w):i[v.name]=[w]}function u(v,w){const C=[];let $;for(const S of w){const N=S[0],R=S[1],F=S[2];if($=S[3]==null?{}:S[3],!(N in r)){a(v,w);return}const O=r[N];if(O.inboundNodes.length<=R){a(v,w);return}const D=O.inboundNodes[R];C.push(D.outputTensors[F])}C.length>0&&v.apply(Bn(C),$)}function d(v){const w=v.name,C=Wo(v,t.customObjects!=null?t.customObjects:{});C.setFastWeightInitDuringBuild(o),r[w]=C,v.inboundNodes.forEach(S=>{if(!(S instanceof Array))throw new G(`Corrupted configuration, expected array for nodeData: ${S}`);a(C,S)})}const h=t.name,p=t.layers;for(const v of p)d(v);for(;!T4(i);)for(const v of p){const w=r[v.name];if(w.name in i){const C=i[w.name];delete i[w.name];for(const $ of C)u(w,$)}}const f=[],g=[],y=t.inputLayers;for(const v of y){const w=v[0],C=v[1],$=v[2];ho(w in r);const N=r[w].inboundNodes[C].outputTensors;f.push(N[$])}const b=t.outputLayers;for(const v of b){const w=v[0],C=v[1],$=v[2];ho(w in r);const N=r[w].inboundNodes[C].outputTensors;g.push(N[$])}return new e({inputs:f,outputs:g,name:h})}get stateful(){if(this._stateful)throw new G("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){se(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jW(n,e,t){const s=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(o=>null);if(s===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==s)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const o=[];return e.forEach(r=>{r in n?o.push(n[r]):o.push(null)}),o}else throw new Error(`The model has multiple (${s}) outputs, so ${t} must be either an array with ${s} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function l2(n,e){return jW(n,e,"classWeight")}async function u2(n,e,t,s){if(t!=null){const o=se(()=>{if(n.shape.length===1)return mi(n);if(n.shape.length===2){if(n.shape[1]>1)return tu(n,1);if(n.shape[1]===1)return Z(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),r=Array.from(await o.data());Ye(o);const i=[];return r.forEach(a=>{if(t[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(t[a])}),es(i,"float32")}else return null}function HW(n,e){return j(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const qW=32;function c2(n,e){let t,s;const o=e;t=o.xs,s=o.ys,_(t!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const r=Ok("input",n.inputNames,t),i=Ok("output",n.outputNames,s),a=r[0].shape[0];_(r.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${r.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),_(i.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let u=0;u<r.length;u++)_(r[u].shape[0]===a,()=>`Batch size mismatch: input ${n.inputNames[u]} has ${r[u].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);for(let u=0;u<i.length;u++)_(i[u].shape[0]===a,()=>`Batch size mismatch: output ${n.outputNames[u]} has ${i[u].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);return{xs:r,ys:i}}function Ok(n,e,t){if(t instanceof qt)return[t];if(Array.isArray(t))return _(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const s=[];for(const o of e){if(t[o]==null)throw new G(`The feature data generated by the dataset lacks the required ${n} key '${o}'.`);s.push(t[o])}return s}}function KW(n){if(n.length===3)throw new He("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function XW(n,e,t){const s=t.batchesPerEpoch!=null;if(_(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),_(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),_(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),_(!s||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),_(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const o=t.validationData!=null;let r,i;if(o)if(Lk(t.validationData))_(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const v=KW(t.validationData);r=v.xs,i=v.ys}const a=n.makeTrainFunction(),u=n.getDedupedMetricsNames();let d;o?d=u.slice().concat(u.map(v=>"val_"+v)):d=u.slice();const h=Z$(t.callbacks,t.yieldEvery),p=t.verbose==null?1:t.verbose,{callbackList:f,history:g}=e2(h,p,t.epochs,null,null,YW(e,t),null,o,d);f.setModel(n),n.history=g,await f.onTrainBegin(),n.stopTraining_=!1;let y=t.initialEpoch==null?0:t.initialEpoch,b=await e.iterator();for(;y<t.epochs;){const v={};await f.onEpochBegin(y);let w=0,C=0;for(s||(b=await e.iterator());!s||w<t.batchesPerEpoch;){const $=await b.next();if(s&&$.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if($.value!=null){const{xs:S,ys:N}=c2(n,$.value),R={};R.batch=C,R.size=S[0].shape[0],await f.onBatchBegin(C,R);const F=[];if(t.classWeight!=null){const A=l2(t.classWeight,n.outputNames);for(let T=0;T<A.length;++T)F.push(await u2(N[T],null,A[T]))}const O=S.concat(N).concat(F),D=a(O);Ye(O);for(let A=0;A<u.length;++A){const T=u[A],B=D[A];R[T]=B,yo(B)}await f.onBatchEnd(C,R),J$(R),C++,w++}if(s?w>=t.batchesPerEpoch:$.done){if(o){let S;Lk(t.validationData)?S=ft(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):S=ft(n.evaluate(r,i,{batchSize:t.validationBatchSize==null?qW:t.validationBatchSize,verbose:0}));for(let N=0;N<n.metricsNames.length;++N)v[`val_${n.metricsNames[N]}`]=S[N]}break}if(n.stopTraining_)break}if(await f.onEpochEnd(y,v),y++,n.stopTraining_)break}return await f.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function YW(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function Lk(n){return typeof n.iterator=="function"}function QW(n){return typeof n.next=="function"}async function JW(n,e,t){t=t||{};const s=t.batches!=null,o=n.testFunction;let r=[];if(t.verbose>0)throw new He("Verbose mode is not implemented yet.");_(!s||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const i=QW(e)?e:await e.iterator();let a=0,u=0;for(;!s||u<t.batches;){const d=await i.next();if(r=se(()=>{if(d.value){const{xs:h,ys:p}=c2(n,d.value),f=h.concat(p),g=se(()=>o(f));if(Ye(f),u===0)for(let b=0;b<g.length;++b)r.push(dt(0));const y=f[0].shape[0];for(let b=0;b<g.length;++b){const v=g[b],w=r[b];r[b]=se(()=>xe(r[b],j(y,v))),u>0&&Ye(w)}Ye(g),a+=y,++u}return r}),d.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let d=0;d<r.length;++d){const h=r[d];r[d]=Me(r[d],a),Ye(h)}return Bn(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pg(n){_(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function Ul(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(s=>yi(s,e,t-e)):yi(n,e,t-e)}function Ny(n,e){return se(()=>n==null?null:Array.isArray(n)?n.map(t=>Ny(t,e)):P$(n,e.dtype==="int32"?e:$e(e,"int32")))}function zg(n,e){const t=[];let s=0,o=null;for(;s<n;)o=s+e,o>=n&&(o=n),t.push([s,o]),s=o;return t}function d2(n){const e=[];n instanceof qt&&(n=[n]);for(let t=0;t<n.length;++t){const s=n[t];if(s.rank===1)e.push(vc(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Us(n,e){if(n==null)return;const t=[];if(e instanceof qt)t.push(e.id);else if(Array.isArray(e))e.forEach(o=>t.push(o.id));else if(e!=null)for(const o in e){const r=e[o];t.push(r.id)}const s=[];if(n instanceof qt)t.indexOf(n.id)===-1&&s.push(n);else if(Array.isArray(n))n.forEach(o=>{t.indexOf(o.id)===-1&&s.push(o)});else if(n!=null)for(const o in n){const r=n[o];t.indexOf(r.id)===-1&&s.push(r)}s.forEach(o=>{o.isDisposed||o.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ZW(n){return n instanceof qt}function Ty(n){return Array.isArray(n)}function Mk(n){return!ZW(n)&&!Ty(n)}function Pk(n,e,t,s=!0,o=""){if(e==null||e.length===0){if(n!=null){let i=!1;if(Ty(n)&&n.length>0)i=!0;else if(Mk(n)){for(const a in n)if(n.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new G(`Error when checking model ${o} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(i=>null);let r;if(Mk(n)){n=n,r=[];for(const i of e){if(n[i]==null)throw new G(`No data provided for "${i}". Need data for each key in: ${e}`);r.push(n[i])}}else if(Ty(n)){if(n=n,n.length!==e.length)throw new G(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);r=n}else{if(n=n,e.length>1)throw new G(`The model ${o} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);r=[n]}if(r=d2(r),t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const a=r[i];if(a.shape.length!==t[i].length)throw new G(`Error when checking ${o}: expected ${e[i]} to have ${t[i].length} dimension(s). but got array with shape ${a.shape}`);for(let u=0;u<t[i].length;++u){if(u===0&&!s)continue;const d=a.shape[u],h=t[i][u];if(h!=null&&h>=0&&d!==h)throw new G(`${o} expected a batch of elements where each example has shape [${t[i].slice(1,t[i].length)}] (i.e.,tensor shape [*,${t[i].slice(1,t[i].length)}]) but the ${o} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return r}function eV(n,e,t){const s=Sr(n.map(r=>r.shape[0]));s.sort();const o=Sr(e.map(r=>r.shape[0]));if(o.sort(),s.length>1)throw new G(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(r=>r.shape))}`);if(o.length>1)throw new G(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(r=>r.shape))}`);if(s.length>0&&o.length>0&&!ht(s,o))throw new G(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${o[0]} target sample(s).`)}function tV(n,e,t){const s=[cf,df,au];for(let o=0;o<n.length;++o){const r=n[o],i=e[o],a=t[o];if(i!=null){if(i===au&&r.shape[r.shape.length-1]===1)throw new G(`You are passing a target array of shape ${r.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const u=r.shape.slice(1),d=a.slice(1);for(let h=0;h<u.length;++h){const p=u[h],f=d[h];if(f!=null&&p!==f)throw new G(`A target Tensor with shape ${r.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function zk(n,e,t,s=!0,o=""){let r;if(Array.isArray(n)){if(n.length!==e.length)throw new G(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);r=n}else{if(e.length>1)throw new G(`The model expects ${e.length} ${o} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);r=[n]}if(t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const a=r[i];if(a.shape.length!==t[i].length)throw new G(`Error when checking ${o}: expected ${e[i]} to have ${t[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let u=0;u<t[i].length;++u){if(u===0&&!s)continue;const d=a.shape[u],h=t[i][u];if(h!=null&&h!==d)throw new G(`Error when checking ${o}: expected ${e[i]} to have shape ${JSON.stringify(t[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function nV(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(s=>t);{const s=[];for(const o of e){let r=t.hasOwnProperty(o)?t[o]:[];Array.isArray(r)||(r=[r]),s.push(r)}return s}}const sV="layers-model";class $a extends Gs{constructor(e){super(e),this.isTraining=!1}summary(e,t,s=console.log){if(!this.built)throw new G("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");zW(this,e,t,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=PW(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof zr))throw new G("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new G(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),t.push(Mg(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new G(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(a=>Mg(a))}else{const i=Mg(e.loss);this.outputs.forEach(a=>{t.push(i)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],u=this.outputNames[i];this.feedOutputNames.push(u),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],gi("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const o=nV(e.metrics,this.outputNames),r=(i,a,u)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([u,i])};gi("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=o[i];(d=>{const h="";let p,f,g;for(const y of d){if(typeof y=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(y)!==-1){const v=this.internalOutputShapes[i];v[v.length-1]===1||this.lossFunctions[i]===df?["accuracy","acc"].indexOf(y)!==-1?f=n2:["crossentropy","ce"].indexOf(y)!==-1&&(f=TW):this.lossFunctions[i]===Dh?["accuracy","acc"].indexOf(y)!==-1?f=EW:["crossentropy","ce"].indexOf(y)!==-1&&(f=r2):["accuracy","acc"].indexOf(y)!==-1?f=s2:["crossentropy","ce"].indexOf(y)!==-1&&(f=o2);let w;["accuracy","acc"].indexOf(y)!==-1?w="acc":["crossentropy","ce"].indexOf(y)!==-1&&(w="ce"),g=f,p=h+w}else g=MW(y),p=h+Kd(y);let b;gi(p,()=>{b=g}),r(i,p,b)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,s={}){const o=s.batchSize==null?32:s.batchSize;Pg(o);const i=this.standardizeUserDataXY(e,t,!0,o);try{const a=i[0].concat(i[1]);this.makeTestFunction();const u=this.testFunction,d=this.testLoop(u,a,o,s.verbose,s.steps);return Bn(d)}finally{Us(i[0],e),Us(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),JW(this,e,t)}checkNumSamples(e,t,s,o="steps"){let r;if(s!=null){if(r=null,t!=null)throw new G(`If ${o} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?r=e[0].shape[0]:r=e.shape[0];else throw new G(`Either the input data should have a defined shape, or ${o} shoud be specified.`);return r}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new G("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(t),o=s?t:[t],r=this.retrieveSymbolicTensors(o),i=new wr;if(e instanceof qt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new G(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let u=0;u<this.inputs.length;++u)i.add(this.inputs[u],e[u])}else for(const u of this.inputs){const d=e[u.name];if(d==null)throw new G(`No value is provided for the model's input ${u.name}`);i.add(u,d)}const a=Kl(r,i);return s?a:a[0]}retrieveSymbolicTensors(e){const t=Ti(null,e.length);let s=e.length;for(const o of this.layers){const r=Array.isArray(o.output)?o.output:[o.output],i=r.map(a=>a.name);for(let a=0;a<e.length;++a){const u=i.indexOf(e[a]);if(u!==-1&&(t[a]=r[u],s--),s===0)break}if(s===0)break}if(s>0){const o=[];throw t.forEach((r,i)=>{r==null&&o.push(e[i])}),new G(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(o)}`)}return t}predictLoop(e,t=32,s=!1){return se(()=>{const o=this.checkNumSamples(e);if(s)throw new He("Verbose predictLoop() is not implemented yet.");const r=zg(o,t),i=this.outputs.map(a=>[]);for(let a=0;a<r.length;++a)se(()=>{const d=r[a][0],h=r[a][1],p=Ul(e,d,h),f=[];if(Array.isArray(p))for(let y=0;y<p.length;++y)f.push({key:this.inputs[y],value:p[y]});else f.push({key:this.inputs[0],value:p});const g=new wr(f);return Kl(this.outputs,g)}).forEach((d,h)=>i[h].push(d));return Bn(i.map(a=>Wn(a,0)))})}predict(e,t={}){const s=d2(e);zk(s,this.inputNames,this.feedInputShapes,!1);try{const o=t.batchSize==null?32:t.batchSize;return Pg(o),this.predictLoop(s,o)}finally{Us(s,e)}}predictOnBatch(e){zk(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,s=!0,o){if(this.optimizer_==null)throw new Ts("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===Dh?r.push(a.slice(0,a.length-1).concat([1])):r.push(a)}if(e=Pk(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=Pk(t,this.feedOutputNames,r,!1,"target"),eV(e,t),tV(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&o!=null&&o>0&&e[0].shape[0]%o!==0)throw new G(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${o}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,s,o,r=!0,i){const[a,u]=this.standardizeUserDataXY(e,t,r,i);if(s!=null)throw new Error("sample weight is not supported yet.");let d=null;if(o!=null){const h=l2(o,this.outputNames);d=[];for(let p=0;p<h.length;++p)d.push(await u2(u[p],null,h[p]))}return[a,u,d]}testLoop(e,t,s,o=0,r){return se(()=>{const i=this.checkNumSamples(t,s,r,"steps"),a=[];if(o>0)throw new He("Verbose mode is not implemented yet.");if(r!=null)throw new He("steps mode in testLoop() is not implemented yet");{const u=zg(i,s),d=es(Qs(0,i));for(let h=0;h<u.length;++h){const p=u[h][0],f=u[h][1],g=yi(d,p,f-p),y=Ny(t,g),b=e(y);if(h===0)for(let v=0;v<b.length;++v)a.push(dt(0));for(let v=0;v<b.length;++v){const w=b[v];a[v]=xe(a[v],j(f-p,w))}}for(let h=0;h<a.length;++h)a[h]=Me(a[h],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let s=0;s<e.length;++s){const o=e[s];let r=o;if(Ck(e,o)>1){const i=Ck(e.slice(0,s),o);r+=`_${i}`}t.push(r)}return t}makeTrainFunction(){return e=>{const t=[],s=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const p=[];for(let b=0;b<this.inputs.length;++b)p.push({key:this.inputs[b],value:s[b]});const f=new wr(p),g=Kl(this.outputs,f,{training:!0});let y;for(let b=0;b<this.lossFunctions.length;++b){const v=this.lossFunctions[b];let w=v(o[b],g[b]);r[b]!=null&&(w=HW(w,r[b]));const C=Gt(w);t.push(C),b===0?y=w:y=xe(y,w)}for(let b=0;b<this.metricsTensors.length;++b){let v;if(this.outputs.length>1&&b<this.outputs.length)v=t[b];else{const w=this.metricsTensors[b][0],C=this.metricsTensors[b][1];v=Gt(w(o[C],g[C]))}yo(v),i.push(v)}return y=Gt(y),this.calculateLosses().forEach(b=>{y=xe(y,b)}),y},u=this.collectedTrainableWeights.map(p=>p.read());return[this.optimizer_.minimize(a,!0,u)].concat(i)}}makeTestFunction(){this.testFunction=e=>se(()=>{const t=[];let s;const o=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let d=0;d<this.inputs.length;++d)i.push({key:this.inputs[d],value:o[d]});const a=new wr(i),u=Kl(this.outputs,a);for(let d=0;d<this.lossFunctions.length;++d){const h=this.lossFunctions[d],p=Gt(h(r[d],u[d]));d===0?s=p:s=xe(s,p),t.push(s)}for(let d=0;d<this.metricsTensors.length;++d){const h=this.metricsTensors[d][0],p=this.metricsTensors[d][1],f=Gt(h(r[p],u[p]));t.push(f)}return t})}async fit(e,t,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let o,r,i,a,u,d,h,p,f;try{const g=s.batchSize==null?32:s.batchSize;Pg(g);const b=await this.standardizeUserData(e,t,s.sampleWeight,s.classWeight,!1,g);o=b[0],r=b[1],f=b[2];let v=!1,w;if(s.validationData!=null&&s.validationData.length>0){if(v=!0,s.validationData.length===2)u=s.validationData[0],d=s.validationData[1];else throw s.validationData.length===3?new He("validationData including sample weights is not supported yet."):new G(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const A=await this.standardizeUserData(u,d,null,null,!0,g);h=A[0],p=A[1],w=h.concat(p)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){v=!0;const D=Math.floor(o[0].shape[0]*(1-s.validationSplit)),A=o[0].shape[0];h=Ul(o,D,A),i=o,o=Ul(o,0,D),p=Ul(r,D,A),a=r,r=Ul(r,0,D),w=h.concat(p)}else s.validationSteps!=null&&(v=!0);const C=o.concat(r).concat(f);this.checkTrainableWeightsConsistency();const $=this.makeTrainFunction(),S=this.getDedupedMetricsNames();let N,R;v?(this.makeTestFunction(),N=this.testFunction,R=S.slice().concat(S.map(D=>"val_"+D))):(N=null,w=[],R=S.slice());const F=Z$(s.callbacks,s.yieldEvery);return await this.fitLoop($,C,S,g,s.epochs,s.verbose,F,N,w,s.shuffle,R,s.initialEpoch,null,null)}finally{this.isTraining=!1,Us(o,e),Us(r,t),Us(i,e),Us(a,t),Us(h,u),Us(p,d),f!=null&&Ye(f)}}async fitLoop(e,t,s,o,r,i,a,u,d,h,p,f,g,y){o==null&&(o=32),r==null&&(r=1),h==null&&(h=!0),f==null&&(f=0);let b=!1;if(u!=null&&d!=null&&(b=!0),y!=null&&(b=!0,g==null))throw new G("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(t,o,g,"steps_per_epoch");let w;v!=null&&(w=Qs(0,v)),i==null&&(i=1);const{callbackList:C,history:$}=e2(a,i,r,f,v,g,o,b,p);C.setModel(this),this.history=$,await C.onTrainBegin(),this.stopTraining_=!1;for(let S=f;S<r;++S){await C.onEpochBegin(S);const N={};if(g!=null)throw new He("stepsPerEpoch mode is not implemented yet.");{if(h==="batch")throw new He("batch shuffling is not implemneted yet");h&&BF(w);const R=es(w),F=zg(v,o);for(let O=0;O<F.length;++O){const D={};if(await C.onBatchBegin(O,D),se(()=>{const A=F[O][0],T=F[O][1],B=yi(R,A,T-A);D.batch=O,D.size=T-A;const U=Ny(t,B),Q=e(U);for(let K=0;K<s.length;++K){const J=s[K],te=Q[K];D[J]=te,yo(te)}if(O===F.length-1&&b){const K=this.testLoop(u,d,o);for(let J=0;J<s.length;++J){const te=s[J],P=K[J];yo(P),N["val_"+te]=P}}}),await C.onBatchEnd(O,D),J$(D),this.stopTraining_)break}R.dispose()}if(await C.onEpochEnd(S,N),this.stopTraining_)break}return await C.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return XW(this,e,t)}async trainOnBatch(e,t){const s=await this.standardizeUserData(e,t),o=s[0],r=s[1],a=this.makeTrainFunction()(o.concat(r)),u=[];for(const d of a){const h=await d.data();u.push(h[0])}return Ye(a),Us(s[0],e),Us(s[1],t),Bn(u)}getNamedWeights(e){const t=[],s=e!=null&&e.trainableOnly,o=s?this.trainableWeights:this.weights,r=this.getWeights(s);for(let i=0;i<o.length;++i)s&&!o[i].trainable||t.push({name:o[i].originalName,tensor:r[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=Qw().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-Qw().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Mo(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>Mo(t))}else{const t=Object.keys(this.loss);e={};const s=this.loss;for(const o of t)if(typeof s[o]=="string")e[o]=Mo(s[o]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Mo(Kd(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Mo(Kd(e)));{const e={};for(const t in this.metrics)e[t]=Mo(Kd(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=Sy(e.optimizer_config),s=Wo(t);let o;if(typeof e.loss=="string")o=ui(e.loss);else if(Array.isArray(e.loss))o=e.loss.map(i=>ui(i));else if(e.loss!=null){o={};for(const i in e.loss)o[i]=ui(e.loss[i])}let r;if(Array.isArray(e.metrics))r=e.metrics.map(i=>ui(i));else if(e.metrics!=null){r={};for(const i in e.metrics)r[i]=ui(e.metrics[i])}this.compile({loss:o,metrics:r,optimizer:s})}async save(e,t){if(typeof e=="string"){const d=O_(e);if(d.length===0)throw new G(`Cannot find any save handlers for URL '${e}'`);if(d.length>1)throw new G(`Found more than one (${d.length}) save handlers for URL '${e}'`);e=d[0]}if(e.save==null)throw new G("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await Zw(this.getNamedWeights(t)),a={modelTopology:this.toJSON(null,!1),format:sV,generatedBy:`TensorFlow.js tfjs-layers v${a2}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const d="optimizer",{data:h,specs:p}=await Zw(await this.optimizer.getWeights(),d);s.specs.push(...p),s.data=__([s.data,h])}return this.userDefinedMetadata!=null&&(_k(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){_k(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}$a.className="Model";fe($a);class h2 extends $a{}h2.className="Functional";fe(h2);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _a extends $a{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:af("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new G(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof _a||e instanceof $a;let s;if(t){if(s=e,s.outputs.length!==1)throw new G("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new G("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new G("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const o=rW({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(o)}if(t)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new G(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new G("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=q$(this.outputs[0])}this.inboundNodes=[],new uf({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Ti(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(o=>o.shape),outputShapes:this.outputs[0].shape})}else{const o=e.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(rt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new $a({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,s=console.log){this.built||this.build(),super.summary(e,t,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,s={}){if(!this.built)throw new Ts("The model needs to be compiled before being used.");return this.model.evaluate(e,t,s)}async evaluateDataset(e,t){if(!this.built)throw new Ts("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,s={}){if(!this.built)throw new Ts("The model needs to be compiled before being used.");return this.model.fit(e,t,s)}async fitDataset(e,t){if(!this.built)throw new Ts("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,s={},o=!1){let r,i={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new G("Legacy serialization format not supported yet.");r=t}else _(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),r=t.layers,delete t.layers,i=t;const a=new e(i);if(!(a instanceof _a))throw new He(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const u of r){const h=Wo(u,void 0,o);o&&h.setFastWeightInitDuringBuild(!0),a.add(h)}return a}set stopTraining(e){if(this.model==null)throw new G("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new G("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const s={};s.className=t.getClassName(),s.config=t.getConfig(),e.push(s)}return{name:this.name,layers:e}}}_a.className="Sequential";fe(_a);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oV(n){return new _a(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let kn=class extends qa{getConfig(){return{}}};class p2 extends kn{apply(e,t=1){return U4(e,t)}}p2.className="elu";fe(p2);class f2 extends kn{apply(e){return AS(e)}}f2.className="selu";fe(f2);class m2 extends kn{apply(e){return _i(e)}}m2.className="relu";fe(m2);class g2 extends kn{apply(e){return se(()=>ou(6,_i(e)))}}g2.className="relu6";fe(g2);class y2 extends kn{apply(e){return e}}y2.className="linear";fe(y2);class x2 extends kn{apply(e){return Ga(e)}}x2.className="sigmoid";fe(x2);class b2 extends kn{apply(e){return j4(e)}}b2.className="hardSigmoid";fe(b2);class v2 extends kn{apply(e){return hc(e)}}v2.className="softplus";fe(v2);class w2 extends kn{apply(e){return G4(e)}}w2.className="softsign";fe(w2);class k2 extends kn{apply(e){return Yp(e)}}k2.className="tanh";fe(k2);let i1=class extends kn{apply(e,t=-1){return u0(e,t)}};i1.className="softmax";fe(i1);class C2 extends kn{apply(e,t=-1){return CS(e,t)}}C2.className="logSoftmax";fe(C2);class I2 extends kn{apply(e){return se(()=>se(()=>{const t=Math.sqrt(2),s=j(.5,xe(1,xS(Me(e,t))));return j(e,s)}))}}I2.className="gelu";fe(I2);class S2 extends kn{apply(e){return se(()=>j(.5,j(e,xe(1,Yp(j(vn(Me(2,Math.PI)),xe(e,j(.044715,Si(e,3)))))))))}}S2.className="gelu_new";fe(S2);class $2 extends kn{apply(e){return se(()=>j(e,Yp(hc(e))))}}$2.className="mish";fe($2);class N2 extends kn{apply(e,t=1){return se(()=>j(Ga(j(e,t)),e))}}N2.className="swish";fe(N2);function Er(n){return n.getClassName()}function Bg(n,e={}){return bc(n,Ns.getMap().classNameMap,e,"activation")}function Rr(n){if(n==null){const e={};return e.className="linear",e.config={},Bg(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},Bg(e)}else return n instanceof kn?n:Bg(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rV(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class T2 extends qa{}class E2 extends T2{constructor(e){super(),rV(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return se(()=>{let t=sn([1]);return this.hasL1&&(t=xe(t,Le(j(this.l1,En(e))))),this.hasL2&&(t=xe(t,Le(j(this.l2,wc(e))))),Z(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}E2.className="L1L2";fe(E2);const Bk={l1l2:"L1L2"};function bt(n){return H0(n)}function Wk(n,e={}){return bc(n,Ns.getMap().classNameMap,e,"regularizer")}function Tt(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in Bk?Bk[n]:n,config:{}};return Wk(t)}else return n instanceof T2?n:Wk(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class R2 extends Xe{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=Ve(e);let s=_i(e);return this.maxValue!=null&&(s=ps(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}R2.className="ReLU";fe(R2);class A2 extends Xe{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=Ve(e);return Zx(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}A2.className="LeakyReLU";fe(A2);class D2 extends Xe{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Nt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Tt(e.alphaRegularizer),this.alphaConstraint=Qt(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new G(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=rt(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const o of this.sharedAxes)t[o-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let o=1;o<e.length;++o)s[o]=e[o];this.inputSpec=[new Xt({ndim:e.length,axes:s})],this.built=!0}call(e,t){return e=Ve(e),r0(e,this.alpha.read())}getConfig(){const e={alphaInitializer:At(this.alphaInitializer),alphaRegularizer:bt(this.alphaRegularizer),alphaConstraint:Yt(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}D2.className="PReLU";fe(D2);let F2=class extends Xe{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new He(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=Ve(e);return Zp(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};F2.className="ELU";fe(F2);class _2 extends Xe{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const s=Ve(e);return j(s,$e(fs(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}_2.className="ThresholdedReLU";fe(_2);class O2 extends Xe{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new i1().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return se(()=>{let s=Ve(e);const o=t.mask;if(o!=null){const r=j(We(Pr(s.shape),$e(o,s.dtype)),dt(-1e9));s=xe(s,r)}return this.axis instanceof Array?this.axis.length>1?ko(We(s,IS(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}O2.className="Softmax";fe(O2);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Na(n,e,t){if(typeof n=="number")return Ti(n,e);if(n.length!==e)throw new G(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let s=0;s<e;++s){const o=n[s];if(!z4(o))throw new G(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${o}`)}return n}function Ys(n,e,t,s,o=1){if(n==null)return n;const r=e+(e-1)*(o-1);let i;return t==="same"?i=n:i=n-r+1,Math.floor((i+s-1)/s)}function po(n,e,t,s){if(n==null)return null;if(s==="valid")n=n*e+Tr([t-e,0]);else if(s==="same")n=n*e;else throw new G(`Unsupport padding mode: ${s}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function a1(n,e){return se(()=>(Bt(e),e==="channelsFirst"?nt(n,[0,2,3,1]):n))}function L2(n,e){return se(()=>(Bt(e),e==="channelsFirst"?nt(n,[0,2,3,4,1]):n))}function iV(n,e,t,s=1,o="valid",r,i=1){return se(()=>{if(r==null&&(r=Js()),Bt(r),n.shape.length!==3)throw new G(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new G(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new G(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(r==="channelsFirst"&&(n=nt(n,[0,2,1])),o==="causal")throw new He("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=pS(n,e,s,o==="same"?"same":"valid","NWC",i);return t!=null&&(a=eo(a,t)),a})}function Vk(n,e,t,s=[1,1],o="valid",r,i,a=null){return se(()=>{if(r==null&&(r=Js()),Bt(r),n.rank!==3&&n.rank!==4)throw new G(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new G(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let u=a1(n,r);if(o==="causal")throw new He("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=f3({x:u,filter:e,strides:s,pad:o==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:t,activation:a}),r==="channelsFirst"&&(u=nt(u,[0,3,1,2])),u})}function aV(n,e,t,s=[1,1,1],o="valid",r,i){return se(()=>{if(r==null&&(r=Js()),Bt(r),n.rank!==4&&n.rank!==5)throw new G(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new G(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let a=L2(n,r);if(o==="causal")throw new He("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=dL(a,e,s,o==="same"?"same":"valid","NDHWC",i),t!=null&&(a=eo(a,t)),r==="channelsFirst"&&(a=nt(a,[0,4,1,2,3])),a})}class hf extends Xe{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",hf.verifyArgs(t),this.rank=e,on(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new He(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Na(t.kernelSize,e,"kernelSize"),this.strides=Na(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,ms(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Bt(this.dataFormat),this.activation=Rr(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=Nt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Qt(t.biasConstraint),this.biasRegularizer=Tt(t.biasRegularizer),this.activityRegularizer=Tt(t.activityRegularizer),this.dilationRate=Na(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new G(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new G(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new G(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(ho("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!q0(e.kernelSize,"number",1,3))throw new G(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Er(this.activation),useBias:this.useBias,biasInitializer:At(this.biasInitializer),biasRegularizer:bt(this.biasRegularizer),activityRegularizer:bt(this.activityRegularizer),biasConstraint:Yt(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class Ka extends hf{constructor(e,t){super(e,t),this.kernel=null,Ka.verifyArgs(t),this.filters=t.filters,on(this.filters,"filters"),this.kernelInitializer=Nt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Qt(t.kernelConstraint),this.kernelRegularizer=Tt(t.kernelRegularizer)}build(e){e=rt(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new G(`The channel dimension of the input should be defined. Found ${e[t]}`);const s=e[t],o=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:s}}],this.built=!0}call(e,t){return se(()=>{e=Ve(e);let s;const o=this.bias==null?null:this.bias.read(),r=D$(this.activation.getClassName());if(r!=null&&this.rank===2)s=Vk(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(this.rank===1)s=iV(e,this.kernel.read(),o,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=Vk(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=aV(e,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new He("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=rt(e);const t=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let r=0;r<s.length;++r){const i=Ys(s[r],this.kernelSize[r],this.padding,this.strides[r],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[r]);t.push(i)}let o=[e[0]];return this.dataFormat==="channelsLast"?(o=o.concat(t),o.push(this.filters)):(o.push(this.filters),o=o.concat(t)),o}getConfig(){const e={filters:this.filters,kernelInitializer:At(this.kernelInitializer),kernelRegularizer:bt(this.kernelRegularizer),kernelConstraint:Yt(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new G(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Sc extends Ka{constructor(e){super(2,e),Sc.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!q0(e.kernelSize,"number",1,2))throw new G(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Sc.className="Conv2D";fe(Sc);class $c extends Ka{constructor(e){super(3,e),$c.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new G(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}$c.className="Conv3D";fe($c);class M2 extends Sc{constructor(e){if(super(e),this.inputSpec=[new Xt({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new G(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=rt(e),e.length!==4)throw new G("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new G("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],o=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Xt({ndim:4,axes:{[t]:s}})],this.built=!0}call(e,t){return se(()=>{let s=Ve(e);if(s.shape.length!==4)throw new G(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const o=s.shape,r=o[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const u=o[i],d=o[a],h=this.kernelSize[0],p=this.kernelSize[1],f=this.strides[0],g=this.strides[1],y=po(u,f,h,this.padding),b=po(d,g,p,this.padding),v=[r,y,b,this.filters];this.dataFormat!=="channelsLast"&&(s=nt(s,[0,2,3,1]));let w=fS(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=nt(w,[0,3,1,2])),this.bias!=null&&(w=eo(w,this.bias.read(),this.dataFormat)),this.activation!=null&&(w=this.activation.apply(w)),w})}computeOutputShape(e){e=rt(e);const t=e.slice();let s,o,r;this.dataFormat==="channelsFirst"?(s=1,o=2,r=3):(s=3,o=1,r=2);const i=this.kernelSize[0],a=this.kernelSize[1],u=this.strides[0],d=this.strides[1];return t[s]=this.filters,t[o]=po(t[o],u,i,this.padding),t[r]=po(t[r],d,a,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}M2.className="Conv2DTranspose";fe(M2);class P2 extends $c{constructor(e){if(super(e),this.inputSpec=[new Xt({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new G(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=rt(e),e.length!==5)throw new G("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new G("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],o=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Xt({ndim:5,axes:{[t]:s}})],this.built=!0}call(e,t){return se(()=>{let s=Ve(e);if(s.shape.length!==5)throw new G(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const o=s.shape,r=o[0];let i,a,u;this.dataFormat==="channelsFirst"?(u=2,i=3,a=4):(u=1,i=2,a=3);const d=o[u],h=o[i],p=o[a],f=this.kernelSize[0],g=this.kernelSize[1],y=this.kernelSize[2],b=this.strides[0],v=this.strides[1],w=this.strides[2],C=po(d,b,f,this.padding),$=po(h,v,g,this.padding),S=po(p,w,y,this.padding),N=[r,C,$,S,this.filters];this.dataFormat!=="channelsLast"&&(s=nt(s,[0,2,3,4,1]));let R=fL(s,this.kernel.read(),N,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(R=nt(R,[0,4,1,2,3])),this.bias!==null&&(R=eo(R,this.bias.read(),this.dataFormat)),this.activation!==null&&(R=this.activation.apply(R)),R})}computeOutputShape(e){e=rt(e);const t=e.slice();let s,o,r,i;this.dataFormat==="channelsFirst"?(s=1,o=2,r=3,i=4):(s=4,o=1,r=2,i=3);const a=this.kernelSize[0],u=this.kernelSize[1],d=this.kernelSize[2],h=this.strides[0],p=this.strides[1],f=this.strides[2];return t[s]=this.filters,t[o]=po(t[o],h,a,this.padding),t[r]=po(t[r],p,u,this.padding),t[i]=po(t[i],f,d,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}P2.className="Conv3DTranspose";fe(P2);class z2 extends Ka{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new G("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new G("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new G(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=Nt(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Tt(t.depthwiseRegularizer),this.depthwiseConstraint=Qt(t.depthwiseConstraint),this.pointwiseInitializer=Nt(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Tt(t.pointwiseRegularizer),this.pointwiseConstraint=Qt(t.pointwiseConstraint)}build(e){if(e=rt(e),e.length<this.rank+2)throw new G(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new G(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const s=e[t],o=this.kernelSize.concat([s,this.depthMultiplier]),r=[];for(let a=0;a<this.rank;++a)r.push(1);r.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",r,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Xt({ndim:this.rank+2,axes:{[t]:s}})],this.built=!0}call(e,t){return se(()=>{e=Ve(e);let s;if(this.rank===1)throw new He("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=nt(e,[0,2,3,1])),s=DS(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=eo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=nt(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=At(this.depthwiseInitializer),e.pointwiseInitializer=At(this.pointwiseInitializer),e.depthwiseRegularizer=bt(this.depthwiseRegularizer),e.pointwiseRegularizer=bt(this.pointwiseRegularizer),e.depthwiseConstraint=Yt(this.depthwiseConstraint),e.pointwiseConstraint=Yt(this.pointwiseConstraint),e}}z2.className="SeparableConv";class B2 extends z2{constructor(e){super(2,e)}}B2.className="SeparableConv2D";fe(B2);class pf extends Ka{constructor(e){super(1,e),pf.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!q0(e.kernelSize,"number",1,1))throw new G(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}pf.className="Conv1D";fe(pf);class W2 extends Xe{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return se(()=>{if(e=Ve(e),this.dataFormat==="channelsLast"){const s=qd(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return qd(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=qd(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return qd(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}W2.className="Cropping2D";fe(W2);class V2 extends Xe{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Bt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,L4(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,s]}else{const t=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],t,s,e[3]]}}call(e,t){return se(()=>{let s=Ve(e);const o=s.shape;if(this.dataFormat==="channelsFirst"){s=nt(s,[0,2,3,1]);const r=this.size[0]*o[2],i=this.size[1]*o[3],a=this.interpolation==="nearest"?zo.resizeNearestNeighbor(s,[r,i]):zo.resizeBilinear(s,[r,i]);return nt(a,[0,3,1,2])}else{const r=this.size[0]*o[1],i=this.size[1]*o[2];return this.interpolation==="nearest"?zo.resizeNearestNeighbor(s,[r,i]):zo.resizeBilinear(s,[r,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}V2.className="UpSampling2D";fe(V2);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lV(n,e,t=[1,1],s="valid",o,r){return se(()=>{o==null&&(o=Js()),Bt(o);let i=a1(n,o);if(n.rank!==4)throw new G(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new G(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=Xx(i,e,t,s==="same"?"same":"valid","NHWC",r),o==="channelsFirst"&&(i=nt(i,[0,3,1,2])),i})}class U2 extends hf{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Nt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Qt(e.depthwiseConstraint),this.depthwiseRegularizer=Tt(e.depthwiseRegularizer)}build(e){if(e=rt(e),e.length<4)throw new G(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new G(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const s=e[t],o=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",o,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return se(()=>{e=Ve(e);let s=lV(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=eo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=rt(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],o=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=Ys(t,this.kernelSize[0],this.padding,this.strides[0]),i=Ys(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],o,r,i]:[e[0],r,i,o]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=At(this.depthwiseInitializer),e.depthwiseRegularizer=bt(this.depthwiseRegularizer),e.depthwiseConstraint=Yt(this.depthwiseRegularizer),e}}U2.className="DepthwiseConv2D";fe(U2);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function G2(n,e,t,s){if(Array.isArray(n)){if(e!=null||t!=null)throw new G("When inputs is an array, neither initialState or constants should be provided");s!=null&&(t=n.slice(n.length-s,n.length),n=n.slice(0,n.length-s)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function o(r){return r==null||Array.isArray(r)?r:[r]}return e=o(e),t=o(t),{inputs:n,initialState:e,constants:t}}function j2(n,e,t,s=!1,o,r,i=!1,a=!1){return se(()=>{const u=e.shape.length;if(u<3)throw new G(`Input should be at least 3D, but is ${u}D.`);const d=[1,0].concat(Qs(2,u));e=nt(e,d),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),o!=null&&(o=$e($e(o,"bool"),"float32"),o.rank===u-1&&(o=zn(o,-1)),o=nt(o,d)),s&&(e=$i(e,0),o!=null&&(o=$i(o,0)));const h=[];let p,f=t;const g=e.shape[0],y=Ni(e);let b;o!=null&&(b=Ni(o));for(let w=0;w<g;++w){const C=y[w],$=se(()=>n(C,f));if(o==null)p=$[0],f=$[1];else{const S=se(()=>{const N=b[w],R=We(As(N),N),F=xe(j($[0],N),j(f[0],R)),O=f.map((D,A)=>xe(j($[1][A],N),j(D,R)));return{output:F,newStates:O}});p=S.output,f=S.newStates}a&&h.push(p)}let v;return a&&(v=Go(h,1)),[p,v,f]})}class Br extends Xe{constructor(e){super(e);let t;if(e.cell==null)throw new G("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new c1({cells:e.cell}):t=e.cell,t.stateSize==null)throw new G("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Xt({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Qs(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){ky(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const s=t[0];let o;if(this.returnSequences?o=[e[0],e[1],s]:o=[e[0],s],this.returnState){const r=[];for(const i of t)r.push([e[0],i]);return[o].concat(r)}else return o}computeMask(e,t){return se(()=>{Array.isArray(t)&&(t=t[0]);const s=this.returnSequences?t:null;if(this.returnState){const o=this.states.map(r=>null);return[s].concat(o)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let s=0;s<e;++s)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new He("Constants support is not implemented in RNN yet.");ky(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Xt({shape:[t,null,...s]});const o=[e[0]].concat(e.slice(2));this.cell.build(o);let r;if(Array.isArray(this.cell.stateSize)?r=this.cell.stateSize:r=[this.cell.stateSize],this.stateSpec!=null){if(!ht(this.stateSpec.map(i=>i.shape[i.shape.length-1]),r))throw new G(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=r.map(i=>new Xt({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){se(()=>{if(!this.stateful)throw new co("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new G("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(o=>sn([s,o])):this.states_=[sn([s,this.cell.stateSize])];else if(e==null)Ye(this.states_),this.keptStates!=null&&(Ye(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(o=>sn([s,o])):this.states_[0]=sn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new G(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):Ye(this.states_);for(let o=0;o<this.states_.length;++o){const r=e[o],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[o]:this.cell.stateSize,a=[s,i];if(!ht(r.shape,a))throw new G(`State ${o} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${r.shape}`);this.states_[o]=r}}this.states_=this.states_.map(o=>yo(o.clone()))})}apply(e,t){let s=t==null?null:t.initialState,o=t==null?null:t.constants;t==null&&(t={});const r=G2(e,s,o,this.numConstants);e=r.inputs,s=r.initialState,o=r.constants;let i=[],a=[];if(s!=null){t.initialState=s,i=i.concat(s),this.stateSpec=[];for(const d of s)this.stateSpec.push(new Xt({shape:d.shape}));a=a.concat(this.stateSpec)}if(o!=null&&(t.constants=o,i=i.concat(o),this.numConstants=o.length),i[0]instanceof Io){const d=[e].concat(i),h=this.inputSpec.concat(a),p=this.inputSpec;this.inputSpec=h;const f=super.apply(d,t);return this.inputSpec=p,f}else return super.apply(e,t)}call(e,t){return se(()=>{const s=t==null?null:t.mask,o=t==null?null:t.training;let r=t==null?null:t.initialState;e=Ve(e),r==null&&(this.stateful?r=this.states_:r=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(r.length!==i)throw new G(`RNN Layer has ${i} state(s) but was passed ${r.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:o},d=j2((y,b)=>{const v=this.cell.call([y].concat(b),a);return[v[0],v.slice(1)]},e,r,this.goBackwards,s,null,this.unroll,this.returnSequences),h=d[0],p=d[1],f=d[2];this.stateful&&this.resetStates(f,o);const g=this.returnSequences?p:h;return this.returnState?[g].concat(f):g})}getInitialState(e){return se(()=>{let t=sn(e.shape);return t=Le(t,[1,2]),t=vc(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?vy(t,[1,s]):t):this.cell.stateSize>1?[vy(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Br.className&&(t.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),t)}static fromConfig(e,t,s={}){const o=t.cell,r=Wo(o,s);return new e(Object.assign(t,{cell:r}))}}Br.className="RNN";fe(Br);class ff extends Xe{}class l1 extends ff{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,on(this.units,"units"),this.activation=Rr(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Nt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Nt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Nt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Tt(e.kernelRegularizer),this.recurrentRegularizer=Tt(e.recurrentRegularizer),this.biasRegularizer=Tt(e.biasRegularizer),this.kernelConstraint=Qt(e.kernelConstraint),this.recurrentConstraint=Qt(e.recurrentConstraint),this.biasConstraint=Qt(e.biasConstraint),this.dropout=Fa([1,Tr([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Fa([1,Tr([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=rt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return se(()=>{if(e=e,e.length!==2)throw new G(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const o=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ar({ones:()=>As(e),rate:this.dropout,training:o,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ar({ones:()=>As(s),rate:this.recurrentDropout,training:o,dropoutFunc:this.dropoutFunc}));let r;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?r=vo(j(e,i),this.kernel.read()):r=vo(e,this.kernel.read()),this.bias!=null&&(r=eo(r,this.bias.read())),a!=null&&(s=j(s,a));let u=xe(r,vo(s,this.recurrentKernel.read()));return this.activation!=null&&(u=this.activation.apply(u)),[u,u]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Er(this.activation),useBias:this.useBias,kernelInitializer:At(this.kernelInitializer),recurrentInitializer:At(this.recurrentInitializer),biasInitializer:At(this.biasInitializer),kernelRegularizer:bt(this.kernelRegularizer),recurrentRegularizer:bt(this.recurrentRegularizer),biasRegularizer:bt(this.biasRegularizer),activityRegularizer:bt(this.activityRegularizer),kernelConstraint:Yt(this.kernelConstraint),recurrentConstraint:Yt(this.recurrentConstraint),biasConstraint:Yt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}l1.className="SimpleRNNCell";fe(l1);class H2 extends Br{constructor(e){e.cell=new l1(e),super(e)}call(e,t){return se(()=>{this.cell.dropoutMask!=null&&(Ye(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ye(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,o=t==null?null:t.training,r=t==null?null:t.initialState;return super.call(e,{mask:s,training:o,initialState:r})})}static fromConfig(e,t){return new e(t)}}H2.className="SimpleRNN";fe(H2);class u1 extends ff{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new G("GRUCell does not support reset_after parameter set to true.");this.units=e.units,on(this.units,"units"),this.activation=Rr(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Rr(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Nt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Nt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Nt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Tt(e.kernelRegularizer),this.recurrentRegularizer=Tt(e.recurrentRegularizer),this.biasRegularizer=Tt(e.biasRegularizer),this.kernelConstraint=Qt(e.kernelConstraint),this.recurrentConstraint=Qt(e.recurrentConstraint),this.biasConstraint=Qt(e.biasConstraint),this.dropout=Fa([1,Tr([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Fa([1,Tr([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=rt(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return se(()=>{if(e=e,e.length!==2)throw new G(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training==null?!1:t.training;let o=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ar({ones:()=>As(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ar({ones:()=>As(o),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const r=this.dropoutMask,i=this.recurrentDropoutMask;let a,u,d;0<this.dropout&&this.dropout<1&&(e=j(e,r[0]));let h=vo(e,this.kernel.read());this.useBias&&(h=eo(h,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(o=j(o,i[0]));const p=this.recurrentKernel.read(),[f,g]=hs(p,[2*this.units,this.units],p.rank-1),y=vo(o,f),[b,v,w]=hs(h,3,h.rank-1),[C,$]=hs(y,2,y.rank-1);a=this.recurrentActivation.apply(xe(b,C)),u=this.recurrentActivation.apply(xe(v,$));const S=vo(j(u,o),g);d=this.activation.apply(xe(w,S));const N=xe(j(a,o),j(xe(1,Mt(a)),d));return[N,N]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Er(this.activation),recurrentActivation:Er(this.recurrentActivation),useBias:this.useBias,kernelInitializer:At(this.kernelInitializer),recurrentInitializer:At(this.recurrentInitializer),biasInitializer:At(this.biasInitializer),kernelRegularizer:bt(this.kernelRegularizer),recurrentRegularizer:bt(this.recurrentRegularizer),biasRegularizer:bt(this.biasRegularizer),activityRegularizer:bt(this.activityRegularizer),kernelConstraint:Yt(this.kernelConstraint),recurrentConstraint:Yt(this.recurrentConstraint),biasConstraint:Yt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}u1.className="GRUCell";fe(u1);class q2 extends Br{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new u1(e),super(e)}call(e,t){return se(()=>{this.cell.dropoutMask!=null&&(Ye(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ye(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,o=t==null?null:t.training,r=t==null?null:t.initialState;return super.call(e,{mask:s,training:o,initialState:r})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}q2.className="GRU";fe(q2);class mf extends ff{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,on(this.units,"units"),this.activation=Rr(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Rr(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Nt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Nt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Nt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Tt(e.kernelRegularizer),this.recurrentRegularizer=Tt(e.recurrentRegularizer),this.biasRegularizer=Tt(e.biasRegularizer),this.kernelConstraint=Qt(e.kernelConstraint),this.recurrentConstraint=Qt(e.recurrentConstraint),this.biasConstraint=Qt(e.biasConstraint),this.dropout=Fa([1,Tr([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Fa([1,Tr([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=rt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let o;if(this.useBias){if(this.unitForgetBias){const r=this.biasInitializer,i=this.units;o=new(t=class extends Fs{apply(u,d){const h=r.apply([i]),p=new X0().apply([i]),f=r.apply([i*2]);return Sk(Sk(h,p),f)}},t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,o,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return se(()=>{const s=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new G(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let o=e[1];const r=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ar({ones:()=>As(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ar({ones:()=>As(o),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let u,d,h,p;0<this.dropout&&this.dropout<1&&(e=j(e,i[0]));let f=vo(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(o=j(o,a[0])),f=xe(f,vo(o,this.recurrentKernel.read())),this.useBias&&(f=eo(f,this.bias.read()));const[g,y,b,v]=hs(f,4,f.rank-1);u=this.recurrentActivation.apply(g),d=this.recurrentActivation.apply(y),h=xe(j(d,r),j(u,this.activation.apply(b))),p=this.recurrentActivation.apply(v);const w=j(p,this.activation.apply(h));return[w,w,h]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Er(this.activation),recurrentActivation:Er(this.recurrentActivation),useBias:this.useBias,kernelInitializer:At(this.kernelInitializer),recurrentInitializer:At(this.recurrentInitializer),biasInitializer:At(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:bt(this.kernelRegularizer),recurrentRegularizer:bt(this.recurrentRegularizer),biasRegularizer:bt(this.biasRegularizer),activityRegularizer:bt(this.activityRegularizer),kernelConstraint:Yt(this.kernelConstraint),recurrentConstraint:Yt(this.recurrentConstraint),biasConstraint:Yt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}mf.className="LSTMCell";fe(mf);class K2 extends Br{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new mf(e),super(e)}call(e,t){return se(()=>{this.cell.dropoutMask!=null&&(Ye(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ye(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,o=t==null?null:t.training,r=t==null?null:t.initialState;return super.call(e,{mask:s,training:o,initialState:r})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}K2.className="LSTM";fe(K2);class c1 extends ff{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return se(()=>{e=e;let s=e.slice(1);const o=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?o.push(s.splice(0,a.stateSize.length)):o.push(s.splice(0,1));o.reverse();const r=[];let i;for(let a=0;a<this.cells.length;++a){const u=this.cells[a];s=o[a],a===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=u.call(i,t),r.push(i.slice(1))}s=[];for(const a of r.slice().reverse())s.push(...a);return[i[0]].concat(s)})}build(e){ky(e)&&(e=e[0]),e=e;let t;this.cells.forEach((s,o)=>{gi(`RNNCell_${o}`,()=>{s.build(e),Array.isArray(s.stateSize)?t=s.stateSize[0]:t=s.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=r=>({className:r.getClassName(),config:r.getConfig()}),o={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),o)}static fromConfig(e,t,s={}){const o=[];for(const r of t.cells)o.push(Wo(r,s));return new e({cells:o})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.cells)t.push(...s.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return Cy(e)}setWeights(e){const t=[];for(const s of this.cells){const o=s.weights.length,r=e.splice(o);for(let i=0;i<s.weights.length;++i)t.push([s.weights[i],r[i]])}n1(t)}}c1.className="StackedRNNCells";fe(c1);function Ar(n){const{ones:e,rate:t,training:s=!1,count:o=1,dropoutFunc:r}=n,i=()=>r!=null?r(e(),t):z$(e(),t),a=()=>kc(i,e,s);return!o||o<=1?yo(a().clone()):Array(o).fill(void 0).map(a).map(d=>yo(d.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var uV=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t};class X2 extends Br{constructor(e){if(e.unroll)throw new He("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new He("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Xt({ndim:5})]}call(e,t){return se(()=>{if(this.cell.dropoutMask!=null&&(Ye(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ye(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new G("ConvRNN2D cell does not support constants");const s=t==null?null:t.mask,o=t==null?null:t.training,r=t==null?null:t.initialState;return super.call(e,{mask:s,training:o,initialState:r})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return se(()=>{const{stateSize:t}=this.cell,s=e.shape,o=this.computeSingleOutputShape(s),r=[o[0],...o.slice(2)],i=sn(r);return Array.isArray(t)?Array(t.length).fill(i):[i]})}resetStates(e,t=!1){se(()=>{if(!this.stateful)throw new co("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,o=this.computeSingleOutputShape(s),r=[o[0],...o.slice(2)];if(s[0]==null)throw new G("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>sn(r)):this.states_=[sn(r)];else if(e==null)Ye(this.states_),this.keptStates!=null&&(Ye(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>sn(r)):this.states_[0]=sn(r);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new G(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):Ye(this.states_);for(let a=0;a<this.states_.length;++a){const u=e[a],d=r;if(!ht(u.shape,d))throw new G(`State ${a} is incompatible with layer ${this.name}: expected shape=${d}, received shape=${u.shape}`);this.states_[a]=u}}this.states_=this.states_.map(a=>yo(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:s,kernelSize:o,padding:r,strides:i,dilationRate:a}=this.cell,u=t==="channelsFirst",d=e[u?3:2],h=e[u?4:3],p=Ys(d,o[0],r,i[0],a[0]),f=Ys(h,o[1],r,i[1],a[1]);return[...e.slice(0,2),...u?[s,p,f]:[p,f,s]]}}X2.className="ConvRNN2D";class d1 extends mf{constructor(e){const{filters:t,kernelSize:s,strides:o,padding:r,dataFormat:i,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,on(this.filters,"filters"),this.kernelSize=Na(s,2,"kernelSize"),this.kernelSize.forEach(u=>on(u,"kernelSize")),this.strides=Na(o||1,2,"strides"),this.strides.forEach(u=>on(u,"strides")),this.padding=r||"valid",ms(this.padding),this.dataFormat=i||"channelsLast",Bt(this.dataFormat),this.dilationRate=Na(a||1,2,"dilationRate"),this.dilationRate.forEach(u=>on(u,"dilationRate"))}build(e){var t;e=rt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new G(`The channel dimension of the input should be defined. Found ${e[s]}`);const o=e[s],r=4,i=this.kernelSize.concat([o,this.filters*r]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*r]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let u;if(this.unitForgetBias){const d=this.biasInitializer,h=this.filters;u=new(t=class extends Fs{apply(f,g){const y=d.apply([h]),b=Pr([h]),v=d.apply([h*2]);return K0([y,b,v])}},t.className="CustomInit",t)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*r],null,u,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return se(()=>{if(e.length!==3)throw new G(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training||!1,o=e[0],r=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ar({ones:()=>As(o),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const u=this.dropoutMask,d=(Y,L,W)=>!L||!L[W]?Y:j(L[W],Y);let h=d(o,u,0),p=d(o,u,1),f=d(o,u,2),g=d(o,u,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ar({ones:()=>As(r),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const y=this.recurrentDropoutMask;let b=d(r,y,0),v=d(r,y,1),w=d(r,y,2),C=d(r,y,3);const $=3,[S,N,R,F]=hs(this.kernel.read(),a,$),[O,D,A,T]=this.useBias?hs(this.bias.read(),a):[null,null,null,null];h=this.inputConv(h,S,O,this.padding),p=this.inputConv(p,N,D,this.padding),f=this.inputConv(f,R,A,this.padding),g=this.inputConv(g,F,T,this.padding);const[B,U,Q,K]=hs(this.recurrentKernel.read(),a,$);b=this.recurrentConv(b,B),v=this.recurrentConv(v,U),w=this.recurrentConv(w,Q),C=this.recurrentConv(C,K);const J=this.recurrentActivation.apply(xe(h,b)),te=this.recurrentActivation.apply(xe(p,v)),P=xe(j(te,i),j(J,this.activation.apply(xe(f,w)))),X=j(this.recurrentActivation.apply(xe(g,C)),this.activation.apply(P));return[X,X,P]})}getConfig(){const e=super.getConfig(),t=uV(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),s)}inputConv(e,t,s,o){const r=Ii(e,t,this.strides,o||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?eo(r,s,this.dataFormat):r}recurrentConv(e,t){return Ii(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}d1.className="ConvLSTM2DCell";fe(d1);class Y2 extends X2{constructor(e){const t=new d1(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}Y2.className="ConvLSTM2D";fe(Y2);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class h1 extends Xe{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,s=[];for(let o=0;o<this.noiseShape.length;++o)s.push(this.noiseShape[o]==null?t[o]:this.noiseShape[o]);return s}call(e,t){return se(()=>{this.invokeCallHook(e,t);const s=Ve(e);if(0<this.rate&&this.rate<1){const o=t.training==null?!1:t.training,r=this.getNoiseShape(s);return kc(()=>z$(s,this.rate,r,this.seed),()=>s,o)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}h1.className="Dropout";fe(h1);class Q2 extends h1{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}Q2.className="SpatialDropout1D";fe(Q2);class p1 extends Xe{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,on(this.units,"units"),this.activation=Rr(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Nt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Nt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Qt(e.kernelConstraint),this.biasConstraint=Qt(e.biasConstraint),this.kernelRegularizer=Tt(e.kernelRegularizer),this.biasRegularizer=Tt(e.biasRegularizer),this.activityRegularizer=Tt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=rt(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=rt(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return se(()=>{this.invokeCallHook(e,t);const s=Ve(e),o=D$(this.activation.getClassName());let r;return o!=null?r=vo(s,this.kernel.read(),o,this.bias?this.bias.read():null):(r=vo(s,this.kernel.read()),this.bias!=null&&(r=eo(r,this.bias.read())),this.activation!=null&&(r=this.activation.apply(r))),r})}getConfig(){const e={units:this.units,activation:Er(this.activation),useBias:this.useBias,kernelInitializer:At(this.kernelInitializer),biasInitializer:At(this.biasInitializer),kernelRegularizer:bt(this.kernelRegularizer),biasRegularizer:bt(this.biasRegularizer),activityRegularizer:bt(this.activityRegularizer),kernelConstraint:Yt(this.kernelConstraint),biasConstraint:Yt(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}p1.className="Dense";fe(p1);class J2 extends Xe{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=rt(e);for(const t of e.slice(1))if(t==null)throw new G(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],$r(e,1)]}call(e,t){return se(()=>{this.invokeCallHook(e,t);let s=Ve(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const o=[0];for(let r=2;r<s.rank;++r)o.push(r);o.push(1),s=nt(s,o)}return V4(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}J2.className="Flatten";fe(J2);class Z2 extends Xe{constructor(e){super(e),this.supportsMasking=!0,this.activation=Rr(e.activation)}call(e,t){return se(()=>{this.invokeCallHook(e,t);const s=Ve(e);return this.activation.apply(s)})}getConfig(){const e={activation:Er(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}Z2.className="Activation";fe(Z2);class eN extends Xe{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return se(()=>(e=Ve(e),B4(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}eN.className="RepeatVector";fe(eN);class tN extends Xe{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const s="Total size of new array must be unchanged.",o=t.slice();let r=1,i=null;for(let u=0;u<o.length;++u){const d=o[u];if(this.isUnknown(d))if(i===null)i=u;else throw new G("Can only specifiy one unknown dimension.");else r*=d}const a=$r(e);if(i!==null){if(r===0||a%r!==0)throw new G(s);o[i]=a/r}else if(a!==r)throw new G(s);return o}computeOutputShape(e){let t=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return se(()=>{this.invokeCallHook(e,t);const s=Ve(e),o=s.shape,r=o.slice(0,1).concat(this.fixUnknownDimension(o.slice(1),this.targetShape));return Z(s,r)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}tN.className="Reshape";fe(tN);class nN extends Xe{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=Qs(1,e.dims.length+1);if(!ht(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Xt({ndim:this.dims.length+1})]}computeOutputShape(e){e=rt(e);const t=e.slice();return this.dims.forEach((s,o)=>{t[o+1]=e[s]}),t}call(e,t){return nt(Ve(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}nN.className="Permute";fe(nN);class sN extends Xe{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const s=Ve(e);return py(Ih(s,this.maskValue),-1)}call(e,t){return se(()=>{this.invokeCallHook(e,t);const s=Ve(e),i=py(Ih(s,this.maskValue),-1,!0);return j(s,$e(i,s.dtype))})}}sN.className="Masking";fe(sN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class oN extends Xe{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(ft(e.inputLength))}this.inputDim=e.inputDim,on(this.inputDim,"inputDim"),this.outputDim=e.outputDim,on(this.outputDim,"outputDim"),this.embeddingsInitializer=Nt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Tt(e.embeddingsRegularizer),this.activityRegularizer=Tt(e.activityRegularizer),this.embeddingsConstraint=Qt(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return se(()=>this.maskZero?(e=Ve(e),Ih(e,st(e))):null)}computeOutputShape(e){if(e=rt(e),this.inputLength==null)return[...e,this.outputDim];const t=ft(this.inputLength);if(t.length!==e.length-1)throw new G(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let o=0;o<t.length;++o){const r=t[o],i=e[o+1];if(r!=null&&i!=null&&r!==i)throw new G(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);r==null&&(t[s]=i),s++}}return[e[0],...t,this.outputDim]}call(e,t){return se(()=>{this.invokeCallHook(e,t);let s=Ve(e);s.dtype!=="int32"&&(s=bo(s,"int32"));const o=P$(this.embeddings.read(),Z(s,[s.size]));return Z(o,rt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:At(this.embeddingsInitializer),embeddingsRegularizer:bt(this.embeddingsRegularizer),activityRegularizer:bt(this.activityRegularizer),embeddingsConstraint:Yt(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}oN.className="Embedding";fe(oN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Mi extends Xe{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new He}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const s=e.slice(0,e.length-t.length);for(let o=0;o<t.length;++o){const r=e[e.length-t.length+o],i=t[o];if(r==null||i==null||r<0||i<0)s.push(null);else if(r===1)s.push(i);else if(i===1)s.push(r);else{if(r!==i)throw new G("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));s.push(r)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[rt(e)]),e=e,e.length<2)throw new G(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const r of e)r!=null&&r[0]!==null&&t.push(r[0]);if(t=Sr(t),t.length>1)throw new G(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const o=e.map(r=>r.length);e.indexOf(null)===-1&&Sr(o).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return se(()=>{if(e=e,this.reshapeRequired){const s=[],o=e.map(r=>r.rank);if(o.indexOf(null)===-1){const r=Tr(o);for(let i of e){const a=i.rank;for(let u=0;u<r-a;++u)i=vc(i,1);s.push(i)}return this.mergeFunction(s)}else{let r=!1;for(const u of e){const d=u.rank;if(d==null){const h=u.shape,p=h[0],f=h.slice(1).concat([p]);let g=Z(u,[p].concat($r(h.slice(1))));g=nt(g,[1,0]),g=Z(g,f),s.push(g),r=!0}else if(d>1){const h=Qs(1,d).concat([0]);s.push(nt(u,h)),r=!0}else s.push(u)}let i=this.mergeFunction(s);const a=i.rank;if(r){if(a==null){const u=i.shape,d=u.length,h=u[d-1],p=[h].concat(u.slice(0,u.length-1));i=Z(nt(Z(i,[-1,h]),[1,0]),p)}else if(a>1){const u=[a-1].concat(Qs(0,a-1));i=nt(i,u)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let o=1;o<e.length;++o){const r=e[o]==null?null:e[o].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}let s=[];for(const o of e)o!=null&&o[0]!==null&&s.push(o[0]);return s=Sr(s),s.length===1?t=s.concat(t):t=[null].concat(t),t}computeMask(e,t){return se(()=>{if(t==null)return null;if(!Array.isArray(t))throw new G("`mask` should be an Array");if(!Array.isArray(e))throw new G("`inputs` should be an Array");if(t.length!==e.length)throw new G(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(o=>o==null))return null;t=t.map(o=>o==null?o:zn(o,0));let s=t[0];for(let o=1;o<t.length-1;++o)s=Uo(s,t[o]);return s})}}class rN extends Mi{constructor(e){super(e)}mergeFunction(e){return se(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=xe(t,e[s]);return t})}}rN.className="Add";fe(rN);class iN extends Mi{constructor(e){super(e)}mergeFunction(e){return se(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=j(t,e[s]);return t})}}iN.className="Multiply";fe(iN);class aN extends Mi{constructor(e){super(e)}mergeFunction(e){return se(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=xe(t,e[s]);return j(1/e.length,t)})}}aN.className="Average";fe(aN);class lN extends Mi{constructor(e){super(e)}mergeFunction(e){return se(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=Mr(t,e[s]);return t})}}lN.className="Maximum";fe(lN);class uN extends Mi{constructor(e){super(e)}mergeFunction(e){return se(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=ou(t,e[s]);return t})}}uN.className="Minimum";fe(uN);class cN extends Mi{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new G("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const o of e)if(o!=null){t=!1;break}if(t)return;const s=[];for(let o=0;o<e.length;++o){const r=e[o].slice();r.splice(this.axis,1);let i=!1;for(const a of s)if(ht(a,r)){i=!0;break}i||s.push(r)}if(s.length>1)throw new G("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return se(()=>K0(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new G("A `Concatenate` layer should be called on a list of inputs.");const t=e,s=t[0].slice(),o=this.axis<0?s.length+this.axis:this.axis;for(const r of t.slice(1)){if(s[o]==null||r[o]==null){s[o]=null;break}s[o]+=r[o]}return s}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new G("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new G("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new G(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return se(()=>{let s=!0;if(t.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const o=[];for(let i=0;i<e.length;++i)t[i]==null?o.push($e(As(e[i]),"bool")):t[i].rank<e[i].rank?o.push(zn(t[i],-1)):o.push(t[i]);const r=Wn(o,this.axis);return hS(r,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}cN.className="Concatenate";fe(cN);function Gl(n,e){for(;n<0;)n+=e;return n}function cV(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new He("batchDot is not implemented for tensors of 4D or higher rank yet");if(_(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),_(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new He("batchDot is not implemented for complex64-type Tensors yet.");const s=n.shape.length,o=e.shape.length;t==null&&(t=[s-1,o-2]);const r=t;return se(()=>{let i;if(s>o){i=s-o;const u=[];for(let d=0;d<i;++d)u.push(1);e=Z(e,e.shape.concat(u))}else if(o>s){i=o-s;const u=[];for(let d=0;d<i;++d)u.push(1);n=Z(n,n.shape.concat(u))}else i=0;let a;if(n.shape.length===2&&e.shape.length===2)r[0]===r[1]?a=Le(j(n,e),r[0]):a=Le(j(nt(n,[1,0]),e),r[1]);else{const u=r[0]!==n.shape.length-1,d=r[1]===e.shape.length-1;a=ct(n,e,u,d)}if(i>0){let u;s>o?u=s+o-3:u=s-1;const d=[];for(let h=u;h<u+i;++h)d.push(h);a=fc(a,d)}return a.shape.length===1&&(a=zn(a,1)),a})}class dN extends Mi{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){_(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],s=e[1];if(t.length>3||s.length>3)throw new He("Dot layer does not support tensors of 4D or higher rank yet.");const o=this.interpretAxes(t,s);if(t[o[0]]!==s[o[1]])throw new G(`Dimension incompatibility: ${t[o[0]]} !== ${s[o[1]]}`)}mergeFunction(e){if(e.length!==2)throw new G(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],s=e[1],o;return Array.isArray(this.axes)?o=this.axes.map((r,i)=>Gl(r,e[i].shape.length)):o=[Gl(this.axes,t.shape.length),Gl(this.axes,s.shape.length)],this.normalize&&(t=Ah(t,o[0]),s=Ah(s,o[1])),cV(t,s,o)}interpretAxes(e,t){let s;return Array.isArray(this.axes)?s=this.axes:s=[Gl(this.axes,e.length),Gl(this.axes,t.length)],s}computeOutputShape(e){_(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),s=e[1].slice();if(t.length>3||s.length>3)throw new He("Dot layer does not support tensors of 4D or higher rank yet.");const o=this.interpretAxes(t,s);t.splice(o[0],1),s.splice(o[1],1),s.splice(0,1);const r=t.concat(s);return r.length===1&&r.push(1),r}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}dN.className="Dot";fe(dN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class hN extends Xe{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return se(()=>{this.invokeCallHook(e,t);const s=Ve(e);return kc(()=>xe(lf(s.shape,0,this.stddev),s),()=>s,t.training||!1)})}}hN.className="GaussianNoise";fe(hN);class pN extends Xe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return se(()=>{this.invokeCallHook(e,t);const s=Ve(e);return this.rate>0&&this.rate<1?kc(()=>{const r=Math.sqrt(this.rate/(1-this.rate));return j(s,lf(s.shape,1,r))},()=>s,t.training||!1):s})}}pN.className="GaussianDropout";fe(pN);class fN extends Xe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Ve(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return se(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return kc(()=>{const r=Ve(e),u=-1.6732632423543772*1.0507009873554805;let d=Fi(pc(s),this.rate);d=bo(d,"float32");const h=((1-this.rate)*(1+this.rate*u**2))**-.5,p=-h*u*this.rate,f=xe(j(r,d),j(xe(d,-1),u));return xe(j(f,h),p)},()=>Ve(e),t.training||!1)}return e})}}fN.className="AlphaDropout";fe(fN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lu(n,e,t,s,o,r=.001){let i;if(n.rank===2)i=WO(n,e,t,s,o,r);else if(n.rank===3)i=UO(n,e,t,s,o,r);else if(n.rank===4)i=jO(n,e,t,s,o,r);else throw new He(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return i}function dV(n,e,t,s,o=.001){return se(()=>{const r=n0(n,s),i=r.mean,a=r.variance;return[lu(n,i,a,t,e,o),i,a]})}function hV(n,e,t,s,o=.001){return se(()=>{const r=n0(n,s),i=r.mean,a=r.variance,u=[];for(const y of Qs(0,n.rank))s.indexOf(y)!==-1?u.push(1):u.push(n.shape[y]);const d=Z(i,u),h=Z(a,u),p=e==null?null:Z(e,u),f=t==null?null:Z(t,u);return[lu(n,d,h,f,p,o),i,a]})}function pV(n,e,t,s,o=.001){return ht(s.slice().sort(),Qs(0,n.rank-1))?dV(n,e,t,s,o):hV(n,e,t,s,o)}class mN extends Xe{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Nt(e.betaInitializer||"zeros"),this.gammaInitializer=Nt(e.gammaInitializer||"ones"),this.movingMeanInitializer=Nt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Nt(e.movingVarianceInitializer||"ones"),this.betaConstraint=Qt(e.betaConstraint),this.gammaConstraint=Qt(e.gammaConstraint),this.betaRegularizer=Tt(e.betaRegularizer),this.gammaRegularizer=Tt(e.gammaRegularizer)}build(e){e=rt(e);const t=this.axis>=0?this.axis:this.axis+e.length,s=e[t];if(s==null)throw new G(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Xt({ndim:e.length,axes:{[t]:s}})];const o=[s];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return se(()=>{const s=t.training==null?!1:t.training,o=Ve(e),r=o.shape,i=r.length,a=Qs(0,i),u=this.axis>=0?this.axis:this.axis+i;a.splice(u,1);const d=Ti(1,i);d[u]=r[u];const h=a.slice();h.sort();const p=!ht(h,Qs(0,i).slice(0,i-1)),f=()=>{if(p){const C=Z(this.movingMean.read(),d),$=Z(this.movingVariance.read(),d),S=this.center?Z(this.beta.read(),d):null,N=this.scale?Z(this.gamma.read(),d):null;return lu(o,C,$,S,N,this.epsilon)}else return lu(o,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return f();const[g,y,b]=pV(o,this.gamma.read(),this.beta.read(),a,this.epsilon),v=(C,$,S)=>{se(()=>{const N=1-S,R=C.read(),F=j(We(R,$),N);C.write(We(R,F))})};return(()=>{v(this.movingMean,y,this.momentum),v(this.movingVariance,b,this.momentum)})(),g})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:At(this.betaInitializer),gammaInitializer:At(this.gammaInitializer),movingMeanInitializer:At(this.movingMeanInitializer),movingVarianceInitializer:At(this.movingVarianceInitializer),betaRegularizer:bt(this.betaRegularizer),gammaRegularizer:bt(this.gammaRegularizer),betaConstraint:Yt(this.betaConstraint),gammaConstraint:Yt(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}mN.className="BatchNormalization";fe(mN);class gN extends Xe{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Nt(e.betaInitializer||"zeros"),this.gammaInitializer=Nt(e.gammaInitializer||"ones"),this.betaRegularizer=Tt(e.betaRegularizer),this.gammaRegularizer=Tt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=rt(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=t);for(const r of this.axis)if(r<0||r>=t)throw new Error(`Invalid axis: ${r}`);if(this.axis.length!==Sr(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(r=>e[r]),o=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,o):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,o):this.beta=null,this.built=!0}call(e,t){const s=Ve(e),o=s.shape,r=o.length;return se(()=>{let{mean:a,variance:u}=n0(s,this.axis,!0);const d=Ti(1,r);for(const b of this.axis)d[b]=o[b];const h=b=>b!=null&&b.shape.length!==r?Z(b,d):b;let p=this.scale?h(this.gamma.read()):null,f=this.center?h(this.beta.read()):null;const g=[],y=[];for(let b=0;b<r;++b)this.axis.indexOf(b)!==-1?(g.push(o[b]),y.push(1)):(g.push(1),y.push(o[b]));return a=qs(a,g),u=qs(u,g),p!=null&&(p=qs(p,y)),f!=null&&(f=qs(f,y)),lu(s,a,u,f,p,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:At(this.betaInitializer),gammaInitializer:At(this.gammaInitializer),betaRegularizer:bt(this.betaRegularizer),gammaRegularizer:bt(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}gN.className="LayerNormalization";fe(gN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fV(n,e,t){return se(()=>{if(n.rank!==4)throw new G(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new G("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=Js()),t!=="channelsLast"&&t!=="channelsFirst")throw new G(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return t==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],s0(n,s)})}class yN extends Xe{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Js():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new G(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,s;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new G(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new G(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[t,s]}this.inputSpec=[new Xt({ndim:4})]}computeOutputShape(e){e=rt(e);let t,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],t,s]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],t,s,e[3]])}call(e,t){return se(()=>fV(Ve(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}yN.className="ZeroPadding2D";fe(yN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gf(n,e,t,s,o,r){return se(()=>{Bt(o),_$(r),ms(s),t==null&&(t=[1,1]),s==null&&(s="valid"),o==null&&(o=Js()),r==null&&(r="max"),n=a1(n,o);let i;const a=s==="same"?"same":"valid";return r==="max"?i=t0(n,e,t,a):i=jx(n,e,t,a),o==="channelsFirst"&&(i=nt(i,[0,3,1,2])),i})}function xN(n,e,t,s,o,r){return se(()=>{Bt(o),_$(r),ms(s),t==null&&(t=[1,1,1]),s==null&&(s="valid"),o==null&&(o=Js()),r==null&&(r="max"),n=L2(n,o);let i;const a=s==="same"?"same":"valid";return r==="max"?i=EM(n,e,t,a):i=AO(n,e,t,a),o==="channelsFirst"&&(i=nt(i,[0,4,1,2,3])),i})}class bN extends Xe{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new G(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(on(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new G(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);on(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,ms(this.padding),this.inputSpec=[new Xt({ndim:3})]}computeOutputShape(e){e=rt(e);const t=Ys(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return se(()=>{this.invokeCallHook(e,t),e=vc(Ve(e),2);const s=this.poolingFunction(Ve(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return fc(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class vN extends bN{constructor(e){super(e)}poolingFunction(e,t,s,o,r){return Bt(r),ms(o),gf(e,t,s,o,r,"max")}}vN.className="MaxPooling1D";fe(vN);class wN extends bN{constructor(e){super(e)}poolingFunction(e,t,s,o,r){return Bt(r),ms(o),gf(e,t,s,o,r,"avg")}}wN.className="AveragePooling1D";fe(wN);class kN extends Xe{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new G(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];on(this.poolSize,"poolSize"),on(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Bt(this.dataFormat),ms(this.padding),this.inputSpec=[new Xt({ndim:4})]}computeOutputShape(e){e=rt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=Ys(t,this.poolSize[0],this.padding,this.strides[0]),s=Ys(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s]:[e[0],t,s,e[3]]}call(e,t){return se(()=>(this.invokeCallHook(e,t),this.poolingFunction(Ve(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class CN extends kN{constructor(e){super(e)}poolingFunction(e,t,s,o,r){return Bt(r),ms(o),gf(e,t,s,o,r,"max")}}CN.className="MaxPooling2D";fe(CN);class IN extends kN{constructor(e){super(e)}poolingFunction(e,t,s,o,r){return Bt(r),ms(o),gf(e,t,s,o,r,"avg")}}IN.className="AveragePooling2D";fe(IN);class SN extends Xe{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new G(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];on(this.poolSize,"poolSize"),on(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Bt(this.dataFormat),ms(this.padding),this.inputSpec=[new Xt({ndim:5})]}computeOutputShape(e){e=rt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],o=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=Ys(t,this.poolSize[0],this.padding,this.strides[0]),s=Ys(s,this.poolSize[1],this.padding,this.strides[1]),o=Ys(o,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s,o]:[e[0],t,s,o,e[4]]}call(e,t){return se(()=>(this.invokeCallHook(e,t),this.poolingFunction(Ve(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class $N extends SN{constructor(e){super(e)}poolingFunction(e,t,s,o,r){return Bt(r),ms(o),xN(e,t,s,o,r,"max")}}$N.className="MaxPooling3D";fe($N);class NN extends SN{constructor(e){super(e)}poolingFunction(e,t,s,o,r){return Bt(r),ms(o),xN(e,t,s,o,r,"avg")}}NN.className="AveragePooling3D";fe(NN);class TN extends Xe{constructor(e){super(e),this.inputSpec=[new Xt({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new He}}class EN extends TN{constructor(e){super(e||{})}call(e,t){return se(()=>{const s=Ve(e);return Gt(s,1)})}}EN.className="GlobalAveragePooling1D";fe(EN);class RN extends TN{constructor(e){super(e||{})}call(e,t){return se(()=>{const s=Ve(e);return Xs(s,1)})}}RN.className="GlobalMaxPooling1D";fe(RN);class AN extends Xe{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Bt(this.dataFormat),this.inputSpec=[new Xt({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new He}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class DN extends AN{call(e,t){return se(()=>{const s=Ve(e);return this.dataFormat==="channelsLast"?Gt(s,[1,2]):Gt(s,[2,3])})}}DN.className="GlobalAveragePooling2D";fe(DN);class FN extends AN{call(e,t){return se(()=>{const s=Ve(e);return this.dataFormat==="channelsLast"?Xs(s,[1,2]):Xs(s,[2,3])})}}FN.className="GlobalMaxPooling2D";fe(FN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _N extends Xe{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,s={}){const o=t.layer,r=Wo(o,s);delete t.layer;const i={layer:r};return Object.assign(i,t),new e(i)}}class ON extends _N{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=rt(e),e.length<3)throw new G(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=rt(e);const t=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(t),o=e[1];return[s[0],o].concat(s.slice(1))}call(e,t){return se(()=>(e=Ve(e),j2((i,a)=>[Ve(this.layer.call(i,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}ON.className="TimeDistributed";fe(ON);function mV(n){Li(O4,"BidirectionalMergeMode",n)}const gV="concat";class LN extends _N{constructor(e){super(e);const t=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=t,this.forwardLayer=Wo(s),t.goBackwards=t.goBackwards!==!0;const o={};if(o.className=e.layer.getClassName(),o.config=t,this.backwardLayer=Wo(o),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?gV:e.mergeMode,mV(this.mergeMode),e.weights)throw new He("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,s=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let s,o,r;return this.returnState&&(r=t.slice(1)),s=t[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,o=[s]):this.mergeMode==null?o=[s,s.slice()]:o=[s],this.returnState?this.mergeMode==null?o.concat(r).concat(r.slice()):[s].concat(r).concat(r.slice()):Bn(o)}apply(e,t){let s=t==null?null:t.initialState,o=t==null?null:t.constants;t==null&&(t={});const r=G2(e,s,o,this.numConstants);if(e=r.inputs,s=r.initialState,o=r.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&o==null)return super.apply(e,t);const i=[],a=[];if(s!=null){const d=s.length;if(d%2>0)throw new G("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=s,i.push(...s);const h=s.map(p=>new Xt({shape:p.shape}));this.forwardLayer.stateSpec=h.slice(0,d/2),this.backwardLayer.stateSpec=h.slice(d/2),a.push(...h)}if(o!=null)throw new He("Support for constants in Bidirectional layers is not implemented yet.");const u=i[0]instanceof Io;for(const d of i)if(d instanceof Io!==u)throw new G("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(u){const d=[e].concat(i),h=this.inputSpec.concat(a),p=this.inputSpec;this.inputSpec=h;const f=super.apply(d,t);return this.inputSpec=p,f}else return super.apply(e,t)}call(e,t){return se(()=>{const s=t.initialState;let o,r;if(s==null)o=this.forwardLayer.call(e,t),r=this.backwardLayer.call(e,t);else{const u=s.slice(0,s.length/2),d=s.slice(s.length/2);o=this.forwardLayer.call(e,Object.assign(t,{initialState:u})),r=this.backwardLayer.call(e,Object.assign(t,{initialState:d}))}let i;this.returnState&&(Array.isArray(o)&&(i=o.slice(1).concat(r.slice(1))),o=o[0],r=r[0]),this.returnSequences&&(r=$i(r,1));let a;return this.mergeMode==="concat"?a=K0([o,r]):this.mergeMode==="sum"?a=xe(o,r):this.mergeMode==="ave"?a=j(.5,xe(o,r)):this.mergeMode==="mul"?a=j(o,r):this.mergeMode==null&&(a=[o,r]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){gi(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),gi(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[t,t]:s=t:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const r=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(r).concat(r):[s].concat(r).concat(r)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const s=Wo(t.layer);if(delete t.layer,t.numConstants!=null)throw new He("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const o=t;return o.layer=s,new e(o)}}LN.className="Bidirectional";fe(LN);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class MN extends Xe{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return se(()=>(e=Ve(e),e.dtype!=="float32"&&(e=bo(e,"float32")),xe(j(e,this.scale),this.offset)))}}MN.className="Rescaling";fe(MN);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:yV,cropAndResize:xV}=zo;class PN extends Xe{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,s,o,r,i,a,u){return se(()=>{let d,h=!1;const p=t/i,f=s/a,g=(o+t)/i,y=(r+s)/a,b=[p,f,g,y],v=[];e.rank===3?(h=!0,d=Go([e])):d=e;for(let N=0;N<d.shape[0];N++)v.push(b);const w=nS(v,[v.length,4]),C=ru(0,v.length,1,"int32"),S=xV(d,w,C,[o,r],"nearest");return bo(h?Ve(Ni(S)):S,u)})}upsize(e,t,s,o){return se(()=>{const r=yV(e,[t,s]);return bo(r,o)})}call(e,t){return se(()=>{const s=Ve(e),o=s.dtype,r=s.shape,i=r[r.length-3],a=r[r.length-2];let u=0;i!==this.height&&(u=Math.floor((i-this.height)/2));let d=0;return a!==this.width&&(d=Math.floor((a-this.width)/2),d===0&&(d=1)),u>=0&&d>=0?this.centerCrop(s,u,d,this.height,this.width,i,a,o):this.upsize(e,this.height,this.width,o)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=rt(e);const t=e.length-3,s=e.length-2;return e[t]=this.height,e[s]=this.width,e}}PN.className="CenterCrop";fe(PN);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bV(n,e,t,s){let o=Ve(n);if(o.dtype!=="int32"&&(o=bo(o,"int32")),e==="int")return o;const r=o.shape;if(o.rank===0&&(o=zn(o,-1)),e==="oneHot"&&o.shape[o.shape.length-1]!==1&&(o=zn(o,-1)),o.rank>2)throw new G(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${r} which would result in output rank ${o.rank}.`);const i=["multiHot","oneHot"].includes(e),a=o;let u;if(typeof s<"u"&&e==="count"?u=nk(a,s,t,i):u=nk(a,[],t,i),e!=="tfIdf")return u;if(s)return j(u,s);throw new G("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zN extends Xe{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=rt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return se(()=>{e=Ve(e),e.dtype!=="int32"&&(e=bo(e,"int32"));let s;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new G(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);s=Ve(t.countWeights)}const o=Xs(e),r=kh(e),i=fs(this.numTokens,o).bufferSync().get(0),a=Fi(r,0).bufferSync().get(0);if(!(i&&a))throw new G(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return bV(e,this.outputMode,this.numTokens,s)})}}zN.className="CategoryEncoding";fe(zN);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const vV=["bilinear","nearest"],Uk=new Set(vV);class BN extends Xe{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(Uk.has(e.interpolation))this.interpolation=e.interpolation;else throw new G(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=rt(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return se(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return zo.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return zo.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...Uk]} are supported`)})}}BN.className="Resizing";fe(BN);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class WN{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}WN.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class VN extends Xe{constructor(e){super(e),this.randomGenerator=new WN(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}VN.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const wV=["bilinear","nearest"],Gk=new Set(wV);class UN extends VN{constructor(e){super(e);const{factor:t,interpolation:s="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new G(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new G(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new G(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(Gk.has(s))this.interpolation=s;else throw new G(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=rt(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return se(()=>{const s=Ve(e);this.imgHeight=s.shape[s.shape.length-3];const o=s.shape[s.shape.length-2];this.widthFactor=pc([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*o;r=Math.round(r);const i=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return zo.resizeBilinear(e,i);case"nearest":return zo.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...Gk]} are supported`)}})}}UN.className="RandomWidth";fe(UN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function f1(n){return new p1(n)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kV=ae();kV.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var jk;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(jk||(jk={}));var Hk;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(Hk||(Hk={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var qk;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(qk||(qk={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ee(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&_(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CV=BS;class yf extends Xy{nextDataId(){return yf.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new cI(this,ao())}write(e,t,s){this.firstUse&&(this.firstUse=!1,ae().get("IS_NODE")&&cs(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const o={id:this.nextDataId()};return this.data.set(o,{values:e,dtype:s,refCount:1}),o}makeTensorInfo(e,t,s){let o;if(t==="string"&&s!=null&&s.length>0&&mu(s[0])){const r=s.map(i=>Ir(i));o=this.write(r,e,t)}else o=this.write(s,e,t);return{dataId:o,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,s,o,r){this.data.set(e,{values:t,dtype:o,refCount:r})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:s}=this.data.get(e);if(t==="complex64"){const o=this.readSync(s.real.dataId),r=this.readSync(s.imag.dataId);return jo(o,r)}return HF(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(o=>Nr(o));return qe(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return qe(e.shape,e.dtype,t)}makeOutput(e,t,s){return ao().makeTensorFromTensorInfo(this.makeTensorInfo(t,s,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=Pn();return e(),{kernelMs:Pn()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ee([e],"where");const t=this.readSync(e.dataId);return CV(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}yf.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GN(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const IV=n=>{const{x:e}=n.inputs,t=n.backend;Ee(e,"abs");let s=new Float32Array(de(e.shape));const o=t.data.get(e.dataId).values;return s=GN(o),t.makeOutput(s,e.shape,e.dtype)},SV={kernelName:qh,backendName:"cpu",kernelFunc:IV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wt(n){return(e,t,s,o,r)=>{const i=je(e,t),a=i.length,u=Oe(i),d=de(i),h=xn(r,d),p=e.length,f=t.length,g=Oe(e),y=Oe(t),b=Aa(e,i),v=Aa(t,i);if(b.length+v.length===0)for(let w=0;w<h.length;++w)h[w]=n(s[w%s.length],o[w%o.length]);else for(let w=0;w<h.length;++w){const C=Wa(w,a,u),$=C.slice(-p);b.forEach(F=>$[F]=0);const S=go($,p,g),N=C.slice(-f);v.forEach(F=>N[F]=0);const R=go(N,f,y);h[w]=n(s[S],o[R])}return[h,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zn(n){const{inputs:e,backend:t}=n,{real:s,imag:o}=e,r=t.data.get(s.dataId).values,i=t.data.get(o.dataId).values,a=t.makeTensorInfo(s.shape,"complex64"),u=t.data.get(a.dataId);return u.complexTensorInfos={real:t.makeTensorInfo(s.shape,"float32",r),imag:t.makeTensorInfo(o.shape,"float32",i)},a}const $V={kernelName:lx,backendName:"cpu",kernelFunc:Zn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lh(n,e,t="float32"){if(t==="complex64"){const o=Lh(n,e,"float32"),r=Lh(n,e,"float32");return Zn({inputs:{real:o,imag:r},backend:n})}const s=bn(de(e),t);return n.makeTensorInfo(e,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function So(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const NV={kernelName:Lu,backendName:"cpu",kernelFunc:So};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ei(n){const{inputs:e,backend:t}=n,{input:s}=e,o=t.data.get(s.dataId).complexTensorInfos.real,r=t.data.get(o.dataId).values;return t.makeTensorInfo(o.shape,o.dtype,r)}const TV={kernelName:Dx,backendName:"cpu",kernelFunc:Ei};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jN(n,e,t,s){if(s==="int32"){const o=Int32Array.from(n);return[e,"int32",o]}if(s==="bool"){const o=Di([0],t),[r,i]=Wt((a,u)=>a!==u?1:0)(e,[],n,o,"bool");return[i,"bool",r]}throw new Error(`Error in Cast: failed to cast ${t} to ${s}`)}function Dr(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{dtype:r}=s;if(r==="complex64"){if(o.dtype==="complex64")return So({inputs:{x:o},backend:t});const h=Lh(t,o.shape,o.dtype),p=Dr({inputs:{x:o},backend:t,attrs:{dtype:"float32"}}),f=Zn({inputs:{real:p,imag:h},backend:t});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),f}if(o.dtype==="complex64"){const h=Ei({inputs:{input:o},backend:t}),p=Dr({inputs:{x:h},backend:t,attrs:{dtype:r}});return t.disposeIntermediateTensorInfo(h),p}if(!pI(o.dtype,r)){const h=So({inputs:{x:o},backend:t});return{dataId:h.dataId,shape:h.shape,dtype:r}}const i=t.data.get(o.dataId).values,[a,u,d]=jN(i,o.shape,o.dtype,r);return t.makeTensorInfo(a,u,d)}const EV={kernelName:Cu,backendName:"cpu",kernelFunc:Dr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zt(n,e,t,s){return t==null?({inputs:o,backend:r})=>{const{a:i,b:a}=o,u=r;Ee([i,a],n);const d=u.data.get(i.dataId).values,h=u.data.get(a.dataId).values,p=i.dtype==="string"?Ho(d):d,f=i.dtype==="string"?Ho(h):h,g=s||i.dtype,[y,b]=e(i.shape,a.shape,p,f,g);return u.makeTensorInfo(b,g,y)}:({inputs:o,backend:r})=>{const{a:i,b:a}=o,u=r;if(i.dtype==="complex64"||a.dtype==="complex64"){const d=Dr({inputs:{x:i},backend:u,attrs:{dtype:"complex64"}}),h=u.data.get(d.dataId),p=h.complexTensorInfos.real,f=h.complexTensorInfos.imag,g=u.data.get(p.dataId).values,y=u.data.get(f.dataId).values,b=Dr({inputs:{x:a},backend:u,attrs:{dtype:"complex64"}}),v=u.data.get(b.dataId),w=v.complexTensorInfos.real,C=v.complexTensorInfos.imag,$=u.data.get(w.dataId).values,S=u.data.get(C.dataId).values,[N,R,F]=t(i.shape,a.shape,g,y,$,S),O=u.makeTensorInfo(F,"float32",N),D=u.makeTensorInfo(F,"float32",R),A=Zn({inputs:{real:O,imag:D},backend:u});return u.disposeIntermediateTensorInfo(d),u.disposeIntermediateTensorInfo(b),u.disposeIntermediateTensorInfo(O),u.disposeIntermediateTensorInfo(D),A}else{const d=u.data.get(i.dataId).values,h=u.data.get(a.dataId).values,p=s||i.dtype,[f,g]=e(i.shape,a.shape,d,h,p);return u.makeTensorInfo(g,p,f)}}}function m1(n){return(e,t,s,o,r,i)=>{const a=je(e,t),u=de(a),d=a.length,h=Oe(a),p=xn("float32",u),f=xn("float32",u),g=Aa(e,a),y=Aa(t,a),b=jo(s,o),v=jo(r,i),w=e.length,C=Oe(e),$=t.length,S=Oe(t);if(g.length+y.length===0)for(let N=0;N<p.length;N++){const R=N%b.length,F=N%v.length,O=n(b[R*2],b[R*2+1],v[F*2],v[F*2+1]);p[N]=O.real,f[N]=O.imag}else for(let N=0;N<p.length;N++){const R=Wa(N,d,h),F=R.slice(-w);g.forEach(B=>F[B]=0);const O=go(F,w,C),D=R.slice(-$);y.forEach(B=>D[B]=0);const A=go(D,$,S),T=n(b[O*2],b[O*2+1],v[A*2],v[A*2+1]);p[N]=T.real,f[N]=T.imag}return[p,f,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HN=Wt((n,e)=>n+e),RV=m1((n,e,t,s)=>({real:n+t,imag:e+s})),Oa=Zt(Va,HN,RV),AV={kernelName:Va,backendName:"cpu",kernelFunc:Oa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1(n,e,t,s,o){const r=de(s),i=bn(o,t);for(let a=0;a<n.length;a++){const u=n[a];if(u<0)throw new Error("Input x must be non-negative!");u>=o||(r>0?i[u]+=e[a]:i[u]+=1)}return i}function qN(n,e,t,s=!1){const o=n.shape[0],r=n.shape[1],i=qe([o,t],e.dtype);for(let a=0;a<o;a++)for(let u=0;u<r;u++){const d=n.get(a,u);if(d<0)throw new Error("Input x must be non-negative!");d>=t||(s?i.set(1,a,d):e.size>0?i.set(i.get(a,d)+e.get(a,u),a,d):i.set(i.get(a,d)+1,a,d))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KN=Wt((n,e)=>n&e),DV=Zt(ax,KN),FV={kernelName:ax,backendName:"cpu",kernelFunc:DV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $o(n){return(e,t,s)=>{const o=Lt(t,e.length);for(let r=0;r<e.length;++r)o[r]=n(e[r],s);return o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mt(n,e,t){const s=$o(e);return Wr(n,s,t)}function Wr(n,e,t){return({inputs:s,attrs:o,backend:r})=>{const{x:i}=s;Ee(i,n);const a=r,u=a.data.get(i.dataId).values;let d;if(i.dtype==="string"){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");d=Ho(u)}else d=u;const h=t||i.dtype,p=e(d,h,o);return a.makeTensorInfo(i.shape,h,p)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XN=$o(n=>Math.ceil(n)),_V=Wr(Iu,XN),OV={kernelName:Iu,backendName:"cpu",kernelFunc:_V};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YN(n,e,t,s){const o=Lt(t,de(e));if(s&&t!=="string"){let r=0;n.forEach(i=>{const a=de(i.shape);o.set(i.vals,r),r+=a})}else{let r=0;n.forEach(i=>{const a=t==="string"?Ho(i.vals):i.vals;let u=0;for(let d=0;d<i.shape[0];++d){const h=d*e[1]+r;for(let p=0;p<i.shape[1];++p)o[h+p]=a[u++]}r+=i.shape[1]})}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QN=Wt((n,e)=>n===e?1:0),JN=Zt(lp,QN,null,"bool"),LV={kernelName:lp,backendName:"cpu",kernelFunc:JN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZN=$o(n=>Math.exp(n)),eT=Wr(Au,ZN,"float32"),MV={kernelName:Au,backendName:"cpu",kernelFunc:eT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tT=$o(n=>Math.expm1(n)),PV=Wr(Du,tT),zV={kernelName:Du,backendName:"cpu",kernelFunc:PV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nT=$o(n=>Math.floor(n)),BV=Wr(Fu,nT),WV={kernelName:Fu,backendName:"cpu",kernelFunc:BV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sT=Wt((n,e)=>Math.floor(n/e)),VV=Zt(_u,sT,null,"int32"),UV={kernelName:_u,backendName:"cpu",kernelFunc:VV};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oT(n,e,t,s,o,r,i,a,u){const d=qe([s,r],t);for(let h=0;h<s;h++){const p=[];let f=0;for(let g=0;g<o;g++){const y=n[h*o+g];f+=y*i[g],p.push(y)}if(f<0||f>=u/r)throw new Error(`Invalid indices: ${p} does not index into ${a}`);for(let g=0;g<r;g++)d.values[h*r+g]=e.get(...e.indexToLoc(f*r+g))}return d}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rT(n,e,t){const s=qe(t,n.dtype);for(let o=0;o<s.size;++o){const i=s.indexToLoc(o).slice(),a=i[0],u=i[2],d=e.locToIndex([a,u]);i[2]=e.values[d];const h=n.locToIndex(i);0<=h&&h<n.values.length&&(s.values[o]=n.values[h])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iT=Wt((n,e)=>n>e?1:0),GV=Zt(hp,iT,null,"bool"),jV={kernelName:hp,backendName:"cpu",kernelFunc:GV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aT=Wt((n,e)=>n>=e?1:0),HV=Zt(Ou,aT,null,"bool"),qV={kernelName:Ou,backendName:"cpu",kernelFunc:HV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lT=Wt((n,e)=>n<e?1:0),KV=Zt(fp,lT,null,"bool"),XV={kernelName:fp,backendName:"cpu",kernelFunc:KV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uT=Wt((n,e)=>n<=e?1:0),YV=Zt(mp,uT,null,"bool"),QV={kernelName:mp,backendName:"cpu",kernelFunc:YV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cT(n,e,t){const s=(e-n)/(t-1),o=bn(t,"float32");o[0]=n;for(let r=1;r<o.length;r++)o[r]=o[r-1]+s;return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dT=$o(n=>Math.log(n)),JV=Wr(Bu,dT),ZV={kernelName:Bu,backendName:"cpu",kernelFunc:JV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hT(n,e,t,s){const o=xn(s,de(t));for(let r=0;r<o.length;++r){const i=r*e;let a=n[i];for(let u=0;u<e;++u){const d=n[i+u];(Number.isNaN(d)||d>a)&&(a=d)}o[r]=a}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pT=Wt((n,e)=>Math.max(n,e)),eU=Zt(Vu,pT),tU={kernelName:Vu,backendName:"cpu",kernelFunc:eU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fT=Wt((n,e)=>Math.min(n,e)),nU=Zt(Uu,fT),sU={kernelName:Uu,backendName:"cpu",kernelFunc:nU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y1=Wt((n,e)=>n*e),oU=m1((n,e,t,s)=>({real:n*t-e*s,imag:n*s+e*t})),xf=Zt(ju,y1,oU),rU={kernelName:ju,backendName:"cpu",kernelFunc:xf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mT(n,e,t){const s=_r(-1,t);return y1([],e,s,n,t)}function iU(n){const{inputs:e,backend:t}=n,{x:s}=e;Ee(s,"neg");const o=t.data.get(s.dataId).values,[r,i]=mT(o,s.shape,s.dtype);return t.makeTensorInfo(i,s.dtype,r)}const aU={kernelName:$p,backendName:"cpu",kernelFunc:iU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gT=Wt((n,e)=>n!==e?1:0),lU=Zt(Np,gT,null,"bool"),uU={kernelName:Np,backendName:"cpu",kernelFunc:lU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1(n,e,t,s,o){const r=e.length,i=de(e),a=Oe(e),u=Oe(o),d=xn(t,de(o));for(let h=0;h<i;++h){const p=Wa(h,r,a),f=new Array(p.length);for(let y=0;y<f.length;y++)f[y]=p[s[y]];const g=go(f,r,u);d[g]=n[h]}return d}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Un(n){const{inputs:e,attrs:t,backend:s}=n,{x:o}=e,{perm:r}=t;Ee(o,"transpose");const i=o.shape.length,a=new Array(i);for(let p=0;p<a.length;p++)a[p]=o.shape[r[p]];const u=s.data.get(o.dataId).values,d=x1(u,o.shape,o.dtype,r,a);return{dataId:s.write(d,a,o.dtype),shape:a,dtype:o.dtype}}const cU={kernelName:Ca,backendName:"cpu",kernelFunc:Un};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yT(n,e,t,s){const[o,r]=rn(n,s),i=ts(e,"int32"),a=bn(de(o),i),u=de(r);for(let d=0;d<a.length;++d){const h=d*u;let p=1;for(let f=0;f<u;++f)p*=t[h+f];a[d]=p}return{outVals:a,outShape:o,outDtype:i}}function dU(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s;Ee(o,"prod");const a=o.shape.length,u=Ke(r,o.shape),d=Dt(u,a);let h=u,p=o;const f=[];d!=null&&(p=Un({inputs:{x:o},backend:t,attrs:{perm:d}}),f.push(p),h=zt(h.length,a));const g=t.data.get(p.dataId).values,{outVals:y,outShape:b,outDtype:v}=yT(p.shape,p.dtype,g,h);let w=b;return i&&(w=jt(b,u)),f.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.makeTensorInfo(w,v,y)}const hU={kernelName:Fp,backendName:"cpu",kernelFunc:dU};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pU(n,e,t){n.forEach((s,o)=>{if(s<0||s>=t){const r=Wa(o,e.length,Oe(e)).join(",");throw new Error(`indices[${r}] = ${s} is not in [0, ${t})`)}})}function fU(n,e){for(let t=0;t<n.length;++t){const s=n[t],o=t===n.length-1?e:n[t+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>o)throw new Error("Ragged splits must not point past values");for(let r=1;r<s.length;++r)if(s[r-1]>s[r])throw new Error("Ragged splits must be sorted in ascending order")}}function mU(n,e,t,s){const o=[];let r=0;const i=e.length-1+t.length,a=new Array(i).fill(null).map(()=>[0]);fU(t,s);let u=1;for(let d=0;d<e.length-1;++d){u*=e[d];const h=e[d+1];for(let p=1;p<u+1;++p)a[d].push(p*h)}for(let d=0;d<n.length;++d){let h=n[d],p=n[d]+1;for(let f=0;f<t.length;++f){const g=t[f],y=f+e.length-1;if(y>=0){const b=a[y],v=b[b.length-1]-g[h];for(let w=h;w<p;++w)a[y].push(g[w+1]+v)}h=g[h],p=g[p]}p!==h&&(o.push([h,p]),r+=p-h)}return{outSplits:a,valueSlices:o,numValues:r}}function gU(n){const e=[];for(let t=0;t<n.length;++t){const s=n[t].length,o=Lt("int32",s);e.push(o),n[t].forEach((r,i)=>o[i]=r)}return e}function Kk(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let s=e;s<n.length;s++)t[e-1]*=n[s];return t}function yU(n,e,t,s,o,r){const i=Kk(e,2)[1],a=Kk(r,2)[1];let u=0;for(const d of t)for(let h=d[0];h<d[1];++h){for(let p=0;p<s;++p)o[u*a+p]=n[h*i+p];++u}}function xU(n,e,t,s,o){const r=e.slice();r[0]=o;const i=Lt(t,de(r)),a=n.length,u=a===0?0:a/e[0];return yU(n,e,s,u,i,r),[i,r]}function xT(n,e,t,s,o,r,i,a){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const u=e[0][0]-1;if(pU(r,i,u),s.length===0)throw new Error("params.rank must be nonzero");const d=s[0],{outSplits:h,valueSlices:p,numValues:f}=mU(r,i,n,d),g=gU(h),y=xU(t,s,o,p,f);return[g,y[0],y[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xk=2147483647;function bT(n,e,t,s,o,r,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(o.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,u=o.length===0,d=i.length===0,h=[];a||h.push(e[0]),u||h.push(o[0]),d||h.push(i[0]);for(let v=1;v<h.length;++v)if(h[v]!==h[v-1])throw new Error("starts, limits, and deltas must have the same shape");const p=h.length===0?1:h[0],f=Lt("int32",p+1);f[0]=0;for(let v=0;v<p;++v){const w=a?n[0]:n[v],C=u?s[0]:s[v],$=d?r[0]:r[v];if($===0)throw new Error("Requires delta != 0");let S;if($>0&&C<w||$<0&&C>w)S=0;else if(S=Math.ceil(Math.abs((C-w)/$)),S>Xk)throw new Error(`Requires ((limit - start) / delta) <= ${Xk}`);f[v+1]=f[v]+S}const g=f[p],y=Lt(t,g);let b=0;for(let v=0;v<p;++v){const w=f[v+1]-f[v];let C=a?n[0]:n[v];const $=d?r[0]:r[v];for(let S=0;S<w;++S)y[b++]=C,C+=$}return[f,y]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ss=Hs;class Mh{constructor(e,t,s,o,r,i,a,u,d,h){this.shape=e,this.shapeShape=t,this.values=s,this.valuesShape=o,this.valuesDType=r,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=u,this.rowPartitionValuesShapes=d,this.rowPartitionTypes=r$(h),this.raggedRank=i$(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ss.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ss.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ss.VALUE_ROWIDS:return Mh.getMaxWidthValueRowID(t);case Ss.ROW_SPLITS:return Mh.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Ss[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let s=0;for(let o=0;o<t-1;++o){const r=e[o+1]-e[o];r>s&&(s=r)}return s}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let s=0,o=e[0],r=0;for(let i=1;i<t;++i){const a=e[i];a!==o&&(o=a,r=Math.max(i-s,r),s=i)}return Math.max(t-s,r)}tensorShapeFromTensor(e,t,s=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Qk(e,s)}calculateOutputSize(e){const t=this.valuesShape,s=this.defaultValueShape;a$(s,t);const o=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=o$(this.raggedRank,o,t);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,t,s){const o=Math.min(e,s),r=[];let i=0;for(let a=0;a<o;++a,i+=t)r.push(i);for(let a=o;a<e;++a)r.push(-1);return _(r.length===e,()=>"Final length of result must be equal to firstDimension."),r}calculateOutputIndexRowSplit(e,t,s,o){const r=e.length,i=[];for(let a=0;a<r-1;++a){const u=e[a+1]-e[a];let d=Math.min(o,u),h=t[a];h===-1&&(d=0);for(let p=0;p<d;++p)i.push(h),h+=s;for(let p=0;p<u-d;++p)i.push(-1)}if(r>0&&i.length!==e[r-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,s,o){const r=e.length,i=[];if(r===0)return[];let a=0,u=e[0];if(u>=t.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${t.length}`);let d=t[u];i.push(d);for(let h=1;h<r;++h){const p=e[h];if(p===u)d>=0&&(++a,a<o?d+=s:d=-1);else{if(a=0,u=p,p>=t.length)throw new Error(`Got nextValueRowId=${p} which is not less than ${t.length}`);d=t[p]}i.push(d)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,s,o){const r=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Ss.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(r,t,s,o);case Ss.ROW_SPLITS:if(r.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${r.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(r,t,s,o);default:throw new Error(`Unsupported partition type: ${Ss[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Ss.FIRST_DIM_SIZE:return e[0];case Ss.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ss.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ss[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),s=this.calculateOutputSize(t),o=new Array(this.raggedRank+1);o[o.length-1]=1;for(let u=o.length-2;u>=0;--u)o[u]=o[u+1]*s[u+1];const r=Qk(s,!1),i=Lt(this.valuesDType,de(r));if(o[0]*s[0]>0){let u=this.calculateFirstParentOutputIndex(t,o[0],s[0]);for(let d=1;d<=this.raggedRank;++d)u=this.calculateOutputIndex(d-1,u,o[d],s[d]);this.setOutput(this.raggedRank,u,i,r)}return[r,i]}setOutput(e,t,s,o){if(s.length===0)return;const r=this.values,i=s;let a=o.slice();a=a.slice(e+1);const u=de(a),d=t.length;let h=this.defaultValue;if(h.length!==u&&h.length!==1){const y=this.defaultValueShape;se(()=>{const b=Z(h,y);h=Jl(b,a).dataSync()})}let p=0,f=0,g=0;for(let y=0;y<=d;++y){let b=y<d?t[y]:-1;if(b===g){++g;continue}if(f<g){const v=r.subarray(p*u),w=i.subarray(f*u),C=(g-f)*u;Yk(w,v,C)}if(y>=d){const v=s.length;b=Math.floor(v/u)}if(b>g)if(this.defaultValue.length===1)i.subarray(g*u,b*u).fill(this.defaultValue[0]),g=b;else for(;b>g;){const v=i.slice(g*u);Yk(v,h,u),++g}b<0?(p=y+1,f=g):(p=y,f=g,g=f+1)}}}function Yk(n,e,t){for(let s=0;s<t;s++)n[s]=e[s]}function Qk(n,e){const t=[];for(let s of n){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}t.push(s)}return t}function vT(n,e,t,s,o,r,i,a,u,d){return new Mh(n,e,t,s,o,r,i,a,u,d).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wT(n,e,t,s){const o=n===e,r=n<e&&t<0,i=e<n&&t>1;if(o||r||i)return bn(0,s);const a=Math.abs(Math.ceil((e-n)/t)),u=bn(a,s);e<n&&t===1&&(t=-1),u[0]=n;for(let d=1;d<u.length;d++)u[d]=u[d-1]+t;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kT=$o(n=>1/Math.sqrt(n)),bU=Wr(Qu,kT),vU={kernelName:Qu,backendName:"cpu",kernelFunc:bU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pi(n,e,t,s,o,r,i,a,u,d){const h=[s/o,o],p=n.values,f=e.values;if(s===0)return qe(t,e.dtype);const g=u instanceof dn?u:qe(h,e.dtype);typeof u=="string"||typeof u=="number"?g.values.fill(u):typeof u=="boolean"&&g.values.fill(+u);for(let y=0;y<r;y++){const b=[];let v=0;for(let w=0;w<i;w++){const C=p[y*i+w];b.push(C),v+=C*a[w]}if(v<0||v>=s/o)throw new Error(`Invalid indices: ${b} does not index into ${t}`);for(let w=0;w<o;w++)d?g.values[v*o+w]+=f[y*o+w]:g.values[v*o+w]=e.rank===0?f[0]:f[y*o+w]}return g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wU=$o(n=>1/(1+Math.exp(-n))),CT=mt(nc,n=>1/(1+Math.exp(-n))),kU={kernelName:nc,backendName:"cpu",kernelFunc:CT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IT(n,e,t,s,o){const r=C0(s,e,t),i=de(t),a=Oe(s);if(r){const p=I0(e,a);return o==="string"?n.slice(p,p+i):n.subarray(p,p+i)}const u=o==="string"?Ho(n):n,d=qe(s,o,u),h=qe(t,o);for(let p=0;p<h.size;++p){const f=h.indexToLoc(p),g=f.map((y,b)=>y+e[b]);h.set(d.get(...g),...f)}return o==="string"?N$(h.values):h.values}function Ri(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{begin:r,size:i}=s;Ee(o,"slice");const[a,u]=nf(o,r,i);w0(o,a,u);const d=t.data.get(o.dataId).values,h=IT(d,a,u,o.shape,o.dtype);return t.makeTensorInfo(u,o.dtype,h)}const CU={kernelName:zp,backendName:"cpu",kernelFunc:Ri};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ST(n,e,t,s,o,r,i){const a=e[0],u=r[0],d=new Array(u),h=new Array(a),p=e[1];if(u===0){if(a!==0)throw new Error(f$(a));const v=Lt(t,0),w=Lt(o,0);return[v,[0,p],w,d,h]}let f=!0,g=0;const y=new Array(u).fill(0);for(let v=0;v<a;++v){const w=n[v*p];if(w<0)throw new Error(m$(v,w));if(w>=u)throw new Error(g$(v,w,u));++y[w],f=f&&w>=g,g=w}let b=!0;for(let v=0;v<u;++v){const w=y[v]===0;d[v]=w,b=b&&!w,y[v]=Math.max(y[v],1),v>0&&(y[v]+=y[v-1])}if(b&&f){const v=n,w=s;for(let C=0;C<a;++C)h[C]=C;return[v,[a,p],w,d,h]}else{const v=y[u-1],w=Lt(t,v*p),C=Lt(o,v),$=new Array(u).fill(0);for(let S=0;S<a;++S){const N=n[S*p],R=$[N],F=(N===0?0:y[N-1])+R;$[N]++;for(let O=0;O<p;++O)w[F*p+O]=n[S*p+O];C[F]=s[S],h[S]=F}for(let S=0;S<u;++S)if($[S]===0){const R=S===0?0:y[S-1];w[R*p+0]=S;for(let F=1;F<p;++F)w[R*p+F]=0;C[R]=i}return[w,[v,p],C,d,h]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $T(n,e,t,s,o){const r=de(s),i=e[0],a=o.length,u=[];let d=1,h=-1;for(let v=0;v<a;++v){const w=o[v];if(w===-1){if(h!==-1)throw new Error(y$(h,v));h=v,u.push(1)}else{if(w<0)throw new Error(x$(v,w));d*=w,u.push(w)}}if(h!==-1){if(d<=0)throw new Error(b$());const v=Math.trunc(r/d);if(d*v!==r)throw new Error(v$(s,u));u[h]=v}if(de(u)!==r)throw new Error(w$(s,u));const f=s.length,g=[];if(f>0){g[f-1]=1;for(let v=f-2;v>=0;--v)g[v]=g[v+1]*s[v+1]}const y=[];if(a>0){y[a-1]=1;for(let v=a-2;v>=0;--v)y[v]=y[v+1]*u[v+1]}const b=Lt(t,i*a);for(let v=0;v<i;++v){let w=0;for(let C=0;C<f;++C)w+=n[v*f+C]*g[C];for(let C=0;C<a;++C)b[v*a+C]=Math.trunc(w/y[C]),w%=y[C]}return[b,[i,a],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1(n,e,t,s,o,r=!1,i=0){const a=s.length,u=[e[0],n.length/e[0]],d=u[1],p=a>0?o[a-1]+1:0;if(p<0)throw new Error(xy());const f=e.slice();f[0]=p;const g=f.reduce(($,S)=>$*S,1),y=Lt(t,g);if(a===0)return p>0&&y.fill(i),[y,f];if(p<=0)throw new Error(xy());let b=0,v=1,w=0,C=o[b];for(;;){let $=0;if(v<a){if($=o[v],C===$){++v;continue}if(C>=$)throw new Error(k$())}if(C<0||C>=p)throw new Error(C$(C,p));C>w&&y.fill(i,w*d,C*d);for(let S=b;S<v;++S){const N=s[S];if(N<0||N>=u[0])throw new Error(I$(S,s[S],u[0]));for(let R=0;R<d;R++)y[C*d+R]+=n[N*d+R]}if(r)for(let S=0;S<d;S++)y[C*d+S]/=v-b;if(b=v,++v,w=C+1,C=$,v>a)break}return w<p&&y.fill(i,w*d,p*d),[y,f]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IU=$o(n=>Math.sqrt(n)),SU=mt(oc,n=>Math.sqrt(n)),$U={kernelName:oc,backendName:"cpu",kernelFunc:SU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NT=Wt((n,e)=>{const t=n-e;return t*t}),NU=Zt(rc,NT),TU={kernelName:rc,backendName:"cpu",kernelFunc:NU};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TT=$o((n,e)=>{const{pattern:t,replaceGlobal:s,rewrite:o}=e;return n.replace(new RegExp(t,s?"g":""),o)}),EU=Wr(Lx,TT),RU={kernelName:Lx,backendName:"cpu",kernelFunc:EU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ET(n,e,t,s){const o=qe(n,e.dtype);for(let r=0;r<o.size;r++){const i=o.indexToLoc(r),a=new Array(i.length);for(let u=0;u<a.length;u++)a[u]=i[u]*t[u]+s[u];o.set(e.get(...a),...i)}return o}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AU{constructor(e,t,s,o,r,i){this.separator=Ir(e),this.nGramWidths=t,this.leftPad=Ir(s),this.rightPad=Ir(o),this.padWidth=r,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const s=this.getPadWidth(t);return Math.max(0,e+2*s-t+1)}createNGrams(e,t,s,o,r,i){for(let a=0;a<r;++a){const u=this.getPadWidth(i),d=Math.max(0,u-a),h=Math.max(0,u-(r-(a+1))),p=i-(d+h),f=t+(d>0?0:a-u);let g=0;g+=d*this.leftPad.length;for(let C=0;C<p;++C)g+=e[f+C].length;g+=h*this.rightPad.length;const y=d+h+p-1;g+=y*this.separator.length,s[o+a]=new Uint8Array(g);const b=s[o+a];let v=0;const w=C=>C.forEach($=>b[v++]=$);for(let C=0;C<d;++C)w(this.leftPad),w(this.separator);for(let C=0;C<p-1;++C)w(e[f+C]),w(this.separator);if(p>0){w(e[f+p-1]);for(let C=0;C<h;++C)w(this.separator),w(this.rightPad)}else{for(let C=0;C<h-1;++C)w(this.rightPad),w(this.separator);w(this.rightPad)}}}compute(e,t){const s=e.length,o=t.length;if(o>0){let u=t[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let d=1;d<o;++d){let h=t[d]>=u;if(h=h&&t[d]<=s,!h)throw new Error(`Invalid split value ${t[d]}, must be in [${u}, ${s}]`);u=t[d]}if(u!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${u}`)}const r=o-1,i=Lt("int32",o);if(s===0||o===0){const u=new Array(s);for(let d=0;d<=r;++d)i[d]=0;return[u,i]}i[0]=0;for(let u=1;u<=r;++u){const d=t[u]-t[u-1];let h=0;this.nGramWidths.forEach(p=>{h+=this.getNumNGrams(d,p)}),this.preserveShort&&d>0&&h===0&&(h=1),i[u]=i[u-1]+h}const a=new Array(i[r]);for(let u=0;u<r;++u){const d=t[u];let h=i[u];if(this.nGramWidths.forEach(p=>{const f=t[u+1]-t[u],g=this.getNumNGrams(f,p);this.createNGrams(e,d,a,h,g,p),h+=g}),this.preserveShort&&h===i[u]){const p=t[u+1]-t[u];if(p===0)continue;const f=p+2*this.padWidth;this.createNGrams(e,d,a,h,1,f)}}return[a,i]}}function RT(n,e,t,s,o,r,i,a){return new AU(t,s,o,r,i,a).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DU(n,e,t,s){if(!n.length)return;if(e.length===0){for(let r=0;r<n.length;++r)s.push(n.subarray(r,r+1));return}if(e.length===1){const r=e[0];let i=n.indexOf(r);for(;i!==-1;){const a=n.subarray(0,i);(!t||a.length!==0)&&s.push(a),n=n.subarray(i+1),i=n.indexOf(r)}(!t||n.length!==0)&&s.push(n);return}let o=0;for(let r=0;r<n.length+1;r++)if(r===n.length||e.indexOf(n[r])!==-1){const i=n.subarray(o,r);(!t||i.length!==0)&&s.push(i),o=r+1}}function AT(n,e,t){const s=n.length,o=[];let r=0,i=0;const a=new Array(s);for(let f=0;f<s;++f){const g=o.length;DU(n[f],e,t,o);const y=o.length-g;a[f]=y,r+=y,i=Math.max(i,y)}const u=Lt("int32",r*2),d=new Array(r),h=[s,i];let p=0;for(let f=0;f<s;++f)for(let g=0;g<a[f];++g)u[p*2]=f,u[p*2+1]=g,d[p]=o[p],++p;return[u,d,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DT(n,e){const t=Lt("int32",n.length);for(let s=0;s<n.length;++s)t[s]=d_(n[s]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FT=Wt((n,e)=>n-e),FU=m1((n,e,t,s)=>({real:n-t,imag:e-s})),v1=Zt(ic,FT,FU),_U={kernelName:ic,backendName:"cpu",kernelFunc:v1};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _T(n,e){const t=new Array(n.rank);for(let o=0;o<t.length;o++)t[o]=n.shape[o]*e[o];const s=qe(t,n.dtype);for(let o=0;o<s.values.length;++o){const r=s.indexToLoc(o),i=new Array(n.rank);for(let u=0;u<i.length;u++)i[u]=r[u]%n.shape[u];const a=n.locToIndex(i);s.values[o]=n.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xl=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function OT(n,e,t=0,s=n.length-1){for(;s>t;){if(s-t>600){const a=s-t+1,u=e-t+1,d=Math.log(a),h=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*h*(a-h)/a)*Math.sign(u-a/2),f=Math.max(t,Math.floor(e-u*h/a+p)),g=Math.min(s,Math.floor(e+(a-u)*h/a+p));OT(n,e,f,g)}const o=n[e];let r=t,i=s;for(xa(n,t,e),Xl(n[s],o)>0&&xa(n,t,s);r<i;){for(xa(n,r,i),r++,i--;Xl(n[r],o)<0;)r=r+1;for(;Xl(n[i],o)>0;)i=i-1}Xl(n[t],o)===0?xa(n,t,i):(i=i+1,xa(n,i,s)),i<=e&&(t=i+1),e<=i&&(s=i-1)}}function LT(n,e,t,s,o){const r=e[e.length-1],[i,a]=[n.length/r,r],u=xn(t,i*s),d=xn("int32",i*s);for(let p=0;p<i;p++){const f=p*a,g=n.subarray(f,f+a);let y=new Array(g.length);g.forEach((C,$)=>y[$]={value:C,index:$}),s<y.length&&(OT(y,s),y=y.slice(0,s)),o&&y.sort(Xl);const b=p*s,v=u.subarray(b,b+s),w=d.subarray(b,b+s);for(let C=0;C<s;C++)v[C]=y[C].value,w[C]=y[C].index}const h=e.slice();return h[h.length-1]=s,[qe(h,t,u),qe(h,"int32",d)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MT(n,e,t,s){const o=Ke(e,t)[0],r=[1,t[0],1];for(let y=0;y<o;y++)r[0]*=t[y];r[1]=t[o];for(let y=o+1;y<t.length;y++)r[2]*=t[y];const i=new Map,a=new Int32Array(t[o]),u=new dn(r,s,n),d=[],h=r[0]===1&&r[2]===1;for(let y=0;y<t[o];y++){let b;if(h)b=n[y].toString();else{const w=[];for(let C=0;C<r[0];C++)for(let $=0;$<r[2];$++)w.push(u.get(C,y,$));b=w.join(",")}const v=i.get(b);if(v!=null)a[y]=v;else{const w=i.size;i.set(b,w),a[y]=w,d.push(y)}}const p=r.slice();p[1]=i.size;const f=new dn(p,s);d.forEach((y,b)=>{for(let v=0;v<r[0];v++)for(let w=0;w<r[2];w++)f.set(u.get(v,y,w),v,b,w)});const g=t.slice();return g[o]=p[1],{outputValues:f.values,outputShape:g,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OU=Object.freeze(Object.defineProperty({__proto__:null,addImpl:HN,bincountImpl:g1,bincountReduceImpl:qN,bitwiseAndImpl:KN,castImpl:jN,ceilImpl:XN,concatImpl:YN,equalImpl:QN,expImpl:ZN,expm1Impl:tT,floorDivImpl:sT,floorImpl:nT,gatherNdImpl:oT,gatherV2Impl:rT,greaterEqualImpl:aT,greaterImpl:iT,lessEqualImpl:uT,lessImpl:lT,linSpaceImpl:cT,logImpl:dT,maxImpl:hT,maximumImpl:pT,minimumImpl:fT,multiplyImpl:y1,negImpl:mT,notEqualImpl:gT,prodImpl:yT,raggedGatherImpl:xT,raggedRangeImpl:bT,raggedTensorToTensorImpl:vT,rangeImpl:wT,rsqrtImpl:kT,scatterImpl:pi,sigmoidImpl:wU,simpleAbsImpl:GN,sliceImpl:IT,sparseFillEmptyRowsImpl:ST,sparseReshapeImpl:$T,sparseSegmentReductionImpl:b1,sqrtImpl:IU,squaredDifferenceImpl:NT,staticRegexReplaceImpl:TT,stridedSliceImpl:ET,stringNGramsImpl:RT,stringSplitImpl:AT,stringToHashBucketFastImpl:DT,subImpl:FT,tileImpl:_T,topKImpl:LT,transposeImpl:x1,uniqueImpl:MT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */sS("cpu",()=>new yf,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PT=mt(Eu,n=>n>=0?n:Math.exp(n)-1),LU={kernelName:Eu,backendName:"cpu",kernelFunc:PT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zT(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{alpha:r}=s;Ee([o],"leakyRelu");const i=de(o.shape),a=t.data.get(o.dataId).values,u=xn("float32",i);for(let d=0;d<a.length;d++)u[d]=a[d]<0?r*a[d]:a[d];return t.makeTensorInfo(o.shape,"float32",u)}const MU={kernelName:pp,backendName:"cpu",kernelFunc:zT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PU=Wt((n,e)=>n<0?e*n:n);function BT(n){const{inputs:e,backend:t}=n,{x:s,alpha:o}=e;Ee([s,o],"prelu");const r=t.data.get(s.dataId).values,i=t.data.get(o.dataId).values,[a,u]=PU(s.shape,o.shape,r,i,"float32");return t.makeTensorInfo(u,"float32",a)}const zU={kernelName:Dp,backendName:"cpu",kernelFunc:BT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WT=mt(Ku,n=>Math.max(0,n)),BU={kernelName:Ku,backendName:"cpu",kernelFunc:WT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VT=mt(Xu,n=>Math.min(Math.max(0,n),6)),WU={kernelName:Xu,backendName:"cpu",kernelFunc:VT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ph(n,e,t,s,o){if(t==="linear")return So({inputs:{x:e},backend:n});if(t==="relu")return WT({inputs:{x:e},backend:n});if(t==="elu")return PT({inputs:{x:e},backend:n});if(t==="relu6")return VT({inputs:{x:e},backend:n});if(t==="prelu")return BT({inputs:{x:e,alpha:s},backend:n});if(t==="leakyrelu")return zT({inputs:{x:e},backend:n,attrs:{alpha:o}});if(t==="sigmoid")return CT({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kt(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{shape:r}=s,i=de(o.shape),a=hI(r,i),u=de(a);_(i===u,()=>`The new shape (${a}) has ${u} elements and the old shape (${o.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),t.incRef(o.dataId);const d=t.data.get(o.dataId);if(d.complexTensorInfos!=null){const h=d.complexTensorInfos.real,p=d.complexTensorInfos.imag;h.shape=a,p.shape=a}return{dataId:o.dataId,shape:a,dtype:o.dtype}}const VU={kernelName:_p,backendName:"cpu",kernelFunc:kt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UT(n){const{inputs:e,backend:t,attrs:s}=n,{a:o,b:r}=e,{transposeA:i,transposeB:a}=s;Ee([o,r],"matMul");const u=o.shape.length,d=r.shape.length,h=i?o.shape[u-2]:o.shape[u-1],p=a?r.shape[d-1]:r.shape[d-2],f=i?o.shape[u-1]:o.shape[u-2],g=a?r.shape[d-2]:r.shape[d-1],y=o.shape.slice(0,-2),b=r.shape.slice(0,-2),v=de(y),w=de(b),$=je(o.shape.slice(0,-2),r.shape.slice(0,-2)).concat([f,g]);_(h===p,()=>`Error in matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${o.shape} and ${r.shape} and transposeA=${i} and transposeB=${a} must match.`);const S=i?[v,h,f]:[v,f,h],N=a?[w,g,p]:[w,p,g],R=kt({inputs:{x:o},backend:t,attrs:{shape:S}}),F=kt({inputs:{x:r},backend:t,attrs:{shape:N}}),O=i?R.shape[1]:R.shape[2],D=i?R.shape[2]:R.shape[1],A=a?F.shape[1]:F.shape[2],T=Math.max(v,w),B=t.data.get(R.dataId).values,U=t.data.get(F.dataId).values,Q=Oe(R.shape),K=Oe(F.shape),[J,te,P]=i?[Q[0],1,Q[1]]:[Q[0],Q[1],1],[X,Y,L]=a?[1,K[1],K[0]]:[K[1],1,K[0]],W=D*A,ie=qe([T,D,A],R.dtype),he=ie.values,pe=t.blockSize;for(let me=0;me<T;me++){const we=me%v,ke=me%w;for(let Ce=0;Ce<D;Ce+=pe){const Fe=Math.min(Ce+pe,D);for(let Ue=0;Ue<A;Ue+=pe){const Ze=Math.min(Ue+pe,A);for(let et=0;et<O;et+=pe){const at=Math.min(et+pe,O);for(let Pe=Ce;Pe<Fe;Pe++)for(let tt=Ue;tt<Ze;tt++){let lt=0;for(let xt=et;xt<at;xt++){const os=B[we*J+Pe*te+xt*P],Et=U[xt*X+tt*Y+ke*L];lt+=os*Et}he[me*W+(Pe*A+tt)]+=lt}}}}}return t.disposeIntermediateTensorInfo(R),t.disposeIntermediateTensorInfo(F),t.makeTensorInfo($,ie.dtype,ie.values)}const UU={kernelName:Jh,backendName:"cpu",kernelFunc:UT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GU(n){const{inputs:e,backend:t,attrs:s}=n,{a:o,b:r,bias:i,preluActivationWeights:a}=e,{transposeA:u,transposeB:d,activation:h,leakyreluAlpha:p}=s;let f,g,y;const b=[];f=UT({inputs:{a:o,b:r},attrs:{transposeA:u,transposeB:d},backend:t}),i&&(g=Oa({inputs:{a:f,b:i},backend:t}),b.push(f),f=g),h&&(y=Ph(t,f,h,a,p),b.push(f),f=y);for(const w of b)t.disposeIntermediateTensorInfo(w);return f}const jU={kernelName:xh,backendName:"cpu",kernelFunc:GU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HU=mt(gu,n=>Math.acos(n)),qU={kernelName:gu,backendName:"cpu",kernelFunc:HU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KU=mt(yu,n=>Math.acosh(n)),XU={kernelName:yu,backendName:"cpu",kernelFunc:KU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YU(n){const{inputs:e,backend:t}=n,s=e;Ee(e,"addN");const o=s.map(a=>t.data.get(a.dataId).values),r=qe(s[0].shape,s[0].dtype),i=r.values;for(let a=0;a<s.length;a++){const u=o[a];for(let d=0;d<i.length;d++)i[d]+=u[d]}return t.makeTensorInfo(r.shape,r.dtype,r.values)}const QU={kernelName:tx,backendName:"cpu",kernelFunc:YU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JU(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s;Ee(o,"all");const a=Ke(r,o.shape);let u=a;const d=Dt(u,o.shape.length);let h=o;d!=null&&(h=Un({inputs:{x:o},backend:t,attrs:{perm:d}}),u=zt(u.length,o.shape.length)),pn("all",u,h.shape.length);const[p,f]=rn(h.shape,u),g=de(f),y=bn(de(p),h.dtype),b=t.data.get(h.dataId).values;for(let w=0;w<y.length;++w){const C=w*g;let $=b[C];for(let S=0;S<g;++S){const N=b[C+S];$=$&&N}y[w]=$}d!=null&&t.disposeIntermediateTensorInfo(h);const v=t.makeTensorInfo(p,h.dtype,y);if(i){const w=jt(p,a),C=kt({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),C}return v}const ZU={kernelName:nx,backendName:"cpu",kernelFunc:JU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eG(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s;Ee(o,"any");const a=Ke(r,o.shape);let u=a;const d=Dt(u,o.shape.length);let h=o;d!=null&&(h=Un({inputs:{x:o},backend:t,attrs:{perm:d}}),u=zt(u.length,o.shape.length)),pn("any",u,h.shape.length);const[p,f]=rn(h.shape,u),g=de(f),y=bn(de(p),h.dtype),b=t.data.get(h.dataId).values;for(let w=0;w<y.length;++w){const C=w*g;let $=b[C];for(let S=0;S<g;++S){const N=b[C+S];$=$||N}y[w]=$}d!=null&&t.disposeIntermediateTensorInfo(h);const v=t.makeTensorInfo(p,h.dtype,y);if(i){const w=jt(p,a),C=kt({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),C}return v}const tG={kernelName:sx,backendName:"cpu",kernelFunc:eG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nG(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r}=s;Ee(o,"argMax");let i=Ke(r,o.shape);const a=Dt(i,o.shape.length);let u=o;const d=[];a!=null&&(u=Un({inputs:{x:o},backend:t,attrs:{perm:a}}),d.push(u),i=zt(i.length,u.shape.length)),i=[i[0]],pn("argMax",i,u.shape.length);const[h,p]=rn(u.shape,i),f=de(h),g=bn(f,"int32"),y=de(p),b=t.data.get(u.dataId).values;for(let v=0;v<g.length;++v){const w=v*y;let C=b[w],$=0;for(let S=0;S<y;++S){const N=b[w+S];N>C&&(C=N,$=S)}g[v]=$}return d.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(h,"int32",g)}const sG={kernelName:Kh,backendName:"cpu",kernelFunc:nG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oG(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r}=s;Ee(o,"argMin");let i=Ke(r,o.shape);const a=Dt(i,o.shape.length);let u=o;const d=[];a!=null&&(u=Un({inputs:{x:o},backend:t,attrs:{perm:a}}),d.push(u),i=zt(i.length,u.shape.length)),i=[i[0]],pn("argMin",i,u.shape.length);const[h,p]=rn(u.shape,i),f=de(h),g=bn(f,"int32"),y=de(p),b=t.data.get(u.dataId).values;for(let v=0;v<g.length;++v){const w=v*y;let C=b[w],$=0;for(let S=0;S<y;++S){const N=b[w+S];N<C&&(C=N,$=S)}g[v]=$}return d.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(h,"int32",g)}const rG={kernelName:Xh,backendName:"cpu",kernelFunc:oG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iG=mt(xu,n=>Math.asin(n)),aG={kernelName:xu,backendName:"cpu",kernelFunc:iG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lG=mt(bu,n=>Math.asinh(n)),uG={kernelName:bu,backendName:"cpu",kernelFunc:lG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cG=mt(vu,n=>Math.atan(n)),dG={kernelName:vu,backendName:"cpu",kernelFunc:cG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hG=Wt((n,e)=>Math.atan2(n,e)),pG=Zt(ku,hG),fG={kernelName:ku,backendName:"cpu",kernelFunc:pG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mG=mt(wu,n=>Math.atanh(n)),gG={kernelName:wu,backendName:"cpu",kernelFunc:mG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1(n,e,t,s,o,r){const i=o.strideHeight,a=o.strideWidth,u=o.dilationHeight,d=o.dilationWidth,h=o.effectiveFilterHeight,p=o.effectiveFilterWidth,f=o.padInfo.top,g=o.padInfo.left,y=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=qe(o.outShape,t),v=b.values,w=o.outShape[1]*o.outShape[2]*o.outShape[3],C=o.outShape[2]*o.outShape[3],$=o.outShape[3];for(let S=0;S<o.batchSize;++S){const N=S*w,R=S*s[0];for(let F=0;F<o.inChannels;++F)for(let O=0;O<o.outHeight;++O){const D=O*i-f,A=Math.max(0,D),T=Math.min(o.inHeight,h+D),B=N+O*C;for(let U=0;U<o.outWidth;++U){const Q=U*a-g,K=Math.max(0,Q),J=Math.min(o.inWidth,p+Q);let te=y,P=0,X=0;for(let L=A;L<T;L+=u){const W=R+L*s[1];for(let ie=K;ie<J;ie+=d){const he=W+ie*s[2],pe=n[he+F];r==="max"&&pe>te?te=pe:r==="avg"&&(P+=pe,X++)}if(isNaN(te))break}const Y=B+U*$+F;v[Y]=r==="avg"?P/X:te}}}return b}function GT(n,e,t,s,o=!1,r=!1){const i=qe(s.outShape,"int32"),a=s.strideHeight,u=s.strideWidth,d=s.dilationHeight,h=s.dilationWidth,p=s.effectiveFilterHeight,f=s.effectiveFilterWidth,g=s.padInfo.top,y=s.padInfo.left,b=qe(e,t,n);for(let v=0;v<s.batchSize;++v)for(let w=0;w<s.inChannels;++w)for(let C=0;C<s.outHeight;++C){const $=C*a-g;let S=$;for(;S<0;)S+=d;const N=Math.min(s.inHeight,p+$);for(let R=0;R<s.outWidth;++R){const F=R*u-y;let O=F;for(;O<0;)O+=h;const D=Math.min(s.inWidth,f+F);let A=Number.NEGATIVE_INFINITY,T=-1;for(let B=S;B<N;B+=d){const U=B-$;for(let Q=O;Q<D;Q+=h){const K=Q-F,J=b.get(v,B,Q,w);J>A&&(A=J,o?T=r?((v*s.inHeight+B)*s.inWidth+Q)*s.inChannels+w:(B*s.inWidth+Q)*s.inChannels+w:T=U*f+K)}}i.set(T,v,C,R,w)}}return i}function jT(n,e,t,s,o,r){const i=o.strideDepth,a=o.strideHeight,u=o.strideWidth,d=o.dilationDepth,h=o.dilationHeight,p=o.dilationWidth,f=o.effectiveFilterDepth,g=o.effectiveFilterHeight,y=o.effectiveFilterWidth,b=o.padInfo.front,v=o.padInfo.top,w=o.padInfo.left,C=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,$=qe(o.outShape,t),S=$.values,N=o.outShape[1]*o.outShape[2]*o.outShape[3]*o.outShape[4],R=o.outShape[2]*o.outShape[3]*o.outShape[4],F=o.outShape[3]*o.outShape[4],O=o.outShape[4];for(let D=0;D<o.batchSize;++D){const A=D*N,T=D*s[0];for(let B=0;B<o.inChannels;++B)for(let U=0;U<o.outDepth;++U){const Q=U*i-b;let K=Q;for(;K<0;)K+=d;const J=Math.min(o.inDepth,f+Q),te=A+U*R;for(let P=0;P<o.outHeight;++P){const X=P*a-v;let Y=X;for(;Y<0;)Y+=h;const L=Math.min(o.inHeight,g+X),W=te+P*F;for(let ie=0;ie<o.outWidth;++ie){const he=ie*u-w;let pe=he;for(;pe<0;)pe+=p;const me=Math.min(o.inWidth,y+he),we=W+ie*O;let ke=C,Ce=0,Fe=0;for(let Ze=K;Ze<J;Ze+=d){const et=T+Ze*s[1];for(let at=Y;at<L;at+=h){const Pe=et+at*s[2];for(let tt=pe;tt<me;tt+=p){const lt=Pe+tt*s[3],xt=n[lt+B];if(r==="max"&&xt>ke?ke=xt:r==="avg"&&(Ce+=xt,Fe++),isNaN(ke))break}if(isNaN(ke))break}if(isNaN(ke))break}const Ue=we+B;S[Ue]=r==="avg"?Ce/Math.max(Fe,1):ke}}}}return $}function yG(n,e){const t=qe(e.outShape,"int32"),s=e.strideDepth,o=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;for(let b=0;b<e.batchSize;++b)for(let v=0;v<e.inChannels;++v)for(let w=0;w<e.outDepth;++w){const C=w*s-f;let $=C;for(;$<0;)$+=i;const S=Math.min(e.inDepth,d+C);for(let N=0;N<e.outHeight;++N){const R=N*o-g;let F=R;for(;F<0;)F+=a;const O=Math.min(e.inHeight,h+R);for(let D=0;D<e.outWidth;++D){const A=D*r-y;let T=A;for(;T<0;)T+=u;const B=Math.min(e.inWidth,p+A);let U=Number.NEGATIVE_INFINITY,Q=-1;for(let K=$;K<S;K+=i){const J=K-C;for(let te=F;te<O;te+=a){const P=te-R;for(let X=T;X<B;X+=u){const Y=X-A,L=n.get(b,K,te,X,v);L>=U&&(U=L,Q=J*h*p+P*h+Y)}}}t.set(Q,b,w,N,D,v)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e;Ee(o,"avgPool");const{filterSize:r,strides:i,pad:a,dimRoundingMode:u}=s,d=1;_(wn(i,d),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);const h=Ds(o.shape,r,i,d,a,u);let p;if(h.filterWidth===1&&h.filterHeight===1&&ht(h.inShape,h.outShape))p=So({inputs:{x:o},backend:t});else{const f=t.data.get(o.dataId).values,g=Oe(o.shape),y=w1(f,o.shape,o.dtype,g,h,"avg");p=t.makeTensorInfo(h.outShape,o.dtype,y.values)}return p}const bG={kernelName:Yh,backendName:"cpu",kernelFunc:xG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{filterSize:r,strides:i,pad:a,dimRoundingMode:u,dataFormat:d}=s;Ee(o,"avgPool3d");const h=Xo(o.shape,r,i,1,a,u,d),p=t.data.get(o.dataId).values,f=jT(p,o.shape,o.dtype,Oe(o.shape),h,"avg");return t.makeTensorInfo(f.shape,"float32",f.values)}const wG={kernelName:Qh,backendName:"cpu",kernelFunc:vG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kG(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,input:r}=e,{filterSize:i,strides:a,pad:u,dimRoundingMode:d}=s;Ee([o,r],"avgPool3DGrad");const h=Xo(r.shape,i,a,1,u,d),p=h.strideDepth,f=h.strideHeight,g=h.strideWidth,y=h.filterDepth,b=h.filterHeight,v=h.filterWidth,w=h.dilationDepth,C=h.dilationHeight,$=h.dilationWidth,S=h.effectiveFilterDepth,N=h.effectiveFilterHeight,R=h.effectiveFilterWidth,F=S-1-h.padInfo.front,O=R-1-h.padInfo.left,D=N-1-h.padInfo.top,A=qe(r.shape,"float32"),T=1/(y*b*v),B=t.bufferSync(o);for(let U=0;U<h.batchSize;++U)for(let Q=0;Q<h.inChannels;++Q)for(let K=0;K<h.inDepth;++K)for(let J=0;J<h.inHeight;++J)for(let te=0;te<h.inWidth;++te){const P=K-F,X=J-D,Y=te-O;let L=0;for(let W=0;W<S;W+=w){const ie=(P+W)/p;if(!(ie<0||ie>=h.outDepth||Math.floor(ie)!==ie))for(let he=0;he<N;he+=C){const pe=(X+he)/f;if(!(pe<0||pe>=h.outHeight||Math.floor(pe)!==pe))for(let me=0;me<R;me+=$){const we=(Y+me)/g;if(we<0||we>=h.outWidth||Math.floor(we)!==we)continue;const ke=B.get(U,ie,pe,we,Q);L+=ke}}}A.set(L*T,U,K,J,te,Q)}return t.makeTensorInfo(A.shape,A.dtype,A.values)}const CG={kernelName:rx,backendName:"cpu",kernelFunc:kG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IG(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,input:r}=e,i=r;Ee([o,r],"avgPoolGrad");const{filterSize:a,strides:u,pad:d}=s,h=Ds(i.shape,a,u,1,d),p=h.strideHeight,f=h.strideWidth,g=h.filterHeight,y=h.filterWidth,b=h.dilationHeight,v=h.dilationWidth,w=h.effectiveFilterHeight,C=h.effectiveFilterWidth,$=C-1-h.padInfo.left,S=w-1-h.padInfo.top,N=qe(i.shape,"float32"),R=1/(g*y),F=t.data.get(o.dataId).values,O=qe(o.shape,"float32",F);for(let D=0;D<h.batchSize;++D)for(let A=0;A<h.inChannels;++A)for(let T=0;T<h.inHeight;++T)for(let B=0;B<h.inWidth;++B){const U=T-S,Q=B-$;let K=0;for(let J=0;J<w;J+=b){const te=(U+J)/p;if(!(te<0||te>=h.outHeight||Math.floor(te)!==te))for(let P=0;P<C;P+=v){const X=(Q+P)/f;if(X<0||X>=h.outWidth||Math.floor(X)!==X)continue;const Y=O.get(D,te,X,A);K+=Y}}N.set(K*R,D,T,B,A)}return t.makeTensorInfo(N.shape,N.dtype,N.values)}const SG={kernelName:ox,backendName:"cpu",kernelFunc:IG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,scale:r,offset:i,mean:a,variance:u}=e;_(a.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),_(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),_(r==null||a.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ee([o,a,u,r,i],"batchNorm");let{varianceEpsilon:d}=s;d==null&&(d=.001);const h=t.data.get(o.dataId).values,p=t.data.get(a.dataId).values,f=t.data.get(u.dataId).values,g=r?t.data.get(r.dataId).values:new Float32Array([1]),y=i?t.data.get(i.dataId).values:new Float32Array([0]),b=new Float32Array(h.length),v=y.length,w=g.length,C=f.length,$=p.length;let S=0,N=0,R=0,F=0;for(let O=0;O<h.length;++O)b[O]=y[S++]+(h[O]-p[N++])*g[R++]/Math.sqrt(f[F++]+d),S>=v&&(S=0),N>=$&&(N=0),R>=w&&(R=0),F>=C&&(F=0);return t.makeTensorInfo(o.shape,o.dtype,b)}const NG={kernelName:cp,backendName:"cpu",kernelFunc:$G};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TG(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{blockShape:r,crops:i}=s;Ee([o],"batchToSpaceND");const a=r.reduce((w,C)=>w*C),u=gc(o.shape,r,a),d=yc(u.length,r.length),h=xc(o.shape,r,a),p=E0(i,r.length),f=R0(h,i,r.length),g=kt({inputs:{x:o},backend:t,attrs:{shape:u}}),y=Un({inputs:{x:g},backend:t,attrs:{perm:d}}),b=kt({inputs:{x:y},backend:t,attrs:{shape:h}}),v=Ri({inputs:{x:b},backend:t,attrs:{begin:p,size:f}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(b),v}const EG={kernelName:Zh,backendName:"cpu",kernelFunc:TG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,weights:r}=e,{size:i}=s,a=t.data.get(o.dataId).values,u=t.data.get(r.dataId).values,d=g1(a,u,r.dtype,r.shape,i);return t.makeTensorInfo([i],r.dtype,d)}const AG={kernelName:ix,backendName:"cpu",kernelFunc:RG};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DG(n){const{inputs:e,backend:t}=n,{s0:s,s1:o}=e,r=t.data.get(s.dataId).values,i=t.data.get(o.dataId).values,a=je(Array.from(r),Array.from(i));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const FG={kernelName:xI,backendName:"cpu",kernelFunc:DG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _G=mt(Su,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),OG={kernelName:Su,backendName:"cpu",kernelFunc:_G};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LG=n=>{const{x:e}=n.inputs,t=n.backend,s=new Float32Array(de(e.shape)),o=t.data.get(e.dataId),r=o.complexTensorInfos.real,i=o.complexTensorInfos.imag,a=t.data.get(r.dataId).values,u=t.data.get(i.dataId).values;for(let d=0;d<a.length;d++){const h=a[d],p=u[d];s[d]=Math.hypot(h,p)}return t.makeOutput(s,e.shape,"float32")},MG={kernelName:ep,backendName:"cpu",kernelFunc:LG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function La(n){const{inputs:e,backend:t}=n,{input:s}=e,o=t.data.get(s.dataId).complexTensorInfos.imag,r=t.data.get(o.dataId).values;return t.makeTensorInfo(o.shape,o.dtype,r)}const PG={kernelName:Ix,backendName:"cpu",kernelFunc:La};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ma(n){const{inputs:e,backend:t,attrs:s}=n,{axis:o}=s,r=Ke(o,e[0].shape)[0],i=e.map(b=>b.shape);$0(i,r);let a=xo(e.map(b=>b.shape),r);if(de(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const u=e.filter(b=>de(b.shape)>0);if(u.length===1)return So({inputs:{x:u[0]},backend:t});if(u[0].dtype==="complex64"){const b=u.map(S=>Ei({inputs:{input:S},backend:t})),v=u.map(S=>La({inputs:{input:S},backend:t})),w=Ma({inputs:b,backend:t,attrs:{axis:r}}),C=Ma({inputs:v,backend:t,attrs:{axis:r}}),$=Zn({inputs:{real:w,imag:C},backend:t});return b.forEach(S=>t.disposeIntermediateTensorInfo(S)),v.forEach(S=>t.disposeIntermediateTensorInfo(S)),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(C),$}const d=u.map(b=>{const w=[-1,de(b.shape.slice(r))];return kt({inputs:{x:b},backend:t,attrs:{shape:w}})}),h=d.map(b=>({vals:t.data.get(b.dataId).values,shape:b.shape}));a=xo(d.map(b=>b.shape),1);const p=d[0].shape[0]===1,f=YN(h,a,e[0].dtype,p),g=xo(u.map(b=>b.shape),r),y=t.makeTensorInfo(g,e[0].dtype,f);return d.forEach(b=>t.disposeIntermediateTensorInfo(b)),y}const zG={kernelName:tp,backendName:"cpu",kernelFunc:Ma};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HT(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r}=e,{strides:i,pad:a,dataFormat:u,dilations:d,dimRoundingMode:h}=s;Ee([o,r],"conv2d");const p=Yo(u),f=hn(o.shape,r.shape,i,d,a,h,!1,p),g=f.filterHeight,y=f.filterWidth,b=f.dilationHeight,v=f.dilationWidth,w=f.padInfo.left,C=f.padInfo.top,$=f.dataFormat==="channelsLast",S=new dn(f.outShape,o.dtype),N=Oe(o.shape),R=Oe(r.shape),F=N[0],O=$?N[1]:N[2],D=$?N[2]:1,A=$?1:N[1],T=S.strides[0],B=$?S.strides[1]:S.strides[2],U=$?S.strides[2]:1,Q=$?1:S.strides[1],K=t.data.get(o.dataId).values,J=t.data.get(r.dataId).values,te=S.values;for(let P=0;P<f.batchSize;++P){const X=P*F,Y=P*T;for(let L=0;L<f.outHeight;++L){const W=Y+L*B,ie=L*f.strideHeight-C;for(let he=0;he<g;++he){const pe=ie+he*b;if(pe<0||pe>=f.inHeight)continue;const me=he*R[0],we=X+pe*O;for(let ke=0;ke<f.outWidth;++ke){const Ce=W+ke*U,Fe=ke*f.strideWidth-w;for(let Ue=0;Ue<y;++Ue){const Ze=Fe+Ue*v;if(Ze<0||Ze>=f.inWidth)continue;const et=me+Ue*R[1],at=we+Ze*D;let Pe=et;for(let tt=0;tt<f.inChannels;++tt){const lt=K[at+tt*A];for(let xt=0;xt<f.outChannels;++xt)te[Ce+xt*Q]+=lt*J[Pe+xt];Pe+=f.outChannels}}}}}}return t.makeTensorInfo(S.shape,S.dtype,te)}const BG={kernelName:np,backendName:"cpu",kernelFunc:HT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WG(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,dy:r}=e,{strides:i,pad:a,dataFormat:u,dimRoundingMode:d,filterShape:h}=s;Ee([o,r],"conv2dBackpropFilter");const p=Yo(u),f=hn(o.shape,h,i,1,a,d,!1,p),{strideHeight:g,strideWidth:y,filterHeight:b,filterWidth:v}=f,w=f.dataFormat==="channelsLast",C=new dn(f.filterShape,"float32"),$=f.padInfo.left,S=f.padInfo.top,N=t.data.get(o.dataId).values,R=t.data.get(r.dataId).values,F=new dn(o.shape,o.dtype,N),O=new dn(r.shape,r.dtype,R);for(let D=0;D<b;++D){const A=Math.max(0,Math.ceil((S-D)/g)),T=Math.min(f.outHeight,(f.inHeight+S-D)/g);for(let B=0;B<v;++B){const U=Math.max(0,Math.ceil(($-B)/y)),Q=Math.min(f.outWidth,(f.inWidth+$-B)/y);for(let K=0;K<f.inChannels;++K)for(let J=0;J<f.outChannels;++J){let te=0;for(let P=0;P<f.batchSize;++P)for(let X=A;X<T;++X){const Y=D+X*g-S;for(let L=U;L<Q;++L){const W=B+L*y-$;w?te+=F.get(P,Y,W,K)*O.get(P,X,L,J):te+=F.get(P,K,Y,W)*O.get(P,J,X,L)}}C.set(te,D,B,K,J)}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const VG={kernelName:ux,backendName:"cpu",kernelFunc:WG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UG(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,filter:r}=e,{inputShape:i,strides:a,pad:u,dataFormat:d,dimRoundingMode:h}=s;Ee([o,r],"conv2dBackpropInput");const p=Oe(r.shape),f=Oe(o.shape);let g=Yo(d);const y=hn(i,r.shape,a,1,u,h,!1,g),b=new dn(y.inShape,"float32"),v=b.values,w=t.data.get(o.dataId).values,C=t.data.get(r.dataId).values,[$,S,N]=p,{batchSize:R,filterHeight:F,filterWidth:O,inChannels:D,inHeight:A,inWidth:T,outChannels:B,outHeight:U,outWidth:Q,strideHeight:K,strideWidth:J}=y;g=y.dataFormat;const te=F-1-y.padInfo.top,P=O-1-y.padInfo.left,X=g==="channelsLast",Y=b.strides[0],L=X?b.strides[1]:b.strides[2],W=X?b.strides[2]:1,ie=X?1:b.strides[1],he=f[0],pe=X?f[1]:f[2],me=X?f[2]:1,we=X?1:f[1];for(let ke=0;ke<R;++ke)for(let Ce=0;Ce<D;++Ce)for(let Fe=0;Fe<A;++Fe){const Ue=Fe-te,Ze=Math.max(0,Math.ceil(Ue/K)),et=Math.min(U,(F+Ue)/K);for(let at=0;at<T;++at){const Pe=at-P,tt=Math.max(0,Math.ceil(Pe/J)),lt=Math.min(Q,(O+Pe)/J);let xt=0;for(let Et=Ze;Et<et;++Et){const On=Et*K-Ue;for(let mn=tt;mn<lt;++mn){const to=mn*J-Pe,jn=he*ke+pe*Et+me*mn,gs=$*(F-1-On)+S*(O-1-to)+N*Ce;for(let Os=0;Os<B;++Os){const ys=w[jn+we*Os],rs=C[gs+Os];xt+=ys*rs}}}const os=Y*ke+L*Fe+W*at+ie*Ce;v[os]=xt}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const GG={kernelName:sp,backendName:"cpu",kernelFunc:UG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r}=e,{strides:i,pad:a,dilations:u}=s;Ee([o,r],"conv3d");const d=Or(o.shape,r.shape,i,u,a),{filterDepth:h,filterHeight:p,filterWidth:f,dilationDepth:g,dilationHeight:y,dilationWidth:b,padInfo:v}=d,w=v.front,C=v.left,$=v.top,S=new dn(d.outShape,o.dtype),N=t.data.get(o.dataId).values,R=t.data.get(r.dataId).values,F=S.values,O=Oe(o.shape),D=Oe(r.shape);for(let A=0;A<d.batchSize;++A){const T=A*O[0],B=A*S.strides[0];for(let U=0;U<d.outDepth;++U){const Q=B+U*S.strides[1],K=U*d.strideDepth-w;for(let J=0;J<h;++J){const te=K+J*g;if(te<0||te>=d.inDepth)continue;const P=J*D[0],X=T+te*O[1];for(let Y=0;Y<d.outHeight;++Y){const L=Q+Y*S.strides[2],W=Y*d.strideHeight-$;for(let ie=0;ie<p;++ie){const he=W+ie*y;if(he<0||he>=d.inHeight)continue;const pe=P+ie*D[1],me=X+he*O[2];for(let we=0;we<d.outWidth;++we){const ke=L+we*d.outChannels,Ce=we*d.strideWidth-C;for(let Fe=0;Fe<f;++Fe){const Ue=Ce+Fe*b;if(Ue<0||Ue>=d.inWidth)continue;const Ze=pe+Fe*D[2],et=me+Ue*d.inChannels;let at=Ze;for(let Pe=0;Pe<d.inChannels;++Pe){const tt=N[et+Pe];for(let lt=0;lt<d.outChannels;++lt)F[ke+lt]+=tt*R[at+lt];at+=d.outChannels}}}}}}}}return t.makeTensorInfo(S.shape,S.dtype,S.values)}const HG={kernelName:op,backendName:"cpu",kernelFunc:jG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qG(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,dy:r}=e,{strides:i,pad:a,filterShape:u}=s;Ee([o,r],"conv3dBackpropFilterV2");const d=Oe(o.shape),h=Oe(r.shape),p=Or(o.shape,u,i,1,a),f=p.strideDepth,g=p.strideHeight,y=p.strideWidth,b=p.filterDepth,v=p.filterHeight,w=p.filterWidth,C=new dn(p.filterShape,"float32"),$=C.values,[S,N,R,F]=C.strides,O=t.data.get(r.dataId).values,[D,A,T,B]=h,U=t.data.get(o.dataId).values,[Q,K,J,te]=d,P=p.padInfo.front,X=p.padInfo.left,Y=p.padInfo.top;for(let L=0;L<b;++L){const W=Math.max(0,Math.ceil((P-L)/f)),ie=Math.min(p.outDepth,(p.inDepth+P-L)/f),he=L*S;for(let pe=0;pe<v;++pe){const me=Math.max(0,Math.ceil((Y-pe)/g)),we=Math.min(p.outHeight,(p.inHeight+Y-pe)/g),ke=pe*N+he;for(let Ce=0;Ce<w;++Ce){const Fe=Math.max(0,Math.ceil((X-Ce)/y)),Ue=Math.min(p.outWidth,(p.inWidth+X-Ce)/y),Ze=Ce*R+ke;for(let et=0;et<p.inChannels;++et){const at=et*F+Ze;for(let Pe=0;Pe<p.outChannels;++Pe){let tt=0;for(let lt=0;lt<p.batchSize;++lt){const xt=lt*Q,os=lt*D;for(let Et=W;Et<ie;++Et){const mn=(L+Et*f-P)*K+xt,to=Et*A+os;for(let jn=me;jn<we;++jn){const Os=(pe+jn*g-Y)*J+mn,ys=jn*T+to;for(let rs=Fe;rs<Ue;++rs){const No=(Ce+rs*y-X)*te+Os,To=rs*B+ys;tt+=U[No+et]*O[To+Pe]}}}}$[at+Pe]=tt}}}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const KG={kernelName:cx,backendName:"cpu",kernelFunc:qG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XG(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,filter:r}=e,{pad:i,strides:a,inputShape:u}=s;Ee([o],"conv3dBackpropInputV2");const d=Oe(o.shape),h=Oe(r.shape),p=Or(u,r.shape,a,1,i),f=new dn(p.inShape,"float32"),g=f.values,[y,b,v,w]=f.strides,C=t.data.get(o.dataId).values,[$,S,N,R]=d,F=t.data.get(r.dataId).values,[O,D,A,T]=h,{batchSize:B,filterDepth:U,filterHeight:Q,filterWidth:K,inChannels:J,inDepth:te,inHeight:P,inWidth:X,outChannels:Y,outDepth:L,outHeight:W,outWidth:ie,strideDepth:he,strideHeight:pe,strideWidth:me}=p,we=U-1-p.padInfo.front,ke=Q-1-p.padInfo.top,Ce=K-1-p.padInfo.left;for(let Fe=0;Fe<B;++Fe)for(let Ue=0;Ue<J;++Ue)for(let Ze=0;Ze<te;++Ze){const et=Ze-we,at=Math.max(0,Math.ceil(et/he)),Pe=Math.min(L,(U+et)/he);for(let tt=0;tt<P;++tt){const lt=tt-ke,xt=Math.max(0,Math.ceil(lt/pe)),os=Math.min(W,(Q+lt)/pe);for(let Et=0;Et<X;++Et){const On=Et-Ce,mn=Math.max(0,Math.ceil(On/me)),to=Math.min(ie,(K+On)/me);let jn=0;for(let gs=at;gs<Pe;++gs){const Os=gs*he-et;for(let ys=xt;ys<os;++ys){const rs=ys*pe-lt;for(let Jo=mn;Jo<to;++Jo){const No=Jo*me-On,To=$*Fe+S*gs+N*ys+R*Jo,If=O*(U-1-Os)+D*(Q-1-rs)+A*(K-1-No)+T*Ue;for(let Ur=0;Ur<Y;++Ur){const Fc=C[To+Ur],Sf=F[If+Ur];jn+=Fc*Sf}}}}g[y*Fe+b*Ze+v*tt+w*Et+Ue]=jn}}}return t.makeTensorInfo(f.shape,f.dtype,f.values)}const YG={kernelName:dx,backendName:"cpu",kernelFunc:XG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QG=mt($u,n=>Math.cos(n)),JG={kernelName:$u,backendName:"cpu",kernelFunc:QG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZG=mt(Nu,n=>Math.cosh(n)),ej={kernelName:Nu,backendName:"cpu",kernelFunc:ZG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tj(n){const{inputs:e,backend:t,attrs:s}=n,{image:o,boxes:r,boxInd:i}=e,{cropSize:a,method:u,extrapolationValue:d}=s,[h,p,f,g]=o.shape,y=r.shape[0],[b,v]=a,w=qe([y,b,v,g],"float32"),C=t.data.get(r.dataId).values,$=t.data.get(i.dataId).values,S=t.data.get(o.dataId).values,N=Oe(o.shape),R=Oe(w.shape);for(let F=0;F<y;F++){const O=F*4,D=C[O],A=C[O+1],T=C[O+2],B=C[O+3],U=$[F];if(U>=h)continue;const Q=b>1?(T-D)*(p-1)/(b-1):0,K=v>1?(B-A)*(f-1)/(v-1):0;for(let J=0;J<b;J++){const te=b>1?D*(p-1)+J*Q:.5*(D+T)*(p-1);if(te<0||te>p-1){for(let P=0;P<v;P++)for(let X=0;X<g;X++){const Y=X+P*R[2]+J*R[1]+F*R[0];w.values[Y]=d}continue}if(u==="bilinear"){const P=Math.floor(te),X=Math.ceil(te),Y=te-P;for(let L=0;L<v;L++){const W=v>1?A*(f-1)+L*K:.5*(A+B)*(f-1);if(W<0||W>f-1){for(let me=0;me<g;me++){const we=me+L*R[2]+J*R[1]+F*R[0];w.values[we]=d}continue}const ie=Math.floor(W),he=Math.ceil(W),pe=W-ie;for(let me=0;me<g;me++){let we=me+ie*N[2]+P*N[1]+U*N[0];const ke=S[we];we=me+he*N[2]+P*N[1]+U*N[0];const Ce=S[we];we=me+ie*N[2]+X*N[1]+U*N[0];const Fe=S[we];we=me+he*N[2]+X*N[1]+U*N[0];const Ue=S[we],Ze=ke+(Ce-ke)*pe,et=Fe+(Ue-Fe)*pe;we=me+L*R[2]+J*R[1]+F*R[0],w.values[we]=Ze+(et-Ze)*Y}}}else for(let P=0;P<v;++P){const X=v>1?A*(f-1)+P*K:.5*(A+B)*(f-1);if(X<0||X>f-1){for(let W=0;W<g;W++){const ie=W+P*R[2]+J*R[1]+F*R[0];w.values[ie]=d}continue}const Y=Math.round(X),L=Math.round(te);for(let W=0;W<g;W++){const ie=W+Y*N[2]+L*N[1]+U*N[0],he=W+P*R[2]+J*R[1]+F*R[0];w.values[he]=S[ie]}}}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const nj={kernelName:px,backendName:"cpu",kernelFunc:tj};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sj(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,exclusive:i,reverse:a}=s;Ee(o,"cumprod");const u=Dt([r],o.shape.length);let d=o;u!=null&&(d=Un({inputs:{x:o},backend:t,attrs:{perm:u}}));const h=zt(1,o.shape.length)[0];if(h!==d.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${d.shape.length-1} but got axis=${h}`);const p=ts(d.dtype,"int32"),f=Jy(de(d.shape),p),g=t.data.get(d.dataId).values,y=d.shape[d.shape.length-1],b=a?(w,C)=>w+y-C-1:(w,C)=>w+C;for(let w=0;w<g.length;w+=y)for(let C=0;C<y;C++){const $=b(w,C);if(C===0)f[$]=i?1:g[$];else{const S=b(w,C-1);f[$]=i?g[S]*f[S]:g[$]*f[S]}}const v=t.makeTensorInfo(d.shape,p,f);if(u!=null){const w=Lr(u),C=Un({inputs:{x:v},backend:t,attrs:{perm:w}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(d),C}return v}const oj={kernelName:hx,backendName:"cpu",kernelFunc:sj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rj(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,exclusive:i,reverse:a}=s;Ee(o,"cumsum");const u=Dt([r],o.shape.length);let d=o;u!=null&&(d=Un({inputs:{x:o},backend:t,attrs:{perm:u}}));const h=zt(1,o.shape.length)[0];if(h!==d.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${d.shape.length-1} but got axis=${h}`);const p=ts(d.dtype,"int32"),f=bn(de(d.shape),p),g=t.data.get(d.dataId).values,y=d.shape[d.shape.length-1],b=a?(w,C)=>w+y-C-1:(w,C)=>w+C;for(let w=0;w<g.length;w+=y)for(let C=0;C<y;C++){const $=b(w,C);if(C===0)f[$]=i?0:g[$];else{const S=b(w,C-1);f[$]=i?g[S]+f[S]:g[$]+f[S]}}const v=t.makeTensorInfo(d.shape,p,f);if(u!=null){const w=Lr(u),C=Un({inputs:{x:v},backend:t,attrs:{perm:w}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(d),C}return v}const ij={kernelName:rp,backendName:"cpu",kernelFunc:rj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aj(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,weights:r}=e,{size:i,binaryOutput:a}=s;if(o.shape.length===1){const u=t.data.get(o.dataId).values,d=t.data.get(r.dataId).values,h=g1(u,d,r.dtype,r.shape,i);return t.makeTensorInfo([i],r.dtype,h)}else if(o.shape.length===2){const u=t.bufferSync(o),d=t.bufferSync(r),h=qN(u,d,i,a);return t.makeTensorInfo(h.shape,r.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}const lj={kernelName:fx,backendName:"cpu",kernelFunc:aj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uj(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{blockSize:r,dataFormat:i}=s;_(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=o.shape[0],u=o.shape[1],d=o.shape[2],h=o.shape[3],p=u*r,f=d*r,g=h/(r*r),y=t.data.get(o.dataId).values,b=new Float32Array(a*p*f*g);let v=0;for(let w=0;w<a;++w)for(let C=0;C<p;++C){const $=Math.floor(C/r),S=C%r;for(let N=0;N<f;++N){const R=Math.floor(N/r),F=N%r,O=(S*r+F)*g;for(let D=0;D<g;++D){const T=D+O+h*(R+d*($+u*w));b[v++]=y[T]}}}return t.makeTensorInfo([a,p,f,g],o.dtype,b)}const cj={kernelName:mx,backendName:"cpu",kernelFunc:uj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qT(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r}=e,{strides:i,pad:a,dilations:u,dimRoundingMode:d}=s;Ee([o,r],"depthwiseConv2DNative");const h=Oe(o.shape),p=Oe(r.shape);let f=u;f==null&&(f=[1,1]),_(wn(i,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${f}'`);const g=hn(o.shape,r.shape,i,f,a,d,!0),{filterHeight:y,filterWidth:b,dilationHeight:v,dilationWidth:w,padInfo:C}=g,$=C.left,S=C.top,N=g.outChannels/g.inChannels,R=new dn(g.outShape,o.dtype),F=t.data.get(o.dataId).values,O=t.data.get(r.dataId).values,D=R.values;for(let A=0;A<g.batchSize;++A){const T=A*h[0],B=A*R.strides[0];for(let U=0;U<g.outHeight;++U){const Q=B+U*R.strides[1],K=U*g.strideHeight-S;for(let J=0;J<y;++J){const te=K+J*v;if(te<0||te>=g.inHeight)continue;const P=J*p[0],X=T+te*h[1];for(let Y=0;Y<g.outWidth;++Y){const L=Q+Y*R.strides[2],W=Y*g.strideWidth-$;for(let ie=0;ie<b;++ie){const he=W+ie*w;if(he<0||he>=g.inWidth)continue;const pe=P+ie*p[1],me=X+he*g.inChannels;let we=L,ke=pe;for(let Ce=0;Ce<g.inChannels;++Ce){const Fe=F[me+Ce];for(let Ue=0;Ue<N;++Ue)D[we+Ue]+=Fe*O[ke+Ue];we+=N,ke+=N}}}}}}return t.makeTensorInfo(R.shape,R.dtype,R.values)}const dj={kernelName:ip,backendName:"cpu",kernelFunc:qT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hj(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,dy:r}=e,{strides:i,dilations:a,pad:u,dimRoundingMode:d,filterShape:h}=s;Ee([o,r],"depthwiseConv2dNativeBackpropFilter");const p=hn(o.shape,h,i,a,u,d,!0),{strideHeight:f,strideWidth:g,filterHeight:y,filterWidth:b}=p,v=new dn(p.filterShape,"float32"),w=p.padInfo.left,C=p.padInfo.top,$=p.outChannels/p.inChannels,S=t.data.get(o.dataId).values,N=new dn(o.shape,o.dtype,S),R=t.data.get(r.dataId).values,F=new dn(r.shape,r.dtype,R);for(let O=0;O<y;++O){const D=Math.max(0,Math.ceil((C-O)/f)),A=Math.min(p.outHeight,(p.inHeight+C-O)/f);for(let T=0;T<b;++T){const B=Math.max(0,Math.ceil((w-T)/g)),U=Math.min(p.outWidth,(p.inWidth+w-T)/g);for(let Q=0;Q<p.outChannels;++Q){const K=Math.trunc(Q/$),J=Q%$;let te=0;for(let P=0;P<p.batchSize;++P)for(let X=D;X<A;++X){const Y=O+X*f-C;for(let L=B;L<U;++L){const W=T+L*g-w;te+=N.get(P,Y,W,K)*F.get(P,X,L,Q)}}v.set(te,O,T,K,J)}}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const pj={kernelName:gx,backendName:"cpu",kernelFunc:hj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fj(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,filter:r}=e,{strides:i,dilations:a,pad:u,dimRoundingMode:d,inputShape:h}=s;Ee([o,r],"depthwiseConv2DNativeBackpropInput");const p=Oe(o.shape),f=Oe(r.shape),g=hn(h,r.shape,i,a,u,d,!0),y=new dn(g.inShape,"float32"),b=y.values,[v,w,C]=y.strides,$=t.data.get(o.dataId).values,[S,N,R]=p,F=t.data.get(r.dataId).values,[O,D,A]=f,{batchSize:T,filterHeight:B,filterWidth:U,inChannels:Q,inHeight:K,inWidth:J,outChannels:te,outHeight:P,outWidth:X,strideHeight:Y,strideWidth:L}=g,W=B-1-g.padInfo.top,ie=U-1-g.padInfo.left,he=te/Q;for(let pe=0;pe<T;++pe)for(let me=0;me<Q;++me)for(let we=0;we<K;++we){const ke=we-W,Ce=Math.max(0,Math.ceil(ke/Y)),Fe=Math.min(P,(B+ke)/Y);for(let Ue=0;Ue<J;++Ue){const Ze=Ue-ie,et=Math.max(0,Math.ceil(Ze/L)),at=Math.min(X,(U+Ze)/L);let Pe=0;for(let tt=Ce;tt<Fe;++tt){const lt=tt*Y-ke;for(let xt=et;xt<at;++xt){const os=xt*L-Ze,Et=S*pe+N*tt+R*xt,On=O*(B-1-lt)+D*(U-1-os)+A*me;for(let mn=0;mn<he;++mn){const to=me*he+mn,jn=$[Et+to],gs=F[On+mn];Pe+=jn*gs}}}b[v*pe+w*we+C*Ue+me]=Pe}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const mj={kernelName:yx,backendName:"cpu",kernelFunc:fj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gj(n){const{inputs:e,backend:t}=n,{x:s}=e,o=de(s.shape),r=t.data.get(s.dataId).values,i=qe([o,o],s.dtype),a=i.values;for(let d=0;d<r.length;d++)a[d*o+d]=r[d];const u=[...s.shape,...s.shape];return t.makeTensorInfo(u,i.dtype,i.values)}const yj={kernelName:bI,backendName:"cpu",kernelFunc:gj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xj={kernelName:ap,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:o}=n,{strides:r,pad:i,dilations:a}=t,u=e,d=u.data.get(s.dataId).values,h=s.shape.length,p=u.data.get(o.dataId).values,f=o.shape.length,{batchSize:g,inHeight:y,inWidth:b,inChannels:v,outHeight:w,outWidth:C,padInfo:$,strideHeight:S,strideWidth:N,filterHeight:R,filterWidth:F,dilationHeight:O,dilationWidth:D,outShape:A}=dc(s.shape,o.shape,r,i,"NHWC",a),T=de(A),B=A.length,U=Lt(s.dtype,T);for(let K=0;K<g;++K)for(let J=0;J<w;++J){const te=J*S-$.top;for(let P=0;P<C;++P){const X=P*N-$.left;for(let Y=0;Y<v;++Y){let L=Number.MIN_SAFE_INTEGER;for(let ie=0;ie<R;++ie){const he=te+ie*O;if(he>=0&&he<y)for(let pe=0;pe<F;++pe){const me=X+pe*D;if(me>=0&&me<b){const we=go([K,he,me,Y],h,Oe(s.shape)),ke=go([ie,pe,Y],f,Oe(o.shape)),Ce=d[we]+p[ke];Ce>L&&(L=Ce)}}}const W=go([K,J,P,Y],B,Oe(A));U[W]=L}}}return{dataId:u.write(Di(U,s.dtype),A,s.dtype),shape:A,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bj={kernelName:sy,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:o,dy:r}=n,{strides:i,pad:a,dilations:u}=t,d=e,h=Ks(s.shape,d.data.get(s.dataId).values),p=Ks(o.shape,d.data.get(o.dataId).values),{batchSize:f,inHeight:g,inWidth:y,inChannels:b,outHeight:v,outWidth:w,padInfo:C,strideHeight:$,strideWidth:S,filterHeight:N,filterWidth:R,dilationHeight:F,dilationWidth:O,outShape:D}=dc(s.shape,o.shape,i,a,"NHWC",u);_(r.rank===D.length,()=>`Error in ${sy}, dy must have the same rank as output ${D.length}, but got ${r.rank}`);const A=Ks(D,d.data.get(r.dataId).values),T=mI(o.shape,o.dtype);for(let U=0;U<f;++U)for(let Q=0;Q<v;++Q){const K=Q*$-C.top;for(let J=0;J<w;++J){const te=J*S-C.left;for(let P=0;P<b;++P){let X=Number.MIN_SAFE_INTEGER,Y=0,L=0;for(let W=0;W<N;++W){const ie=K+W*F;if(ie>=0&&ie<g)for(let he=0;he<R;++he){const pe=te+he*O;if(pe>=0&&pe<y){const me=h[U][ie][pe][P]+p[W][he][P];me>X&&(X=me,Y=W,L=he)}}}T[Y][L][P]+=A[U][Q][J][P]}}}return{dataId:d.write(Di(T,s.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vj={kernelName:ny,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:o,dy:r}=n,{strides:i,pad:a,dilations:u}=t,d=e,h=Ks(s.shape,d.data.get(s.dataId).values),p=Ks(o.shape,d.data.get(o.dataId).values),{batchSize:f,inHeight:g,inWidth:y,inChannels:b,outHeight:v,outWidth:w,padInfo:C,strideHeight:$,strideWidth:S,filterHeight:N,filterWidth:R,dilationHeight:F,dilationWidth:O,outShape:D}=dc(s.shape,o.shape,i,a,"NHWC",u);_(r.rank===D.length,()=>`Error in ${ny}, dy must have the same rank as output ${D.length}, but got ${r.rank}`);const A=Ks(D,d.data.get(r.dataId).values),T=mI(s.shape,s.dtype);for(let U=0;U<f;++U)for(let Q=0;Q<v;++Q){const K=Q*$-C.top;for(let J=0;J<w;++J){const te=J*S-C.left;for(let P=0;P<b;++P){let X=Number.MIN_SAFE_INTEGER,Y=K<0?0:K,L=te<0?0:te;for(let W=0;W<N;++W){const ie=K+W*F;if(ie>=0&&ie<g)for(let he=0;he<R;++he){const pe=te+he*O;if(pe>=0&&pe<y){const me=h[U][ie][pe][P]+p[W][he][P];me>X&&(X=me,Y=ie,L=pe)}}}T[U][Y][L][P]+=A[U][Q][J][P]}}}return{dataId:d.write(Di(T,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wj(n){const{inputs:e,backend:t,attrs:s}=n,{image:o}=e,{canvas:r,options:i}=s,{contextOptions:a,imageOptions:u}=i||{},d=(u==null?void 0:u.alpha)||1,h=(a==null?void 0:a.contextType)||"2d";if(h!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const p=r.getContext(h,(a==null?void 0:a.contextAttributes)||{});if(p==null)throw new Error(`Could not get the context with ${h} type.`);const[f,g]=o.shape.slice(0,2),y=o.shape.length===2?1:o.shape[2],b=t.data.get(o.dataId).values,v=o.dtype==="float32"?255:1,w=new Uint8ClampedArray(g*f*4);for(let $=0;$<f*g;++$){const S=[0,0,0,255*d];for(let R=0;R<y;R++){const F=b[$*y+R];if(o.dtype==="float32"){if(F<0||F>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${F}.`)}else if(o.dtype==="int32"&&(F<0||F>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${F}.`);y===1?(S[0]=F*v,S[1]=F*v,S[2]=F*v):S[R]=F*v}const N=$*4;w[N+0]=Math.round(S[0]),w[N+1]=Math.round(S[1]),w[N+2]=Math.round(S[2]),w[N+3]=Math.round(S[3])}r.width=g,r.height=f;const C=new ImageData(w,g,f);return p.putImageData(C,0,0),o}const kj={kernelName:e_,backendName:"cpu",kernelFunc:wj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nc(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s;Ee(o,"sum");let a;o.dtype==="bool"?a=Dr({inputs:{x:o},backend:t,attrs:{dtype:"int32"}}):a=So({inputs:{x:o},backend:t});const u=a.shape.length,d=Ke(r,a.shape),h=Dt(d,u);let p=d,f=a;h!=null&&(f=Un({inputs:{x:a},backend:t,attrs:{perm:h}}),p=zt(p.length,u)),pn("sum",p,f.shape.length);const[g,y]=rn(f.shape,p),b=ts(f.dtype,"int32");let v=Lh(t,g,b);const w=de(y),C=t.data.get(v.dataId).values,$=t.data.get(f.dataId).values;for(let S=0;S<C.length;++S){const N=S*w;let R=0;for(let F=0;F<w;++F)R+=$[N+F];C[S]=R}if(i){const S=jt(v.shape,d),N=v;v=kt({inputs:{x:v},backend:t,attrs:{shape:S}}),t.disposeIntermediateTensorInfo(N)}return t.disposeIntermediateTensorInfo(a),h!=null&&t.disposeIntermediateTensorInfo(f),v}const Cj={kernelName:Bp,backendName:"cpu",kernelFunc:Nc};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ij(n){const{inputs:e,backend:t,attrs:s}=n,{equation:o}=s,r=e,{allDims:i,summedDims:a,idDims:u}=P0(o,r.length);B0(i.length,u,r);const{path:d,steps:h}=W0(a,u),p=h.length;let f=null,g=i.length;const y=[];for(let b=0;b<p;++b){for(const v of h[b]){const{permutationIndices:w,expandDims:C}=z0(g,u[v]);let $;V0(w)?$=r[v]:($=Un({inputs:{x:r[v]},backend:t,attrs:{perm:w}}),y.push($));const S=$.shape.slice();for(let N=0;N<C.length;++N)S.splice(C[N],0,1);ht($.shape,S)||($=kt({inputs:{x:$},backend:t,attrs:{shape:S}}),y.push($)),f===null?f=$:(f=xf({inputs:{a:$,b:f},backend:t}),y.push(f))}b<p-1&&(d[b]>=0&&(f=Nc({inputs:{x:f},backend:t,attrs:{axis:d[b]-(i.length-g),keepDims:!1}}),y.push(f)),g--)}for(const b of y)b!==f&&t.disposeIntermediateTensorInfo(b);return f}const Sj={kernelName:xx,backendName:"cpu",kernelFunc:Ij};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $j(n){const{inputs:e,backend:t}=n,{dy:s,y:o}=e;Ee([s,o],"eluGrad");const r=new Float32Array(de(o.shape)),i=t.data.get(o.dataId).values,a=t.data.get(s.dataId).values;for(let u=0;u<i.length;++u){const d=i[u];d>=0?r[u]=a[u]:r[u]=a[u]*(d+1)}return t.makeTensorInfo(o.shape,"float32",r)}const Nj={kernelName:bx,backendName:"cpu",kernelFunc:$j};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tj=A0,Ej=D0,Rj=F0,Aj=_0,Dj=O0,Fj=L0,_j=mt(Ru,n=>{const e=Math.sign(n),t=Math.abs(n),s=1/(1+Tj*t);return e*(1-((((Fj*s+Dj)*s+Aj)*s+Rj)*s+Ej)*s*Math.exp(-t*t))}),Oj={kernelName:Ru,backendName:"cpu",kernelFunc:_j};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zh(n){const{inputs:e,backend:t,attrs:s}=n,{input:o}=e,{dim:r}=s,i=o.shape.length,a=o.shape.slice();let u=r;return r<0&&(_(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+r+1),a.splice(u,0,1),kt({inputs:{x:o},backend:t,attrs:{shape:a}})}const Lj={kernelName:up,backendName:"cpu",kernelFunc:zh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mj=Wt((n,e)=>n/e),k1=Zt(Tu,Mj),Ey={kernelName:Tu,backendName:"cpu",kernelFunc:k1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KT(n,e,t){const s=n.shape,o=s[0],r=s[1],i=t.data.get(n.dataId),a=i.complexTensorInfos.real,u=i.complexTensorInfos.imag,d=[o,r],h=de(d),p=xn("float32",h),f=xn("float32",h);for(let v=0;v<o;v++){const w=Ri({inputs:{x:a},backend:t,attrs:{begin:[v,0],size:[1,r]}}),C=Ri({inputs:{x:u},backend:t,attrs:{begin:[v,0],size:[1,r]}}),$=Zn({inputs:{real:w,imag:C},backend:t}),{real:S,imag:N}=Pj($,e,t),R=jo(S,N);for(let F=0;F<r;F++){const O=M0(R,F);p[v*r+F]=O.real,f[v*r+F]=O.imag}t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo($)}const g=t.makeTensorInfo(d,"float32",p),y=t.makeTensorInfo(d,"float32",f),b=Zn({inputs:{real:g,imag:y},backend:t});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),b}function Pj(n,e,t){const s=de(n.shape),o=t.data.get(n.dataId),r=t.data.get(o.complexTensorInfos.real.dataId).values,i=t.data.get(o.complexTensorInfos.imag.dataId).values;if(zj(s)){const a=Ry(r,i,s,e,t),u=[n.shape[0],n.shape[1]];if(e){const d=t.makeTensorInfo(u,"float32",a.real),h=t.makeTensorInfo(u,"float32",a.imag),p=t.makeTensorInfo([],"float32",_r(s,"float32")),f=So({inputs:{x:p},backend:t}),g=Ey.kernelFunc({inputs:{a:d,b:p},backend:t}),y=Ey.kernelFunc({inputs:{a:h,b:f},backend:t}),b=t.data.get(g.dataId).values,v=t.data.get(y.dataId).values;return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),{real:b,imag:v}}return a}else{const a=jo(r,i),u=Bj(a,s,e);return l$(u)}}function zj(n){return(n&n-1)===0}function Ry(n,e,t,s,o){if(t===1)return{real:n,imag:e};const r=jo(n,e),i=t/2,a=u$(r),u=a.real,d=a.imag,h=[u.length],p=o.makeTensorInfo(h,"float32",u),f=o.makeTensorInfo(h,"float32",d),g=Zn({inputs:{real:p,imag:f},backend:o}),y=c$(r),b=y.real,v=y.imag,w=[b.length],C=o.makeTensorInfo(w,"float32",b),$=o.makeTensorInfo(w,"float32",v),S=Zn({inputs:{real:C,imag:$},backend:o}),N=Ry(u,d,i,s,o),R=N.real,F=N.imag,O=[R.length],D=o.makeTensorInfo(O,"float32",R),A=o.makeTensorInfo(O,"float32",F),T=Zn({inputs:{real:D,imag:A},backend:o}),B=Ry(b,v,i,s,o),U=B.real,Q=B.imag,K=[U.length],J=o.makeTensorInfo(K,"float32",U),te=o.makeTensorInfo(K,"float32",Q),P=Zn({inputs:{real:J,imag:te},backend:o}),X=h$(t,s),Y=[X.real.length],L=o.makeTensorInfo(Y,"float32",X.real),W=o.makeTensorInfo(Y,"float32",X.imag),ie=Zn({inputs:{real:L,imag:W},backend:o}),he=xf({inputs:{a:ie,b:P},backend:o}),pe=Oa({inputs:{a:T,b:he},backend:o}),me=v1({inputs:{a:T,b:he},backend:o}),we=Ei({inputs:{input:pe},backend:o}),ke=Ei({inputs:{input:me},backend:o}),Ce=La({inputs:{input:pe},backend:o}),Fe=La({inputs:{input:me},backend:o}),Ue=Ma({inputs:[we,ke],backend:o,attrs:{axis:0}}),Ze=Ma({inputs:[Ce,Fe],backend:o,attrs:{axis:0}}),et=o.data.get(Ue.dataId).values,at=o.data.get(Ze.dataId).values;return o.disposeIntermediateTensorInfo(p),o.disposeIntermediateTensorInfo(f),o.disposeIntermediateTensorInfo(g),o.disposeIntermediateTensorInfo(C),o.disposeIntermediateTensorInfo($),o.disposeIntermediateTensorInfo(S),o.disposeIntermediateTensorInfo(D),o.disposeIntermediateTensorInfo(A),o.disposeIntermediateTensorInfo(T),o.disposeIntermediateTensorInfo(J),o.disposeIntermediateTensorInfo(te),o.disposeIntermediateTensorInfo(P),o.disposeIntermediateTensorInfo(L),o.disposeIntermediateTensorInfo(W),o.disposeIntermediateTensorInfo(ie),o.disposeIntermediateTensorInfo(he),o.disposeIntermediateTensorInfo(pe),o.disposeIntermediateTensorInfo(me),o.disposeIntermediateTensorInfo(we),o.disposeIntermediateTensorInfo(Ce),o.disposeIntermediateTensorInfo(ke),o.disposeIntermediateTensorInfo(Fe),o.disposeIntermediateTensorInfo(Ue),o.disposeIntermediateTensorInfo(Ze),{real:et,imag:at}}function Bj(n,e,t){const s=new Float32Array(e*2);for(let o=0;o<e;o++){let r=0,i=0;for(let a=0;a<e;a++){const u=p$(o*a,e,t),d=M0(n,a);r+=d.real*u.real-d.imag*u.imag,i+=d.real*u.imag+d.imag*u.real}t&&(r/=e,i/=e),d$(s,r,i,o)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wj(n){const{inputs:e,backend:t}=n,{input:s}=e,o=de(s.shape),r=s.shape[s.shape.length-1],i=o/r,a=kt({inputs:{x:s},backend:t,attrs:{shape:[i,r]}}),u=KT(a,!1,t),d=kt({inputs:{x:u},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(u),d}const Vj={kernelName:vx,backendName:"cpu",kernelFunc:Wj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1(n){const{backend:e,attrs:t}=n,{shape:s,value:o,dtype:r}=t,i=r||Ba(o),a=Lt(i,de(s));return Gj(a,o,i),e.makeTensorInfo(s,i,a)}const Uj={kernelName:wx,backendName:"cpu",kernelFunc:C1};function Gj(n,e,t){n.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jj={kernelName:kx,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,o=t,r=xn(s.dtype,de(s.shape)),[i,a,u,d]=s.shape,h=o.data.get(s.dataId).values;for(let f=0;f<i;f++){const g=f*u*a*d;for(let y=0;y<a;y++){const b=y*(u*d);for(let v=0;v<u;v++){const w=v*d;for(let C=0;C<d;C++){const $=Math.round(u-v-1),S=g+b+w+C;let N=h[S];if($>=0&&$<u){const R=$*d,F=g+b+R+C;N=h[F]}r[S]=N}}}}return{dataId:o.write(r,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hj(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r,bias:i,preluActivationWeights:a}=e,{strides:u,pad:d,dataFormat:h,dilations:p,dimRoundingMode:f,activation:g,leakyreluAlpha:y}=s;let b=HT({inputs:{x:o,filter:r},backend:t,attrs:{strides:u,pad:d,dataFormat:h,dilations:p,dimRoundingMode:f}});if(i){const v=b;if(h==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const w=kt({inputs:{x:i},backend:t,attrs:{shape:[i.shape[0],1,1]}});b=Oa({inputs:{a:b,b:w},backend:t}),t.disposeIntermediateTensorInfo(w)}else b=Oa({inputs:{a:b,b:i},backend:t});t.disposeIntermediateTensorInfo(v)}if(g){const v=b;if(h==="NCHW"&&g==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const w=kt({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});b=Ph(t,b,g,w,y),t.disposeIntermediateTensorInfo(w)}else b=Ph(t,b,g,a,y);t.disposeIntermediateTensorInfo(v)}return b}const qj={kernelName:bh,backendName:"cpu",kernelFunc:Hj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kj(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r,bias:i,preluActivationWeights:a}=e,{strides:u,pad:d,dataFormat:h,dilations:p,dimRoundingMode:f,activation:g,leakyreluAlpha:y}=s;let b=qT({inputs:{x:o,filter:r},backend:t,attrs:{strides:u,pad:d,dataFormat:h,dilations:p,dimRoundingMode:f}});if(i){const v=b;b=Oa({inputs:{a:b,b:i},backend:t}),t.disposeIntermediateTensorInfo(v)}if(g){const v=b;b=Ph(t,b,g,a,y),t.disposeIntermediateTensorInfo(v)}return b}const Xj={kernelName:PI,backendName:"cpu",kernelFunc:Kj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yj(n){const{inputs:e,backend:t}=n,{params:s,indices:o}=e,r=de(s.shape),i=o.shape,a=i[i.length-1],[u,d,h,p]=v0(s,o);if(d===0)return t.makeTensorInfo(u,s.dtype,[]);const f=t.data.get(o.dataId).values,g=t.bufferSync(s),y=oT(f,g,s.dtype,d,a,h,p,s.shape,r);return t.makeTensorInfo(u,s.dtype,y.values)}const Qj={kernelName:vI,backendName:"cpu",kernelFunc:Yj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jj(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,indices:r}=e,{axis:i,batchDims:a}=s;Ee([o,r],"gatherV2");const u=Ke(i,o.shape)[0],d=t.data.get(r.dataId).values,h=o.shape[u];for(let S=0;S<d.length;++S){const N=d[S];_(N<=h-1&&N>=0,()=>`GatherV2: the index value ${N} is not in [0, ${h-1}]`)}let p=a;a==null&&(p=0);const f=de(r.shape),g=G0(o,r,u,p),y=kt({inputs:{x:o},backend:t,attrs:{shape:[g.batchSize,g.outerSize,g.dimSize,g.sliceSize]}}),b=kt({inputs:{x:r},backend:t,attrs:{shape:[g.batchSize,f/g.batchSize]}}),v=[g.batchSize,g.outerSize,f/g.batchSize,g.sliceSize],w=t.bufferSync(b),C=t.bufferSync(y),$=rT(C,w,v);return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(b),t.makeTensorInfo(g.outputShape,$.dtype,$.values)}const Zj={kernelName:dp,backendName:"cpu",kernelFunc:Jj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eH(n){const{inputs:e,backend:t}=n,{input:s}=e,o=de(s.shape),r=s.shape[s.shape.length-1],i=o/r,a=kt({inputs:{x:s},backend:t,attrs:{shape:[i,r]}}),u=KT(a,!0,t),d=kt({inputs:{x:u},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(u),d}const tH={kernelName:Cx,backendName:"cpu",kernelFunc:eH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nH=mt(Mu,n=>Number.isFinite(n)?1:0,"bool"),sH={kernelName:Mu,backendName:"cpu",kernelFunc:nH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oH=mt(Pu,n=>Math.abs(n)===1/0?1:0,"bool"),rH={kernelName:Pu,backendName:"cpu",kernelFunc:oH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iH=mt(zu,n=>Number.isNaN(n)?1:0,"bool"),aH={kernelName:zu,backendName:"cpu",kernelFunc:iH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lH(n){const{backend:e,attrs:t}=n,{start:s,stop:o,num:r}=t,i=cT(s,o,r);return e.makeTensorInfo([i.length],"float32",i)}const uH={kernelName:wI,backendName:"cpu",kernelFunc:lH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cH=mt(Wu,n=>Math.log1p(n)),dH={kernelName:Wu,backendName:"cpu",kernelFunc:cH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hH=Wt((n,e)=>n&&e),pH=Zt(gp,hH,null,"bool"),fH={kernelName:gp,backendName:"cpu",kernelFunc:pH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mH=mt(yp,n=>n?0:1,"bool"),gH={kernelName:yp,backendName:"cpu",kernelFunc:mH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yH=Wt((n,e)=>n||e),xH=Zt(xp,yH,null,"bool"),bH={kernelName:xp,backendName:"cpu",kernelFunc:xH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vH(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{depthRadius:r,bias:i,alpha:a,beta:u}=s;Ee(o,"LRN");const d=o.shape[3],h=d-1,p=t.data.get(o.dataId).values,f=de(o.shape),g=new Float32Array(f);function y(b){const v=b%d;let w=b-v+Math.max(0,v-r);const C=b-v+Math.min(v+r,h);let $=0;for(;w<=C;w++){const S=p[w];$+=S*S}return $}for(let b=0;b<f;b++){const v=y(b),w=p[b]*Math.pow(i+a*v,-u);g[b]=w}return t.makeTensorInfo(o.shape,o.dtype,g)}const wH={kernelName:bp,backendName:"cpu",kernelFunc:vH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kH(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,y:r,dy:i}=e,{depthRadius:a,bias:u,alpha:d,beta:h}=s;Ee(i,"LRNGrad");const p=de(i.shape),f=i.shape[3],g=t.data.get(i.dataId).values,y=t.data.get(o.dataId).values,b=t.data.get(r.dataId).values,v=new Float32Array(p),w=p;for(let C=0;C<w;C++){const $=C%f,S=C-$+Math.max(0,$-a),N=C-$+Math.min(f,$+a+1);let R=0;for(let F=S;F<N;F++)R+=Math.pow(y[F],2);R=d*R+u;for(let F=S;F<N;F++){let O=-2*d*h*y[F]*b[C]/R;C===F&&(O+=Math.pow(R,-h)),O*=g[C],v[F]+=O}}return t.makeTensorInfo(i.shape,o.dtype,v)}const CH={kernelName:Sx,backendName:"cpu",kernelFunc:kH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XT(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{reductionIndices:r,keepDims:i}=s,a=t;let u=o.shape;const d=u.length,h=Ke(r,u);let p=h;const f=Dt(p,d);let g=a.data.get(o.dataId).values;if(f!=null){const S=new Array(d);for(let N=0;N<S.length;N++)S[N]=u[f[N]];g=x1(g,u,o.dtype,f,S),p=zt(p.length,d),u=S}Ee(o,"max"),pn("max",p,d);const[y,b]=rn(u,p),v=de(b),w=hT(g,v,y,o.dtype),C=a.write(w,y,o.dtype);let $=y;return i&&($=jt(y,h)),{dataId:C,shape:$,dtype:o.dtype}}const IH={kernelName:vp,backendName:"cpu",kernelFunc:XT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SH(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e;Ee(o,"maxPool");const{filterSize:r,strides:i,pad:a,dimRoundingMode:u}=s,d=1;_(wn(i,d),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);const h=Ds(o.shape,r,i,d,a,u);let p;if(h.filterWidth===1&&h.filterHeight===1&&ht(h.inShape,h.outShape))p=So({inputs:{x:o},backend:t});else{const f=t.data.get(o.dataId).values,g=Oe(o.shape),y=w1(f,o.shape,o.dtype,g,h,"max");p=t.makeTensorInfo(h.outShape,o.dtype,y.values)}return p}const $H={kernelName:wp,backendName:"cpu",kernelFunc:SH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NH(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{filterSize:r,strides:i,pad:a,dimRoundingMode:u,dataFormat:d}=s;Ee(o,"maxPool3d");const h=Xo(o.shape,r,i,1,a,u,d),p=t.data.get(o.dataId).values,f=jT(p,o.shape,o.dtype,Oe(o.shape),h,"max");return t.makeTensorInfo(f.shape,"float32",f.values)}const TH={kernelName:kp,backendName:"cpu",kernelFunc:NH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EH(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,input:r}=e,{filterSize:i,strides:a,pad:u,dimRoundingMode:d}=s;Ee([o,r],"maxPool3DGrad");const h=Xo(r.shape,i,a,1,u,d),p=t.bufferSync(r),f=yG(p,h),g=h.strideDepth,y=h.strideHeight,b=h.strideWidth,v=h.dilationDepth,w=h.dilationHeight,C=h.dilationWidth,$=h.effectiveFilterDepth,S=h.effectiveFilterHeight,N=h.effectiveFilterWidth,R=$-1-h.padInfo.front,F=N-1-h.padInfo.left,O=S-1-h.padInfo.top,D=qe(r.shape,"float32"),A=t.bufferSync(o);for(let T=0;T<h.batchSize;++T)for(let B=0;B<h.inChannels;++B)for(let U=0;U<h.inDepth;++U)for(let Q=0;Q<h.inHeight;++Q)for(let K=0;K<h.inWidth;++K){const J=U-R,te=Q-O,P=K-F;let X=0;for(let Y=0;Y<$;Y+=v){const L=(J+Y)/g;if(!(L<0||L>=h.outDepth||Math.floor(L)!==L))for(let W=0;W<S;W+=w){const ie=(te+W)/y;if(!(ie<0||ie>=h.outHeight||Math.floor(ie)!==ie))for(let he=0;he<N;he+=C){const pe=(P+he)/b;if(pe<0||pe>=h.outWidth||Math.floor(pe)!==pe)continue;const me=$*S*N-1-f.get(T,L,ie,pe,B),we=Y*S*N+W*N+he,ke=me===we?1:0;if(ke===0)continue;const Ce=A.get(T,L,ie,pe,B);X+=Ce*ke}}}D.set(X,T,U,Q,K,B)}return t.makeTensorInfo(D.shape,D.dtype,D.values)}const RH={kernelName:Nx,backendName:"cpu",kernelFunc:EH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,input:r,output:i}=e,a=r;Ee([r,i],"maxPoolGrad");const{filterSize:u,strides:d,pad:h,dimRoundingMode:p}=s,f=Ds(a.shape,u,d,1,h,p),g=t.data.get(a.dataId).values,y=qe(f.outShape,a.dtype,GT(g,a.shape,a.dtype,f).values),b=f.strideHeight,v=f.strideWidth,w=f.dilationHeight,C=f.dilationWidth,$=f.effectiveFilterHeight,S=f.effectiveFilterWidth,N=S-1-f.padInfo.left,R=$-1-f.padInfo.top,F=qe(a.shape,"float32"),O=t.data.get(o.dataId).values,D=qe(o.shape,"float32",O);for(let A=0;A<f.batchSize;++A)for(let T=0;T<f.inChannels;++T)for(let B=0;B<f.inHeight;++B)for(let U=0;U<f.inWidth;++U){const Q=B-R,K=U-N;let J=0;for(let te=0;te<$;te+=w){const P=(Q+te)/b;if(!(P<0||P>=f.outHeight||Math.floor(P)!==P))for(let X=0;X<S;X+=C){const Y=(K+X)/v;if(Y<0||Y>=f.outWidth||Math.floor(Y)!==Y)continue;const L=$*S-1-y.get(A,P,Y,T),W=te*S+X,ie=L===W?1:0;if(ie===0)continue;const he=D.get(A,P,Y,T);J+=he*ie}}F.set(J,A,B,U,T)}return t.makeTensorInfo(F.shape,F.dtype,F.values)}const DH={kernelName:$x,backendName:"cpu",kernelFunc:AH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FH(n,e,t,s,o){const r=Oe(e),i=w1(n,e,t,r,o,"max"),a=GT(n,e,t,o,!0,s);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _H={kernelName:kI,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:o,strides:r,pad:i,includeBatchInIndex:a}=e,u=t;Ee(s,"MaxPoolWithArgmax");const d=u.data.get(s.dataId).values,h=Ds(s.shape,o,r,[1,1],i),[p,f]=FH(d,s.shape,s.dtype,a,h),g=u.write(p,h.outShape,s.dtype),y=u.write(f,h.outShape,s.dtype);return[{dataId:g,shape:h.outShape,dtype:s.dtype},{dataId:y,shape:h.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OH(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s,a=Ke(r,o.shape),d=rn(o.shape,a)[1],h=de(d),p=[],f=t.makeTensorInfo([],"float32",new Float32Array([h]));p.push(f);const g=Dr({inputs:{x:o},backend:t,attrs:{dtype:"float32"}});p.push(g);const y=k1({inputs:{a:g,b:f},backend:t});p.push(y);const b=Nc({inputs:{x:y},backend:t,attrs:{axis:r,keepDims:i}});return p.forEach(v=>t.disposeIntermediateTensorInfo(v)),b}const LH={kernelName:Cp,backendName:"cpu",kernelFunc:OH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MH(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s;Ee(o,"min");const a=Ke(r,o.shape);let u=a;const d=Dt(u,o.shape.length);let h=o;d!=null&&(h=Un({inputs:{x:o},backend:t,attrs:{perm:d}}),u=zt(u.length,o.shape.length)),pn("min",u,h.shape.length);const[p,f]=rn(h.shape,u),g=de(f),y=bn(de(p),h.dtype),b=t.data.get(h.dataId).values;for(let w=0;w<y.length;++w){const C=w*g;let $=b[C];for(let S=0;S<g;++S){const N=b[C+S];(Number.isNaN(N)||N<$)&&($=N)}y[w]=$}d!=null&&t.disposeIntermediateTensorInfo(h);const v=t.makeTensorInfo(p,h.dtype,y);if(i){const w=jt(p,a),C=kt({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),C}return v}const PH={kernelName:Ip,backendName:"cpu",kernelFunc:MH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zH(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{paddings:r,mode:i}=s;Ee(o,"mirrorPad");const a=r.map(($,S)=>$[0]+o.shape[S]+$[1]),u=r.map($=>$[0]),d=r.map(($,S)=>$[0]+o.shape[S]),h=i==="reflect"?0:1,p=t.data.get(o.dataId).values,f=o.shape.length,g=Oe(o.shape),y=de(a),b=a.length,v=Oe(a),w=xn(o.dtype,y);for(let $=0;$<y;$++){let S=Wa($,b,v);for(let R=0;R<b;R++)S[R]<u[R]?S[R]=u[R]*2-S[R]-h:S[R]>=d[R]&&(S[R]=(d[R]-1)*2-S[R]+h);S=S.map((R,F)=>R-u[F]);const N=go(S,f,g);w[$]=p[N]}return{dataId:t.write(w,a,o.dtype),shape:a,dtype:o.dtype}}const BH={kernelName:Sp,backendName:"cpu",kernelFunc:zH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WH=Wt((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e}),VH=Zt(Gu,WH),UH={kernelName:Gu,backendName:"cpu",kernelFunc:VH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YT(n){const{inputs:e,backend:t,attrs:s}=n,{logits:o}=e,{dim:r}=s,i=o.shape.length;let a=r;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const u=Ke([a],o.shape),d=XT({inputs:{x:o},backend:t,attrs:{reductionIndices:u,keepDims:!1}}),h=jt(d.shape,u),p=kt({inputs:{x:d},backend:t,attrs:{shape:h}}),f=v1({inputs:{a:o,b:p},backend:t}),g=eT({inputs:{x:f},backend:t}),y=Nc({inputs:{x:g},backend:t,attrs:{axis:u,keepDims:!1}}),b=kt({inputs:{x:y},backend:t,attrs:{shape:h}}),v=k1({inputs:{a:g,b},backend:t});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(b),v}const GH={kernelName:Up,backendName:"cpu",kernelFunc:YT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(n){const{inputs:e,backend:t,attrs:s}=n,{logits:o}=e,{numSamples:r,seed:i,normalized:a}=s;Ee(o,"multinomial");const u=a?o:YT({inputs:{logits:o},backend:t,attrs:{dim:-1}}),d=u.shape[0],h=u.shape[1],p=t.data.get(u.dataId).values,f=[d,r],g=bn(de(f),"int32");for(let y=0;y<d;++y){const b=y*h,v=new Float32Array(h-1);v[0]=p[b];for(let $=1;$<v.length;++$)v[$]=v[$-1]+p[b+$];const w=i0.alea(i.toString()),C=y*r;for(let $=0;$<r;++$){const S=w();g[C+$]=v.length;for(let N=0;N<v.length;N++)if(S<v[N]){g[C+$]=N;break}}}return a||t.disposeIntermediateTensorInfo(u),t.makeTensorInfo(f,"int32",g)}const HH={kernelName:CI,backendName:"cpu",kernelFunc:jH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qH=m0;function KH(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:u}=s;Ee(o,"NonMaxSuppression");const d=t.data.get(o.dataId).values,h=t.data.get(r.dataId).values,{selectedIndices:p}=qH(d,h,i,a,u);return t.makeTensorInfo([p.length],"int32",new Int32Array(p))}const XH={kernelName:Tx,backendName:"cpu",kernelFunc:KH};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YH=g0;function QH(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:u,padToMaxOutputSize:d}=s;Ee(o,"NonMaxSuppressionPadded");const h=t.data.get(o.dataId).values,p=t.data.get(r.dataId).values,{selectedIndices:f,validOutputs:g}=YH(h,p,i,a,u,d);return[t.makeTensorInfo([f.length],"int32",new Int32Array(f)),t.makeTensorInfo([],"int32",new Int32Array([g]))]}const JH={kernelName:Ex,backendName:"cpu",kernelFunc:QH};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZH=y0;function eq(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:u,softNmsSigma:d}=s;Ee(o,"NonMaxSuppressionWithScore");const h=t.data.get(o.dataId).values,p=t.data.get(r.dataId).values,f=i,g=a,y=u,b=d,{selectedIndices:v,selectedScores:w}=ZH(h,p,f,g,y,b);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const tq={kernelName:Rx,backendName:"cpu",kernelFunc:eq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nq(n){const{inputs:e,backend:t,attrs:s}=n,{indices:o}=e,{dtype:r,depth:i,onValue:a,offValue:u}=s;Ee(o,"oneHot");const d=de(o.shape),h=new Float32Array(d*i);h.fill(u);const p=t.data.get(o.dataId).values;for(let f=0;f<d;++f)p[f]>=0&&p[f]<i&&(h[f*i+p[f]]=a);return t.makeTensorInfo([...o.shape,i],r,h)}const sq={kernelName:Ep,backendName:"cpu",kernelFunc:nq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bh(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const o=Ei({inputs:{input:s},backend:t}),r=Bh({inputs:{x:o},backend:t}),i=La({inputs:{input:s},backend:t}),a=Bh({inputs:{x:i},backend:t}),u=Zn({inputs:{real:r,imag:a},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),u}else return C1({backend:t,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const oq={kernelName:Hp,backendName:"cpu",kernelFunc:Bh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QT(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const o=Ei({inputs:{input:s},backend:t}),r=QT({inputs:{x:o},backend:t}),i=La({inputs:{input:s},backend:t}),a=Bh({inputs:{x:i},backend:t}),u=Zn({inputs:{real:r,imag:a},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),u}else return C1({backend:t,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const rq={kernelName:Tp,backendName:"cpu",kernelFunc:QT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JT(n){const{inputs:e,backend:t,attrs:s}=n,{axis:o}=s;if(e.length===1)return zh({inputs:{input:e[0]},backend:t,attrs:{dim:o}});const r=e[0].shape,i=e[0].dtype;e.forEach(h=>{Qy(r,h.shape,"All tensors passed to stack must have matching shapes"),_(i===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],u=e.map(h=>{const p=zh({inputs:{input:h},backend:t,attrs:{dim:o}});return a.push(p),p}),d=Ma({inputs:u,backend:t,attrs:{axis:o}});return a.forEach(h=>t.disposeIntermediateTensorInfo(h)),d}const iq={kernelName:Rp,backendName:"cpu",kernelFunc:JT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aq(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{paddings:r,constantValue:i}=s;Ee(o,"pad");const a=r.map((C,$)=>C[0]+o.shape[$]+C[1]),u=r.map(C=>C[0]),d=t.data.get(o.dataId).values,h=de(o.shape),p=o.shape.length,f=Oe(o.shape),g=de(a),y=a.length,b=Oe(a),v=xn(o.dtype,g);i!==0&&v.fill(i);for(let C=0;C<h;C++){const S=Wa(C,p,f).map((R,F)=>R+u[F]),N=go(S,y,b);v[N]=d[C]}return{dataId:t.write(v,a,o.dtype),shape:a,dtype:o.dtype}}const ZT={kernelName:Ap,backendName:"cpu",kernelFunc:aq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lq=Wt((n,e)=>Math.pow(n,e)),uq=Zt(Hu,lq),cq={kernelName:Hu,backendName:"cpu",kernelFunc:uq};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dq(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:o,paramsDenseValues:r,indices:i}=e,a=o.map(v=>t.data.get(v.dataId).values),u=o.map(v=>v.shape),d=t.data.get(r.dataId).values,h=t.data.get(i.dataId).values,[p,f,g]=xT(a,u,d,r.shape,r.dtype,h,i.shape),y=p.map(v=>t.makeTensorInfo([v.length],"int32",v)),b=t.makeTensorInfo(g,r.dtype,f);return y.concat([b])}const hq={kernelName:II,backendName:"cpu",kernelFunc:dq};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pq(n){const{inputs:e,backend:t}=n,{starts:s,limits:o,deltas:r}=e,i=t.data.get(s.dataId).values,a=t.data.get(o.dataId).values,u=t.data.get(r.dataId).values,[d,h]=bT(i,s.shape,s.dtype,a,o.shape,u,r.shape),p=t.makeTensorInfo([d.length],"int32",d),f=t.makeTensorInfo([h.length],s.dtype,h);return[p,f]}const fq={kernelName:SI,backendName:"cpu",kernelFunc:pq};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mq(n){const{inputs:e,backend:t,attrs:s}=n,{shape:o,values:r,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:u}=s,d=t.data.get(o.dataId).values,h=t.data.get(r.dataId).values,p=t.data.get(i.dataId).values,f=a.map(v=>t.data.get(v.dataId).values),g=a.map(v=>v.shape),[y,b]=vT(d,o.shape,h,r.shape,r.dtype,p,i.shape,f,g,u);return t.makeTensorInfo(y,r.dtype,b)}const gq={kernelName:$I,backendName:"cpu",kernelFunc:mq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yq(n){const{backend:e,attrs:t}=n,{start:s,stop:o,dtype:r,step:i}=t,a=wT(s,o,i,r);return e.makeTensorInfo([a.length],r,a)}const xq={kernelName:Ax,backendName:"cpu",kernelFunc:yq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bq=mt(qu,n=>1/n),vq={kernelName:qu,backendName:"cpu",kernelFunc:bq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wq(n){const{inputs:e,backend:t,attrs:s}=n,{images:o}=e,{alignCorners:r,halfPixelCenters:i,size:a}=s;Ee(o,"resizeBilinear");const u=Oe(o.shape),[d,h]=a,[p,f,g,y]=o.shape,b=t.data.get(o.dataId).values,v=new Float32Array(de([p,d,h,y])),w=[r&&d>1?f-1:f,r&&h>1?g-1:g],C=[r&&d>1?d-1:d,r&&h>1?h-1:h];let $=0;const S=w[0]/C[0],N=w[1]/C[1];for(let R=0;R<p;R++)for(let F=0;F<d;F++){let O;i?O=S*(F+.5)-.5:O=S*F;const D=Math.max(0,Math.floor(O)),A=O-D,T=Math.min(f-1,Math.ceil(O)),B=R*u[0]+D*u[1],U=R*u[0]+T*u[1];for(let Q=0;Q<h;Q++){let K;i?K=N*(Q+.5)-.5:K=N*Q;const J=Math.max(0,Math.floor(K)),te=K-J,P=Math.min(g-1,Math.ceil(K)),X=B+J*u[2],Y=U+J*u[2],L=B+P*u[2],W=U+P*u[2];for(let ie=0;ie<y;ie++){const he=b[X+ie],pe=b[Y+ie],me=b[L+ie],we=b[W+ie],ke=he+(me-he)*te,Ce=pe+(we-pe)*te,Fe=ke+(Ce-ke)*A;v[$++]=Fe}}}return t.makeTensorInfo([p,d,h,y],"float32",v)}const kq={kernelName:Lp,backendName:"cpu",kernelFunc:wq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cq(n){const{inputs:e,backend:t,attrs:s}=n,{images:o,dy:r}=e,{alignCorners:i}=s;Ee([r,o],"resizeBilinearGrad");const a=Oe(o.shape),[u,d,h,p]=o.shape,[,f,g]=r.shape,y=new Float32Array(u*d*h*p),b=[i&&f>1?d-1:d,i&&g>1?h-1:h],v=[i&&f>1?f-1:f,i&&g>1?g-1:g],w=b[0]/v[0],C=b[1]/v[1],$=t.data.get(r.dataId).values;let S=0;for(let N=0;N<u;N++){const R=N*a[0];for(let F=0;F<f;F++){const O=F*w,D=Math.floor(O),A=Math.min(Math.ceil(O),d-1),T=R+D*a[1],B=R+A*a[1],U=O-D,Q=1-U;for(let K=0;K<g;K++){const J=K*C,te=Math.floor(J),P=Math.min(Math.ceil(J),h-1),X=J-te,Y=1-X,L=T+te*a[2],W=T+P*a[2],ie=B+te*a[2],he=B+P*a[2],pe=Q*Y,me=Q*X,we=U*Y,ke=U*X;for(let Ce=0;Ce<p;Ce++){const Fe=$[S++];y[L+Ce]+=Fe*pe,y[W+Ce]+=Fe*me,y[ie+Ce]+=Fe*we,y[he+Ce]+=Fe*ke}}}}return t.makeTensorInfo([u,h,d,p],"float32",y)}const Iq={kernelName:_x,backendName:"cpu",kernelFunc:Cq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(n){const{inputs:e,backend:t,attrs:s}=n,{images:o}=e,{alignCorners:r,halfPixelCenters:i,size:a}=s;Ee(o,"resizeNearestNeighbor");const u=Oe(o.shape),[d,h]=a,[p,f,g,y]=o.shape,b=t.data.get(o.dataId).values,v=new Float32Array(p*d*h*y),w=[r&&d>1?f-1:f,r&&h>1?g-1:g],C=[r&&d>1?d-1:d,r&&h>1?h-1:h],$=w[0]/C[0],S=w[1]/C[1];let N=0;for(let R=0;R<p;R++){const F=R*u[0];for(let O=0;O<d;O++){const D=i?$*(O+.5):$*O;let A=Math.min(f-1,r?Math.round(D):Math.floor(D));i&&(A=Math.max(0,A));const T=F+A*u[1];for(let B=0;B<h;B++){const U=i?S*(B+.5):S*B;let Q=Math.min(g-1,r?Math.round(U):Math.floor(U));i&&(Q=Math.max(0,Q));const K=T+Q*u[2];for(let J=0;J<y;J++){const te=b[K+J];v[N++]=te}}}}return t.makeTensorInfo([p,d,h,y],o.dtype,v)}const $q={kernelName:Op,backendName:"cpu",kernelFunc:Sq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nq(n){const{inputs:e,backend:t,attrs:s}=n,{images:o,dy:r}=e,{alignCorners:i}=s;Ee([r,o],"resizeNearestNeighborGrad");const a=Oe(o.shape),u=Oe(r.shape),[d,h,p,f]=o.shape,[,g,y]=r.shape,b=new Float32Array(d*h*p*f),v=t.data.get(r.dataId).values,w=[i&&g>1?h-1:h,i&&y>1?p-1:p],C=[i&&g>1?g-1:g,i&&y>1?y-1:y],$=w[0]/C[0],S=w[1]/C[1],N=1/$,R=1/S,F=Math.ceil(N)*2+2,O=Math.ceil(R)*2+2;for(let D=0;D<d;D++){const A=D*a[0];for(let T=0;T<h;T++){const B=A+T*a[1],U=Math.floor(T*N),Q=Math.floor(U-F/2);for(let K=0;K<p;K++){const J=B+K*a[2],te=Math.floor(K*R),P=Math.floor(te-O/2);for(let X=0;X<f;X++){let Y=0;for(let L=0;L<F;L++){const W=L+Q;if(W<0||W>=g)continue;const ie=A+W*u[1],he=W*$,pe=Math.min(h-1,i?Math.round(he):Math.floor(he));if(T===pe)for(let me=0;me<O;me++){const we=me+P;if(we<0||we>=y)continue;const ke=ie+we*u[2],Ce=we*S,Fe=Math.min(p-1,i?Math.round(Ce):Math.floor(Ce));K===Fe&&(Y+=v[ke+X])}}b[J+X]=Y}}}}return t.makeTensorInfo(o.shape,o.dtype,b)}const Tq={kernelName:Fx,backendName:"cpu",kernelFunc:Nq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{dims:r}=s;Ee(o,"reverse");const i=o.shape.length,a=Ke(r,o.shape);if(i===0)return So({inputs:{x:o},backend:t});const u=new dn(o.shape,o.dtype),d=t.bufferSync(o);for(let h=0;h<u.size;h++){const p=u.indexToLoc(h),f=p.slice();a.forEach(g=>f[g]=o.shape[g]-1-f[g]),u.set(d.get(...f),...p)}return t.makeTensorInfo(u.shape,u.dtype,u.values)}const Rq={kernelName:Mp,backendName:"cpu",kernelFunc:Eq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aq={kernelName:Wx,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:o,fillValue:r,center:i}=e,a=t,u=xn(s.dtype,de(s.shape)),[d,h,p,f]=s.shape,[g,y]=T0(i,h,p),b=255,v=Math.sin(o),w=Math.cos(o),C=a.data.get(s.dataId).values;for(let S=0;S<d;S++){const N=S*p*h*f;for(let R=0;R<h;R++){const F=R*(p*f);for(let O=0;O<p;O++){const D=O*f;for(let A=0;A<f;A++){const T=[d,R,O,A],B=T[2],U=T[1];let Q=(B-g)*w-(U-y)*v,K=(B-g)*v+(U-y)*w;Q=Math.round(Q+g),K=Math.round(K+y);let J=r;if(typeof r!="number"&&(A===3?J=b:J=r[A]),Q>=0&&Q<p&&K>=0&&K<h){const P=K*(p*f),X=Q*f,Y=N+P+X+A;J=C[Y]}const te=N+F+D+A;u[te]=J}}}}return{dataId:a.write(u,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dq=mt(Yu,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),Fq={kernelName:Yu,backendName:"cpu",kernelFunc:Dq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _q(n){const{inputs:e,backend:t,attrs:s}=n,{indices:o,updates:r}=e,{shape:i}=s,{sliceRank:a,numUpdates:u,sliceSize:d,strides:h,outputSize:p}=Oi(r,o,i),f=!0,g=t.bufferSync(o),y=t.bufferSync(r),b=pi(g,y,i,p,d,u,a,h,0,f);return t.makeTensorInfo(i,b.dtype,b.values)}const Oq={kernelName:NI,backendName:"cpu",kernelFunc:_q};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lq(n,e){let t=0,s=n.length,o=0;for(;t<s;)o=Math.floor((t+s)/2),n[o]<e?t=o+1:s=o;return s}function Mq(n,e){let t=0,s=n.length,o=0;for(;t<s;)o=Math.floor((t+s)/2),n[o]<=e?t=o+1:s=o;return s}function Pq(n,e,t,s,o,r){const i=Lt("int32",t*o);for(let a=0;a<t;++a){const u=n.slice(a*s,(a+1)*s),d=a*o;for(let h=0;h<o;++h)i[d+h]=r==="left"?Lq(u,e[h+d]):Mq(u,e[h+d])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zq(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:o,values:r}=e,{side:i}=s,a=t.data.get(o.dataId).values,u=t.data.get(r.dataId).values,d=Pq(a,u,o.shape[0],o.shape[1],r.shape[1],i);return t.makeTensorInfo(r.shape,"int32",d)}const Bq={kernelName:EI,backendName:"cpu",kernelFunc:zq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wq(n){const{inputs:e,backend:t}=n,{condition:s,t:o,e:r}=e;Ee([s,o,r],"select");const i=s.shape.length,a=t.data.get(s.dataId).values,u=t.data.get(o.dataId).values,d=t.data.get(r.dataId).values,h=ts(o.dtype,r.dtype),p=bn(de(o.shape),h);let f=0;const g=i===0||i>1||o.shape.length===1?1:de(o.shape.slice(1));for(let y=0;y<a.length;y++)for(let b=0;b<g;b++)a[y]===1?p[f++]=u[y]:p[f++]=d[y];return t.makeTensorInfo(o.shape,h,p)}const Vq={kernelName:Pp,backendName:"cpu",kernelFunc:Wq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uq=of,Gq=rf,jq=mt(Ju,n=>n>=0?Gq*n:Uq*(Math.exp(n)-1)),Hq={kernelName:Ju,backendName:"cpu",kernelFunc:jq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qq=mt(tc,n=>n<0?-1:n>0?1:0),Kq={kernelName:tc,backendName:"cpu",kernelFunc:qq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xq=mt(Zu,n=>Math.sin(n)),Yq={kernelName:Zu,backendName:"cpu",kernelFunc:Xq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qq=mt(ec,n=>Math.sinh(n)),Jq={kernelName:ec,backendName:"cpu",kernelFunc:Qq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zq=11920928955078125e-23,Jk=Math.log(Zq)+2,e6=mt(sc,n=>{const e=n>-Jk,t=n<Jk,s=Math.exp(n);let o;return t?o=s:e?o=n:o=Math.log(1+s),o}),t6={kernelName:sc,backendName:"cpu",kernelFunc:e6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n6(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{blockShape:r,paddings:i}=s;Ee([o],"spaceToBatchND");const a=de(r),u=[[0,0]];u.push(...i);for(let R=1+r.length;R<o.shape.length;++R)u.push([0,0]);const d=ZT.kernelFunc({inputs:{x:o},backend:t,attrs:{paddings:u,constantValue:0}}),h=gc(d.shape,r,a,!1),p=yc(h.length,r.length,!1),f=xc(d.shape,r,a,!1),b=kt({inputs:{x:d},backend:t,attrs:{shape:h}}),C=Un({inputs:{x:b},backend:t,attrs:{perm:p}}),N=kt({inputs:{x:C},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(C),N}const s6={kernelName:Wp,backendName:"cpu",kernelFunc:n6};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o6(n){const{inputs:e,backend:t}=n,{indices:s,values:o,denseShape:r,defaultValue:i}=e;if(r.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${r.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=t.data.get(s.dataId).values,u=t.data.get(o.dataId).values,d=t.data.get(r.dataId).values,h=t.data.get(i.dataId).values[0],[p,f,g,y,b]=ST(a,s.shape,s.dtype,u,o.dtype,d,h);return[t.makeTensorInfo(f,s.dtype,p),t.makeTensorInfo([f[0]],o.dtype,g),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(v=>Number(v)))),t.makeTensorInfo([b.length],s.dtype,new Int32Array(b))]}const r6={kernelName:RI,backendName:"cpu",kernelFunc:o6};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i6(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:o,newShape:r}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${o.shape}`);if(r.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const i=Array.from(t.data.get(o.dataId).values),a=t.data.get(s.dataId).values,u=Array.from(t.data.get(r.dataId).values),[d,h,p]=$T(a,s.shape,s.dtype,i,u);return[t.makeTensorInfo(h,s.dtype,d),t.makeTensorInfo([p.length],r.dtype,new Int32Array(p))]}const a6={kernelName:AI,backendName:"cpu",kernelFunc:i6};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l6(n){const{inputs:e,backend:t}=n,{data:s,indices:o,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${o.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${r.shape}`);if(o.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(s.dataId).values,a=t.data.get(o.dataId).values,u=t.data.get(r.dataId).values,[d,h]=b1(i,s.shape,s.dtype,a,u,!0);return t.makeTensorInfo(h,s.dtype,d)}const u6={kernelName:DI,backendName:"cpu",kernelFunc:l6};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c6(n){const{inputs:e,backend:t}=n,{data:s,indices:o,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${o.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${r.shape}`);if(o.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(s.dataId).values,a=t.data.get(o.dataId).values,u=t.data.get(r.dataId).values,[d,h]=b1(i,s.shape,s.dtype,a,u);return t.makeTensorInfo(h,s.dtype,d)}const d6={kernelName:FI,backendName:"cpu",kernelFunc:c6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h6(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:o,sparseValues:r,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:u,numUpdates:d,sliceSize:h,strides:p,outputSize:f}=Oi(r,o,a),g=!1,y=t.bufferSync(o);let b;switch(r.dtype){case"bool":{const v=t.bufferSync(r),w=!!t.data.get(i.dataId).values[0];b=pi(y,v,a,f,h,d,u,p,w,g);break}case"float32":{const v=t.bufferSync(r),w=t.data.get(i.dataId).values[0];b=pi(y,v,a,f,h,d,u,p,w,g);break}case"int32":{const v=t.bufferSync(r),w=t.data.get(i.dataId).values[0];b=pi(y,v,a,f,h,d,u,p,w,g);break}case"string":{const v=t.bufferSync(r),w=Nr(t.data.get(i.dataId).values[0]);b=pi(y,v,a,f,h,d,u,p,w,g);break}default:throw new Error(`Unsupported type ${r.dtype}`)}return t.makeTensorInfo(a,b.dtype,b.values)}const p6={kernelName:_I,backendName:"cpu",kernelFunc:h6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f6(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{numOrSizeSplits:r,axis:i}=s,a=Ke(i,o.shape)[0],u=U0(o,r,a),d=new Array(o.shape.length).fill(0),h=o.shape.slice();return u.map(p=>{const f=[...h];f[a]=p;const g=Ri({inputs:{x:o},backend:t,attrs:{begin:d,size:f}});return d[a]+=p,g})}const m6={kernelName:Vp,backendName:"cpu",kernelFunc:f6};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g6={kernelName:Ox,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,s=e;Ee(t,"square");const o=s.data.get(t.dataId).values,r=new Float32Array(o.length);for(let a=0;a<o.length;++a){const u=o[a];r[a]=u*u}return{dataId:s.write(r,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y6=mt(cc,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),x6={kernelName:cc,backendName:"cpu",kernelFunc:y6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b6(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{begin:r,end:i,strides:a,beginMask:u,endMask:d,ellipsisMask:h,newAxisMask:p,shrinkAxisMask:f}=s;Ee(o,"stridedSlice");const{finalShapeSparse:g,finalShape:y,isIdentity:b,sliceDim0:v,isSimpleSlice:w,begin:C,end:$,strides:S}=S0(o.shape,r,i,a,u,d,h,p,f);let N;if(b)N=kt({inputs:{x:o},backend:t,attrs:{shape:y}});else if(v||w){_(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);const R=k0(C,$,S),F=Ri({inputs:{x:o},backend:t,attrs:{begin:C,size:R}});N=kt({inputs:{x:F},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(F)}else{const R=t.bufferSync(o),F=ET(g,R,S,C);N=t.makeTensorInfo(y,F.dtype,F.values)}return N}const v6={kernelName:Mx,backendName:"cpu",kernelFunc:b6};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w6(n){const{inputs:e,backend:t,attrs:s}=n,{separator:o,nGramWidths:r,leftPad:i,rightPad:a,padWidth:u,preserveShortSequences:d}=s,{data:h,dataSplits:p}=e,f=t.data.get(h.dataId).values,g=t.data.get(p.dataId).values,[y,b]=RT(f,g,o,r,i,a,u,d);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(p.shape,"int32",b)]}const k6={kernelName:OI,backendName:"cpu",kernelFunc:w6};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C6(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:o}=s,{input:r,delimiter:i}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(r.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=t.data.get(r.dataId).values,u=t.data.get(i.dataId).values[0],[d,h,p]=AT(a,u,o),f=h.length;return[t.makeTensorInfo([f,2],"int32",d),t.makeTensorInfo([f],"string",h),t.makeTensorInfo([2],"int32",new Int32Array(p))]}const I6={kernelName:LI,backendName:"cpu",kernelFunc:C6};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:o}=s,{input:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const i=t.data.get(r.dataId).values,a=DT(i,o);return t.makeTensorInfo(r.shape,"int32",a)}const $6={kernelName:MI,backendName:"cpu",kernelFunc:S6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N6=mt(ac,n=>Math.tan(n)),T6={kernelName:ac,backendName:"cpu",kernelFunc:N6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E6=mt(lc,n=>Math.tanh(n)),R6={kernelName:lc,backendName:"cpu",kernelFunc:E6};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A6(n){const{inputs:e,backend:t}=n,{tensor:s,indices:o,updates:r}=e,{sliceRank:i,numUpdates:a,sliceSize:u,strides:d,outputSize:h}=Oi(r,o,s.shape),p=!1,f=t.bufferSync(o),g=t.bufferSync(r),y=t.bufferSync(s),b=pi(f,g,s.shape,h,u,a,i,d,y,p);return t.makeTensorInfo(s.shape,b.dtype,b.values)}const D6={kernelName:TI,backendName:"cpu",kernelFunc:A6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F6(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{reps:r}=s;Ee(o,"tile");const i=_T(t.bufferSync(o),r);return t.makeTensorInfo(i.shape,i.dtype,i.values)}const _6={kernelName:uc,backendName:"cpu",kernelFunc:F6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{k:r,sorted:i}=s;Ee(o,"topk");const a=t.data.get(o.dataId).values,[u,d]=LT(a,o.shape,o.dtype,r,i);return[t.makeTensorInfo(u.shape,u.dtype,u.values),t.makeTensorInfo(d.shape,d.dtype,d.values)]}const L6={kernelName:Px,backendName:"cpu",kernelFunc:O6};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M6(n){const{inputs:e,attrs:t,backend:s}=n,{image:o,transforms:r}=e,{interpolation:i,fillMode:a,fillValue:u,outputShape:d}=t,[h,p,f,g]=o.shape,[y,b]=d??[p,f],v=[h,y,b,g],w=Oe(o.shape),C=w[0],$=w[1],S=w[2],N=Oe(v),R=N[0],F=N[1],O=N[2],D=xn(o.dtype,de(v));D.fill(u);const A=s.data.get(o.dataId).values,T=s.data.get(r.dataId).values;for(let U=0;U<h;++U){const Q=r.shape[0]===1?T:T.subarray(U*8,U*8+8);for(let K=0;K<y;++K)for(let J=0;J<b;++J)for(let te=0;te<g;++te){let P;const X=Q[6]*J+Q[7]*K+1;if(X===0)continue;const Y=(Q[0]*J+Q[1]*K+Q[2])/X,L=(Q[3]*J+Q[4]*K+Q[5])/X,W=Zk(Y,f,a),ie=Zk(L,p,a);switch(i){case"nearest":P=U6(A,p,f,C,$,S,U,ie,W,te,u);break;case"bilinear":P=G6(A,p,f,C,$,S,U,ie,W,te,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const he=U*R+K*F+J*O+te;D[he]=P}return s.makeTensorInfo(v,o.dtype,D)}return{dataId:s.write(D,v,o.dtype),shape:o.shape,dtype:o.dtype}}const P6={kernelName:zx,backendName:"cpu",kernelFunc:M6};function Zk(n,e,t){switch(t){case"reflect":return z6(n,e);case"wrap":return B6(n,e);case"nearest":return V6(n,e);case"constant":default:return W6(n)}}function z6(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=2*e;t<s&&(t=s*Math.trunc(-t/s)+t),t=t<-e?t+s:-t-1}else if(t>e-1)if(e<=1)t=0;else{const s=2*e;t-=s*Math.trunc(t/s),t>=e&&(t=s-t-1)}return xi(0,t,e-1)}function B6(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=e-1;t+=e*(Math.trunc(-t/s)+1)}else if(t>e-1)if(e<=1)t=0;else{const s=e-1;t-=e*Math.trunc(t/s)}return xi(0,t,e-1)}function W6(n,e){return n}function V6(n,e){return xi(0,n,e-1)}function Yl(n,e,t,s,o,r,i,a,u,d,h){const p=i*s+a*o+u*r+d;return 0<=a&&a<e&&0<=u&&u<t?n[p]:h}function U6(n,e,t,s,o,r,i,a,u,d,h){const p=Math.round(a),f=Math.round(u);return Yl(n,e,t,s,o,r,i,p,f,d,h)}function G6(n,e,t,s,o,r,i,a,u,d,h){const p=Math.floor(a),f=Math.floor(u),g=p+1,y=f+1,b=(y-u)*Yl(n,e,t,s,o,r,i,p,f,d,h)+(u-f)*Yl(n,e,t,s,o,r,i,p,y,d,h),v=(y-u)*Yl(n,e,t,s,o,r,i,g,f,d,h)+(u-f)*Yl(n,e,t,s,o,r,i,g,y,d,h);return(g-a)*b+(a-p)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(n){const{inputs:e,attrs:t,backend:s}=n,{axis:o}=t,{x:r}=e;Ee(r,"unique");const i=s.data.get(r.dataId).values,{outputValues:a,outputShape:u,indices:d}=MT(i,o,r.shape,r.dtype);return[s.makeTensorInfo(u,r.dtype,a),s.makeTensorInfo([d.length],"int32",d)]}const H6={kernelName:Bx,backendName:"cpu",kernelFunc:j6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q6(n){const{inputs:e,backend:t,attrs:s}=n,{value:o}=e;let{axis:r}=s;r<0&&(r+=o.shape.length);const i=o.shape.length,a=o.shape[r],u=new Array(i-1);let d=0;for(let g=0;g<i;g++)g!==r&&(u[d++]=o.shape[g]);const h=new Array(i).fill(0),p=o.shape.slice();p[r]=1;const f=new Array(a);for(let g=0;g<f.length;g++){h[r]=g;const y=Ri({inputs:{x:o},backend:t,attrs:{begin:h,size:p}});f[g]=kt({inputs:{x:y},backend:t,attrs:{shape:u}}),t.disposeIntermediateTensorInfo(y)}return f}const K6={kernelName:Gp,backendName:"cpu",kernelFunc:q6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,segmentIds:r}=e,{numSegments:i}=s;Ee(o,"unsortedSegmentSum");const a=o.shape.length,u=r.shape.length,d=[],h=[],p=a-u;let f=r;for(let y=0;y<p;++y){const b=zh({inputs:{input:f},backend:t,attrs:{dim:y+1}});f=b,h.push(b)}for(let y=0;y<i;++y){const b=_r(y,"int32"),v=t.makeTensorInfo([],"int32",b),w=JN({inputs:{a:v,b:f},backend:t}),C=Dr({inputs:{x:w},backend:t,attrs:{dtype:"float32"}}),$=xf({inputs:{a:C,b:o},backend:t}),S=Nc({inputs:{x:$},backend:t,attrs:{axis:0,keepDims:!1}});d.push(S),h.push(v),h.push(w),h.push(C),h.push($),h.push(S)}const g=JT({inputs:d,backend:t,attrs:{axis:0}});return h.forEach(y=>t.disposeIntermediateTensorInfo(y)),g}const Y6={kernelName:jp,backendName:"cpu",kernelFunc:X6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q6=[jU,SV,qU,XU,AV,QU,ZU,tG,sG,rG,aG,uG,dG,fG,gG,bG,wG,CG,SG,UU,NG,EG,AG,FV,FG,EV,OV,OG,$V,MG,zG,BG,VG,GG,HG,KG,YG,JG,ej,nj,oj,ij,lj,cj,dj,pj,mj,yj,xj,bj,vj,kj,Sj,LU,Nj,LV,Oj,MV,Lj,zV,Vj,Uj,jj,WV,UV,qj,Xj,Qj,Zj,jV,qV,NV,tH,PG,sH,rH,aH,MU,XV,QV,uH,ZV,dH,fH,gH,bH,wH,CH,IH,tU,$H,TH,RH,DH,_H,LH,PH,sU,BH,UH,HH,rU,aU,XH,JH,tq,uU,sq,rq,iq,ZT,cq,zU,hU,hq,fq,gq,xq,TV,Ey,vq,BU,WU,VU,kq,Iq,$q,Tq,Rq,Aq,Fq,vU,Oq,Bq,Vq,Hq,kU,Kq,Yq,Jq,CU,GH,t6,s6,r6,a6,u6,d6,p6,m6,$U,g6,TU,RU,x6,v6,k6,I6,$6,_U,Cj,T6,R6,D6,_6,L6,P6,cU,H6,K6,Y6,oq];for(const n of Q6)zI(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ci={},Xd={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function J6(n,e){ci[n]=e}function Zs(n,e){if(!(n in ci)||e!=null){const s=e5(n,e);if(s!==null)ci[n]=s;else return console.log("Could not get context for WebGL version",n),null}const t=ci[n];return t==null||t.isContextLost()?(delete ci[n],Zs(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),ci[n])}function Z6(n){if(!ae().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function e5(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??Z6(n);return t.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete ci[n]},!1),ae().getBool("SOFTWARE_WEBGL_ENABLED")&&(Xd.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",Xd)||t.getContext("experimental-webgl",Xd):t.getContext("webgl2",Xd)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var uu;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(uu||(uu={}));var ds;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(ds||(ds={}));var cn;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(cn||(cn={}));function Tc(n,e){return[e,n]}function t5(n,e){return n*e}function Yd(n){const e=de(n),t=Math.ceil(e/4);return Jg(t)}function Xa(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function n5(n,e){const[t,s]=Xa(n,e);return t*s*4}function I1(n,e){const t=n;let s,o,r,i,a,u,d,h,p,f;return ae().getNumber("WEBGL_VERSION")===2?(s=t.R32F,o=t.R16F,r=t.RGBA16F,i=t.RGBA32F,a=t.RED,d=4,h=1,p=t.HALF_FLOAT,f=t.FLOAT,u=t.RGBA8):(s=n.RGBA,o=n.RGBA,r=n.RGBA,i=t.RGBA,a=n.RGBA,d=4,h=4,p=e!=null?e.HALF_FLOAT_OES:null,f=n.FLOAT,u=n.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:o,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:u,downloadUnpackNumChannels:d,defaultNumChannels:h,textureTypeHalfFloat:p,textureTypeFloat:f}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Se(n,e){const t=e();return ae().getBool("DEBUG")&&s5(n),t}function s5(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+a5(n,e))}const o5=596e-10,r5=65504;function i5(n){return!!(ae().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||o5<Math.abs(n)&&Math.abs(n)<r5)}function a5(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Qd(n,e){return Qo(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function l5(n,e){const t=Qo(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Se(n,()=>n.shaderSource(t,e)),Se(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function u5(n,e){const t=Qo(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Se(n,()=>n.shaderSource(t,e)),Se(n,()=>n.compileShader(t)),ae().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw eE(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const c5=/ERROR: [0-9]+:([0-9]+):/g;function eE(n,e){const t=c5.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const s=+t[1],o=n.split(`
`),r=o.length.toString().length+2,i=o.map((p,f)=>ka((f+1).toString(),r)+p);let a=0;for(let p=0;p<i.length;p++)a=Math.max(i[p].length,a);const u=i.slice(0,s-1),d=i.slice(s-1,s),h=i.slice(s);console.log(u.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${ka(d[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join(`
`))}function d5(n){return Qo(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function h5(n,e){if(Se(n,()=>n.linkProgram(e)),!ae().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Wg(n,e){if(Se(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function p5(n,e){const t=Qo(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Se(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),Se(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function f5(n,e){const t=Qo(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Se(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),Se(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function m5(n){return Qo(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function g5(n,e){const t=ae().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const s=`[${n}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(n>t||e>t){const s=`[${n}x${e}]`,o=`[${t}x${t}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+o+".")}}function y5(n){return Qo(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function eC(n,e,t,s,o,r,i){const a=n.getAttribLocation(e,t);return a===-1?!1:(Se(n,()=>n.bindBuffer(n.ARRAY_BUFFER,s)),Se(n,()=>n.vertexAttribPointer(a,o,n.FLOAT,!1,r,i)),Se(n,()=>n.enableVertexAttribArray(a)),!0)}function x5(n,e,t){C5(n,t),Se(n,()=>n.activeTexture(n.TEXTURE0+t)),Se(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function b5(n,e,t){return Qo(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function v5(n,e,t){return n.getUniformLocation(e,t)}function w5(n,e,t,s){Se(n,()=>x5(n,e,s)),Se(n,()=>n.uniform1i(t,s))}function Vg(n,e,t){Se(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),Se(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function tC(n,e){Se(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),Se(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function Jd(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+k5(n,e))}function k5(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Qo(n,e,t){const s=Se(n,()=>e());if(s==null)throw new Error(t);return s}function C5(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+n.TEXTURE0;if(s<n.TEXTURE0||s>t){const o=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${o}.`)}}function Pa(n,e=2){return de(n.slice(0,n.length-e))}function za(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Zd(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Pa(n),...za(n)]),e}function I5(n,e=!1){let t=ae().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=ae().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&ae().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=t/2),e&&(t=t*2,s=s*2,n=n.map((a,u)=>u>=n.length-2?Yy(n[u]):n[u]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=Fr(n).newShape);let o=de(n),r=null;n.length<=1&&o<=t?r=[1,o]:n.length===2&&n[0]<=t&&n[1]<=t?r=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?r=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?r=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?r=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(r=[n[0],n[1]*n[2]*n[3]]);const i=r!=null&&Math.max(...r)>s&&Math.min(...r)<=(e?2:1)&&Math.min(...r)>0;if(r==null||i)if(e){const a=Pa(n);let u=2,d=2;n.length&&([u,d]=za(n)),o=a*(u/2)*(d/2),r=Jg(o).map(h=>h*2)}else r=Jg(o);return r}function eh(n){return n%2===0}function Wh(n,e){if(n=n.slice(-2),e=e.slice(-2),ht(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],s=e[e.length-1];if(t===s||eh(t)&&eh(s)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&eh(n[0])&&eh(e[0])}let Ug,Gg;function S5(n){if(Ug==null){const e=Zs(n);Ug=e.getParameter(e.MAX_TEXTURE_SIZE)}return Ug}function $5(n){if(Gg==null){const e=Zs(n);Gg=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Gg)}function N5(n){if(n===0)return 0;let e;const t=Zs(n);return Es(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:Es(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function Es(n,e){return n.getExtension(e)!=null}function nC(n){try{if(Zs(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function T5(n){if(n===0)return!1;const e=Zs(n);if(n===1){if(!Es(e,"OES_texture_float"))return!1}else if(!Es(e,"EXT_color_buffer_float"))return!1;return Ay(e)}function E5(n){if(n===0)return!1;const e=Zs(n);if(n===1){if(!Es(e,"OES_texture_float")||!Es(e,"WEBGL_color_buffer_float"))return!1}else{if(Es(e,"EXT_color_buffer_float"))return Ay(e);const s="EXT_color_buffer_half_float";if(Es(e,s)){const o=e.getExtension(s);return R5(e,o)}return!1}return Ay(e)}function Ay(n){const e=I1(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(r),i}function R5(n,e){const t=I1(n,e),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(i),a}function A5(n){return n!==2?!1:Zs(n).fenceSync!=null}function Ec(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&_(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ae=ae();Ae.registerFlag("HAS_WEBGL",()=>Ae.getNumber("WEBGL_VERSION")>0);Ae.registerFlag("WEBGL_VERSION",()=>nC(2)?2:nC(1)?1:0);Ae.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ae.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ae.get("WEBGL_VERSION")===2);Ae.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ae.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ae.registerFlag("WEBGL_PACK",()=>Ae.getBool("HAS_WEBGL"));Ae.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_CLIP",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_REDUCE",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_CONV_IM2COL",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>S5(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>$5(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Ae.getNumber("WEBGL_VERSION");return n===0?0:N5(n)});Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ae.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!JI());Ae.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>T5(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ae.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ae.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ae.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>E5(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_FENCE_API_ENABLED",()=>A5(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ae.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ae.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Ae.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>JI()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Ae.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ae.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ae.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ae.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ae.registerFlag("WEBGL_EXP_CONV",()=>!1);Ae.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ae.getBool("IS_TEST"));Ae.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ae.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ae.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ae.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _n(){let n,e,t,s,o,r,i,a,u,d;return ae().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",s="in",o="texture",r="outputColor",i="out vec4 outputColor;",a=ae().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",u="",d=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",s="varying",o="texture2D",r="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,d=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:s,texture2D:o,output:r,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:u,defineRound:d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi(n,e,t="index"){const s=Oe(e);return s.map((o,r)=>{const i=`int ${n[r]} = ${t} / ${o}`,a=r===s.length-1?`int ${n[r+1]} = ${t} - ${n[r]} * ${o}`:`index -= ${n[r]} * ${o}`;return`${i}; ${a};`}).join("")}function bf(n,e,t="index"){const s=Oe(e);return s.map((o,r)=>{const i=`int ${n[r]} = ${t} / outShapeStrides[${r}]`,a=r===s.length-1?`int ${n[r+1]} = ${t} - ${n[r]} * outShapeStrides[${r}]`:`index -= ${n[r]} * outShapeStrides[${r}]`;return`${i}; ${a};`}).join("")}function D5(n,e){const t=n.length,s=n.map(r=>`${e}[${r}]`),o=new Array(t-1);o[t-2]=s[t-1];for(let r=t-3;r>=0;--r)o[r]=`(${o[r+1]} * ${s[r+1]})`;return o}function F5(n,e,t="index"){const s=n.map((r,i)=>i),o=D5(s,e);return o.map((r,i)=>{const a=`int ${n[i]} = ${t} / ${o[i]}`,u=i===o.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${o[i]}`:`index -= ${n[i]} * ${o[i]}`;return`${a}; ${u};`}).join("")}function S1(n){const e=Oe(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function $1(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const tE=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:nE}=kz;function _5(n,e,t){const s=[];if(n.forEach(g=>{const y=de(g.shapeInfo.logicalShape);if(g.shapeInfo.isUniform?s.push(`uniform float ${g.name}${y>1?`[${y}]`:""};`):(s.push(`uniform sampler2D ${g.name};`),s.push(`uniform int offset${g.name};`)),t.enableShapeUniforms){const{uniformShape:b}=N1(t.packedInputs,g.shapeInfo.logicalShape,g.shapeInfo.texShape);switch(b.length){case 1:s.push(`uniform int ${g.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${g.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${g.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${g.name}Shape;`);break}s.push(`uniform ivec2 ${g.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(g=>{s.push(`uniform ${g.type} ${g.name}${g.arrayIndex?`[${g.arrayIndex}]`:""};`)});const o=s.join(`
`),r=n.map(g=>O5(g,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),i=e.texShape,a=_n(),u=P5(a);let d,h,p=W5(a);return e.isPacked?(d=L5(e.logicalShape,i,t.enableShapeUniforms),h=B5(a)):(d=M5(e.logicalShape,i,t.enableShapeUniforms),h=z5(a)),t.packedInputs&&(p+=j5),[p,u,h,o,d,r,t.userCode].join(`
`)}function Ya(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return sK(n,e);case 1:return rK(n,e);case 2:return aK(n,e);case 3:return uK(n,e);case 4:return dK(n,e);case 5:return hK(n);case 6:return pK(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function sE(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return nK(n);case 1:return oK(n,e);case 2:return iK(n,e);case 3:return lK(n,e);default:return cK(n,e)}}function O5(n,e,t=!1,s){let o="";t?o+=sE(n,s):o+=Ya(n,s);const r=n.shapeInfo.logicalShape,i=e.logicalShape;return r.length<=i.length&&(t?o+=fK(n,e):o+=mK(n,e)),o}function L5(n,e,t){switch(n.length){case 0:return oE();case 1:return H5(n,e,t);case 2:return eK(n,e,t);case 3:return K5(n,e,t);default:return Y5(n,e,t)}}function M5(n,e,t){switch(n.length){case 0:return oE();case 1:return q5(n,e,t);case 2:return tK(n,e,t);case 3:return X5(n,e,t);case 4:return Q5(n,e,t);case 5:return J5(n,e);case 6:return Z5(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function P5(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function z5(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function B5(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function W5(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${V5}
    ${U5}
    ${G5}
  `}const V5=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,U5=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,G5=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,j5=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function oE(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function H5(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function q5(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function K5(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],o=Math.ceil(n[2]/2),r=o*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec3(b, r, c);
    }
  `}function X5(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${bf(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const s=Pi(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function Y5(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],o=Math.ceil(n[n.length-1]/2),r=o*Math.ceil(n[n.length-2]/2);let i=r,a="",u="b, r, c";for(let d=2;d<n.length-1;d++)i*=n[n.length-d-1],a=`
      int b${d} = index / ${i};
      index -= b${d} * ${i};
    `+a,u=`b${d}, `+u;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec${n.length}(${u});
    }
  `}function Q5(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${bf(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Pi(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function J5(n,e){const t=Pi(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Z5(n,e){const t=Pi(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function eK(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(ht(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const o=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec2(r, c);
    }
  `}function tK(n,e,t){return ht(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function zi(n){return`offset${n}`}function nK(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),s=_n();return`
    vec4 ${t}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function sK(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${s}() {return ${t};}`;const[o,r]=n.shapeInfo.texShape;if(o===1&&r===1)return`
      float ${s}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const i=zi(t);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${i});
      return sampleTexture(${t}, uv);
    }
  `;const[a,u]=n.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${u}, ${i});
      return sampleTexture(${t}, uv);
    }
  `}function oK(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),o=n.shapeInfo.texShape,r=_n();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${r.texture2D}(${t}, uv);
    }
  `;const i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${r.texture2D}(${t}, uv);
    }
  `}function rK(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Qa(n)}
      }
    `;const o=n.shapeInfo.texShape,r=o[0],i=o[1];if(i===1&&r===1)return`
      float ${s}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=zi(t);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${r}.0);
        return sampleTexture(${t}, uv);
      }
    `:r===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${a});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${r}, ${i}, index + ${a});
      return sampleTexture(${t}, uv);
    }
  `}function iK(n,e){const t=n.shapeInfo.logicalShape,s=n.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n.shapeInfo.texShape,i=r[0],a=r[1],u=_n();if(r!=null&&ht(t,r))return e?`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${u.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${u.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${o}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${u.texture2D}(${s}, uv);
    }
  `;const d=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],h=Math.ceil(t[1]/2);return`
    vec4 ${o}(int row, int col) {
      vec2 uv = packedUVfrom2D(${h}, ${d[0]}, ${d[1]}, row, col);
      return ${u.texture2D}(${s}, uv);
    }
  `}function aK(n,e){const t=n.shapeInfo.logicalShape,s=n.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n.shapeInfo.texShape;if(r!=null&&ht(t,r)){if(e)return`
      float ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const f=r[0],g=r[1];return`
    float ${o}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${g}.0, ${f}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:a}=Fr(t),u=i;if(u.length<t.length){const f=Ja(n,u),g=["row","col"];return`
      ${Ya(f,e)}
      float ${o}(int row, int col) {
        return ${o}(${Za(g,a)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${o}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${Qa(n)}
      }
    `;const d=r[0],h=r[1],p=zi(s);return h===1?e?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `:d===1?e?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${h}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${o}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${p};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${o}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${p};
    vec2 uv = uvFromFlat(${d}, ${h}, index);
    return sampleTexture(${s}, uv);
  }
`}function lK(n,e){const t=n.shapeInfo.logicalShape,s=n.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(t[0]===1){const f=t.slice(1),g=[1,2],y=Ja(n,f),b=["b","row","col"];return`
        ${sE(y,e)}
        vec4 ${o}(int b, int row, int col) {
          return ${o}(${Za(b,g)});
        }
      `}const a=_n();if(e)return`
    vec4 ${o}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const u=i[0],d=i[1],h=Math.ceil(t[2]/2),p=h*Math.ceil(t[1]/2);return`
    vec4 ${o}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${u}, ${d}, ${p}, ${h}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function uK(n,e){const t=n.shapeInfo.logicalShape,s=n.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t[1]*t[2],i=t[2],{newShape:a,keptDims:u}=Fr(t),d=a;if(d.length<t.length){const b=Ja(n,d),v=["row","col","depth"];return`
        ${Ya(b,e)}
        float ${o}(int row, int col, int depth) {
          return ${o}(${Za(v,u)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${r}, ${i}, 1)));
        ${Qa(n)}
      }
    `;const h=n.shapeInfo.texShape,p=h[0],f=h[1],g=n.shapeInfo.flatOffset;if(f===r&&g==null)return e?`
      float ${o}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${o}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${p}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(f===i&&g==null)return e?`
      float ${o}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${o}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `;const y=zi(s);return e?`
    float ${o}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${y};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${o}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r} + col * ${i} + depth + ${y};
        vec2 uv = uvFromFlat(${p}, ${f}, index);
        return sampleTexture(${s}, uv);
      }
  `}function cK(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),o=_n();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${o.texture2D}(${t}, uv);
    }
  `;const r=n.shapeInfo.logicalShape,i=r.length,a=n.shapeInfo.texShape,u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],d=u[0],h=u[1],p=Math.ceil(r[i-1]/2);let f=p*Math.ceil(r[i-2]/2),g="int b, int row, int col",y=`b * ${f} + (row / 2) * ${p} + (col / 2)`;for(let b=2;b<i-1;b++)g=`int b${b}, `+g,f*=r[i-b-1],y=`b${b} * ${f} + `+y;return`
    vec4 ${s}(${g}) {
      int index = ${y};
      int texR = index / ${h};
      int texC = index - texR * ${h};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}, ${d});
      return ${o.texture2D}(${t}, uv);
    }
  `}function dK(n,e){const t=n.shapeInfo.logicalShape,s=n.name,o="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t[3],i=t[2]*r,a=t[1]*i,{newShape:u,keptDims:d}=Fr(t);if(u.length<t.length){const C=Ja(n,u),$=["row","col","depth","depth2"];return`
      ${Ya(C,e)}
      float ${o}(int row, int col, int depth, int depth2) {
        return ${o}(${Za($,d)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${r}, 1)));
        ${Qa(n)}
      }
    `;const h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,f=p[0],g=p[1],y=`int stride2 = ${s}Shape[3];`,b=`int stride1 = ${s}Shape[2] * stride2;`,v=`int stride0 = ${s}Shape[1] * stride1;`;if(g===a&&h==null)return e?`
      float ${o}(int row, int col, int depth, int depth2) {
        ${y}
        ${b}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${f}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(g===r&&h==null)return e?`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${f}.0);
        return sampleTexture(${s}, uv);
      }
    `;const w=zi(s);return e?`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${y}
      ${b}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${w});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${r} + depth2;
      vec2 uv = uvFromFlat(${f}, ${g}, index + ${w});
      return sampleTexture(${s}, uv);
    }
  `}function hK(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),o=e[4],r=e[3]*o,i=e[2]*r,a=e[1]*i,{newShape:u,keptDims:d}=Fr(e);if(u.length<e.length){const b=Ja(n,u),v=["row","col","depth","depth2","depth3"];return`
      ${Ya(b)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Za(v,d)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${r}, ${o})) +
          depth3;
        ${Qa(n)}
      }
    `;const h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,f=p[0],g=p[1];if(g===a&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${r}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${f}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(g===o&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${f}.0);
        return sampleTexture(${t}, uv);
      }
    `;const y=zi(t);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${r} +
          depth2 * ${o} + depth3 + ${y};
      vec2 uv = uvFromFlat(${f}, ${g}, index);
      return sampleTexture(${t}, uv);
    }
  `}function pK(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:o,keptDims:r}=Fr(e);if(o.length<e.length){const v=Ja(n,o),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${Ya(v)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Za(w,r)});
      }
    `}const i=e[5],a=e[4]*i,u=e[3]*a,d=e[2]*u,h=e[1]*d;if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${h}, ${d}, ${u}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${Qa(n)}
      }
    `;const p=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,g=f[0],y=f[1];if(y===h&&p==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${d}, ${u}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${g}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(y===i&&p==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${g}.0);
        return sampleTexture(${t}, uv);
      }
    `;const b=zi(t);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${h} + col * ${d} + depth * ${u} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${b};
      vec2 uv = uvFromFlat(${g}, ${y}, index);
      return sampleTexture(${t}, uv);
    }
  `}function Qa(n){const e=n.name,t=de(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function fK(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),o="get"+s+"AtOutCoords",r=n.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=nE(n.shapeInfo.logicalShape,e.logicalShape),u=yt(i),d=i-r;let h;const p=["x","y","z","w","u","v"];r===0?h="":i<2&&a.length>=1?h="coords = 0;":h=a.map(C=>`coords.${p[C+d]} = 0;`).join(`
`);let f="";i<2&&r>0?f="coords":f=n.shapeInfo.logicalShape.map((C,$)=>`coords.${p[$+d]}`).join(", ");let g="return outputValue;";const b=de(n.shapeInfo.logicalShape)===1,w=de(e.logicalShape)===1;if(r===1&&!b&&!w)g=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(b&&!w)i===1?g=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:g=`
        return vec4(outputValue.x);
      `;else if(a.length){const C=r-2,$=r-1;a.indexOf(C)>-1&&a.indexOf($)>-1?g="return vec4(outputValue.x);":a.indexOf(C)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf($)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${o}() {
      ${u} coords = getOutputCoords();
      ${h}
      vec4 outputValue = get${s}(${f});
      ${g}
    }
  `}function mK(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),o="get"+s+"AtOutCoords",r=e.texShape,i=n.shapeInfo.texShape,a=n.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!n.shapeInfo.isUniform&&a===u&&n.shapeInfo.flatOffset==null&&ht(i,r))return`
      float ${o}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const d=yt(u),h=nE(n.shapeInfo.logicalShape,e.logicalShape),p=u-a;let f;const g=["x","y","z","w","u","v"];a===0?f="":u<2&&h.length>=1?f="coords = 0;":f=h.map(b=>`coords.${g[b+p]} = 0;`).join(`
`);let y="";return u<2&&a>0?y="coords":y=n.shapeInfo.logicalShape.map((b,v)=>`coords.${g[v+p]}`).join(", "),`
    float ${o}() {
      ${d} coords = getOutputCoords();
      ${f}
      return get${s}(${y});
    }
  `}function yt(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function N1(n,e,t){const{newShape:s,keptDims:o}=Fr(e),r=e.length,i=n&&r===3&&e[0]===1,a=i?e.slice(1):s,u=!n&&r>1&&!ht(e,t)&&s.length<r||i;return{useSqueezeShape:u,uniformShape:u?a:e,keptDims:o}}function Ja(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function Za(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gK(n,e,t,s){const o=t.map((h,p)=>{const f={logicalShape:h.shape,texShape:h.isUniform?null:h.texData.texShape,isUniform:h.isUniform,isPacked:h.isUniform?!1:h.texData.isPacked,flatOffset:null};return h.texData!=null&&h.texData.slice!=null&&h.texData.slice.flatOffset>0&&(f.flatOffset=h.texData.slice.flatOffset),{name:e.variableNames[p],shapeInfo:f}}),r=o.map(h=>h.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=_5(o,i,e),u=u5(n.gl,a),d=n.createProgram(u);return ae().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:u,source:a,webGLProgram:d,inShapeInfos:r,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(d),Object.assign({program:e,fragmentShader:u,source:a,webGLProgram:d,inShapeInfos:r,outShapeInfo:i},rE(n,e,d)))}function rE(n,e,t){const s=[],o=[];let r,i,a,u=null,d=null;d=n.getUniformLocation(t,"NAN",!1),ae().getNumber("WEBGL_VERSION")===1&&(u=n.getUniformLocation(t,"INFINITY",!1));const h=!1;for(const p of e.variableNames){const f={name:p,uniform:n.getUniformLocation(t,p,h),offset:n.getUniformLocation(t,`offset${p}`,h)};e.enableShapeUniforms&&(f.shape=n.getUniformLocation(t,`${p}Shape`,h),f.texShape=n.getUniformLocation(t,`${p}TexShape`,h)),s.push(f)}if(e.enableShapeUniforms&&(r=n.getUniformLocation(t,"outShape",h),a=n.getUniformLocation(t,"outShapeStrides",h),i=n.getUniformLocation(t,"outTexShape",h)),e.customUniforms)for(const p of e.customUniforms)o.push(n.getUniformLocation(t,p.name,h));return{variablesLocations:s,customUniformLocations:o,infLoc:u,nanLoc:d,outShapeLocation:r,outShapeStridesLocation:a,outTexShapeLocation:i}}function sC(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,s)=>{const o=t.logicalShape,r=e[s],i=r.shape;if(!ht(o,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${o} and ${i} must match`);if(t.isUniform&&r.isUniform)return;const a=t.texShape,u=r.isUniform?null:r.texData.texShape;if(!ht(a,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${u} must match`)})}function yK(n,e,t,s,o){e.program.enableShapeUniforms||(sC(e.inShapeInfos,t),sC([e.outShapeInfo],[s]));const r=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?n.setOutputPackedMatrixTexture(r.texture,i[0],i[1]):n.setOutputMatrixTexture(r.texture,i[0],i[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),ae().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let u=0;u<t.length;++u){const d=t[u],{uniform:h,offset:p,shape:f,texShape:g}=e.variablesLocations[u];if(f){const{uniformShape:y}=N1(e.program.packedInputs,d.shape,d.texData.texShape);switch(y.length){case 1:n.gl.uniform1iv(f,new Int32Array(y));break;case 2:n.gl.uniform2iv(f,new Int32Array(y));break;case 3:n.gl.uniform3iv(f,new Int32Array(y));break;case 4:n.gl.uniform4iv(f,new Int32Array(y));break}}if(g&&n.gl.uniform2i(g,d.texData.texShape[0],d.texData.texShape[1]),h!=null){if(d.isUniform){if(de(d.shape)<2)n.gl.uniform1f(h,d.uniformValues[0]);else{let y=d.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),n.gl.uniform1fv(h,y)}continue}d.texData.slice!=null&&p!=null&&n.gl.uniform1i(p,d.texData.slice.flatOffset),n.setInputMatrixTexture(d.texData.texture.texture,h,u)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:n.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:n.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:n.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:n.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const u=Oe(s.shape);switch(s.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(u));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(u));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(u));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&o)for(let u=0;u<e.program.customUniforms.length;++u){const d=e.program.customUniforms[u],h=e.customUniformLocations[u],p=o[u];if(d.type==="float")n.gl.uniform1fv(h,p);else if(d.type==="vec2")n.gl.uniform2fv(h,p);else if(d.type==="vec3")n.gl.uniform3fv(h,p);else if(d.type==="vec4")n.gl.uniform4fv(h,p);else if(d.type==="int")n.gl.uniform1iv(h,p);else if(d.type==="ivec2")n.gl.uniform2iv(h,p);else if(d.type==="ivec3")n.gl.uniform3iv(h,p);else if(d.type==="ivec4")n.gl.uniform4iv(h,p);else throw Error(`uniform type ${d.type} is not supported yet.`)}n.executeProgram()}function xK(n,e,t){let s="";e.concat(t).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!i.isUniform){const u=i.texData.texShape,{useSqueezeShape:d,uniformShape:h,keptDims:p}=N1(n.packedInputs,i.shape,u);let f="",g="",y="";if(h.length===1&&n.packedInputs){const N=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];f=`${N[0]>1}_${N[1]>1}`}else if(h.length===2&&!n.packedInputs)g=`${h[0]>1}_${h[1]>1}`;else if(h.length>2&&!n.packedInputs){const N=Oe(h);y=`${N[0]===u[1]}_${N[N.length-1]===u[1]}`}const b=i.shape.length,v=h.length===2&&ht(i.shape,u),w=de(i.shape)===1,C=Aa(i.shape,t.shape),$=!n.packedInputs&&b===t.shape.length&&ht(u,t.texData.texShape),S=n.packedInputs||h.length>2?"":`${u[0]>1}_${u[1]>1}`;s+=`${b}_${$}_${d?p:""}_${h.length}_${w}_${C}_${v}_${f}_${g}_${y}_${S}_${a}`}else{const u=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${u}_${a}`}});const o=n.userCode;let r=n.constructor.name;return r+="_"+s+"_"+o+`${ae().getNumber("WEBGL_VERSION")}`,r}function Cn(n){return ae().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bK{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=uu.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=_n();this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?bf(["r","c","d"],e):Pi(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vK{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=uu.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=_n();this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?bf(["r","c","d"],e):Pi(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wK{constructor(e){this.variableNames=["A"],this.outTexUsage=ds.DOWNLOAD;const t=_n();this.outputShape=e,this.userCode=`
      ${tE}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kK{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ds.DOWNLOAD;const t=_n();this.outputShape=e,this.userCode=`
      ${tE}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CK={R:0,G:1,B:2,A:3};class oC{constructor(e,t=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const o=_n();this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length);let r="result";t&&(r="floor(result * 255. + 0.5)");let i="";for(let a=0;a<s.length;a++){const u=s[a];i+=`
          if(offset == ${a}) {
            result = values[${CK[u]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?$1():S1(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${o.texture2D}(A, uv);
          ${i}
        }
        ${o.output} = vec4(${r}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IK{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=_n();this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length);let o="",r="result";t&&(r="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const u=i*2+a;o+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${u}] = values[0];
            } else if (offset == 1) {
              result[${u}] = values[1];
            } else if (offset == 2) {
              result[${u}] = values[2];
            } else {
              result[${u}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?$1():S1(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${o}

          ${s.output} = ${r};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SK(n){const e=_n(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return l5(n,t)}function $K(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return p5(n,e)}function NK(n){const e=new Uint16Array([0,1,2,2,1,3]);return f5(n,e)}function Rc(n,e,t,s,o,r){g5(e,t);const i=m5(n),a=n.TEXTURE_2D;return Se(n,()=>n.bindTexture(a,i)),Se(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),Se(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),Se(n,()=>n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.NEAREST)),Se(n,()=>n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.NEAREST)),ae().getNumber("WEBGL_VERSION")===1?Se(n,()=>n.texImage2D(a,0,s,e,t,0,o,r,null)):Se(n,()=>n.texStorage2D(a,1,s,e,t)),Se(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:i,texShape:[t,e]}}function iE(n){return n.internalFormatFloat}function TK(n,e,t,s){const[o,r]=Tc(e,t);return Rc(n,o,r,iE(s),s.textureFormatFloat,n.FLOAT)}function aE(n){return n.internalFormatHalfFloat}function EK(n,e,t,s){const[o,r]=Tc(e,t);return Rc(n,o,r,aE(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function lE(n){return n.downloadTextureFormat}function RK(n,e,t,s){const[o,r]=Tc(e,t);return Rc(n,o,r,lE(s),n.RGBA,n.UNSIGNED_BYTE)}function uE(n){return n.internalFormatPackedFloat}function AK(n,e,t,s){const[o,r]=Xa(e,t);return Rc(n,o,r,uE(s),n.RGBA,n.FLOAT)}function cE(n){return n.internalFormatPackedHalfFloat}function DK(n,e,t,s){const[o,r]=Xa(e,t);return Rc(n,o,r,cE(s),n.RGBA,s.textureTypeHalfFloat)}function FK(n,e,t){return Se(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),eC(n,e,"clipSpacePos",t,3,20,0)&&eC(n,e,"uv",t,2,20,12)}function _K(n,e,t,s,o,r){Se(n,()=>n.bindTexture(n.TEXTURE_2D,e));let i,a,u;o instanceof Uint8Array?(i=new Uint8Array(t*s*4),a=n.UNSIGNED_BYTE,u=n.RGBA):(i=new Float32Array(t*s*4),a=n.FLOAT,u=r.internalFormatPackedFloat),i.set(o),ae().getNumber("WEBGL_VERSION")===2?Se(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,s,n.RGBA,a,i)):Se(n,()=>n.texImage2D(n.TEXTURE_2D,0,u,t,s,0,n.RGBA,a,i)),Se(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function OK(n,e,t){Se(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?ae().getNumber("WEBGL_VERSION")===2?Se(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):Se(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):ae().getNumber("WEBGL_VERSION")===2?Se(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):Se(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),Se(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function LK(n,e,t,s){const o=n.createBuffer();Se(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,o));const a=4*4*e*t;return Se(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)),Se(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),Se(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),o}function MK(n,e,t){const s=n,o=new Float32Array(t);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,o),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),o}function PK(n,e,t,s){const[o,r]=Tc(e,t),i=4,a=new Uint8Array(t5(e*t,i));return Se(n,()=>n.readPixels(0,0,o,r,s.downloadTextureFormat,n.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function zK(n,e,t,s,o,r,i,a){const u=n,d=new Float32Array(n5(r,i));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,d),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),d}function BK(n,e,t){const s=new Float32Array(e*t*4);return Se(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jg{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=ae().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,J6(t,e)):this.gl=Zs(t),e=this.gl,ae().getNumber("WEBGL_VERSION")===2){const r=e;this.createVertexArray=()=>Se(r,()=>r.createVertexArray()),this.bindVertexArray=i=>Se(r,()=>r.bindVertexArray(i)),this.deleteVertexArray=i=>Se(r,()=>r.deleteVertexArray(i)),this.getVertexArray=()=>Se(r,()=>r.getParameter(r.VERTEX_ARRAY_BINDING))}else if(e!=null){const r=e.getExtension("OES_vertex_array_object");if(r==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Se(e,()=>r.createVertexArrayOES()),this.bindVertexArray=i=>Se(e,()=>r.bindVertexArrayOES(i)),this.deleteVertexArray=i=>Se(e,()=>r.deleteVertexArrayOES(i)),this.getVertexArray=()=>Se(e,()=>e.getParameter(r.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ae().getNumber("WEBGL_VERSION")===1){const r="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Qd(this.gl,r),Es(this.gl,i))this.textureHalfFloatExtension=Qd(this.gl,i);else if(ae().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Es(this.gl,o))this.colorBufferHalfFloatExtension=Qd(this.gl,o);else if(ae().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Es(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Es(this.gl,o))this.colorBufferHalfFloatExtension=this.gl.getExtension(o);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=$K(this.gl),this.indexBuffer=NK(this.gl),this.framebuffer=y5(this.gl),this.textureConfig=I1(this.gl,this.textureHalfFloatExtension)}get debug(){return ae().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Se(e,()=>e.finish()),Se(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Se(e,()=>e.deleteFramebuffer(this.framebuffer)),Se(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Se(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Se(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),TK(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),EK(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),RK(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),OK(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,s,o){this.throwIfDisposed(),_K(this.gl,e,t,s,o,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),DK(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),AK(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(tC(this.gl,this.framebuffer),this.outputTexture=null),Se(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,s){return this.downloadMatrixDriver(e,()=>PK(this.gl,t,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,s,o,r,i){return zK(this.gl,e,t,s,o,r,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return MK(this.gl,e,t)}createBufferFromTexture(e,t,s){this.bindTextureToFrameBuffer(e);const o=LK(this.gl,t,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),o}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,s;if(ae().getBool("WEBGL_FENCE_API_ENABLED")){const o=e,r=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=o.clientWaitSync(r,0,0);return i===o.ALREADY_SIGNALED||i===o.CONDITION_SATISFIED},t=r}else ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(t,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:t,isFencePassed:s}}downloadMatrixFromPackedTexture(e,t,s){return this.downloadMatrixDriver(e,()=>BK(this.gl,t,s))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=SK(t));const s=d5(t);Se(t,()=>t.attachShader(s,this.vertexShader)),Se(t,()=>t.attachShader(s,e)),h5(t,s);const o=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&Wg(t,o),o}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;Se(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),FK(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Se(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Wg(this.gl,this.program),Se(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,s=!0){return this.throwIfDisposed(),s?b5(this.gl,e,t):v5(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Se(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,s){this.throwIfDisposed(),this.throwIfNoProgram(),w5(this.gl,e,t,s)}setOutputMatrixTexture(e,t,s){this.setOutputMatrixTextureDriver(e,s,t)}setOutputPackedMatrixTexture(e,t,s){this.throwIfDisposed();const[o,r]=Xa(t,s);this.setOutputMatrixTextureDriver(e,o,r)}setOutputMatrixWriteRegion(e,t,s,o){this.setOutputMatrixWriteRegionDriver(s,e,o,t)}setOutputPackedMatrixWriteRegion(e,t,s,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Wg(this.gl,this.program),Jd(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Se(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Se(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Qd(this.gl,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,o=this.getQueryTimerExtensionWebGL2(),r=s.createQuery();return s.beginQuery(o.TIME_ELAPSED_EXT,r),r}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,s=this.getQueryTimerExtensionWebGL2();t.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await Bw(()=>this.disposed||this.isQueryAvailable(e,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const s=this.gl,o=this.getQueryTimerExtensionWebGL2(),r=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),r&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),o=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),o&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=WK(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:s}=this.itemsToPoll[t];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in ae().platform&&(s=ae().platform.setTimeoutCustom.bind(ae().platform)),Bw(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Vg(this.gl,e,this.framebuffer),this.debug&&Jd(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Vg(this.gl,this.outputTexture,this.framebuffer),this.debug&&Jd(this.gl)):tC(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const s=t();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,t,s){this.throwIfDisposed();const o=this.gl;Vg(o,e,this.framebuffer),this.debug&&Jd(o),this.outputTexture=e,Se(o,()=>o.viewport(0,0,t,s)),Se(o,()=>o.scissor(0,0,t,s))}setOutputMatrixWriteRegionDriver(e,t,s,o){this.throwIfDisposed(),Se(this.gl,()=>this.gl.scissor(e,t,s,o))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function WK(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:VK,bincountImpl:dE,bincountReduceImpl:UK,bitwiseAndImpl:GK,castImpl:jK,ceilImpl:HK,concatImpl:qK,equalImpl:KK,expImpl:XK,expm1Impl:YK,floorImpl:QK,gatherNdImpl:JK,gatherV2Impl:ZK,greaterImpl:eX,greaterEqualImpl:tX,lessImpl:nX,lessEqualImpl:sX,linSpaceImpl:oX,logImpl:rX,maxImpl:iX,maximumImpl:aX,minimumImpl:lX,multiplyImpl:uX,negImpl:cX,notEqualImpl:dX,prodImpl:hX,raggedGatherImpl:pX,raggedRangeImpl:fX,raggedTensorToTensorImpl:mX,rangeImpl:gX,rsqrtImpl:yX,scatterImpl:xX,sigmoidImpl:bX,simpleAbsImpl:hE,sliceImpl:vX,sparseFillEmptyRowsImpl:wX,sparseReshapeImpl:kX,sparseSegmentReductionImpl:pE,sqrtImpl:CX,staticRegexReplaceImpl:IX,stridedSliceImpl:SX,stringNGramsImpl:$X,stringSplitImpl:NX,stringToHashBucketFastImpl:TX,subImpl:EX,tileImpl:RX,topKImpl:AX,transposeImpl:T1,uniqueImpl:DX}=OU;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fE(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function An(n,e){return e===1?[n]:fE(n,e)}function FX(n,e){if(n===1)return"rc";let t="";for(let s=0;s<n;s++)t+=e[s],s<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _X{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Cn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=An("rc",this.rank),s=yt(this.rank),o=this.getOutOfBoundsCondition(t),r=this.getSetup(t),i=this.getOutput(t);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${o}) {
            setOutput(vec4(0));
          } else {
            ${r}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let s=0;s<=1;s++)for(let o=0;o<=1;o++){let r=`${s===0?"r":"rp1"}, ${o===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)r=`${e[e.length-1-i]},`+r;t.push(r)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let s=this.rank-2;s<this.rank;s++)t+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],o=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${o};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mE{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length);let s="";for(let o=0;o<4;o++){let r="thisRC = rc;";o%2===1&&(r+="thisRC.z += 1;"),o>1&&(r+="thisRC.y += 1;"),s+=`
        ${r}
        ${o>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${o}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${o>0?"}":""}
      `}this.userCode=`
      ${OX(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?$1():S1(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function OX(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?F5(["r","c","d"],"inputShape"):Pi(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LX{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,s){const o=iC(t,s),r=aC(e,o,s);r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]);const i=rC(e,o,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const u=this.freeTextures[r].pop();return this.usedTextures[r].push(u),u}let a;return o===cn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===cn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===cn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===cn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===cn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[r].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,t,s,o){if(this.freeTextures==null)return;const r=iC(s,o),i=aC(t,r,o);i in this.freeTextures||(this.freeTextures[i]=[]);const a=rC(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,o),u=ae().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");u!==-1&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const d=this.usedTextures[i],h=d&&d.indexOf(e);if(h==null||h<0)throw new Error("Cannot release a texture that was never provided by this texture manager");d[h]=d[d.length-1],d.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function MX(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function rC(n,e,t,s,o){const r=PX(e,s);let i;if(o){const[u,d]=Xa(n[0],n[1]);i=u*d}else{const[u,d]=Tc(n[0],n[1]);i=u*d}const a=MX(t,r);return i*a}function PX(n,e){switch(n){case cn.PACKED_2X2_FLOAT32:return uE(e);case cn.PACKED_2X2_FLOAT16:return cE(e);case cn.UNPACKED_FLOAT32:return iE(e);case cn.UNPACKED_FLOAT16:return aE(e);case cn.PACKED_4X1_UNSIGNED_BYTE:return lE(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function zX(n){return ae().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?cn.PACKED_2X2_FLOAT32:cn.UNPACKED_FLOAT32:n?cn.PACKED_2X2_FLOAT16:cn.UNPACKED_FLOAT16}function iC(n,e){if(n===ds.UPLOAD)return cn.PACKED_2X2_FLOAT32;if(n===ds.RENDER||n==null)return zX(e);if(n===ds.DOWNLOAD||n===ds.PIXELS)return cn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function aC(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mo{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const _s="if (isnan(x)) return x;",BX="return x;",lC="return abs(x);",WX="return (x >= 0.0) ? x : (exp(x) - 1.0);",VX=_s+`
  return (x < 0.0) ? 0.0 : x;
`,UX=_s+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,xr="return x;",GX="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jX="return x;",HX=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,qX=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,KX=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XX="return 1.0 / (1.0 + exp(-1.0 * x));";class kr{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YX{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length);const t=e.length,s=An("rc",t),o=yt(t),r=FX(t,s),i=s.slice(-2),a=t<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${o} rc = getOutputCoords();
        vec4 packedInput = getA(${r});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QX=BS,JX=1e-7,ZX=1e-4,th={};function e8(n){return n in th||(th[n]={}),th[n]}const t8=ae().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),n8=600;function s8(){return ae().global.screen==null?1024:ae().global.screen.height*ae().global.screen.width*window.devicePixelRatio*n8/1024/1024}class vf extends Xy{nextDataId(){return vf.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ae().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof jg)t=e;else{const s=Zs(ae().getNumber("WEBGL_VERSION"),e);t=new jg(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Zs(ae().getNumber("WEBGL_VERSION"));t=new jg(s),this.binaryCache=e8(ae().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new LX(this.gpgpu),this.numMBBeforeWarning=s8(),this.texData=new cI(this,ao())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,s,o,r,i){const a=this.makeTensorInfo(t,s),u=this.texData.get(a.dataId);u.isPacked=!1,u.texture={texture:e,texShape:[o,r]},u.texShape=[o,r];const d=Zd(t),h=new oC(d,!1,i),p=this.runWebGLProgram(h,[a],s,[[o,r]]);return p.shape=t,u.texture=null,this.disposeIntermediateTensorInfo(a),p.dataId}write(e,t,s){if((ae().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ae().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const o={id:this.nextDataId()};return this.texData.set(o,{shape:t,dtype:s,values:e,usage:ds.UPLOAD,refCount:1}),o}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,s,o,r){if(ae().getBool("DEBUG")&&this.checkNumericalProblems(t),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:o,values:t,usage:ds.UPLOAD,refCount:r})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:s,dtype:o,complexTensorInfos:r,slice:i,shape:a,isPacked:u}=t;if(i!=null){let f;u?f=new kr(a,xr):f=new mo(a,xr);const g=this.runWebGLProgram(f,[{dataId:e,shape:a,dtype:o}],o),y=this.readSync(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(o==="string")return s;const d=this.activeTimers!=null;let h;d&&(h=Pn());let p;if(o==="complex64"){const f=this.readSync(r.real.dataId),g=this.readSync(r.imag.dataId);p=jo(f,g)}else p=this.getValuesFromTexture(e);return d&&(this.downloadWaitMs+=Pn()-h),this.convertAndCacheOnCPU(e,p)}async read(e){if(this.pendingRead.has(e)){const y=this.pendingRead.get(e);return new Promise(b=>y.push(b))}const t=this.texData.get(e),{values:s,shape:o,slice:r,dtype:i,complexTensorInfos:a,isPacked:u}=t;if(r!=null){let y;u?y=new kr(o,xr):y=new mo(o,xr);const b=this.runWebGLProgram(y,[{dataId:e,shape:o,dtype:i}],i),v=this.read(b.dataId);return this.disposeIntermediateTensorInfo(b),v}if(s!=null)return this.convertAndCacheOnCPU(e);if(ae().getBool("DEBUG")&&!ae().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ae().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let d=null,h;if(i!=="complex64"&&ae().get("WEBGL_BUFFER_SUPPORTED")){h=this.decode(e);const y=this.texData.get(h.dataId);d=this.gpgpu.createBufferFromTexture(y.texture.texture,...Yd(o))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let p;if(i==="complex64"){const y=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),b=y[0],v=y[1];p=jo(b,v)}else if(d==null)p=this.getValuesFromTexture(e);else{const y=de(o);p=this.gpgpu.downloadFloat32MatrixFromBuffer(d,y)}if(h!=null&&this.disposeIntermediateTensorInfo(h),d!=null){const y=this.gpgpu.gl;Se(y,()=>y.deleteBuffer(d))}const f=this.convertAndCacheOnCPU(e,p),g=this.pendingRead.get(e);return this.pendingRead.delete(e),g.forEach(y=>y(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ao().removeDataId(e,this),this.pendingDeletes--),f}readToGPU(e,t={}){const s=this.texData.get(e),{values:o,shape:r,slice:i,dtype:a,isPacked:u,texture:d}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let g;u?g=new kr(r,xr):g=new mo(r,xr);const y=this.runWebGLProgram(g,[{dataId:e,shape:r,dtype:a}],a),b=this.readToGPU(y,t);return this.disposeIntermediateTensorInfo(y),b}if(d==null)throw o!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const h=this.decode(e,t.customTexShape),p=ao().makeTensorFromTensorInfo(h),f=this.texData.get(h.dataId);return Object.assign({tensorRef:p},f.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(o=>Nr(o));return qe(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return qe(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const s=e[t];if(!i5(s))throw ae().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:s,isPacked:o}=this.texData.get(e),r=de(t);if(ae().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const f=this.decode(e),g=this.texData.get(f.dataId),y=this.gpgpu.downloadMatrixFromPackedTexture(g.texture.texture,...Yd(t)).subarray(0,r);return this.disposeIntermediateTensorInfo(f),y}const i=ae().getBool("WEBGL_PACK")&&o===!0,a=i?Zd(t):t,u=i?new kK(a):new wK(a),d=this.runWebGLProgram(u,[{shape:a,dtype:s,dataId:e}],"float32"),h=this.texData.get(d.dataId),p=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture.texture,h.texShape[0],h.texShape[1]).subarray(0,r);return this.disposeIntermediateTensorInfo(d),p}timerAvailable(){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,s=[];let o=!1;this.programTimersStack==null?(this.programTimersStack=s,o=!0):this.activeTimers.push(s),this.activeTimers=s,e();const r=bi(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),i=bi(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=t,o&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const u=await Promise.all(r);a.kernelMs=WF(u),a.getExtraProfileInfo=()=>u.map((d,h)=>({name:i[h],ms:d})).map(d=>`${d.name}: ${d.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Pn(),endMs:null}}endTimer(e){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Pn(),e)}async getQueryTime(e){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,t),this.disposeData(s.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:s,texShape:o,usage:r,isPacked:i,slice:a}=this.texData.get(e),u=a&&a.origDataId||e,d=this.dataRefCount.get(u);d>1?this.dataRefCount.set(u,d-1):(this.dataRefCount.delete(u),t!=null&&(this.numBytesInGPU-=this.computeBytes(o,s),this.textureManager.releaseTexture(t,o,r,i)));const h=this.texData.get(e);h.texture=null,h.texShape=null,h.isPacked=!1,h.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=t8){return ae().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&de(s.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){cs("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return QX(e.shape,t)}packedUnaryOp(e,t,s){const o=new kr(e.shape,t),r=this.compileAndRun(o,[e],s);return ao().makeTensorFromTensorInfo(r)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const o=hE(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,o)}if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,lC,e.dtype);const t=new mo(e.shape,lC),s=this.compileAndRun(t,[e]);return ao().makeTensorFromTensorInfo(s)}makeTensorInfo(e,t,s){let o;if(t==="string"&&s!=null&&s.length>0&&mu(s[0])){const r=s.map(i=>Ir(i));o=this.write(r,e,t)}else o=this.write(s,e,t);return this.texData.get(o).usage=null,{dataId:o,shape:e,dtype:t}}makeOutput(e,t,s){return ao().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,s),this)}unpackTensor(e){const t=new YX(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new _X(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const s=[Pa(e.shape),...za(e.shape)],o={dtype:e.dtype,shape:s,dataId:e.dataId},r=[Pa(t),...za(t)],i=new mE(r,s),a=!0,u=[s],d=this.runWebGLProgram(i,[o],e.dtype,u,a);return{dataId:d.dataId,shape:t,dtype:d.dtype}}decode(e,t){const s=this.texData.get(e),{isPacked:o,shape:r,dtype:i}=s;if(t!=null){const f=de(r),g=t[0]*t[1]*4;_(f<=g,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Zd(r);let u;o?u=new vK(a):u=new bK(a);const d=!0,h=[t??Yd(a)],p=this.runWebGLProgram(u,[{shape:a,dtype:i,dataId:e}],i,h,d,t);return{dtype:i,shape:r,dataId:p.dataId}}runWebGLProgram(e,t,s,o,r=!1,i){const a=this.makeTensorInfo(e.outputShape,s),u=this.texData.get(a.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===uu.DENSE){const w=i??Yd(e.outputShape);u.texShape=w.map(C=>C*2)}if(e.outTexUsage!=null&&(u.usage=e.outTexUsage),de(a.shape)===0)return u.values=xn(a.dtype,0),a;const d=[],h=t.map(w=>{if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let C=this.texData.get(w.dataId);if(C.texture==null){if(!e.packedInputs&&de(w.shape)<=ae().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:C.values};e.packedInputs&&(C.isPacked=!0,C.shape=w.shape)}if(this.uploadToGPU(w.dataId),!!C.isPacked!=!!e.packedInputs)w=C.isPacked?this.unpackTensor(w):this.packTensor(w),d.push(w),C=this.texData.get(w.dataId);else if(C.isPacked&&!Wh(C.shape,w.shape)){const $=w,S=w.shape;w.shape=C.shape,w=this.packedReshape(w,S),d.push(w),C=this.texData.get(w.dataId),$.shape=S}return{shape:w.shape,texData:C,isUniform:!1}});this.uploadToGPU(a.dataId);const p={shape:a.shape,texData:u,isUniform:!1},f=xK(e,h,p),g=this.getAndSaveBinary(f,()=>gK(this.gpgpu,e,h,p)),y=this.activeTimers!=null;let b;y&&(b=this.startTimer()),ae().get("ENGINE_COMPILE_ONLY")||yK(this.gpgpu,g,h,p,o),d.forEach(w=>this.disposeIntermediateTensorInfo(w)),y&&(b=this.endTimer(b),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(b)}));const v=ae().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const w=Pn();w-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!ae().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&r===!1){const w=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),w}return a}compileAndRun(e,t,s,o,r=!1){return s=s||t[0].dtype,this.runWebGLProgram(e,t,s,o,r)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ae().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=se(()=>{if(!ae().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ae().getBool("DEBUG");ae().set("DEBUG",!1);const t=this.abs(dt(1e-8)).dataSync()[0];if(ae().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?JX:ZX}uploadToGPU(e){const t=this.texData.get(e),{shape:s,dtype:o,values:r,texture:i,usage:a,isPacked:u}=t;if(i!=null)return;const d=this.activeTimers!=null;let h;d&&(h=Pn());let p=t.texShape;if(p==null&&(p=I5(s,u),t.texShape=p),r!=null){const f=Zd(s);let g,y=p[1],b=p[0];const v=r instanceof Uint8Array||r instanceof Uint8ClampedArray;(u||!v)&&([y,b]=Xa(p[0],p[1])),u?g=new IK(f,v):g=new oC(f,v);const w=v?[b,y]:p,C=this.makeTensorInfo(w,o),$=this.texData.get(C.dataId);v?$.usage=ds.PIXELS:$.usage=ds.UPLOAD,$.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(C.dataId),y,b,r);const S=[[b,y]],R=this.runWebGLProgram(g,[C],o,S,!0),F=this.texData.get(R.dataId);t.texShape=F.texShape,t.isPacked=F.isPacked,t.usage=F.usage,ae().get("ENGINE_COMPILE_ONLY")?this.disposeData(R.dataId):(t.texture=F.texture,t.values=null,this.texData.delete(R.dataId)),this.disposeIntermediateTensorInfo(C),d&&(this.uploadWaitMs+=Pn()-h)}else{const f=this.acquireTexture(p,a,o,u);t.texture=f}}convertAndCacheOnCPU(e,t){const s=this.texData.get(e),{dtype:o}=s;return t!=null&&(s.values=o8(t,o)),s.values}acquireTexture(e,t,s,o){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const r=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${r} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,o)}computeBytes(e,t){return e[0]*e[1]*yh(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const s=new Promise(o=>{try{this.checkCompletion_(t),o(!0)}catch(r){throw r}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await s$(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(eE(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:s,infLoc:o,nanLoc:r,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:u}=rE(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=s,e.infLoc=o,e.nanLoc=r,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=u}}createTensorFromGPUData(e,t,s){e.channels=e.channels||"RGBA";const{texture:o,height:r,width:i,channels:a}=e,u=ao().backend;if(!u.gpgpu.gl.isTexture(o))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const d=u.writeTexture(o,t,s,r,i,a);return ao().makeTensorFromDataId(d,t,s,u)}}vf.nextDataId=0;function o8(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let s=0;s<t.length;++s)t[s]=Math.round(n[s]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ZI()&&sS("webgl",()=>new vf,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E1=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Ai{constructor(e,t,s){this.variableNames=["A","B"],this.outputShape=je(t,s),this.enableShapeUniforms=Cn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bi=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class el{constructor(e,t,s,o=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=je(t,s);const r=this.outputShape.length;this.enableShapeUniforms=Cn(r);let i="";if(o)if(r===0||de(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${yt(r)} coords = getOutputCoords();
        `,r===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const u=An("coords",r);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${u[r-2]} + 1) >= outShape[${r} - 2];
            bool nextColOutOfBounds =
              (${u[r-1]} + 1) >= outShape[${r} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${u[r-2]} + 1) >= ${this.outputShape[r-2]};
            bool nextColOutOfBounds =
              (${u[r-1]} + 1) >= ${this.outputShape[r-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ss(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const r8={kernelName:Lu,backendName:"webgl",kernelFunc:ss};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vr(n){const{inputs:e,backend:t}=n,{real:s,imag:o}=e,r=t.makeTensorInfo(s.shape,"complex64"),i=t.texData.get(r.dataId),a=ss({inputs:{x:s},backend:t}),u=ss({inputs:{x:o},backend:t});return i.complexTensorInfos={real:a,imag:u},r}const i8={kernelName:lx,backendName:"webgl",kernelFunc:Vr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gE="return (a < 0.) ? b * a : a;",yE=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function a8(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{alpha:r}=s,i=t.makeTensorInfo([],"float32",_r(r,"float32")),a=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new el(yE,o.shape,i.shape):new Ai(gE,o.shape,i.shape),u=t.runWebGLProgram(a,[o,i],"float32");return t.disposeIntermediateTensorInfo(i),u}const l8={kernelName:pp,backendName:"webgl",kernelFunc:a8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xE="return (a < 0.) ? b * a : a;",bE=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function u8(n){const{inputs:e,backend:t}=n,{x:s,alpha:o}=e,r=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new el(bE,s.shape,o.shape):new Ai(xE,s.shape,o.shape);return t.runWebGLProgram(r,[s,o],"float32")}const c8={kernelName:Dp,backendName:"webgl",kernelFunc:u8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tl="if (isnan(x)) return x;";function ot({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:s}){return({inputs:o,backend:r})=>{const{x:i}=o,a=r,u=s||i.dtype;if(a.shouldExecuteOnCPU([i])&&t!=null){const p=a.texData.get(i.dataId),f=t(p.values,u);return a.makeTensorInfo(i.shape,u,f)}const d=ae().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let h;return d?h=new kr(i.shape,e):h=new mo(i.shape,n),a.runWebGLProgram(h,[i],u)}}function fn({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:s=!1,cpuKernelImpl:o,dtype:r}){return({inputs:i,backend:a})=>{const{a:u,b:d}=i,h=a;if(s&&u.dtype==="complex64"){const y=h.texData.get(u.dataId),b=h.texData.get(d.dataId),[v,w]=[[y.complexTensorInfos.real,b.complexTensorInfos.real],[y.complexTensorInfos.imag,b.complexTensorInfos.imag]].map($=>{const[S,N]=$,R={dataId:S.dataId,dtype:S.dtype,shape:u.shape},F={dataId:N.dataId,dtype:N.dtype,shape:d.shape},O=new Ai(n,u.shape,d.shape);return h.runWebGLProgram(O,[R,F],ts(S.dtype,N.dtype))}),C=Vr({inputs:{real:v,imag:w},backend:h});return h.disposeIntermediateTensorInfo(v),h.disposeIntermediateTensorInfo(w),C}const p=r||ts(u.dtype,d.dtype);if((u.dtype==="string"||d.dtype==="string"||h.shouldExecuteOnCPU([u,d]))&&o!=null){const y=h.texData.get(u.dataId).values,b=h.texData.get(d.dataId).values,v=u.dtype==="string"?Ho(y):y,w=u.dtype==="string"?Ho(b):b,[C,$]=o(u.shape,d.shape,v,w,p),S=h.makeTensorInfo($,p),N=h.texData.get(S.dataId);return N.values=C,S}const f=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let g;return f?g=new el(e,u.shape,d.shape,t):g=new Ai(n,u.shape,d.shape),h.runWebGLProgram(g,[u,d],p)}}function cu(n,e=!1){if(n==="linear")return e?jX:BX;if(n==="relu")return e?qX:VX;if(n==="elu")return e?HX:WX;if(n==="relu6")return e?KX:UX;if(n==="prelu")return e?bE:xE;if(n==="leakyrelu")return e?yE:gE;if(n==="sigmoid")return e?XX:GX;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vE{constructor(e,t,s,o=!1,r=!1,i=!1,a=null,u=!1,d=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Cn(this.outputShape.length);const h=o?e[1]:e[2],p=Math.ceil(h/2),f=o?"i * 2, rc.y":"rc.y, i * 2",g=r?"rc.z, i * 2":"i * 2, rc.z",y=o?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],b=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",w="";a&&(u?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:d?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:v=`vec4 activation(vec4 x) {
          ${a}
        }`,w="result = activation(result);");const C=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),d&&this.variableNames.push("leakyreluAlpha");let $="rc.x",S="rc.x";e[0]<t[0]?$=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(S=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${p}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${$};
        int batchB = ${S};
        for (int i = 0; i < ${p}; i++) {
          vec4 a = getMatrixA(batchA, ${f});
          vec4 b = getMatrixB(batchB, ${g});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${y[0]} * ${b[0]});
          result += (${y[1]} * ${b[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${C}

        ${w}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uC={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class cC{constructor(e,t,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=je(t,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dC="return a * b;";function R1(n){const{inputs:e,backend:t}=n,{a:s,b:o}=e,r=ts(s.dtype,o.dtype);if(s.dtype==="complex64"){const a=t.texData.get(s.dataId),u=t.texData.get(o.dataId),d=new cC(uC.REAL,s.shape,o.shape),h=new cC(uC.IMAG,s.shape,o.shape),p=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:o.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:o.shape}],f=t.runWebGLProgram(d,p,"float32"),g=t.runWebGLProgram(h,p,"float32"),y=Vr({inputs:{real:f,imag:g},backend:t});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),y}if(t.shouldExecuteOnCPU([s,o])){const a=t.texData.get(s.dataId),u=t.texData.get(o.dataId),[d,h]=uX(s.shape,o.shape,a.values,u.values,r),p=t.makeTensorInfo(h,r),f=t.texData.get(p.dataId);return f.values=d,p}let i;return ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new el(dC,s.shape,o.shape):i=new Ai(dC,s.shape,o.shape),t.runWebGLProgram(i,[s,o],r)}const d8={kernelName:ju,backendName:"webgl",kernelFunc:R1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h8(n,e,t){const s=[Pa(n.shape),...za(n.shape)],o={dtype:n.dtype,shape:s,dataId:n.dataId},r=[Pa(e),...za(e)],i=new mE(r,s),a=!0,u=[s],d=t.runWebGLProgram(i,[o],n.dtype,u,a);return{dataId:d.dataId,shape:e,dtype:d.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ie(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{shape:r}=s,i=t,a=de(o.shape),u=hI(r,a),d=de(u);_(a===d,()=>`The new shape (${u}) has ${d} elements and the old shape (${o.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const h=i.texData.get(o.dataId);return h.isPacked&&!Wh(o.shape,u)&&!(h.texture!==null&&Wh(h.shape,u))?h8(o,u,i):(i.incRef(o.dataId),{dataId:o.dataId,shape:u,dtype:o.dtype})}const p8={kernelName:_p,backendName:"webgl",kernelFunc:Ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hC{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:o,inSize:r,outSize:i}=e;this.outputShape=[o,i];const a=Math.floor(s/4)*4,u=s%4;let d="sumValue += dot(values, ones);";if(t!=null){const p=1/t;d=`sumValue += dot(values * ${Ta(p)?p.toPrecision(2):p}, ones);`}let h="";r%s>0&&(h=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${a};
        if (${u===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${d}
        } else if (${u===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${d}
        } else if (${u===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${d}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f8{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:o,inSize:r,outSize:i}=e;this.outputShape=[o,i];let a="0.0",u="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",u="min"):t==="max"&&(a="-1.0 / 1e-20",u="max");let d=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?d="sumValue":t==="prod"?d="prodValue":t==="all"?d="allValue":t==="any"&&(d="anyValue");const h=Math.floor(s/4)*4,p=s%4;let f=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${u}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${u}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,g="vec4";t==="all"?(a="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,g="bvec4"):t==="any"&&(a="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,g="bvec4");let y="";r%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${y}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${f}
        }

        int inIdx = inOffset + ${h};
        if (${p===1}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${p===2}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${p===3}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${f}
        }
        setOutput(${d});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],s=sf(t);e.push({inSize:t,windowSize:s,outSize:Math.ceil(t/s)})}return e}function Wi(n,e,t,s){const o=m8(n.shape);let r=n;for(let i=0;i<o.length;i++){const{inSize:a,windowSize:u,outSize:d}=o[i];let h,p;t==="mean"?h=i===0?new hC({windowSize:u,inSize:a,batchSize:n.shape[0],outSize:d},a):new hC({windowSize:u,inSize:a,batchSize:n.shape[0],outSize:d}):h=new f8({windowSize:u,inSize:a,batchSize:n.shape[0],outSize:d},t),p=r,r=s.runWebGLProgram(h,[r],e),p.dataId!==n.dataId&&s.disposeIntermediateTensorInfo(p)}return r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g8{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[t[i]];this.outputShape=s,this.rank=s.length;const o=yt(this.rank),r=y8(t);this.userCode=`
    void main() {
      ${o} resRC = getOutputCoords();
      setOutput(getA(${r}));
    }
    `}}function y8(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let o=0;o<n.length;o++)s[n[o]]=t[o];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x8{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let h=0;h<s.length;h++)s[h]=e[t[h]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const o=yt(this.rank),r=fE("rc",this.rank),i=new Array(this.rank);for(let h=0;h<t.length;h++)i[t[h]]=r[h];const a=`vec2(${i.slice(-2).join()})`,u=`++${r[this.rank-1]} < ${s[this.rank-1]}`,d=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${o} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${d};
      if(${u}) {
        result[1] = ${d};
      }
      --${r[this.rank-1]};
      if(++${r[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${d};
        if(${u}) {
          result[3] = ${d};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wf(n,e,t){const s=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new x8(n.shape,e):new g8(n.shape,e);return t.runWebGLProgram(s,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8(n,e,t,s){const o=e,r=n.shape.length,i=Ke(o,n.shape);let a=i;const u=Dt(a,r),d=u!=null;let h=n;d&&(h=wf(n,u,s),a=zt(a.length,r)),pn("sum",a,r);const[p,f]=rn(h.shape,a);let g=p;t&&(g=jt(p,i));const y=de(f),v=de(n.shape)/y,w=Ie({inputs:{x:h},attrs:{shape:[v,y]},backend:s}),C=Vx(n.dtype),$=Wi(w,C,"sum",s),S=Ie({inputs:{x:$},attrs:{shape:g},backend:s});return s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo($),d&&s.disposeIntermediateTensorInfo(h),S}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kf(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s;return b8(o,r,i,t)}const v8={kernelName:Bp,backendName:"webgl",kernelFunc:kf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fn(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{perm:r}=s,i=t,a=o.shape.length,u=new Array(a);for(let h=0;h<u.length;h++)u[h]=o.shape[r[h]];let d;if(i.shouldExecuteOnCPU([o])){const p=i.texData.get(o.dataId).values,f=T1(p,o.shape,o.dtype,r,u);d=i.makeTensorInfo(u,o.dtype);const g=i.texData.get(d.dataId);g.values=f}else d=wf(o,r,i);return d}const w8={kernelName:Ca,backendName:"webgl",kernelFunc:Fn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wE=1e3;function Vh({a:n,b:e,transposeA:t,transposeB:s,backend:o,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:u=null}){const d=n.shape.length,h=e.shape.length,p=t?n.shape[d-2]:n.shape[d-1],f=s?e.shape[h-1]:e.shape[h-2],g=t?n.shape[d-1]:n.shape[d-2],y=s?e.shape[h-2]:e.shape[h-1],b=n.shape.slice(0,-2),v=e.shape.slice(0,-2),w=de(b),C=de(v),S=je(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([g,y]);_(p===f,()=>`Error in matMul: inner shapes (${p}) and (${f}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${s} must match.`);const N=t?[w,p,g]:[w,g,p],R=s?[C,y,f]:[C,f,y],F=Ie({inputs:{x:n},backend:o,attrs:{shape:N}}),O=Ie({inputs:{x:e},backend:o,attrs:{shape:R}}),D=[F,O],A=Math.max(w,C),T=t?F.shape[1]:F.shape[2],B=r!=null,U=i!=null,Q=u==="leakyrelu",K=u!=null?cu(u,!0):null,J=B||U||Q||K!=null;let te;if((g===1||y===1)&&T>wE&&J===!1){let X=F,Y=O;t&&(X=Fn({inputs:{x:F},backend:o,attrs:{perm:[0,2,1]}}),D.push(X)),s&&(Y=Fn({inputs:{x:O},backend:o,attrs:{perm:[0,2,1]}}),D.push(Y));const L=y!==1,W=y===1;let ie=X;L&&(ie=Ie({inputs:{x:X},backend:o,attrs:{shape:[A,T,1]}}),D.push(ie));const he=y===1?2:1;let pe=Y;W&&(pe=Ie({inputs:{x:Y},backend:o,attrs:{shape:[A,1,T]}}),D.push(pe));const me=R1({inputs:{a:ie,b:pe},backend:o});te=kf({inputs:{x:me},backend:o,attrs:{axis:he,keepDims:!0}}),D.push(me)}else{const X=ts(n.dtype,e.dtype),Y=new vE(N,R,[A,g,y],t,s,B,K,U,Q),L=[F,O];if(r!=null&&L.push(r),U&&L.push(i),Q){const W=o.makeTensorInfo([],"float32",_r(a,"float32"));L.push(W),D.push(W)}te=o.runWebGLProgram(Y,L,X)}const P=Ie({inputs:{x:te},backend:o,attrs:{shape:S}});D.push(te);for(const X of D)o.disposeIntermediateTensorInfo(X);return P}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k8(n){const{inputs:e,backend:t,attrs:s}=n,{a:o,b:r,bias:i,preluActivationWeights:a}=e,{transposeA:u,transposeB:d,activation:h,leakyreluAlpha:p}=s;return Vh({a:o,b:r,transposeA:u,transposeB:d,backend:t,bias:i,preluActivationWeights:a,leakyreluAlpha:p,activation:h})}const C8={kernelName:xh,backendName:"webgl",kernelFunc:k8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pC="return abs(x);";function I8(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const r=t.texData.get(s.dataId),i=hE(r.values);return t.makeTensorInfo(s.shape,s.dtype,i)}let o;return ae().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new kr(s.shape,pC):o=new mo(s.shape,pC),t.runWebGLProgram(o,[s],s.dtype)}const S8={kernelName:qh,backendName:"webgl",kernelFunc:I8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $8=_s+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,N8=ot({opSnippet:$8}),T8={kernelName:gu,backendName:"webgl",kernelFunc:N8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8=_s+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,R8=ot({opSnippet:E8}),A8={kernelName:yu,backendName:"webgl",kernelFunc:R8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fC="return a + b;",D8=fn({opSnippet:fC,packedOpSnippet:fC,supportsComplex:!0,cpuKernelImpl:VK}),F8={kernelName:Va,backendName:"webgl",kernelFunc:D8};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _8{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((r,i)=>`T${i}`);const s=[];this.variableNames.forEach(r=>{s.push(`float v${r} = get${r}AtOutCoords();`)});const o=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${o};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O8{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((r,i)=>`T${i}`);const s=[];this.variableNames.forEach(r=>{s.push(`vec4 v${r} = get${r}AtOutCoords();`)});const o=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${o};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dh(n){const{inputs:e,backend:t}=n,s=e;if(s.length===1)return ss({inputs:{x:s[0]},backend:t});if(s.length>ae().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const u=Math.floor(s.length/2),d=dh({inputs:s.slice(0,u),backend:t}),h=dh({inputs:s.slice(u),backend:t});return dh({inputs:[d,h],backend:t})}const o=s.map(u=>u.dtype).reduce((u,d)=>ts(u,d)),r=s.map(u=>u.shape),a=ae().getBool("WEBGL_PACK")?new O8(s[0].shape,r):new _8(s[0].shape,r);return t.runWebGLProgram(a,s,o)}const L8={kernelName:tx,backendName:"webgl",kernelFunc:dh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M8(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s,a=o.shape.length,u=Ke(r,o.shape);let d=u;const h=Dt(d,a);let p=o;h!=null&&(p=Fn({inputs:{x:o},backend:t,attrs:{perm:h}}),d=zt(d.length,a)),pn("all",d,a);const[f,g]=rn(p.shape,d),y=de(g),b=Ie({inputs:{x:p},backend:t,attrs:{shape:[-1,y]}}),v=Wi(b,b.dtype,"all",t);let w;if(i){const C=jt(f,u);w=Ie({inputs:{x:v},backend:t,attrs:{shape:C}})}else w=Ie({inputs:{x:v},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(v),h!=null&&t.disposeIntermediateTensorInfo(p),w}const P8={kernelName:nx,backendName:"webgl",kernelFunc:M8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z8(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s,a=o.shape.length,u=Ke(r,o.shape);let d=u;const h=Dt(d,a);let p=o;h!=null&&(p=Fn({inputs:{x:o},backend:t,attrs:{perm:h}}),d=zt(d.length,a)),pn("any",d,a);const[f,g]=rn(p.shape,d),y=de(g),b=Ie({inputs:{x:p},backend:t,attrs:{shape:[-1,y]}}),v=Wi(b,b.dtype,"any",t);let w;if(i){const C=jt(f,u);w=Ie({inputs:{x:v},backend:t,attrs:{shape:C}})}else w=Ie({inputs:{x:v},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(v),h!=null&&t.disposeIntermediateTensorInfo(p),w}const B8={kernelName:sx,backendName:"webgl",kernelFunc:z8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W8{constructor(e,t,s){this.variableNames=["A"];const{windowSize:o,batchSize:r,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[r,i];const a=t==="max"?">":"<",u=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${o}; i++) {
          int inIdx = ${u};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V8{constructor(e,t,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,_(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const r=e[e.length-1],i=Math.ceil(r/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),o||this.variableNames.push("bestIndicesA");const a=this.outputShape,u=a.length,d=yt(u),h=An("coords",u);let p,f;if(i===1){f=u+1;const O=yt(f);p=`
        ${O} sourceLocR = ${O}(${h.join()}, 0);
        ++${h[u-1]};
        ${O} sourceLocG = ${O}(${h.join()}, 0);
        ++${h[u-2]};
        ${O} sourceLocA = ${O}(${h.join()}, 0);
        --${h[u-1]};
        ${O} sourceLocB = ${O}(${h.join()}, 0);
        --${h[u-2]};`}else f=u,p=`
        ${d} sourceLocR = coords;
        ++${h[u-1]};
        ${d} sourceLocG = coords;
        ++${h[u-2]};
        ${d} sourceLocA = coords;
        --${h[u-1]};
        ${d} sourceLocB = coords;
        --${h[u-2]};`;const g=["x","y","z","w","u","v"].slice(0,f),y="."+g[f-1],b=g.map(O=>"int "+O),v=An("sourceLocR",f-1).concat("inIdx.r"),w=An("sourceLocG",f-1).concat("inIdx.g"),C=An("sourceLocB",f-1).concat("inIdx.b"),$=An("sourceLocA",f-1).concat("inIdx.a"),S=s==="max"?"greaterThan":"lessThan",N=o?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${C.join()}),
                             getBestIndicesAChannel(${$.join()})));`,R=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${C.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${$.join()}) : 0.)`,F=o?"":`
      float getBestIndicesAChannel(${b.join()}) {
        return getChannel(getBestIndicesA(${g.join()}),
                                          vec2(${g.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${b.join()}) {
        return getChannel(getA(${g.join()}),
                               vec2(${g.slice(-2).join()}));
      }
      ${F}
      void main() {
        ${d} coords = getOutputCoords();
        bool hasNextCol = ${h[u-1]} < ${a[u-1]-1};
        bool hasNextRow = ${h[u-2]} < ${a[u-2]-1};
        ${p}
        ivec4 srcIdx = ivec4(sourceLocR${y}, sourceLocG${y},
          sourceLocB${y}, sourceLocA${y}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${R};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${N}
          vec4 candidate = ${R};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${S}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kE(n,e,t,s=null){let o=e.shape[0],r=e.shape[1];s!=null&&(o=s.shape[0],r=s.shape[1]);const i=sf(r),a={windowSize:i,inSize:r,batchSize:o,outSize:Math.ceil(r/i)},u=new W8(a,t,s==null),d=[e];s!=null&&d.push(s);const h=n.runWebGLProgram(u,d,"int32");if(h.shape[1]===1)return h;const p=kE(n,e,t,h);return n.disposeIntermediateTensorInfo(h),p}function CE(n,e,t,s=null){const o=s!=null?s.shape:e.shape,r=o[o.length-1],i=sf(r),a=new V8(o,i,t,s==null),u=s==null?[e]:[e,s],d=n.runWebGLProgram(a,u,"int32");if(d.shape.length===e.shape.length){const h=CE(n,e,t,d);return n.disposeIntermediateTensorInfo(d),h}return d}function IE(n,e,t,s){const o=[t];if(pn("arg"+s.charAt(0).toUpperCase()+s.slice(1),o,e.shape.length),!ae().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const r=[],i=n.texData.get(e.dataId),a=i!==null&&i.isPacked;let u=e;a&&(u=n.unpackTensor(e),r.push(u));const[d,h]=rn(u.shape,o),p=de(h),f=Ie({inputs:{x:u},backend:n,attrs:{shape:[-1,p]}});r.push(f);const g=kE(n,f,s);r.push(g);const y=Ie({inputs:{x:g},backend:n,attrs:{shape:d}});return r.forEach(b=>n.disposeIntermediateTensorInfo(b)),y}return CE(n,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U8(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r}=s;let i=Ke(r,o.shape);const a=Dt(i,o.shape.length);let u=o;const d=[];a!=null&&(u=Fn({inputs:{x:o},backend:t,attrs:{perm:a}}),d.push(u),i=zt(i.length,u.shape.length)),pn("argMax",[i[0]],u.shape.length);const h=IE(t,u,i[0],"max");return d.forEach(p=>t.disposeIntermediateTensorInfo(p)),h}const G8={kernelName:Kh,backendName:"webgl",kernelFunc:U8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j8(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r}=s;let i=Ke(r,o.shape);const a=Dt(i,o.shape.length);let u=o;const d=[];a!=null&&(u=Fn({inputs:{x:o},backend:t,attrs:{perm:a}}),d.push(u),i=zt(i.length,u.shape.length)),pn("argMin",[i[0]],u.shape.length);const h=IE(t,u,i[0],"min");return d.forEach(p=>t.disposeIntermediateTensorInfo(p)),h}const H8={kernelName:Xh,backendName:"webgl",kernelFunc:j8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q8=_s+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,K8=ot({opSnippet:q8}),X8={kernelName:xu,backendName:"webgl",kernelFunc:K8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y8=_s+"return log(x + sqrt(x * x + 1.0));",Q8=ot({opSnippet:Y8}),J8={kernelName:bu,backendName:"webgl",kernelFunc:Q8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z8=_s+`
  return atan(x);
`,e7=ot({opSnippet:Z8}),t7={kernelName:vu,backendName:"webgl",kernelFunc:e7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n7=E1+`
  return atan(a, b);
`,s7=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Bi+`
  return result;
`,o7=fn({opSnippet:n7,packedOpSnippet:s7}),r7={kernelName:ku,backendName:"webgl",kernelFunc:o7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i7=_s+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,a7=ot({opSnippet:i7}),l7={kernelName:wu,backendName:"webgl",kernelFunc:a7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class du{constructor(e,t,s,o=!1,r=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,u=e.strideWidth,d=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const b=t==="avg",v=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,w=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let C="0.0";if(b||(C="-1.0 / 1e-20"),s){const O=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${u});
        const ivec2 pads = ivec2(${g}, ${y});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${p};
              wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f};
                wC += ${h}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${O} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${o?r?v:w:`wR * ${f} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let S=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(S="avgValue / max(count, 1.0)");const N=Math.floor(i/4)*4,R=i%4,F=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${u});
      const ivec2 pads = ivec2(${g}, ${y});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${p};
            wR += ${d}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${N}; wC += 4) {
            int xC = xCCorner + wC * ${h};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              getValue(batch, xR, xC + 3 * ${h}, d)
            );

            ${F}
          }

          int xC = xCCorner + ${N};
          if (${R===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${F}
          } else if (${R===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              initializationValue,
              initializationValue
            );

            ${F}
          } else if (${R===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              initializationValue
            );

            ${F}
          }
        }
        setOutput(${S});
      }
    `}}class A1{constructor(e,t,s,o=!1,r=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,u=e.strideHeight,d=e.strideWidth,h=e.dilationDepth,p=e.dilationHeight,f=e.dilationWidth,g=e.effectiveFilterDepth,y=e.effectiveFilterHeight,b=e.effectiveFilterWidth,v=e.padInfo.front,w=e.padInfo.top,C=e.padInfo.left;this.outputShape=e.outShape;const $=t==="avg";let S="0.0";if($||(S="-1.0 / 1e-20"),s){const A=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${u}, ${d});
        const ivec3 pads = ivec3(${v}, ${w}, ${C});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${g};
              wD += ${h}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${y};
                wR += ${p}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${b};
                  wC += ${f}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${A} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${o?r?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${y} * ${b} +
                      wR * ${b} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const N="max";let R=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(R="avgValue / max(count, 1.0)");const F=Math.floor(i/4)*4,O=i%4,D=`
      if (${$}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${N}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${u}, ${d});
      const ivec3 pads = ivec3(${v}, ${w}, ${C});
      const float initializationValue = ${S};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${S});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${g};
            wD += ${h}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${y};
            wR += ${p}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${F}; wC += 4) {
              int xC = xCCorner + wC * ${f};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                getValue(batch, xD, xR, xC + 3 * ${f}, ch)
              );

              ${D}
            }

            int xC = xCCorner + ${F};
            if (${O===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${O===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                initializationValue,
                initializationValue
              );

              ${D}
            } else if (${O===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                initializationValue
              );

              ${D}
            }
          }
        }
        setOutput(${R});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e;Ec(o,"avgPool");const{filterSize:r,strides:i,pad:a,dimRoundingMode:u}=s,d=1;_(wn(i,d),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);const h=Ds(o.shape,r,i,d,a,u);if(h.filterWidth===1&&h.filterHeight===1&&ht(h.inShape,h.outShape))return ss({inputs:{x:o},backend:t});const p=new du(h,"avg",!1);return t.runWebGLProgram(p,[o],"float32")}const c7={kernelName:Yh,backendName:"webgl",kernelFunc:u7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{filterSize:r,strides:i,pad:a,dimRoundingMode:u,dataFormat:d}=s,h=[1,1,1],p=Xo(o.shape,r,i,h,a,u,d),f=new A1(p,"avg",!1);return t.runWebGLProgram(f,[o],"float32")}const h7={kernelName:Qh,backendName:"webgl",kernelFunc:d7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p7{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,o=e.strideHeight,r=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=u-1-e.padInfo.top,p=d-1-e.padInfo.left,f=1/(t*s);this.userCode=`
      const ivec2 pads = ivec2(${h}, ${p});
      const float avgMultiplier = float(${f});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${u};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${d};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class f7{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,o=e.filterWidth,r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterDepth,f=e.effectiveFilterHeight,g=e.effectiveFilterWidth,y=p-1-e.padInfo.front,b=f-1-e.padInfo.top,v=g-1-e.padInfo.left,w=1/(t*s*o);this.userCode=`
      const ivec3 pads = ivec3(${y}, ${b}, ${v});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${u}) {
          float dyD = float(dyDCorner + wD) / ${r}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${f};
              wR += ${d}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${g};
                wC += ${h}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,input:r}=e,i=r,{filterSize:a,strides:u,pad:d,dimRoundingMode:h}=s,p=[1,1,1],f=Xo(i.shape,a,u,p,d,h),g=new f7(f);return t.runWebGLProgram(g,[o],i.dtype)}const g7={kernelName:rx,backendName:"webgl",kernelFunc:m7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y7(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,input:r}=e,i=r;Ec([o,r],"avgPoolGrad");const{filterSize:a,strides:u,pad:d}=s,h=Ds(i.shape,a,u,1,d),p=new p7(h);return t.runWebGLProgram(p,[o],i.dtype)}const x7={kernelName:ox,backendName:"webgl",kernelFunc:y7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b7(n){const{inputs:e,backend:t,attrs:s}=n,{a:o,b:r}=e,{transposeA:i,transposeB:a}=s;return Vh({a:o,b:r,transposeA:i,transposeB:a,backend:t})}const v7={kernelName:Jh,backendName:"webgl",kernelFunc:b7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w7{constructor(e,t,s,o,r,i){this.outputShape=[],this.variableNames=["x","mean","variance"],je(e,t),je(e,s);let a="0.0";o!=null&&(je(e,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="1.0";r!=null&&(je(e,r),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${u};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k7{constructor(e,t,s,o,r,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],je(e,t),je(e,s);let a="vec4(0.0)";o!=null&&(je(e,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="vec4(1.0)";r!=null&&(je(e,r),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${u};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C7=({inputs:n,backend:e,attrs:t})=>{const{x:s,mean:o,variance:r,offset:i,scale:a}=n;_(o.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),_(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),_(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=t;u==null&&(u=.001);const d=[s,o,r];let h=null;i!=null&&(h=i.shape,d.push(i));let p=null;a!=null&&(p=a.shape,d.push(a));const f=ae().getBool("WEBGL_PACK_NORMALIZATION")?new k7(s.shape,o.shape,r.shape,h,p,u):new w7(s.shape,o.shape,r.shape,h,p,u);return e.runWebGLProgram(f,d,d[0].dtype)},I7={kernelName:cp,backendName:"webgl",kernelFunc:C7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S7{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=yt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=$7(this.rank);let o;const r=e.map((i,a)=>`sourceLoc.${Dy[a]} = start[${a}] + coords.${Dy[a]};`);o=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${r.join(`
`)}
      `,this.userCode=`
      void main() {
        ${o}
        setOutput(getSource(${s}));
      }
    `}}const Dy=["x","y","z","w","u","v"];function $7(n){if(n===1)return"sourceLoc";if(n<=6)return Dy.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N7{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=yt(this.rank),s=An("coords",this.rank),o=An("sourceLoc",this.rank),r=this.rank===1?"sourceLoc":`vec2(${o.slice(-2).join()})`,i=`getChannel(getSource(${o.join()}), ${r})`,a=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${o[this.rank-1]};
        result.y = ${i};
        --${o[this.rank-1]};
      }
    `,u=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${o[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${o[this.rank-1]};
          result.w = ${i};
        }
      }
    `,d=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((h,p)=>`start[${p}]`).join()});`:e.map((h,p)=>`${o[p]} = ${s[p]} + start[${p}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${d}
        vec4 result = vec4(0.);
        ${a}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7(n,e,t,s){const o=s.texData.get(n.dataId),r=s.makeTensorInfo(t,n.dtype),i=s.texData.get(r.dataId);Object.assign(i,o),i.refCount=1,i.shape=t,i.dtype=n.dtype;let a=I0(e,Oe(n.shape));o.slice&&(a+=o.slice.flatOffset),i.slice={flatOffset:a,origDataId:o.slice&&o.slice.origDataId||n.dataId};const u=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,u+1),r}function nl(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{begin:r,size:i}=s,[a,u]=nf(o,r,i);if(w0(o,a,u),de(u)===0)return t.makeTensorInfo(u,o.dtype,[]);if(t.shouldExecuteOnCPU([o])||o.dtype==="string"){const p=t.texData.get(o.dataId),f=vX(p.values,a,u,o.shape,o.dtype);return t.makeTensorInfo(u,o.dtype,f)}const{isPacked:d}=t.texData.get(o.dataId),h=C0(o.shape,a,u);if(d||!h){const p=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new N7(u):new S7(u),f=[a];return t.runWebGLProgram(p,[o],o.dtype,f)}return t.uploadToGPU(o.dataId),T7(o,a,u,t)}const E7={kernelName:zp,backendName:"webgl",kernelFunc:nl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R7=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{blockShape:r,crops:i}=s;_(o.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=r.reduce((C,$)=>C*$),u=gc(o.shape,r,a),d=yc(u.length,r.length),h=xc(o.shape,r,a),p=E0(i,r.length),f=R0(h,i,r.length),g=[],y=Ie({inputs:{x:o},backend:t,attrs:{shape:u}}),b=Fn({inputs:{x:y},backend:t,attrs:{perm:d}}),v=Ie({inputs:{x:b},backend:t,attrs:{shape:h}}),w=nl({inputs:{x:v},backend:t,attrs:{begin:p,size:f}});return g.push(y),g.push(b),g.push(v),g.forEach(C=>t.disposeIntermediateTensorInfo(C)),w},A7={kernelName:Zh,backendName:"webgl",kernelFunc:R7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D7(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,weights:r}=e,{size:i}=s,a=t.readSync(o.dataId),u=t.readSync(r.dataId),d=dE(a,u,r.dtype,r.shape,i);return t.makeTensorInfo([i],r.dtype,d)}const F7={kernelName:ix,backendName:"webgl",kernelFunc:D7};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _7=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,O7=`
  return float(int(a.r) & int(b.r));
`;function L7(n){const{inputs:e,backend:t}=n,{a:s,b:o}=e,r=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=ae().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([s,o])||i===1){const u=t.texData.get(s.dataId).values,d=t.texData.get(o.dataId).values,[h,p]=GK(s.shape,o.shape,u,d,s.dtype),f=t.makeTensorInfo(p,s.dtype),g=t.texData.get(f.dataId);return g.values=h,f}let a;return r?a=new el(_7,s.shape,o.shape,!1):a=new Ai(O7,s.shape,o.shape),t.runWebGLProgram(a,[s,o],s.dtype)}const M7={kernelName:ax,backendName:"webgl",kernelFunc:L7};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(n){const{inputs:e,backend:t}=n,{s0:s,s1:o}=e,r=t.readSync(s.dataId),i=t.readSync(o.dataId),a=je(Array.from(r),Array.from(i));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const z7={kernelName:xI,backendName:"webgl",kernelFunc:P7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B7="return float(a != b);",SE=fn({opSnippet:B7,cpuKernelImpl:dX,dtype:"bool"}),W7={kernelName:Np,backendName:"webgl",kernelFunc:SE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ac(n){const{inputs:e,backend:t}=n,{input:s}=e,o=t.texData.get(s.dataId);return ss({inputs:{x:o.complexTensorInfos.real},backend:t})}const V7={kernelName:Dx,backendName:"webgl",kernelFunc:Ac};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U7="return float(int(x));";function G7(n,e){const t=new mo(n.shape,U7),s=e.runWebGLProgram(t,[n],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fy(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{dtype:r}=s;if(r==="complex64"){if(o.dtype==="complex64")return ss({inputs:{x:o},backend:t});const i=sn(o.shape),a=Fy({inputs:{x:o},backend:t,attrs:{dtype:"float32"}}),u=Vr({inputs:{real:a,imag:i},backend:t});return i.dispose(),t.disposeIntermediateTensorInfo(a),u}if(o.dtype==="complex64"){const i=Ac({inputs:{input:o},backend:t}),a=Fy({inputs:{x:i},backend:t,attrs:{dtype:r}});return t.disposeIntermediateTensorInfo(i),a}if(!pI(o.dtype,r)){const i=ss({inputs:{x:o},backend:t});return{dataId:i.dataId,shape:i.shape,dtype:r}}if(t.shouldExecuteOnCPU([o])){const i=t.texData.get(o.dataId).values,[a,u,d]=jK(i,o.shape,o.dtype,r);return t.makeTensorInfo(a,u,d)}if(r==="int32")return G7(o,t);if(r==="bool"){const i=t.makeTensorInfo([],"bool",xn("bool",1)),u=SE({inputs:{a:o,b:i},backend:t});return t.disposeIntermediateTensorInfo(i),u}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${r}`)}const j7={kernelName:Cu,backendName:"webgl",kernelFunc:Fy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mC="return ceil(x);",H7=ot({opSnippet:mC,packedOpSnippet:mC,cpuKernelImpl:HK}),q7={kernelName:Iu,backendName:"webgl",kernelFunc:H7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K7{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X7{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{clipValueMin:r,clipValueMax:i}=s;let a;ae().getBool("WEBGL_PACK_CLIP")?a=new X7(o.shape):a=new K7(o.shape);const u=[[r],[i]];return t.runWebGLProgram(a,[o],o.dtype,u)}const Q7={kernelName:Su,backendName:"webgl",kernelFunc:Y7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J7{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gC(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function Z7(n){const{inputs:e,backend:t}=n,{x:s}=e,o=t.texData.get(s.dataId),r=new J7(s.shape),i=[gC(s,o.complexTensorInfos.real),gC(s,o.complexTensorInfos.imag)];return t.runWebGLProgram(r,i,i[0].dtype)}const e9={kernelName:ep,backendName:"webgl",kernelFunc:Z7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t9{constructor(e){this.outputShape=[],this.outputShape=xo(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];const s=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<t.length;i++){const a=t[i-1];s.push(`else if (yC < ${t[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const o=t.length,r=t[t.length-1];s.push(`else setOutput(getT${o}(yR, yC-${r}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n9{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=xo(e,t);const s=this.outputShape,o=s.length,r=yt(o),i=An("coords",o),a=["x","y","z","w","u","v"].slice(0,o);this.variableNames=e.map((b,v)=>`T${v}`);const u=new Array(e.length-1);u[0]=e[0][t];for(let b=1;b<u.length;b++)u[b]=u[b-1]+e[b][t];const d=a[t],h=a.slice(-2),p=a.join();let f=`if (${d} < ${u[0]}) {
        return getChannel(
            getT0(${p}), vec2(${h.join()}));
        }`;for(let b=1;b<u.length;b++){const v=u[b-1];f+=`
        if (${d} < ${u[b]}  && ${d} >= ${u[b-1]}) {
          return getChannel(
            getT${b}(${nh(a,d,v)}),
            vec2(${nh(h,d,v)}));
        }`}const g=u.length,y=u[u.length-1];f+=`
        return getChannel(
          getT${g}(${nh(a,d,y)}),
          vec2(${nh(h,d,y)}));`,this.userCode=`
      float getValue(${a.map(b=>"int "+b)}) {
        ${f}
      }

      void main() {
        ${r} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[o-1]} = ${i[o-1]} + 1;
        if (${i[o-1]} < ${s[o-1]}) {
          result.g = getValue(${i});
        }

        ${i[o-2]} = ${i[o-2]} + 1;
        if (${i[o-2]} < ${s[o-2]}) {
          result.a = getValue(${i});
        }

        ${i[o-1]} = ${i[o-1]} - 1;
        if (${i[o-2]} < ${s[o-2]} &&
            ${i[o-1]} < ${s[o-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function nh(n,e,t){const s=n.indexOf(e);return n.map((r,i)=>i===s?`${r} - ${t}`:r).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cf(n){const{inputs:e,backend:t}=n,{input:s}=e,o=t.texData.get(s.dataId);return ss({inputs:{x:o.complexTensorInfos.imag},backend:t})}const s9={kernelName:Ix,backendName:"webgl",kernelFunc:Cf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ql(n,e,t){const s=n[0].dtype;if(s==="complex64"){const g=n.map(C=>Ac({inputs:{input:C},backend:t})),y=n.map(C=>Cf({inputs:{input:C},backend:t})),b=Ql(g,e,t),v=Ql(y,e,t),w=Vr({inputs:{real:b,imag:v},backend:t});return g.forEach(C=>t.disposeIntermediateTensorInfo(C)),y.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(v),w}let o=t.shouldExecuteOnCPU(n);if(s==="string"&&(o=!0),o){const g=n.map(S=>{const R=[-1,de(S.shape.slice(e))];return Ie({inputs:{x:S},backend:t,attrs:{shape:R}})}),y=g.map(S=>({vals:t.readSync(S.dataId),shape:S.shape})),b=xo(g.map(S=>S.shape),1),v=g[0].shape[0]===1,w=qK(y,b,s,v),C=xo(n.map(S=>S.shape),e),$=t.makeTensorInfo(C,s,w);return g.forEach(S=>t.disposeIntermediateTensorInfo(S)),$}const r=n.filter(g=>de(g.shape)>0),i=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1;if(r.length===1){const g=i?new mo(n[0].shape,xr):new kr(n[0].shape,xr);return t.runWebGLProgram(g,n,s)}const a=ae().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(r.length>a){const g=[];for(let b=0;b<r.length;b+=a){const v=r.slice(b,b+a);g.push(Ql(v,e,t))}const y=Ql(g,e,t);for(const b of g)t.disposeIntermediateTensorInfo(b);return y}if(i){const g=new n9(r.map(y=>y.shape),e);return t.runWebGLProgram(g,r,s)}const{tensors2D:u,outShape:d}=o9(r,e,t),h=new t9(u.map(g=>g.shape)),p=t.runWebGLProgram(h,u,s);u.forEach(g=>t.disposeIntermediateTensorInfo(g));const f=Ie({inputs:{x:p},attrs:{shape:d},backend:t});return t.disposeIntermediateTensorInfo(p),f}function o9(n,e,t){const s=xo(n.map(r=>r.shape),e);return{tensors2D:n.map(r=>Ie({inputs:{x:r},attrs:{shape:[-1,de(r.shape.slice(e))]},backend:t})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $E(n){const{inputs:e,backend:t,attrs:s}=n,{axis:o}=s,r=Ke(o,e[0].shape)[0],i=e.map(d=>d.shape);$0(i,r);const a=xo(e.map(d=>d.shape),r);if(de(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const u=e.filter(d=>de(d.shape)>0);return u.length===1?ss({inputs:{x:u[0]},backend:t}):Ql(u,r,t)}const r9={kernelName:tp,backendName:"webgl",kernelFunc:$E};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NE{constructor(e,t=!1,s=null,o=!1,r=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,u=e.strideHeight,d=e.strideWidth,h=e.dilationHeight,p=e.dilationWidth,f=e.filterHeight,g=e.filterWidth,y=Math.floor(e.inChannels/4)*4,b=e.inChannels%4,v=e.dataFormat==="channelsLast",w=v?1:2,C=v?2:3,$=v?3:1;let S="",N="";s&&(o?S=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?S=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:S=`
          float activation(float x) {
            ${s}
          }
        `,N="result = activation(result);");const R=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${S}

      const ivec2 strides = ivec2(${u}, ${d});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${$}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${C}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${f}; wR++) {
          int xR = xRCorner + wR * ${h};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${g}; wC++) {
            int xC = xCCorner + wC * ${p};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${y}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${b===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${y}) *
                    getW(wR, wC, ${y}, d2);
              } else {
                dotProd +=
                    getX(batch, ${y}, xR, xC) *
                    getW(wR, wC, ${y}, d2);
              }

            } else if (${b===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${b===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2),
                getW(wR, wC, ${y} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1),
                  getX(batch, xR, xC, ${y} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC),
                  getX(batch, ${y} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${R}
        ${N}
        setOutput(result);
      }
    `}}class i9{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,s=e.padInfo.top,o=e.padInfo.left,r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,p=e.filterDepth,f=e.filterHeight,g=e.filterWidth,y=Math.floor(e.inChannels/4)*4,b=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${r}, ${i}, ${a});
      const ivec3 pads = ivec3(${t}, ${s}, ${o});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${p}; wF++) {
          int xF = xFCorner + wF * ${u};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f}; wR++) {
            int xR = xRCorner + wR * ${d};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${g}; wC++) {
              int xC = xCCorner + wC * ${h};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${y}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${b===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${y}) *
                  getW(wF, wR, wC, ${y}, d2);
              } else if (${b===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${b===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1),
                  getX(batch, xF, xR, xC, ${y} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2),
                  getW(wF, wR, wC, ${y} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TE{constructor(e,t=!1,s=null,o=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Cn(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,u=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=h;let f=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<h;v++)f+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;f+=`
     for (int r = 0; r < ${d}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let v=0;v<h;v++)f+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;f+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(p+1)/2;v++){const w=v*2;if(f+=`
           xC = xCCorner + ${w*u};
           `,a===1){if(w<h&&(i%2===1?(f+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }
               `,u===1&&w>0?f+=`
                 xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                 `:f+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                   } else {
                     xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                   }
                   `):f+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xC${w} = xTexelC${w};
                 `,w+1<h)){const C=i%2===0?Yy(u):u;u%2===0&&i%2===1||u%2!==0&&i%2!==1?(f+=`
                   xCOffset = xC + imod(pads[1], 2) + ${C};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                     xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${w+1}.zw = vec2(0.0);
                     }
                     xTexelC${w+1}Ready = 1;
                   }
                   `,u>1?f+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                     } else {
                      xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                     }
                     `:f+=`
                     xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                     `):C===1?f+=`
                     xC${w+1} = xTexelC${w};
                     `:f+=`
                     xCOffset = xC + ${C};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                       xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${w+1}.zw = vec2(0.0);
                       }
                       xTexelC${w+1}Ready = 1;
                     }

                     xC${w+1} = xTexelC${w+1};
                     `}}else w<h&&(i%2===1?(f+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.0);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
               `,w+1<h&&(f+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                 `)):(f+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(
                   xTexelC${w}.xy, xTexelC${w+1}.xy);
               `,w+1<h&&(f+=`
                   xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                 `)));w<h&&(f+=`
             wTexel = getW(r, ${w}, d1, d2);
             dotProd += xC${w}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${w}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,w+1<h&&(f+=`
               wTexel = getW(r, ${w+1}, d1, d2);
               dotProd += xC${w+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${w+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}f+=`
     }
   `,f+=`
     }
   `,f+=`
     }
   `;let g="",y="";s&&(o?g=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:r?g=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:g=`vec4 activation(vec4 x) {
           ${s}
         }`,y="result = activation(result);");const b=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${g}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${f}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${b}
         ${y}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a9{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Cn(this.outputShape.length);const{dataFormat:s}=t,o=_n(),r=s==="channelsLast",i=r?1:2,a=r?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let d="";for(let h=0;h<=1;h++)for(let p=0;p<=1;p++)d+=`
          blockIndex = rc.z + ${p};
          pos = rc.y + ${h};

          ${u}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${r}) {
                  innerDims = vec2(d1, ch);
                  result[${h*2+p}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${h*2+p}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${d}

        ${o.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uh(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function EE({x:n,filter:e,convInfo:t,backend:s,bias:o=null,preluActivationWeights:r=null,leakyreluAlpha:i=0,activation:a=null}){const u=n.shape,d=s.texData.get(n.dataId),h=t.inChannels,p=u[0]*u[1]*u[2],f=t.outChannels,g=t.dataFormat==="channelsLast",y=!1,b=!1;let v;const w=[];if(r!=null){const S=Uh(r.shape,g);S!=null&&(r=Ie({inputs:{x:r},backend:s,attrs:{shape:S}}),w.push(r))}if(o!=null){const S=Uh(o.shape,g);S!=null&&(o=Ie({inputs:{x:o},backend:s,attrs:{shape:S}}),w.push(o))}if(!((p===1||f===1)&&h>wE)&&d.isPacked&&g&&d.texture!=null&&u[2]%2!==0&&ht(d.shape.slice(-3),u.slice(-3))){const S=u[0]*u[1]*(u[2]+1),N={dataId:n.dataId,shape:[1,S,t.inChannels],dtype:n.dtype},R=d.shape;d.shape=d.shape.slice(),d.shape[d.shape.length-2]++,_(Wh(d.shape,N.shape),()=>`packed reshape ${d.shape} to ${N.shape} isn't free`);const F=Ie({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}});w.push(F);const O=Vh({a:N,b:F,backend:s,transposeA:y,transposeB:b,bias:o,activation:a,preluActivationWeights:r,leakyreluAlpha:i}),D=s.texData.get(O.dataId);_(D.isPacked,()=>"batchMatMul result is expected to be packed"),d.shape=R,D.shape=t.outShape,v=ss({inputs:{x:O},backend:s}),v.shape=t.outShape,w.push(O)}else{const S=t.outHeight*t.outWidth,N=Ie({inputs:{x:n},backend:s,attrs:{shape:g?[t.batchSize,S,t.inChannels]:[t.batchSize,t.inChannels,S]}}),R=Ie({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}}),F=Vh({a:g?N:R,b:g?R:N,transposeA:!g,transposeB:b,backend:s,bias:o,activation:a,preluActivationWeights:r,leakyreluAlpha:i});v=Ie({inputs:{x:F},backend:s,attrs:{shape:t.outShape}}),w.push(N),w.push(R),w.push(F)}for(const S of w)s.disposeIntermediateTensorInfo(S);return v}function RE({x:n,filter:e,convInfo:t,backend:s,bias:o=null,preluActivationWeights:r=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:u,filterHeight:d,inChannels:h,outWidth:p,outHeight:f,dataFormat:g}=t,y=g==="channelsLast",b=u*d*h,v=f*p,w=[t.batchSize,b,v],C=!0,$=!1,S=[];if(r!=null){const P=Uh(r.shape,y);P!=null&&(r=Ie({inputs:{x:r},backend:s,attrs:{shape:P}}),S.push(r))}if(o!=null){const P=Uh(o.shape,y);P!=null&&(o=Ie({inputs:{x:o},backend:s,attrs:{shape:P}}),S.push(o))}const N=Ie({inputs:{x:e},backend:s,attrs:{shape:[1,b,de(e.shape)/b]}});S.push(N);const R=new a9(w,t),F=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],O=s.runWebGLProgram(R,[n],"float32",F),D=Ie({inputs:{x:O},backend:s,attrs:{shape:w}});S.push(O),S.push(D);const A=o!=null,T=r!=null,B=a==="leakyrelu",U=a?cu(a,!0):null,Q=new vE(y?D.shape:N.shape,y?N.shape:D.shape,y?[t.batchSize,v,t.outChannels]:[t.batchSize,t.outChannels,v],C,$,A,U,T,B),K=y?[D,N]:[N,D];if(o&&K.push(o),T&&K.push(r),B){const P=s.makeTensorInfo([],"float32",_r(i,"float32"));K.push(P),S.push(P)}const J=s.runWebGLProgram(Q,K,"float32"),te=Ie({inputs:{x:J},backend:s,attrs:{shape:t.outShape}});S.push(J);for(const P of S)s.disposeIntermediateTensorInfo(P);return te}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r}=e,{strides:i,pad:a,dataFormat:u,dilations:d,dimRoundingMode:h}=s,p=Yo(u),f=hn(o.shape,r.shape,i,d,a,h,!1,p);let g;if(f.filterHeight===1&&f.filterWidth===1&&f.dilationHeight===1&&f.dilationWidth===1&&f.strideHeight===1&&f.strideWidth===1&&(f.padInfo.type==="SAME"||f.padInfo.type==="VALID"))g=EE({x:o,filter:r,convInfo:f,backend:t});else if(f.strideWidth<=2&&p==="channelsLast"&&ae().getBool("WEBGL_EXP_CONV")){const b=new TE(f),v=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];g=t.runWebGLProgram(b,[o,r],"float32",v)}else if(ae().getBool("WEBGL_CONV_IM2COL"))g=RE({x:o,filter:r,convInfo:f,backend:t});else{const b=new NE(f);g=t.runWebGLProgram(b,[o,r],"float32")}const y=Ie({inputs:{x:g},backend:t,attrs:{shape:f.outShape}});return t.disposeIntermediateTensorInfo(g),y}const u9={kernelName:np,backendName:"webgl",kernelFunc:l9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c9{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,o=e.padInfo.top,r=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${o};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${r};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class d9{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,o=e.strideHeight,r=e.strideWidth,i=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,u=s-1-e.padInfo.left,d=i?1:2,h=i?2:3,p=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${p}];

        ivec2 dyCorner = ivec2(coords[${d}], coords[${h}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class h9{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,s=e.strideHeight,o=e.strideWidth,r=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${r};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${o} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class p9{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,o=e.filterWidth,r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,u=t-1-e.padInfo.front,d=s-1-e.padInfo.top,h=o-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${d}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${r}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${o}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${o} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,dy:r}=e,{strides:i,pad:a,dataFormat:u,dimRoundingMode:d,filterShape:h}=s,p=Yo(u),f=hn(o.shape,h,i,1,a,d,!1,p),g=new c9(f);return t.runWebGLProgram(g,[o,r],"float32")}const m9={kernelName:ux,backendName:"webgl",kernelFunc:f9};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g9{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Cn(this.outputShape.length);const t=e.filterHeight,s=e.filterWidth,o=t-1-e.padInfo.top,r=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${r});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y9(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,filter:r}=e,{inputShape:i,strides:a,pad:u,dataFormat:d,dimRoundingMode:h}=s,p=Yo(d),f=hn(i,r.shape,a,1,u,h,!1,p);if(ae().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&p==="channelsLast"){const g=[[f.strideHeight,f.strideWidth]],y=new g9(f);return t.runWebGLProgram(y,[o,r],"float32",g)}else{const g=new d9(f);return t.runWebGLProgram(g,[o,r],"float32")}}const x9={kernelName:sp,backendName:"webgl",kernelFunc:y9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b9(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r}=e,{strides:i,pad:a,dilations:u}=s,d=Or(o.shape,r.shape,i,u,a),h=new i9(d);return t.runWebGLProgram(h,[o,r],"float32")}const v9={kernelName:op,backendName:"webgl",kernelFunc:b9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,dy:r}=e,{strides:i,pad:a,filterShape:u}=s,d=Or(o.shape,u,i,1,a),h=new h9(d);return t.runWebGLProgram(h,[o,r],"float32")}const k9={kernelName:cx,backendName:"webgl",kernelFunc:w9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,filter:r}=e,{pad:i,strides:a,inputShape:u}=s,d=Or(u,r.shape,a,1,i),h=new p9(d);return t.runWebGLProgram(h,[o,r],"float32")}const I9={kernelName:dx,backendName:"webgl",kernelFunc:C9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S9=tl+`
  return cos(x);
`,$9=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Bi}
  return result;
`,N9=ot({opSnippet:S9,packedOpSnippet:$9}),T9={kernelName:$u,backendName:"webgl",kernelFunc:N9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E9=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,R9=ot({opSnippet:E9}),A9={kernelName:Nu,backendName:"webgl",kernelFunc:R9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D9{constructor(e,t,s,o,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,u,d]=e,[h]=t,[p,f]=s;this.outputShape=[h,p,f,d];const g=o==="bilinear"?1:0,[y,b]=[`${a-1}.0`,`${u-1}.0`],[v,w,C]=p>1?[`${(a-1)/(p-1)}`,"(y2-y1) * height_ratio",`y1*${y} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${y}`],[$,S,N]=f>1?[`${(u-1)/(f-1)}`,"(x2-x1) * width_ratio",`x1*${b} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${b}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${$});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${S};

        float in_y = ${C};
        if( in_y < 0.0 || in_y > ${y} ) {
          setOutput(float(${r}));
          return;
        }
        float in_x = ${N};
        if( in_x < 0.0 || in_x > ${b} ) {
          setOutput(float(${r}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${g} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F9=n=>{const{inputs:e,backend:t,attrs:s}=n,{image:o,boxes:r,boxInd:i}=e,{cropSize:a,method:u,extrapolationValue:d}=s,h=new D9(o.shape,r.shape,a,u,d);return t.runWebGLProgram(h,[o,r,i],"float32")},_9={kernelName:px,backendName:"webgl",kernelFunc:F9};var hu;(function(n){n.Prod="*",n.Sum="+"})(hu||(hu={}));class yC{constructor(e,t,s,o){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const r=this.outputShape.length,i=this.op===hu.Prod?"1.0":"0.0",a=s?i:`getX(${xC(r,"coords",this.op)})`,u=this.outputShape[this.outputShape.length-1];let d="",h="";s?(d=o?`end != ${u-1}`:"end != 0",h=o?"end + 1":"end - 1"):(d=o?`end + pow2 < ${u}`:"end >= pow2",h=o?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${yt(r)} coords = getOutputCoords();
        int end = ${bC(r,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${d}) {
          int idx = ${h};
          ${bC(r,"coords",this.op)} = idx;
          val ${this.op}= getX(${xC(r,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function xC(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function bC(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AE(n,e,t,s,o,r){const i=e.shape.length,a=Dt([s],i);let u=e;a!=null&&(u=Fn({inputs:{x:e},backend:t,attrs:{perm:a}}));const d=zt(1,i)[0];if(d!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const h=u.shape[d];let p=ss({inputs:{x:u},backend:t});for(let f=0;f<=Math.ceil(Math.log2(h))-1;f++){const g=new yC(n,u.shape,!1,r),y=[[f]],b=p;p=t.runWebGLProgram(g,[p],p.dtype,y),t.disposeIntermediateTensorInfo(b)}if(o){const f=new yC(n,u.shape,o,r),g=p;p=t.runWebGLProgram(f,[p],p.dtype),t.disposeIntermediateTensorInfo(g)}if(a!=null){const f=Lr(a),g=Fn({inputs:{x:p},backend:t,attrs:{perm:f}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(u),g}return p}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,exclusive:i,reverse:a}=s;return AE(hu.Prod,o,t,r,i,a)}const L9={kernelName:hx,backendName:"webgl",kernelFunc:O9};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,exclusive:i,reverse:a}=s;return AE(hu.Sum,o,t,r,i,a)}const P9={kernelName:rp,backendName:"webgl",kernelFunc:M9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,weights:r}=e,{size:i,binaryOutput:a}=s;if(o.shape.length===1){const u=t.readSync(o.dataId),d=t.readSync(r.dataId),h=dE(u,d,r.dtype,r.shape,i);return t.makeTensorInfo([i],r.dtype,h)}else if(o.shape.length===2){const u=t.bufferSync(o),d=t.bufferSync(r),h=UK(u,d,i,a);return t.makeTensorInfo(h.shape,r.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}const B9={kernelName:fx,backendName:"webgl",kernelFunc:z9};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W9{constructor(e,t,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V9(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{blockSize:r,dataFormat:i}=s,a=o.shape[0],u=i==="NHWC"?o.shape[1]:o.shape[2],d=i==="NHWC"?o.shape[2]:o.shape[3],h=i==="NHWC"?o.shape[3]:o.shape[1],p=u*r,f=d*r,g=h/(r*r),y=i==="NHWC"?[a,p,f,g]:[a,g,p,f],b=new W9(y,r,i);return t.runWebGLProgram(b,[o],o.dtype)}const U9={kernelName:mx,backendName:"webgl",kernelFunc:V9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DE{constructor(e,t=!1,s=null,o=!1,r=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Cn(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,u=e.outChannels/e.inChannels;let d="",h="";s&&(o?d=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?d=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:d=`
          float activation(float x) {
            ${s}
          }
        `,h="result = activation(result);");const p=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${d}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${u};
        int q = d2 - d1 * ${u};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${p}
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FE{constructor(e,t=!1,s=null,o=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Cn(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,u=e.strideWidth,d=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,f=p;let g=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let w=0;w<p;w++)g+=`
          vec4 xTexelC${w*2};
          int xTexelC${w*2}Ready;
          vec4 xTexelC${w*2+1};
          int xTexelC${w*2+1}Ready;
          vec4 xC${w};`;g+=`
    for (int r = 0; r < ${h}; r++) {
      `;for(let w=0;w<p;w++)g+=`
          xTexelC${w*2} = vec4(0.0);
          xTexelC${w*2}Ready = 0;
          xTexelC${w*2+1} = vec4(0.0);
          xTexelC${w*2+1}Ready = 0;
          xC${w} = vec4(0.0);`;g+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let w=0;w<(f+1)/2;w++){const C=w*2;if(g+=`
          xC = xCCorner + ${C*d};
          `,u===1){if(C<p&&(a%2===1?(g+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }
              `,d===1&&C>0?g+=`
                xC${C} = vec4(xTexelC${C-2}.zw, xTexelC${C}.xy);
                `:g+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${C} = vec4(previous.zw, xTexelC${C}.xy);
                  } else {
                    xC${C} = vec4(0.0, 0.0, xTexelC${C}.xy);
                  }
                  `):g+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                xC${C} = xTexelC${C};
                `,C+1<p)){const $=a%2===0?Yy(d):d;d%2===0&&a%2===1||d%2!==0&&a%2!==1?(g+=`
                  xCOffset = xC + imod(pads[1], 2) + ${$};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                    xTexelC${C+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${C+1}.zw = vec2(0.0);
                    }
                    xTexelC${C+1}Ready = 1;
                  }
                  `,d>1?g+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${C+1} = vec4(previous.zw, xTexelC${C+1}.xy);
                    } else {
                     xC${C+1} = vec4(0.0, 0.0, xTexelC${C+1}.xy);
                    }
                    `:g+=`
                    xC${C+1} = vec4(xTexelC${C}.zw, xTexelC${C+1}.xy);
                    `):$===1?g+=`
                    xC${C+1} = xTexelC${C};
                    `:g+=`
                    xCOffset = xC + ${$};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                      xTexelC${C+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${C+1}.zw = vec2(0.0);
                      }
                      xTexelC${C+1}Ready = 1;
                    }

                    xC${C+1} = xTexelC${C+1};
                    `}}else C<p&&(a%2===1?(g+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${C+1}Ready == 0) {
                  xTexelC${C+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${C+1}.zw = vec2(0.0);
                  }
                  xTexelC${C+1}Ready = 1;
                }

                xC${C} = vec4(xTexelC${C}.zw, xTexelC${C+1}.zw);
              `,C+1<p&&(g+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${C+1} = vec4(xTexelC${C+1}.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                  xTexelC${C+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C+1}.zw = vec2(0.);
                  }
                  xTexelC${C+1}Ready = 1;
                }

                xC${C} = vec4(
                  xTexelC${C}.xy, xTexelC${C+1}.xy);
              `,C+1<p&&(g+=`
                  xC${C+1} = vec4(xTexelC${C}.zw, xTexelC${C+1}.zw);
                `)));C<p&&(g+=`
            wTexel = getW(r, ${C}, d1, q);
            dotProd += xC${C} * vec4(wTexel.xz, wTexel.xz);
          `,C+1<p&&(g+=`
              wTexel = getW(r, ${C+1}, d1, q);
              dotProd += xC${C+1} * vec4(wTexel.xz, wTexel.xz);
            `))}g+=`
    }
  `,g+=`
      }
    `;let y="",b="";s&&(o?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:y=`vec4 activation(vec4 x) {
          ${s}
        }`,b="result = activation(result);");const v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${y}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${g}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${b}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r}=e,{strides:i,pad:a,dilations:u,dimRoundingMode:d}=s;let h=u;h==null&&(h=[1,1]),_(wn(i,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const p=hn(o.shape,r.shape,i,h,a,d,!0);let f;ae().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?f=new FE(p):f=new DE(p);const g=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return t.runWebGLProgram(f,[o,r],"float32",g)}const j9={kernelName:ip,backendName:"webgl",kernelFunc:G9};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H9{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,o=e.padInfo.top,r=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${o};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${r};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class q9{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,o=e.strideHeight,r=e.strideWidth,i=t-1-e.padInfo.top,a=s-1-e.padInfo.left,u=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${u}; dm++) {
              int d2 = d1 * ${u} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,dy:r}=e,{strides:i,dilations:a,pad:u,dimRoundingMode:d,filterShape:h}=s,p=hn(o.shape,h,i,a,u,d,!0),f=new H9(p);return t.runWebGLProgram(f,[o,r],"float32")}const X9={kernelName:gx,backendName:"webgl",kernelFunc:K9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,filter:r}=e,{strides:i,dilations:a,pad:u,dimRoundingMode:d,inputShape:h}=s,p=hn(h,r.shape,i,a,u,d,!0),f=new q9(p);return t.runWebGLProgram(f,[o,r],"float32")}const Q9={kernelName:yx,backendName:"webgl",kernelFunc:Y9};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J9{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9(n){const{inputs:e,backend:t}=n,{x:s}=e,o=[...s.shape,...s.shape],r=de(s.shape),i=Ie({inputs:{x:s},backend:t,attrs:{shape:[r]}}),a=new J9(r),u=t.runWebGLProgram(a,[i],i.dtype),d=Ie({inputs:{x:u},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(u),d}const eY={kernelName:bI,backendName:"webgl",kernelFunc:Z9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tY{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:s,padInfo:o,strideHeight:r,strideWidth:i,filterHeight:a,filterWidth:u,dilationHeight:d,dilationWidth:h}=e,{top:p,left:f}=o;this.userCode=`
      const ivec2 strides = ivec2(${r}, ${i});
      const ivec2 pads = ivec2(${p}, ${f});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${d};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${u}; w++) {
              int wIn = wBeg + w * ${h};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nY(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r}=e,{strides:i,pad:a,dilations:u}=s,d=dc(o.shape,r.shape,i,a,"NHWC",u);let h;const p=new tY(d);h=t.runWebGLProgram(p,[o,r],"float32");const f=Ie({inputs:{x:h},backend:t,attrs:{shape:d.outShape}});return t.disposeIntermediateTensorInfo(h),f}const sY={kernelName:ap,backendName:"webgl",kernelFunc:nY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oY(n){const{inputs:e,backend:t,attrs:s}=n,{equation:o}=s,r=e,{allDims:i,summedDims:a,idDims:u}=P0(o,r.length);B0(i.length,u,r);const{path:d,steps:h}=W0(a,u),p=h.length;let f=null,g=i.length;const y=[];for(let b=0;b<p;++b){for(const v of h[b]){const{permutationIndices:w,expandDims:C}=z0(g,u[v]);let $;V0(w)?$=r[v]:($=Fn({inputs:{x:r[v]},backend:t,attrs:{perm:w}}),y.push($));const S=$.shape.slice();for(let N=0;N<C.length;++N)S.splice(C[N],0,1);ht($.shape,S)||($=Ie({inputs:{x:$},backend:t,attrs:{shape:S}}),y.push($)),f===null?f=$:(f=R1({inputs:{a:$,b:f},backend:t}),y.push(f))}b<p-1&&(d[b]>=0&&(f=kf({inputs:{x:f},backend:t,attrs:{axis:d[b]-(i.length-g),keepDims:!1}}),y.push(f)),g--)}for(const b of y)b!==f&&t.disposeIntermediateTensorInfo(b);return f}const rY={kernelName:xx,backendName:"webgl",kernelFunc:oY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iY="return (x >= 0.0) ? x : (exp(x) - 1.0);",aY=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,lY=ot({opSnippet:iY,packedOpSnippet:aY}),uY={kernelName:Eu,backendName:"webgl",kernelFunc:lY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cY="return (b >= 0.0) ? a : a * (b + 1.0);",dY=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,hY=n=>{const{inputs:e,backend:t}=n,{dy:s,y:o}=e,r=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new el(dY,s.shape,o.shape):new Ai(cY,s.shape,o.shape);return t.runWebGLProgram(r,[s,o],s.dtype)},pY={kernelName:bx,backendName:"webgl",kernelFunc:hY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fY=`
  return vec4(equal(a, b));
`,mY="return float(a == b);",gY=fn({opSnippet:mY,packedOpSnippet:fY,dtype:"bool",cpuKernelImpl:KK}),yY={kernelName:lp,backendName:"webgl",kernelFunc:gY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xY=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${A0};
  float a1 = ${D0};
  float a2 = ${F0};
  float a3 = ${_0};
  float a4 = ${O0};
  float a5 = ${L0};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,bY=ot({opSnippet:xY}),vY={kernelName:Ru,backendName:"webgl",kernelFunc:bY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wY=tl+`
  return exp(x);
`,kY=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_E=ot({opSnippet:wY,packedOpSnippet:kY,cpuKernelImpl:XK,dtype:"float32"}),CY={kernelName:Au,backendName:"webgl",kernelFunc:_E};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _y(n){const{inputs:e,attrs:t,backend:s}=n,{dim:o}=t,{input:r}=e,i=r.shape.length,a=r.shape.slice();let u=o;return o<0&&(_(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+o+1),a.splice(u,0,1),Ie({inputs:{x:r},backend:s,attrs:{shape:a}})}const IY={kernelName:up,backendName:"webgl",kernelFunc:_y};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vC="return exp(x) - 1.0;",SY=ot({opSnippet:vC,packedOpSnippet:vC,cpuKernelImpl:YK}),$Y={kernelName:Du,backendName:"webgl",kernelFunc:SY};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wC{constructor(e,t,s){this.variableNames=["real","imag"];const o=t[1];this.outputShape=t;const r=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${o}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${r};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${o});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${o}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OE(n,e,t){const s=t.texData.get(n.dataId),o=de(n.shape),r=n.shape[n.shape.length-1],i=o/r,a=Ie({inputs:{x:n},backend:t,attrs:{shape:[i,r]}}),u=a.shape,d=new wC("real",u,e),h=new wC("imag",u,e),p=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:u},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:u}],f=t.runWebGLProgram(d,p,"float32"),g=t.runWebGLProgram(h,p,"float32"),y=Vr({inputs:{real:f,imag:g},backend:t});t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g);const b=Ie({inputs:{x:y},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(y),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NY(n){const{inputs:e,backend:t}=n,{input:s}=e;return OE(s,!1,t)}const TY={kernelName:vx,backendName:"webgl",kernelFunc:NY};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EY{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dc(n){const{backend:e,attrs:t}=n,{shape:s,value:o}=t;let{dtype:r}=t;if(r=r||Ba(o),r==="string"){const i=Lt(r,de(s));return i.fill(o),e.makeTensorInfo(s,r,i)}else{const i=new EY(s,o),a=[[o]];return e.runWebGLProgram(i,[],r,a)}}const RY={kernelName:wx,backendName:"webgl",kernelFunc:Dc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AY{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DY={kernelName:kx,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,s=e,o=new AY(t.shape);return s.runWebGLProgram(o,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kC="return floor(x);",FY=ot({opSnippet:kC,packedOpSnippet:kC,cpuKernelImpl:QK}),_Y={kernelName:Fu,backendName:"webgl",kernelFunc:FY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OY=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,LY=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,MY=fn({opSnippet:OY,packedOpSnippet:LY,dtype:"int32"}),PY={kernelName:_u,backendName:"webgl",kernelFunc:MY};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zY{constructor(e){this.variableNames=["A"];const t=_n(),[s,o]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${o}.0, ${s}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BY{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=_n(),[s,o]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${o}.0, ${s}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WY={kernelName:n_,backendName:"webgl",kernelFunc:VY};let ya,Hg=ae().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function VY(n){const{inputs:e,backend:t,attrs:s}=n;let{pixels:o}=e;const{numChannels:r}=s,i=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,[u,d]=i?[o.videoWidth,o.videoHeight]:[o.width,o.height],h=[d,u],p=[d,u,r];if(a||i){const b=ae().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(ya==null||b!==Hg)&&(Hg=b,ya=document.createElement("canvas").getContext("2d",{willReadFrequently:Hg})),ya.canvas.width=u,ya.canvas.height=d,ya.drawImage(o,0,0,u,d),o=ya.canvas}const f=t.makeTensorInfo(h,"int32");t.texData.get(f.dataId).usage=ds.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(f.dataId),o);const g=ae().getBool("WEBGL_PACK")?new BY(p):new zY(p),y=t.runWebGLProgram(g,[f],"int32");return t.disposeData(f.dataId),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UY(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r,bias:i,preluActivationWeights:a}=e,{strides:u,pad:d,dataFormat:h,dilations:p,dimRoundingMode:f,activation:g,leakyreluAlpha:y}=s,b=Yo(h),v=hn(o.shape,r.shape,u,p,d,f,!1,b);let w;const C=[],$=i!=null,S=a!=null,N=g==="leakyrelu",R=()=>{const O=[o,r],D=(A,T)=>{if(T==="NCHW"&&A.shape.length===1&&A.shape[0]!==1){const B=Ie({inputs:{x:A},backend:t,attrs:{shape:[A.shape[0],1,1]}});return C.push(B),B}return A};if($&&O.push(D(i,h)),S&&O.push(D(a,h)),N){const A=t.makeTensorInfo([],"float32",_r(y,"float32"));O.push(A),C.push(A)}return O};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))w=EE({x:o,filter:r,convInfo:v,backend:t,bias:i,activation:g,preluActivationWeights:a,leakyreluAlpha:y});else if(v.strideWidth<=2&&b==="channelsLast"&&ae().getBool("WEBGL_EXP_CONV")){const O=g?cu(g,!0):null,D=new TE(v,$,O,S,N),A=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],T=R();w=t.runWebGLProgram(D,T,"float32",A)}else if(ae().getBool("WEBGL_CONV_IM2COL"))w=RE({x:o,filter:r,convInfo:v,backend:t,bias:i,activation:g,preluActivationWeights:a,leakyreluAlpha:y});else{const O=g?cu(g,!1):null,D=new NE(v,$,O,S,N),A=R();w=t.runWebGLProgram(D,A,"float32")}const F=Ie({inputs:{x:w},backend:t,attrs:{shape:v.outShape}});return C.push(w),C.forEach(O=>t.disposeIntermediateTensorInfo(O)),F}const GY={kernelName:bh,backendName:"webgl",kernelFunc:UY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jY(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,filter:r,bias:i,preluActivationWeights:a}=e,{strides:u,pad:d,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=s,y=[];let b=h;b==null&&(b=[1,1]),_(wn(u,b),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${b}'`);const v=hn(o.shape,r.shape,u,b,d,p,!0),w=ae().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,C=f?cu(f,w):null,$=[o,r],S=i!=null,N=a!=null,R=f==="leakyrelu";if(S&&$.push(i),N&&$.push(a),R){const A=t.makeTensorInfo([],"float32",_r(g,"float32"));$.push(A),y.push(A)}let F;w?F=new FE(v,S,C,N,R):F=new DE(v,S,C,N,R);const O=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],D=t.runWebGLProgram(F,$,"float32",O);return y.forEach(A=>t.disposeIntermediateTensorInfo(A)),D}const HY={kernelName:PI,backendName:"webgl",kernelFunc:jY};class qY{constructor(e,t,s,o){this.sliceDim=e,this.strides=t,this.paramsShape=o,this.variableNames=["x","indices"],this.outputShape=s;const r=yt(s.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${r} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KY(n){const{inputs:e,backend:t}=n,{params:s,indices:o}=e,r=o.shape,i=r[r.length-1],a=de(s.shape),[u,d,h,p]=v0(s,o),f=Ie({inputs:{x:o},backend:t,attrs:{shape:[d,i]}}),g=Ie({inputs:{x:s},backend:t,attrs:{shape:[de(s.shape)/h,h]}});if(t.shouldExecuteOnCPU([s,o])||s.dtype==="string"){const w=t.readSync(o.dataId),C=t.bufferSync(s),$=JK(w,C,s.dtype,d,i,h,p,s.shape,a);return t.makeTensorInfo(u,s.dtype,$.values)}const y=new qY(i,p,[d,h],s.shape),b=t.runWebGLProgram(y,[g,f],g.dtype),v=Ie({inputs:{x:b},backend:t,attrs:{shape:u}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(b),v}const XY={kernelName:vI,backendName:"webgl",kernelFunc:KY};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YY{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const s=yt(this.rank),o=QY(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${o}));
      }
    `}}function QY(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let o=0;o<n.length;o++)o===2?s.push("index"):s.push(`${t[o]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LE(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,indices:r}=e,{axis:i,batchDims:a}=s,u=Ke(i,o.shape)[0];if(ae().get("DEBUG")){const C=t.readSync(r.dataId),$=o.shape[u];for(let S=0;S<C.length;++S){const N=C[S];_(N<=$-1&&N>=0,()=>`GatherV2: the index value ${N} is not in [0, ${$-1}]`)}}const d=G0(o,r,u,a),h=de(r.shape),p=[],f=Ie({inputs:{x:o},backend:t,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),g=Ie({inputs:{x:r},backend:t,attrs:{shape:[d.batchSize,h/d.batchSize]}});p.push(f),p.push(g);const y=[d.batchSize,d.outerSize,h/d.batchSize,d.sliceSize];if(t.shouldExecuteOnCPU([o,r])||o.dtype==="string"){const C=t.bufferSync(g),$=t.bufferSync(f),S=ZK($,C,y);return p.forEach(N=>t.disposeIntermediateTensorInfo(N)),t.makeTensorInfo(d.outputShape,S.dtype,S.values)}const b=new YY(f.shape,y),v=t.runWebGLProgram(b,[f,g],f.dtype);p.push(v);const w=Ie({inputs:{x:v},backend:t,attrs:{shape:d.outputShape}});return p.forEach(C=>t.disposeIntermediateTensorInfo(C)),w}const JY={kernelName:dp,backendName:"webgl",kernelFunc:LE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZY="return float(a > b);",eQ=`
  return vec4(greaterThan(a, b));
`,tQ=fn({opSnippet:ZY,packedOpSnippet:eQ,cpuKernelImpl:eX,dtype:"bool"}),nQ={kernelName:hp,backendName:"webgl",kernelFunc:tQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sQ="return float(a >= b);",oQ=`
  return vec4(greaterThanEqual(a, b));
`,rQ=fn({opSnippet:sQ,packedOpSnippet:oQ,dtype:"bool",cpuKernelImpl:tX}),iQ={kernelName:Ou,backendName:"webgl",kernelFunc:rQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aQ(n){const{inputs:e,backend:t}=n,{input:s}=e;return OE(s,!0,t)}const lQ={kernelName:Cx,backendName:"webgl",kernelFunc:aQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uQ="return float(!isnan(x) && !isinf(x));",cQ=ot({opSnippet:uQ,dtype:"bool"}),dQ={kernelName:Mu,backendName:"webgl",kernelFunc:cQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hQ="return float(isinf(x));",pQ=ot({opSnippet:hQ,dtype:"bool"}),fQ={kernelName:Pu,backendName:"webgl",kernelFunc:pQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mQ="return float(isnan(x));",gQ=ot({opSnippet:mQ,dtype:"bool"}),yQ={kernelName:zu,backendName:"webgl",kernelFunc:gQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xQ="return float(a < b);",bQ=`
  return vec4(lessThan(a, b));
`,vQ=fn({opSnippet:xQ,packedOpSnippet:bQ,cpuKernelImpl:nX,dtype:"bool"}),wQ={kernelName:fp,backendName:"webgl",kernelFunc:vQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kQ="return float(a <= b);",CQ=`
  return vec4(lessThanEqual(a, b));
`,IQ=fn({opSnippet:kQ,packedOpSnippet:CQ,cpuKernelImpl:sX,dtype:"bool"}),SQ={kernelName:mp,backendName:"webgl",kernelFunc:IQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Q(n){const{backend:e,attrs:t}=n,{start:s,stop:o,num:r}=t,i=oX(s,o,r);return e.makeTensorInfo([i.length],"float32",i)}const NQ={kernelName:wI,backendName:"webgl",kernelFunc:$Q};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TQ=tl+`
  return x < 0.0 ? 0./0. : log(x);
`,EQ=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,RQ=ot({opSnippet:TQ,packedOpSnippet:EQ,cpuKernelImpl:rX}),AQ={kernelName:Bu,backendName:"webgl",kernelFunc:RQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DQ=tl+`
  return log(1.0 + x);
`,FQ=ot({opSnippet:DQ}),_Q={kernelName:Wu,backendName:"webgl",kernelFunc:FQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OQ="return float(a >= 1.0 && b >= 1.0);",LQ=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,MQ=fn({opSnippet:OQ,packedOpSnippet:LQ,dtype:"bool"}),PQ={kernelName:gp,backendName:"webgl",kernelFunc:MQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zQ="return float(!(x >= 1.0));",BQ=ot({opSnippet:zQ}),WQ={kernelName:yp,backendName:"webgl",kernelFunc:BQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VQ="return float(a >= 1.0 || b >= 1.0);",UQ=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,GQ=fn({opSnippet:VQ,packedOpSnippet:UQ,dtype:"bool"}),jQ={kernelName:xp,backendName:"webgl",kernelFunc:GQ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HQ{constructor(e,t,s,o,r){this.variableNames=["x"],this.outputShape=[];const i=t,a=e[3]-1;this.outputShape=e;let u;const d=`float(${s}) + float(${o}) * sum`;r===.5?u=`inversesqrt(${d})`:r===1?u=`1.0/(${d})`:u=`exp(log(${d}) * float(-${r}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${u};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qQ{constructor(e,t,s,o,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=t,a=e[3]-1;this.outputShape=e;let u;const d=`float(${s}) + float(${o}) * sum`;r===.5?u=`inversesqrt(${d})`:r===1?u=`1.0/(${d})`:u=`exp(log(${d}) * float(-${r}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KQ=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{depthRadius:r,bias:i,alpha:a,beta:u}=s,d=ae().getBool("WEBGL_PACK_NORMALIZATION")?new qQ(o.shape,r,i,a,u):new HQ(o.shape,r,i,a,u);return t.runWebGLProgram(d,[o],o.dtype)},XQ={kernelName:bp,backendName:"webgl",kernelFunc:KQ};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YQ{constructor(e,t,s,o,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=s,this.alpha=o,this.beta=r,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${o}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${o})
                * float(${r})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${r});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QQ=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:o,y:r,dy:i}=e,{depthRadius:a,bias:u,alpha:d,beta:h}=s,p=new YQ(o.shape,a,u,d,h);return t.runWebGLProgram(p,[o,r,i],o.dtype)},JQ={kernelName:Sx,backendName:"webgl",kernelFunc:QQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZQ(n,e,t,s){const o=de(e),i=de(n.shape)/o,a=Ie({inputs:{x:n},attrs:{shape:[i,o]},backend:s}),u=Wi(a,n.dtype,"max",s),d=Ie({inputs:{x:u},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(u),d}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ME(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{reductionIndices:r,keepDims:i}=s,a=o.shape.length,u=Ke(r,o.shape);let d=u;const h=Dt(d,a),p=h!=null,f=t.shouldExecuteOnCPU([o]);let g=o;if(p){if(f){const $=t.texData.get(g.dataId).values,S=new Array(a);for(let F=0;F<S.length;F++)S[F]=o.shape[h[F]];const N=T1($,o.shape,o.dtype,h,S);g=t.makeTensorInfo(S,o.dtype);const R=t.texData.get(g.dataId);R.values=N}else g=wf(o,h,t);d=zt(d.length,a)}pn("max",d,a);const[y,b]=rn(g.shape,d);let v=y;i&&(v=jt(y,u));let w;if(f){const $=t.texData.get(g.dataId).values,S=iX($,de(b),v,o.dtype);w=t.makeTensorInfo(v,o.dtype);const N=t.texData.get(w.dataId);N.values=S}else w=ZQ(g,b,v,t);return p&&t.disposeIntermediateTensorInfo(g),w}const eJ={kernelName:vp,backendName:"webgl",kernelFunc:ME};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tJ=E1+`
  return max(a, b);
`,nJ=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Bi+`
  return result;
`,sJ=fn({opSnippet:tJ,packedOpSnippet:nJ,cpuKernelImpl:aX}),oJ={kernelName:Vu,backendName:"webgl",kernelFunc:sJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rJ(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e;Ec(o,"maxPool");const{filterSize:r,strides:i,pad:a,dimRoundingMode:u}=s,d=1;_(wn(i,d),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);const h=Ds(o.shape,r,i,d,a,u);if(h.filterWidth===1&&h.filterHeight===1&&ht(h.inShape,h.outShape))return ss({inputs:{x:o},backend:t});const p=new du(h,"max",!1);return t.runWebGLProgram(p,[o],o.dtype)}const iJ={kernelName:wp,backendName:"webgl",kernelFunc:rJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aJ(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{filterSize:r,strides:i,pad:a,dataFormat:u,dimRoundingMode:d}=s,h=[1,1,1],p=Xo(o.shape,r,i,h,a,d,u),f=new A1(p,"max",!1);return t.runWebGLProgram(f,[o],o.dtype)}const lJ={kernelName:kp,backendName:"webgl",kernelFunc:aJ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uJ{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,s=e.strideWidth,o=e.dilationHeight,r=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=r-1-e.padInfo.top,u=i-1-e.padInfo.left,d=r*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${r};
          wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${d} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class cJ{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,s=e.strideHeight,o=e.strideWidth,r=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=u-1-e.padInfo.front,f=d-1-e.padInfo.top,g=h-1-e.padInfo.left,y=u*d*h-1;this.userCode=`
      const ivec3 pads = ivec3(${p}, ${f}, ${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
           wD += ${r}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${y} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${d} * ${h} +
                  wR * ${h} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dJ(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,input:r}=e,i=r,{filterSize:a,strides:u,pad:d,dimRoundingMode:h}=s,p=[1,1,1],f=Xo(i.shape,a,u,p,d,h),g=new A1(f,"max",!0),y=t.runWebGLProgram(g,[i],i.dtype),b=new cJ(f),v=t.runWebGLProgram(b,[o,y],i.dtype);return t.disposeIntermediateTensorInfo(y),v}const hJ={kernelName:Nx,backendName:"webgl",kernelFunc:dJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pJ(n){const{inputs:e,backend:t,attrs:s}=n,{dy:o,input:r,output:i}=e,a=r;Ec([r,i],"maxPoolGrad");const{filterSize:u,strides:d,pad:h,dimRoundingMode:p}=s,f=Ds(a.shape,u,d,1,h,p),g=!0,y=new du(f,"max",g),b=t.runWebGLProgram(y,[a],a.dtype),v=new uJ(f),w=t.runWebGLProgram(v,[o,b],a.dtype);return t.disposeIntermediateTensorInfo(b),w}const fJ={kernelName:$x,backendName:"webgl",kernelFunc:pJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mJ(n,e,t,s){let o=new du(t,"max",!1);const r=s.runWebGLProgram(o,[n],"float32");o=new du(t,"max",!0,!0,e);const i=s.runWebGLProgram(o,[n],"float32");return[r,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gJ={kernelName:kI,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:o,strides:r,pad:i,includeBatchInIndex:a}=e,u=t;_(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const d=[1,1];_(wn(r,d),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${r} and dilations '${d}'`);const h=Ds(s.shape,o,r,d,i),[p,f]=mJ(s,a,h,u);return[p,f]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yJ(n,e,t,s){const o=de(e),i=de(n.shape)/o,a=Ie({inputs:{x:n},attrs:{shape:[i,o]},backend:s}),u=Wi(a,"float32","mean",s),d=Ie({inputs:{x:u},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(u),d}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xJ={kernelName:Cp,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{keepDims:o,axis:r}=e,i=t,a=s.shape.length,u=Ke(r,s.shape);let d=u;const h=Dt(d,a),p=h!=null,f=i.shouldExecuteOnCPU([s]),g=[];let y=s;if(p){if(f){const S=i.texData.get(y.dataId).values,N=new Array(a);for(let O=0;O<N.length;O++)N[O]=s.shape[h[O]];const R=T1(S,s.shape,s.dtype,h,N);y=i.makeTensorInfo(N,s.dtype);const F=i.texData.get(y.dataId);F.values=R}else y=wf(s,h,i);g.push(y),d=zt(d.length,a)}pn("sum",d,a);const[b,v]=rn(y.shape,d);let w=b;o&&(w=jt(b,u));const C=yJ(y,v,w,i);for(const $ of g)i.disposeIntermediateTensorInfo($);return C}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bJ(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s,a=o.shape.length,u=Ke(r,o.shape);let d=u;const h=Dt(d,a);let p=o;h!=null&&(p=Fn({inputs:{x:o},backend:t,attrs:{perm:h}}),d=zt(d.length,o.shape.length)),pn("min",d,a);const[f,g]=rn(p.shape,d),y=de(g),b=Ie({inputs:{x:p},backend:t,attrs:{shape:[-1,y]}}),v=Wi(b,b.dtype,"min",t);let w;if(i){const C=jt(f,u);w=Ie({inputs:{x:v},backend:t,attrs:{shape:C}})}else w=Ie({inputs:{x:v},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(v),h!=null&&t.disposeIntermediateTensorInfo(p),w}const vJ={kernelName:Ip,backendName:"webgl",kernelFunc:bJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wJ=E1+`
  return min(a, b);
`,kJ=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Bi+`
  return result;
`,CJ=fn({opSnippet:wJ,packedOpSnippet:kJ,cpuKernelImpl:lX}),IJ={kernelName:Uu,backendName:"webgl",kernelFunc:CJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SJ{constructor(e,t,s){this.variableNames=["x"],this.outputShape=t.map((h,p)=>h[0]+e[p]+h[1]);const o=e.length,r=yt(o),i=t.map(h=>h[0]).join(","),a=t.map((h,p)=>h[0]+e[p]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o),d=s==="reflect"?0:1;if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${d};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${d};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${r} start = ${r}(${i});
      ${r} end = ${r}(${a});

      void main() {
        ${r} outC = getOutputCoords();
        for (int i = 0; i < ${o}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${d};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${d};
          }
        }
        ${r} coords = outC - start;
        setOutput(getX(${u}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $J{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((y,b)=>y[0]+e[b]+y[1]);const o=e.length,r=yt(o),i=t.map(y=>y[0]).join(","),a=t.map((y,b)=>y[0]+e[b]).join(","),u=An("rc",o),d=An("source",o),h=`${u[o-1]} < ${this.outputShape[o-1]}`,p=o===1?"source":`vec2(${d.slice(-2).join()})`,f=s==="reflect"?0:1;let g="";if(o===1){const y=`
        ${r} source = rc;
        if (source < start) {
          source = start * 2 - source - ${f};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${f};
        }
        source -= start;
      `;g=`
        ${r} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${d.join()}), ${p});
        ${u[o-1]} += 1;
        if(${h}) {
          ${y}
          result[1] = getChannel(getX(${d.join()}), ${p});
        }
      `}else{const y=`
        ${r} source = rc;
        ${r} lt = ${r}(lessThan(source, start));
        ${r} gte = ${r}(greaterThanEqual(source, end));
        ${r} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${f}) +
                gte * ((end - 1) * 2 - source + ${f});
        source -= start;
      `;g=`
        ${r} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${d.join()}), ${p});
        ${u[o-1]} += 1;
        if(${h}) {
          ${y}
          result[1] = getChannel(getX(${d.join()}), ${p});
        }
        rc = outputLoc;
        ${u[o-2]} += 1;
        if(${u[o-2]} < ${this.outputShape[o-2]}) {
          ${y}
          result[2] = getChannel(getX(${d.join()}), ${p});
          ${u[o-1]} += 1;
          if(${h}) {
            ${y}
            result[3] = getChannel(getX(${d.join()}), ${p});
          }
        }
      `}this.userCode=`
      const ${r} start = ${r}(${i});
      const ${r} end = ${r}(${a});

      void main() {
        ${r} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NJ=({inputs:n,backend:e,attrs:t})=>{const{x:s}=n,{paddings:o,mode:r}=t,i=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $J(s.shape,o,r):new SJ(s.shape,o,r);return e.runWebGLProgram(i,[s],s.dtype)},TJ={kernelName:Sp,backendName:"webgl",kernelFunc:NJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EJ=`if (b == 0.0) return NAN;
  return mod(a, b);`,RJ=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Bi+`
  return result;
`,AJ=fn({opSnippet:EJ,packedOpSnippet:RJ}),DJ={kernelName:Gu,backendName:"webgl",kernelFunc:AJ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FJ{constructor(e,t,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _J=`
if (a == b) {
  return 1.0;
};
return a / b;`,OJ=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,PE=fn({opSnippet:_J,packedOpSnippet:OJ,checkOutOfBounds:!0}),LJ={kernelName:Tu,backendName:"webgl",kernelFunc:PE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CC="return a - b;",zE=fn({opSnippet:CC,packedOpSnippet:CC,supportsComplex:!0,cpuKernelImpl:EX}),MJ={kernelName:ic,backendName:"webgl",kernelFunc:zE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BE(n){const{inputs:e,backend:t,attrs:s}=n,{logits:o}=e,{dim:r}=s,i=Ke([r],o.shape),a=ME({inputs:{x:o},backend:t,attrs:{reductionIndices:i,keepDims:!1}}),u=jt(a.shape,i),d=Ie({inputs:{x:a},backend:t,attrs:{shape:u}}),h=zE({inputs:{a:o,b:d},backend:t}),p=_E({inputs:{x:h},backend:t}),f=kf({inputs:{x:p},backend:t,attrs:{axis:i,keepDims:!1}}),g=Ie({inputs:{x:f},backend:t,attrs:{shape:u}}),y=PE({inputs:{a:p,b:g},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(g),y}const PJ={kernelName:Up,backendName:"webgl",kernelFunc:BE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zJ(n){const{inputs:e,backend:t,attrs:s}=n,{logits:o}=e,{numSamples:r,seed:i,normalized:a}=s,u=a?o:BE({inputs:{logits:o},backend:t,attrs:{dim:o.shape.length-1}}),d=u.shape[0],h=u.shape[1],p=new FJ(d,h,r),f=[[i]],g=t.runWebGLProgram(p,[u],"int32",f);return a||t.disposeIntermediateTensorInfo(u),g}const BJ={kernelName:CI,backendName:"webgl",kernelFunc:zJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WJ=_s+`
  return -x;
`,VJ=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function UJ(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])){const r=t.texData.get(s.dataId),[i,a]=cX(r.values,s.shape,s.dtype);return t.makeTensorInfo(a,s.dtype,i)}let o;return ae().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new kr(s.shape,VJ):o=new mo(s.shape,WJ),t.runWebGLProgram(o,[s],s.dtype)}const GJ={kernelName:$p,backendName:"webgl",kernelFunc:UJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jJ=m0;function HJ(n){cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:u}=s,d=t.readSync(o.dataId),h=t.readSync(r.dataId),{selectedIndices:p}=jJ(d,h,i,a,u);return t.makeTensorInfo([p.length],"int32",new Int32Array(p))}const qJ={kernelName:Tx,backendName:"webgl",kernelFunc:HJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KJ=g0;function XJ(n){cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:u,padToMaxOutputSize:d}=s,h=t.readSync(o.dataId),p=t.readSync(r.dataId),{selectedIndices:f,validOutputs:g}=KJ(h,p,i,a,u,d);return[t.makeTensorInfo([f.length],"int32",new Int32Array(f)),t.makeTensorInfo([],"int32",new Int32Array([g]))]}const YJ={kernelName:Ex,backendName:"webgl",kernelFunc:XJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QJ=y0;function JJ(n){cs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:o,scores:r}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:u,softNmsSigma:d}=s,h=t.readSync(o.dataId),p=t.readSync(r.dataId),f=i,g=a,y=u,b=d,{selectedIndices:v,selectedScores:w}=QJ(h,p,f,g,y,b);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const ZJ={kernelName:Rx,backendName:"webgl",kernelFunc:JJ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eZ{constructor(e,t,s,o){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${o}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tZ=n=>{const{inputs:e,backend:t,attrs:s}=n,{indices:o}=e,{dtype:r,depth:i,onValue:a,offValue:u}=s,d=de(o.shape),h=new eZ(d,i,a,u),p=Ie({inputs:{x:o},backend:t,attrs:{shape:[d]}}),f=t.runWebGLProgram(h,[p],r);t.disposeIntermediateTensorInfo(p);const g=[...o.shape,i],y=Ie({inputs:{x:f},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(f),y},nZ={kernelName:Ep,backendName:"webgl",kernelFunc:tZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gh(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="complex64"){const o=Ac({inputs:{input:s},backend:t}),r=Gh({inputs:{x:o},backend:t}),i=Cf({inputs:{input:s},backend:t}),a=Gh({inputs:{x:i},backend:t}),u=Vr({inputs:{real:r,imag:a},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),u}else return Dc({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:t})}const sZ={kernelName:Hp,backendName:"webgl",kernelFunc:Gh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WE(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const o=Ac({inputs:{input:s},backend:t}),r=WE({inputs:{x:o},backend:t}),i=Cf({inputs:{input:s},backend:t}),a=Gh({inputs:{x:i},backend:t}),u=Vr({inputs:{real:r,imag:a},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),u}else return Dc({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:t})}const oZ={kernelName:Tp,backendName:"webgl",kernelFunc:WE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rZ(n){const{inputs:e,backend:t,attrs:s}=n,{axis:o}=s;if(e.length===1)return _y({inputs:{input:e[0]},backend:t,attrs:{dim:o}});const r=e[0].shape,i=e[0].dtype;e.forEach(h=>{Qy(r,h.shape,"All tensors passed to stack must have matching shapes"),_(i===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],u=e.map(h=>{const p=_y({inputs:{input:h},backend:t,attrs:{dim:o}});return a.push(p),p}),d=$E({inputs:u,backend:t,attrs:{axis:o}});return a.forEach(h=>t.disposeIntermediateTensorInfo(h)),d}const iZ={kernelName:Rp,backendName:"webgl",kernelFunc:rZ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aZ{constructor(e,t,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((d,h)=>d[0]+e[h]+d[1]);const o=e.length,r=yt(o),i=t.map(d=>d[0]).join(","),a=t.map((d,h)=>d[0]+e[h]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o);if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${r} start = ${r}(${i});
      ${r} end = ${r}(${a});

      void main() {
        ${r} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${r} coords = outC - start;
          setOutput(getX(${u}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lZ{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((b,v)=>b[0]+e[v]+b[1]);const o=e.length,r=yt(o),i=t.map(b=>b[0]).join(","),a=t.map((b,v)=>b[0]+e[v]).join(","),u=An("rc",o),d=An("source",o),h=`${u[o-1]} < ${this.outputShape[o-1]}`,p=o===1?"source":`vec2(${d.slice(-2).join()})`,f=[`${r} rc = outputLoc;`,`${u[o-1]} += 1;
       if(${h}) {
      `,o===1?"":`}
       rc = outputLoc;
       ${u[o-2]} += 1;
       if(${u[o-2]} < ${this.outputShape[o-2]}) {`,o===1?"":`  ${u[o-1]} += 1;
         if(${h}) {`],g=o===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let y="";for(let b=0,v=o===1?2:4;b<v;b++)y+=`
        ${f[b]}
        if (${g}) {
          result[${b}] = float(value);
        } else {
          ${r} source = rc - start;
          result[${b}] = getChannel(getX(${d.join()}), ${p});
        }
      `;y+=o===1?"} ":"}}",this.userCode=`
      const ${r} start = ${r}(${i});
      const ${r} end = ${r}(${a});

      void main() {
        ${r} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VE=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{paddings:r,constantValue:i}=s;if(de(o.shape)===0){const d=r.map((h,p)=>h[0]+o.shape[p]+h[1]);return Dc({backend:t,attrs:{shape:d,value:i,dtype:o.dtype}})}const a=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new lZ(o.shape,r,i):new aZ(o.shape,r,i),u=[[i]];return t.runWebGLProgram(a,[o],o.dtype,u)},uZ={kernelName:Ap,backendName:"webgl",kernelFunc:VE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cZ=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,dZ=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Bi+`
  return result;
`,hZ=fn({opSnippet:cZ,packedOpSnippet:dZ}),pZ={kernelName:Hu,backendName:"webgl",kernelFunc:hZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fZ(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{axis:r,keepDims:i}=s,a=o.shape.length,u=[],d=Ke(r,o.shape);let h=d;const p=Dt(h,a);let f=o;p!=null&&(f=Fn({inputs:{x:o},backend:t,attrs:{perm:p}}),h=zt(h.length,a),u.push(f)),pn("prod",h,a);let g;if(t.shouldExecuteOnCPU([f])){const y=t.texData.get(f.dataId).values,{outVals:b,outShape:v,outDtype:w}=hX(f.shape,f.dtype,y,h);g=t.makeTensorInfo(v,w,b)}else{const[y,b]=rn(f.shape,h),v=de(b),w=Ie({inputs:{x:f},backend:t,attrs:{shape:[-1,v]}}),C=Vx(o.dtype),$=Wi(w,C,"prod",t);g=Ie({inputs:{x:$},backend:t,attrs:{shape:y}}),u.push(w),u.push($)}if(i){u.push(g);const y=jt(g.shape,d);g=Ie({inputs:{x:g},backend:t,attrs:{shape:y}})}return u.forEach(y=>t.disposeIntermediateTensorInfo(y)),g}const mZ={kernelName:Fp,backendName:"webgl",kernelFunc:fZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gZ(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:o,paramsDenseValues:r,indices:i}=e,{outputRaggedRank:a}=s,u=o.map(w=>t.readSync(w.dataId)),d=o.map(w=>w.shape),h=t.readSync(r.dataId),p=t.readSync(i.dataId),[f,g,y]=pX(u,d,h,r.shape,r.dtype,p,i.shape,a),b=f.map(w=>t.makeTensorInfo([w.length],"int32",w)),v=t.makeTensorInfo(y,r.dtype,g);return b.concat([v])}const yZ={kernelName:II,backendName:"webgl",kernelFunc:gZ};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xZ(n){const{inputs:e,backend:t}=n,{starts:s,limits:o,deltas:r}=e,i=t.readSync(s.dataId),a=t.readSync(o.dataId),u=t.readSync(r.dataId),[d,h]=fX(i,s.shape,s.dtype,a,o.shape,u,r.shape),p=t.makeTensorInfo([d.length],"int32",d),f=t.makeTensorInfo([h.length],s.dtype,h);return[p,f]}const bZ={kernelName:SI,backendName:"webgl",kernelFunc:xZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vZ(n){const{inputs:e,backend:t,attrs:s}=n,{shape:o,values:r,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:u}=s,d=t.readSync(o.dataId),h=t.readSync(r.dataId),p=t.readSync(i.dataId),f=a.map(v=>t.readSync(v.dataId)),g=a.map(v=>v.shape),[y,b]=mX(d,o.shape,h,r.shape,r.dtype,p,i.shape,f,g,u);return t.makeTensorInfo(y,r.dtype,b)}const wZ={kernelName:$I,backendName:"webgl",kernelFunc:vZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UE=n=>{const{backend:e,attrs:t}=n,{start:s,stop:o,step:r,dtype:i}=t,a=gX(s,o,r,i);return e.makeTensorInfo([a.length],i,a)},kZ={kernelName:Ax,backendName:"webgl",kernelFunc:UE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CZ="return 1.0 / x;",IZ=ot({opSnippet:CZ}),SZ={kernelName:qu,backendName:"webgl",kernelFunc:IZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Z=_s+`
  return (x < 0.0) ? 0.0 : x;
`,NZ=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,TZ=ot({opSnippet:$Z,packedOpSnippet:NZ}),EZ={kernelName:Ku,backendName:"webgl",kernelFunc:TZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RZ=_s+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,AZ=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,DZ=ot({opSnippet:RZ,packedOpSnippet:AZ}),FZ={kernelName:Xu,backendName:"webgl",kernelFunc:DZ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Z{constructor(e,t,s,o,r){this.variableNames=["A"],this.outputShape=[];const[i,a,u,d]=e;this.outputShape=[i,t,s,d];const h=[o&&t>1?a-1:a,o&&s>1?u-1:u],p=[o&&t>1?t-1:t,o&&s>1?s-1:s];let f;r?f="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/p[0]},
          ${h[1]/p[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OZ{constructor(e,t,s,o,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,u,d]=e;this.outputShape=[i,t,s,d];const h=[o&&t>1?a-1:a,o&&s>1?u-1:u],p=[o&&t>1?t-1:t,o&&s>1?s-1:s];let f;r?f="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/p[0]},
          ${h[1]/p[1]},
          ${h[1]/p[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${d-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LZ(n){const{inputs:e,backend:t,attrs:s}=n,{images:o}=e,{alignCorners:r,halfPixelCenters:i,size:a}=s,[u,d]=a,h=ae().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new OZ(o.shape,u,d,r,i):new _Z(o.shape,u,d,r,i);return t.runWebGLProgram(h,[o],"float32")}const MZ={kernelName:Lp,backendName:"webgl",kernelFunc:LZ};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PZ{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,o,r]=t,[,i,a]=e,u=[s&&i>1?o-1:o,s&&a>1?r-1:r],d=[s&&i>1?i-1:i,s&&a>1?a-1:a],h=u[0]/d[0],p=u[1]/d[1],f=1/h,g=1/p,y=Math.ceil(f)*2+2,b=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${p});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${g});

        const int winHeight = int(${y});
        const int winWidth = int(${b});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${o-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${r-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zZ(n){const{inputs:e,backend:t,attrs:s}=n,{images:o,dy:r}=e,{alignCorners:i}=s,a=new PZ(r.shape,o.shape,i);return t.runWebGLProgram(a,[r],r.dtype)}const BZ={kernelName:_x,backendName:"webgl",kernelFunc:zZ};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WZ{constructor(e,t,s,o,r){this.variableNames=["A"],this.outputShape=[];const[i,a,u,d]=e;this.outputShape=[i,t,s,d];const h=[o&&t>1?a-1:a,o&&s>1?u-1:u],p=[o&&t>1?t-1:t,o&&s>1?s-1:s],f=o?"0.5":"0.0";let g;r?g="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/p[0]},
          ${h[1]/p[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VZ{constructor(e,t,s,o,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,u,d]=e;this.outputShape=[i,t,s,d];const h=[o&&t>1?a-1:a,o&&s>1?u-1:u],p=[o&&t>1?t-1:t,o&&s>1?s-1:s],f=o?"0.5":"0.0";let g;r?g="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/p[0]},
          ${h[1]/p[1]},
          ${h[1]/p[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${d-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UZ(n){const{inputs:e,backend:t,attrs:s}=n,{images:o}=e,{alignCorners:r,halfPixelCenters:i,size:a}=s,[u,d]=a,h=ae().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new VZ(o.shape,u,d,r,i):new WZ(o.shape,u,d,r,i);return t.runWebGLProgram(h,[o],o.dtype)}const GZ={kernelName:Op,backendName:"webgl",kernelFunc:UZ};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jZ{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,o,r]=t,[,i,a]=e,u=[s&&i>1?o-1:o,s&&a>1?r-1:r],d=[s&&i>1?i-1:i,s&&a>1?a-1:a],h=u[0]/d[0],p=u[1]/d[1],f=1/h,g=1/p,y=Math.ceil(f)*2+2,b=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${p});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${g});

        const int winHeight = int(${y});
        const int winWidth = int(${b});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${u[0]}) *
                (float(dyR) / float(${d[0]}));

            float sourceFracCol =
                float(${u[1]}) *
                  (float(dyC) / float(${d[1]}));

            int sourceNearestRow = int(min(
                float(int(${o}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HZ(n){const{inputs:e,backend:t,attrs:s}=n,{images:o,dy:r}=e,{alignCorners:i}=s,a=new jZ(r.shape,o.shape,i);return t.runWebGLProgram(a,[r],r.dtype)}const qZ={kernelName:Fx,backendName:"webgl",kernelFunc:HZ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KZ{constructor(e,t){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const o=a=>t.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,r=e.map((a,u)=>o(u)).join(","),i=yt(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${r}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XZ{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const o=An("rc",s),r=`${o[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${o[s-2]} + 1 < ${this.outputShape[s-2]}`,a=yt(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${r}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${u(o.slice())};
          if(${r}){
            result.g = ${d(o.slice())};
          }
          if(${i}) {
            result.b = ${h(o.slice())};
            if(${r}) {
              result.a = ${p(o.slice())};
            }
          }
          setOutput(result);
        }
    `;function u(y){return f(y)}function d(y){return y[s-1]="("+y[s-1]+" + 1)",f(y)}function h(y){return y[s-2]="("+y[s-2]+" + 1)",f(y)}function p(y){return y[s-1]="("+y[s-1]+" + 1)",y[s-2]="("+y[s-2]+" + 1)",f(y)}function f(y){const b=e.map((C,$)=>g($,y)),v=b.join(","),w=b.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${w}))`}function g(y,b){return t.indexOf(y)!==-1&&e[y]!==1?`${e[y]} - ${b[y]} - 1`:`${b[y]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YZ(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{dims:r}=s,i=o.shape.length,a=Ke(r,o.shape);if(i===0)return ss({inputs:{x:o},backend:t});const u=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new XZ(o.shape,a):new KZ(o.shape,a);return t.runWebGLProgram(u,[o],o.dtype)}const QZ={kernelName:Mp,backendName:"webgl",kernelFunc:YZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JZ{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],o=e[2];this.outputShape=e;let r="";typeof t=="number"?r=`float outputValue = ${t.toFixed(2)};`:r=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${r}
          if(coordX >= 0 && coordX < ${o} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZZ={kernelName:Wx,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:o,fillValue:r,center:i}=e,a=t,u=new JZ(s.shape,r),[d,h]=T0(i,s.shape[1],s.shape[2]),p=[[d,h,Math.sin(o),Math.cos(o)]];return a.runWebGLProgram(u,[s],s.dtype,p)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eee=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,tee=ot({opSnippet:eee}),nee={kernelName:Yu,backendName:"webgl",kernelFunc:tee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const see="return inversesqrt(x);",oee=ot({opSnippet:see,cpuKernelImpl:yX}),ree={kernelName:Qu,backendName:"webgl",kernelFunc:oee};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D1{constructor(e,t,s,o,r,i,a=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const d=yt(r.length),h=yt(i.length);let p="";s===1?p="i":s===2&&(p="i, j");const f=`getIndices(${p})`;let g="";o===1?g="i":o===2&&(g="i, coords[1]");const y=`getUpdates(${g})`;let b="";u&&(b="coords[0], coords[1]");const v=`getDefaultValue(${b})`,w=t>1?"strides[j]":"strides";this.userCode=`
        ${d} strides = ${d}(${r});

        void main() {
          ${h} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${w};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${y};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iee{constructor(e,t,s,o,r,i,a=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const d=yt(r.length),h=yt(i.length);let p="";s===1?p="i":s===2&&(p="i, j");const f=`getIndices(${p})`;let g="";o===1?g="i":o===2&&(g="i, coords[1]");const y=`getUpdates(${g})`;let b="";u&&(b="coords[0], coords[1]");const v=`getDefaultValue(${b})`,w=t>1?"strides[j]":"strides",C=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${d} strides = ${d}(${r});

        void main() {
          ${h} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${f});
              flattenedIndex += index.xz * ${w};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${C};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${y};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aee(n){const{inputs:e,backend:t,attrs:s}=n,{indices:o,updates:r}=e,{shape:i}=s,{sliceRank:a,numUpdates:u,sliceSize:d,strides:h,outputSize:p}=Oi(r,o,i),f=[p/d,d];if(p===0)return t.makeTensorInfo(i,o.dtype);const g=Ie({inputs:{x:o},backend:t,attrs:{shape:[u,a]}}),y=Ie({inputs:{x:r},backend:t,attrs:{shape:[u,d]}}),b=t.makeTensorInfo([],"float32",new Float32Array([0]));let v;ae().getBool("WEBGL_PACK")?v=new iee(u,a,g.shape.length,y.shape.length,h,f):v=new D1(u,a,g.shape.length,y.shape.length,h,f);const w=t.runWebGLProgram(v,[y,g,b],y.dtype),C=Ie({inputs:{x:w},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(b),C}const lee={kernelName:NI,backendName:"webgl",kernelFunc:aee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uee{constructor(e,t,s,o){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const r="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,a=ae().getNumber("WEBGL_VERSION")===2?r:i,u=o==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${u} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cee(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:o,values:r}=e,{side:i}=s,a=new uee(o.shape[0],o.shape[1],r.shape[1],i),u=[[o.shape[1]]];return t.runWebGLProgram(a,[o,r],"int32",u)}const dee={kernelName:EI,backendName:"webgl",kernelFunc:cee};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hee{constructor(e,t,s){this.variableNames=["c","a","b"],this.outputShape=t;let o,r;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)r="resRC",o="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],d=[];for(let h=0;h<t.length;h++)d.push(`${a[h]}`),h<e&&u.push(`${a[h]}`);o=u.join(),r=d.join()}const i=yt(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${o});
        if (cVal >= 1.0) {
          setOutput(getA(${r}));
        } else {
          setOutput(getB(${r}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pee(n){const{inputs:e,backend:t}=n,{condition:s,t:o,e:r}=e,i=new hee(s.shape.length,o.shape,o.shape.length);return t.runWebGLProgram(i,[s,o,r],ts(o.dtype,r.dtype))}const fee={kernelName:Pp,backendName:"webgl",kernelFunc:pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mee=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${of};
  float scale = ${rf};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,gee=ot({opSnippet:mee}),yee={kernelName:Ju,backendName:"webgl",kernelFunc:gee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xee=tl+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,bee=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,vee=ot({opSnippet:xee,packedOpSnippet:bee,cpuKernelImpl:bX}),wee={kernelName:nc,backendName:"webgl",kernelFunc:vee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kee=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Cee=ot({opSnippet:kee}),Iee={kernelName:tc,backendName:"webgl",kernelFunc:Cee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const See=tl+`
  return sin(x);
`,$ee=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Bi}
  return result;
`,Nee=ot({opSnippet:See,packedOpSnippet:$ee}),Tee={kernelName:Zu,backendName:"webgl",kernelFunc:Nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eee=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Ree=ot({opSnippet:Eee}),Aee={kernelName:ec,backendName:"webgl",kernelFunc:Ree};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dee=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Fee=ot({opSnippet:Dee}),_ee={kernelName:sc,backendName:"webgl",kernelFunc:Fee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oee=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{blockShape:r,paddings:i}=s;_(o.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=r.reduce((w,C)=>w*C),u=[[0,0]];u.push(...i);for(let w=1+r.length;w<o.shape.length;++w)u.push([0,0]);const d=[],h=VE({inputs:{x:o},backend:t,attrs:{paddings:u,constantValue:0}}),p=gc(h.shape,r,a,!1),f=yc(p.length,r.length,!1),g=xc(h.shape,r,a,!1),y=Ie({inputs:{x:h},backend:t,attrs:{shape:p}}),b=Fn({inputs:{x:y},backend:t,attrs:{perm:f}}),v=Ie({inputs:{x:b},backend:t,attrs:{shape:g}});return d.push(h),d.push(y),d.push(b),d.forEach(w=>t.disposeIntermediateTensorInfo(w)),v},Lee={kernelName:Wp,backendName:"webgl",kernelFunc:Oee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mee(n){const{inputs:e,backend:t}=n,{indices:s,values:o,denseShape:r,defaultValue:i}=e;if(r.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${r.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=t.readSync(s.dataId),u=t.readSync(o.dataId),d=t.readSync(r.dataId),h=t.readSync(i.dataId)[0],[p,f,g,y,b]=wX(a,s.shape,s.dtype,u,o.dtype,d,h);return[t.makeTensorInfo(f,s.dtype,p),t.makeTensorInfo([f[0]],o.dtype,g),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(v=>Number(v)))),t.makeTensorInfo([b.length],s.dtype,new Int32Array(b))]}const Pee={kernelName:RI,backendName:"webgl",kernelFunc:Mee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zee(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:o,newShape:r}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${o.shape}`);if(r.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const i=Array.from(t.readSync(o.dataId)),a=t.readSync(s.dataId),u=Array.from(t.readSync(r.dataId)),[d,h,p]=kX(a,s.shape,s.dtype,i,u);return[t.makeTensorInfo(h,s.dtype,d),t.makeTensorInfo([p.length],r.dtype,new Int32Array(p))]}const Bee={kernelName:AI,backendName:"webgl",kernelFunc:zee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(n){const{inputs:e,backend:t}=n,{data:s,indices:o,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${o.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${r.shape}`);const i=t.readSync(s.dataId),a=t.readSync(o.dataId),u=t.readSync(r.dataId),[d,h]=pE(i,s.shape,s.dtype,a,u,!0);return t.makeTensorInfo(h,s.dtype,d)}const Vee={kernelName:DI,backendName:"webgl",kernelFunc:Wee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(n){const{inputs:e,backend:t}=n,{data:s,indices:o,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${o.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${r.shape}`);const i=t.readSync(s.dataId),a=t.readSync(o.dataId),u=t.readSync(r.dataId),[d,h]=pE(i,s.shape,s.dtype,a,u);return t.makeTensorInfo(h,s.dtype,d)}const Gee={kernelName:FI,backendName:"webgl",kernelFunc:Uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:o,sparseValues:r,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:u,numUpdates:d,sliceSize:h,strides:p,outputSize:f}=Oi(r,o,a),g=!1;if(r.dtype==="string"){const w=t.bufferSync(o),C=t.bufferSync(r),$=Nr(t.readSync(i.dataId)[0]),S=xX(w,C,a,f,h,d,u,p,$,g);return t.makeTensorInfo(a,S.dtype,S.values)}const y=new D1(d,u,o.shape.length,r.shape.length,p,[f,1],g),b=t.runWebGLProgram(y,[r,o,i],r.dtype),v=Ie({inputs:{x:b},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(b),v}const Hee={kernelName:_I,backendName:"webgl",kernelFunc:jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{numOrSizeSplits:r,axis:i}=s,a=Ke(i,o.shape)[0],u=U0(o,r,a),d=o.shape.length,h=new Array(d).fill(0),p=o.shape.slice();return u.map(f=>{const g=[...p];g[a]=f;const y=nl({inputs:{x:o},backend:t,attrs:{begin:h,size:g}});return h[a]+=f,y})}const Kee={kernelName:Vp,backendName:"webgl",kernelFunc:qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IC="return sqrt(x);",Xee=ot({opSnippet:IC,packedOpSnippet:IC,cpuKernelImpl:CX}),Yee={kernelName:oc,backendName:"webgl",kernelFunc:Xee};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qee="return x * x;",Jee=ot({opSnippet:Qee}),Zee={kernelName:Ox,backendName:"webgl",kernelFunc:Jee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SC="return (a - b) * (a - b);",ete=fn({opSnippet:SC,packedOpSnippet:SC}),tte={kernelName:rc,backendName:"webgl",kernelFunc:ete};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nte(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");const r=t.readSync(o.dataId),i=Ho(r),a=IX(i,"string",s);return t.makeTensorInfo(o.shape,"string",a)}const ste={kernelName:Lx,backendName:"webgl",kernelFunc:nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote({inputs:n,attrs:e,backend:t}){const{x:s}=n,o=_s+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,r=new mo(s.shape,o);return t.runWebGLProgram(r,[s],s.dtype)}const rte={kernelName:cc,backendName:"webgl",kernelFunc:ote};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ite{constructor(e,t,s){this.variableNames=["x"],this.outputShape=s;const o=s.length,r=yt(s.length),i=yt(s.length);let a="";if(o===1)a="coords * strides + begin";else{let u=0;a=s.map((d,h)=>(u++,s.length===1?`coords * strides[${h}] + begin[${h}]`:`coords[${u-1}] * strides[${h}] + begin[${h}]`)).join(",")}this.userCode=`
      ${r} begin = ${r}(${e});
      ${r} strides = ${r}(${t});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ate(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{begin:r,end:i,strides:a,beginMask:u,endMask:d,ellipsisMask:h,newAxisMask:p,shrinkAxisMask:f}=s,{finalShapeSparse:g,finalShape:y,isIdentity:b,sliceDim0:v,isSimpleSlice:w,begin:C,end:$,strides:S}=S0(o.shape,r,i,a,u,d,h,p,f);let N;if(b)N=Ie({inputs:{x:o},backend:t,attrs:{shape:y}});else if(v||w){_(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);const F=k0(C,$,S),O=nl({inputs:{x:o},backend:t,attrs:{begin:C,size:F}});N=Ie({inputs:{x:O},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(O)}else if(t.shouldExecuteOnCPU([o])){const O=t.readSync(o.dataId),D=qe(o.shape,o.dtype,O),A=SX(g,D,S,C);N=t.makeTensorInfo(y,o.dtype,A.values)}else{const O=new ite(C,S,g);N=t.runWebGLProgram(O,[o],o.dtype)}const R=Ie({inputs:{x:N},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo(N),R}const lte={kernelName:Mx,backendName:"webgl",kernelFunc:ate};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ute(n){const{inputs:e,backend:t,attrs:s}=n,{separator:o,nGramWidths:r,leftPad:i,rightPad:a,padWidth:u,preserveShortSequences:d}=s,{data:h,dataSplits:p}=e,f=t.readSync(h.dataId),g=t.readSync(p.dataId),[y,b]=$X(f,g,o,r,i,a,u,d);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(p.shape,"int32",b)]}const cte={kernelName:OI,backendName:"webgl",kernelFunc:ute};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:o}=s,{input:r,delimiter:i}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(r.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=t.readSync(r.dataId),u=t.readSync(i.dataId)[0],[d,h,p]=NX(a,u,o),f=h.length;return[t.makeTensorInfo([f,2],"int32",d),t.makeTensorInfo([f],"string",h),t.makeTensorInfo([2],"int32",new Int32Array(p))]}const hte={kernelName:LI,backendName:"webgl",kernelFunc:dte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pte(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:o}=s,{input:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const i=t.readSync(r.dataId),a=TX(i,o);return t.makeTensorInfo(r.shape,"int32",a)}const fte={kernelName:MI,backendName:"webgl",kernelFunc:pte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mte="return tan(x);",gte=ot({opSnippet:mte}),yte={kernelName:ac,backendName:"webgl",kernelFunc:gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xte=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,bte=ot({opSnippet:xte}),vte={kernelName:lc,backendName:"webgl",kernelFunc:bte};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(n){const{inputs:e,backend:t,attrs:s}=n,{tensor:o,indices:r,updates:i}=e,{sliceRank:a,numUpdates:u,sliceSize:d,strides:h,outputSize:p}=Oi(i,r,o.shape),f=[p/d,d];if(p===0)return t.makeTensorInfo(o.shape,r.dtype);const g=Ie({inputs:{x:r},backend:t,attrs:{shape:[u,a]}}),y=Ie({inputs:{x:i},backend:t,attrs:{shape:[u,d]}}),b=Ie({inputs:{x:o},backend:t,attrs:{shape:f}}),v=new D1(u,a,g.shape.length,y.shape.length,h,f,!1,!0),w=t.runWebGLProgram(v,[y,g,b],b.dtype),C=Ie({inputs:{x:w},backend:t,attrs:{shape:o.shape}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(w),C}const kte={kernelName:TI,backendName:"webgl",kernelFunc:wte};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cte{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*t[i];this.outputShape=s,this.rank=s.length;const o=yt(this.rank),r=Ite(e);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        setOutput(getA(${r}));
      }
    `}}function Ite(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let o=0;o<n.length;o++)s.push(`imod(${t[o]}, ${n[o]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GE(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{reps:r}=s;if(o.dtype==="string"||o.shape.length>5){const u=t.readSync(o.dataId),d=o.dtype==="string"?u.map(f=>Nr(f)):u,h=qe(o.shape,o.dtype,d),p=RX(h,r);return t.makeTensorInfo(p.shape,p.dtype,p.values)}const i=new Cte(o.shape,r);return t.runWebGLProgram(i,[o],o.dtype)}const Ste={kernelName:uc,backendName:"webgl",kernelFunc:GE};class $te{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Nte{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oi(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function $C(n){let e=1;for(;e<n;)e*=2;return e}function Tte(n){const{inputs:e,backend:t,attrs:s}=n,{x:o}=e,{k:r,sorted:i}=s,a=ae().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=ae().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),d=o.shape,h=d[d.length-1];if(t.shouldExecuteOnCPU([o])||h<a||r>u){const A=t.readSync(o.dataId),[T,B]=AX(A,d,o.dtype,r,i);return[t.makeTensorInfo(T.shape,T.dtype,T.values),t.makeTensorInfo(B.shape,B.dtype,B.values)]}if(r===0)return d[d.length-1]=0,[t.makeTensorInfo(d,o.dtype,[]),t.makeTensorInfo(d,"int32",[])];if(h===1)return[o,Dc({attrs:{shape:d,dtype:"int32",value:0},backend:t})];const p=t.texData.get(o.dataId),f=p!==null&&p.isPacked,g=f?t.unpackTensor(o):o,b=de(d)/h,v=Ie({inputs:{x:g},attrs:{shape:[b,h]},backend:t});f&&oi(t,g);const w=$C(r),C=$C(h);let $=null;const S=()=>$===null?[v,v]:[v,$],N=(A,T,B)=>{const U=S(),Q=new $te(B),J=[[h],[$===null?1:0],[Number.NEGATIVE_INFINITY],[A],[T]],te=$;$=t.runWebGLProgram(Q,U,"int32",J),oi(t,te)};for(let A=1;A<w;A*=2){const T=A*2;for(let B=A;B>=1;B/=2)N(T,B,[b,C])}for(let A=C;A>w;A/=2){const T=S(),B=new Nte([b,A/2]),Q=[[h],[$===null?1:0],[w]],K=$;$=t.runWebGLProgram(B,T,"int32",Q),oi(t,K);const J=w/2,te=J*2;for(let P=J;P>=1;P/=2)N(te,P,$.shape)}let R=$;$=nl({inputs:{x:$},backend:t,attrs:{begin:0,size:[b,r]}}),oi(t,R);let F=LE({inputs:{x:v,indices:$},backend:t,attrs:{axis:1,batchDims:1}});oi(t,v);const O=d.slice(0,-1);O.push(r),R=$,$=Ie({inputs:{x:$},attrs:{shape:O},backend:t}),oi(t,R);const D=F;return F=Ie({inputs:{x:F},attrs:{shape:O},backend:t}),oi(t,D),[F,$]}const Ete={kernelName:Px,backendName:"webgl",kernelFunc:Tte};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rte{constructor(e,t,s,o,r,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=s==="nearest"?1:2;let u;switch(o){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${u} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${r});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${r});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(n){const{inputs:e,backend:t,attrs:s}=n,{image:o,transforms:r}=e,{interpolation:i,fillMode:a,fillValue:u,outputShape:d}=s,[h,p,f,g]=o.shape,[y,b]=d??[p,f],v=[h,y,b,g],w=new Rte(p,f,i,a,u,v);return t.runWebGLProgram(w,[o,r],"float32")}const Dte={kernelName:zx,backendName:"webgl",kernelFunc:Ate};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(n){const{inputs:e,attrs:t,backend:s}=n,{axis:o}=t,{x:r}=e;Ec(r,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(r.dataId),{outputValues:a,outputShape:u,indices:d}=DX(i,o,r.shape,r.dtype);return[s.makeTensorInfo(u,r.dtype,a),s.makeTensorInfo([d.length],"int32",d)]}const _te={kernelName:Bx,backendName:"webgl",kernelFunc:Fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ote(n){const{inputs:e,backend:t,attrs:s}=n,{value:o}=e;let{axis:r}=s;r<0&&(r+=o.shape.length);const i=o,a=i.shape.length,u=o.shape[r],d=new Array(a-1);let h=0;for(let b=0;b<a;b++)b!==r&&(d[h++]=i.shape[b]);const p=[],f=new Array(a).fill(0),g=i.shape.slice();g[r]=1;const y=new Array(u);for(let b=0;b<y.length;b++){f[r]=b;const v=nl({inputs:{x:i},backend:t,attrs:{begin:f,size:g}}),w=Ie({inputs:{x:v},backend:t,attrs:{shape:d}});y[b]=w,p.push(v)}return p.forEach(b=>t.disposeIntermediateTensorInfo(b)),y}const Lte={kernelName:Gp,backendName:"webgl",kernelFunc:Ote};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mte{constructor(e,t){this.variableNames=["x","segmentIds"];const s=e.windowSize,o=e.batchSize,r=e.inSize,i=e.numSegments,a=i*Math.ceil(r/s);this.outputShape=[o,a];const u="0.0",d="sumValue",h=Math.floor(s/4)*4,p=s%4,f=`
        sumValue += dot(values, segFilter);
    `;let g="";r%s>0&&(g=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return initializationValue;
        }
      `);let y="";r%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${u};

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${y}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${f}
        }

        int inIdx = inOffset + ${h};
        if (${p===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${f}
        } else if (${p===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${f}
        } else if (${p===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${f}
        }
        setOutput(${d});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pte(n){const{inputs:e,backend:t,attrs:s}=n,{x:o,segmentIds:r}=e,{numSegments:i}=s,a=o.shape.length,u=[];let d=0;const h=Dt([d],a);let p=o;h!=null&&(p=Fn({inputs:{x:o},backend:t,attrs:{perm:h}}),u.push(p),d=zt(1,a)[0]);const f=$$(p.shape,d,i),g=de([p.shape[d]]),y=Ie({inputs:{x:p},backend:t,attrs:{shape:[-1,g]}});u.push(y);const b=Vx(o.dtype),v=(S,N,R,F,O)=>{const D=S.shape[0],A=S.shape[1],T=S$(A,O),B={windowSize:T,inSize:A,batchSize:D,numSegments:O},U=new Mte(B,N),Q=t.compileAndRun(U,[S,R],F);if(u.push(Q),Q.shape[1]===O)return Q;const K=UE({backend:t,attrs:{start:0,stop:O,step:1,dtype:"float32"}}),J=GE({inputs:{x:K},backend:t,attrs:{reps:[A/T]}});return u.push(K),u.push(J),v(Q,N,J,F,O)},w=v(y,"unsortedSegmentSum",r,b,i),C=Ie({inputs:{x:w},backend:t,attrs:{shape:f}});let $=C;if(h!=null){u.push(C);const S=Lr(h);$=Fn({inputs:{x:$},backend:t,attrs:{perm:S}})}return u.forEach(S=>t.disposeIntermediateTensorInfo(S)),$}const zte={kernelName:jp,backendName:"webgl",kernelFunc:Pte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bte=[C8,S8,T8,A8,F8,L8,P8,B8,G8,H8,X8,J8,t7,r7,l7,c7,h7,g7,x7,v7,I7,A7,F7,M7,z7,j7,q7,Q7,i8,e9,r9,u9,m9,x9,v9,k9,I9,T9,A9,_9,L9,P9,B9,U9,j9,X9,Q9,eY,sY,rY,uY,pY,yY,vY,CY,IY,$Y,TY,RY,DY,_Y,PY,WY,GY,HY,XY,JY,nQ,iQ,r8,lQ,s9,dQ,fQ,yQ,l8,wQ,SQ,NQ,AQ,_Q,PQ,WQ,jQ,XQ,JQ,eJ,oJ,iJ,lJ,hJ,fJ,gJ,xJ,vJ,IJ,TJ,DJ,BJ,d8,GJ,qJ,YJ,ZJ,W7,nZ,oZ,iZ,uZ,pZ,c8,mZ,yZ,bZ,wZ,kZ,V7,LJ,SZ,EZ,FZ,p8,MZ,BZ,GZ,qZ,QZ,ZZ,nee,ree,lee,dee,fee,yee,wee,Iee,Tee,Aee,E7,PJ,_ee,Lee,Pee,Bee,Vee,Gee,Hee,Kee,Yee,Zee,tte,ste,rte,lte,cte,hte,fte,MJ,v8,yte,vte,kte,Ste,Ete,Dte,w8,_te,Lte,zte,sZ];for(const n of Bte)zI(n);const Wte=JSON.parse(`[{"tag":"saludo_es","patterns":["¡Hola!","¿Cómo estás?","Buenas tardes","Hola, ¿qué tal?","Hey!","¡Qué tal!"],"responses":["¡Hola! ¿En qué puedo ayudarte?","¡Hola! ¿Cómo puedo asistirte hoy?","¡Hola! ¿En qué te puedo ayudar?"]},{"tag":"saludo_en","patterns":["Hello","Hi","How are you?","Good morning","Hey there"],"responses":["Hi! How can I assist you today?","Hello! How can I help you?","Hey! How can I help you?"]},{"tag":"goodbye_es","patterns":["Adiós","Hasta luego","Nos vemos","Bye"],"responses":["¡Hasta luego!","¡Adiós! Que tengas un buen día.","¡Nos vemos pronto!"]},{"tag":"goodbye_en","patterns":["Goodbye","See you later","Take care","Farewell"],"responses":["Goodbye! Have a great day.","See you soon!","Take care!"]},{"tag":"gracias_es","patterns":["Gracias","Muchas gracias","Te agradezco"],"responses":["¡De nada!","¡Con gusto!","¡Es un placer ayudarte!"]},{"tag":"gracias_en","patterns":["Thank you","Thanks","I appreciate it"],"responses":["You're welcome!","No problem, happy to help!","Anytime!"]},{"tag":"informacion_es","patterns":["¿Qué es la inteligencia artificial?","¿Qué es IA?","¿Qué es un chatbot?"],"responses":["La inteligencia artificial (IA) es un área de la informática que se centra en crear máquinas que pueden realizar tareas que requieren inteligencia humana.","La IA es una rama de la ciencia de la computación que permite a las máquinas imitar comportamientos humanos."]},{"tag":"informacion_en","patterns":["What is artificial intelligence?","Tell me about AI","What does AI mean?","Explain AI","What is a chatbot?"],"responses":["Artificial intelligence (AI) is the simulation of human intelligence in machines. It allows them to perform tasks that typically require human intelligence.","AI refers to the ability of machines to learn, reason, and perform tasks that normally require human intelligence."]},{"tag":"ayuda_es","patterns":["¿Puedes ayudarme?","Necesito ayuda","¿Me puedes asistir?"],"responses":["Claro, ¿cómo puedo ayudarte?","Por supuesto, ¿en qué necesitas ayuda?","¡Estoy aquí para ayudarte! ¿Qué necesitas?"]},{"tag":"ayuda_en","patterns":["Can you help me?","I need help","I need assistance","Can you assist me?"],"responses":["Of course! How can I assist you today?","I'm here to help! What do you need assistance with?","How can I help you?"]},{"tag":"chiste_es","patterns":["Dime un chiste","¿Puedes contarme un chiste?","Hazme reír","Cuéntame algo gracioso"],"responses":["¿Por qué los matemáticos odian el otoño? Porque las hojas se caen.","¿Qué hace una abeja en el gimnasio? ¡Zum-ba!","¿Por qué las computadoras nunca se broncean? Porque siempre trabajan en la nube.","¿Qué le dice un bit al otro bit? Nos vemos en el bus.","¿Por qué la escoba está feliz? Porque va barriendo con todo.","¿Por qué el libro de matemáticas estaba triste? ¡Porque tenía muchos problemas!","¿Qué hace un perro con un taladro? ¡Taladrando!","¿Por qué los peces no juegan al escondite? Porque siempre se encuentran en el agua.","¿Cómo se despide un químico? ¡Átomo luego!","¿Qué le dice una impresora a otra? ¿Esa hoja es tuya o es una copia?","¿Por qué el semáforo no habla? Porque está cambiando.","¿Cómo se llama el pez más divertido? ¡El pez payaso!","¿Qué hace un pájaro en la panadería? ¡Pi-pi-pi!","¿Qué dijo un cable al otro? ¡Somos una conexión perfecta!","¿Por qué los programas de computadora son malos para el gimnasio? Porque siempre tienen bugs."]},{"tag":"chiste_en","patterns":["Tell me a joke","Can you tell me a joke?","Make me laugh","Tell me something funny"],"responses":["Why do mathematicians hate autumn? Because the leaves are falling.","What does a bee do in the gym? Buzz!","Why do computers never tan? Because they always work in the cloud.","What does one bit say to another bit? See you on the bus.","Why is the broom happy? Because it sweeps everything away.","Why was the math book sad? Because it had a lot of problems!","What does a dog do with a drill? Drilling!","Why don't fish play hide and seek? Because they always meet in the water.","How does a chemist say goodbye? Atom later!","What does one printer say to another? Is that sheet of paper yours or is it a copy?","Why doesn't the traffic light talk? Because it's changing.","What is the name of the funniest fish? The clown fish!","What is a bird doing in the bakery? Pee-pee-pee!","What did one cable say to the other? We are a perfect connection!","Why are computer programs bad for the gym? Because they always have bugs."]},{"tag":"joke_es","patterns":["Dime un chiste","¿Puedes contarme un chiste?","Hazme reír","Cuéntame algo gracioso"],"responses":["¿Por qué los matemáticos odian el otoño? Porque las hojas se caen.","¿Qué hace una abeja en el gimnasio? ¡Zum-ba!","¿Por qué las computadoras nunca se broncean? Porque siempre trabajan en la nube.","¿Qué le dice un bit al otro bit? Nos vemos en el bus.","¿Por qué la escoba está feliz? Porque va barriendo con todo.","¿Por qué el libro de matemáticas estaba triste? ¡Porque tenía muchos problemas!","¿Qué hace un perro con un taladro? ¡Taladrando!","¿Por qué los peces no juegan al escondite? Porque siempre se encuentran en el agua.","¿Cómo se despide un químico? ¡Átomo luego!","¿Qué le dice una impresora a otra? ¿Esa hoja es tuya o es una copia?","¿Por qué el semáforo no habla? Porque está cambiando.","¿Cómo se llama el pez más divertido? ¡El pez payaso!","¿Qué hace un pájaro en la panadería? ¡Pi-pi-pi!","¿Qué dijo un cable al otro? ¡Somos una conexión perfecta!","¿Por qué los programas de computadora son malos para el gimnasio? Porque siempre tienen bugs."]},{"tag":"joke_en","patterns":["Tell me a joke","Can you tell me a joke?","Make me laugh","Tell me something funny"],"responses":["Why do mathematicians hate autumn? Because the leaves are falling.","What does a bee do in the gym? Buzz!","Why do computers never tan? Because they always work in the cloud.","What does one bit say to another bit? See you on the bus.","Why is the broom happy? Because it sweeps everything away.","Why was the math book sad? Because it had a lot of problems!","What does a dog do with a drill? Drilling!","Why don't fish play hide and seek? Because they always meet in the water.","How does a chemist say goodbye? Atom later!","What does one printer say to another? Is that sheet of paper yours or is it a copy?","Why doesn't the traffic light talk? Because it's changing.","What is the name of the funniest fish? The clown fish!","What is a bird doing in the bakery? Pee-pee-pee!","What did one cable say to the other? We are a perfect connection!","Why are computer programs bad for the gym? Because they always have bugs."]},{"tag":"pelicula_es","patterns":["Recomiéndame películas","Háblame de películas famosas","¿Cuáles son las mejores películas?","Dame información sobre películas populares","¿Qué películas debería ver?"],"responses":["Si te gustan las aventuras, te recomiendo 'Indiana Jones', una de las franquicias más icónicas de acción y aventura.","Si prefieres la ciencia ficción, no te puedes perder 'Star Wars', que revolucionó el cine y sigue siendo una saga legendaria.","En el cine de terror, 'El Exorcista' es una de las películas más aterradoras de todos los tiempos.","Para una película de superhéroes, 'Avengers: Endgame' es un épico cierre para el universo Marvel.","Si te interesan las historias dramáticas, 'La Lista de Schindler' es una poderosa película sobre el Holocausto.","Si eres fanático de la comedia, 'La Vida de Brian' de Monty Python es una de las más divertidas de todos los tiempos.","En el género de animación, 'El Rey León' es una obra maestra de Disney que sigue siendo popular a través de los años.","Si te gustan las películas de suspenso, 'El Sexto Sentido' de M. Night Shyamalan tiene un giro final inolvidable.","La película 'Titanic' se convirtió en un clásico romántico y es una de las más taquilleras de todos los tiempos.","En el cine de terror psicológico, 'El Resplandor' de Stanley Kubrick es una obra maestra con una atmósfera única.","Para un thriller de acción, 'Inception' de Christopher Nolan es un juego mental visualmente impresionante.","En el género de fantasía, 'El Señor de los Anillos' es una trilogía épica que ha dejado una huella en el cine moderno.","Si prefieres una película de acción, 'Mad Max: Fury Road' es un espectáculo visual con un ritmo frenético.","¿Buscas algo más específico? Puedo recomendarte películas por género: drama, terror, comedia, ciencia ficción, etc."]},{"tag":"pelicula_en","patterns":["Recommend movies to me","Tell me about famous movies","What are the best movies?","Give me information about popular movies","What movies should I watch?"],"responses":["If you like adventures, I recommend 'Indiana Jones', one of the most iconic action-adventure franchises.","If you prefer science fiction, you can't miss 'Star Wars', which revolutionized cinema and remains a legendary saga.","In horror cinema, 'The Exorcist' is one of the scariest movies of all time.","For a superhero movie, 'Avengers: Endgame' is an epic conclusion to the Marvel universe.","If you're interested in dramatic stories, 'Schindler's List' is a powerful film about the Holocaust.","If you're a fan of comedy, Monty Python's 'Life of Brian' is one of the funniest of all time.","In the animation genre, 'The Lion King' is a Disney masterpiece that remains popular through the years.","If you like thrillers, M. Night Shyamalan's 'The Sixth Sense' has an unforgettable final twist.","The film 'Titanic' became a romantic classic and is one of the highest-grossing films of all time.","In psychological horror cinema, Stanley Kubrick's 'The Shining' is a masterpiece with a unique atmosphere.","For an action thriller, Christopher Nolan's 'Inception' is a visually stunning mind game.","In the fantasy genre, 'The Lord of the Rings' is an epic trilogy that has left a mark on modern cinema.","If you prefer an action film, 'Mad Max: Fury Road' is a visual spectacle with a frenetic pace.","Looking for something more specific? I can recommend movies by genre: drama, horror, comedy, sci-fi, etc."]},{"tag":"movie_es","patterns":["Recomiéndame películas","Háblame de películas famosas","¿Cuáles son las mejores películas?","Dame información sobre películas populares","¿Qué películas debería ver?"],"responses":["Si te gustan las aventuras, te recomiendo 'Indiana Jones', una de las franquicias más icónicas de acción y aventura.","Si prefieres la ciencia ficción, no te puedes perder 'Star Wars', que revolucionó el cine y sigue siendo una saga legendaria.","En el cine de terror, 'El Exorcista' es una de las películas más aterradoras de todos los tiempos.","Para una película de superhéroes, 'Avengers: Endgame' es un épico cierre para el universo Marvel.","Si te interesan las historias dramáticas, 'La Lista de Schindler' es una poderosa película sobre el Holocausto.","Si eres fanático de la comedia, 'La Vida de Brian' de Monty Python es una de las más divertidas de todos los tiempos.","En el género de animación, 'El Rey León' es una obra maestra de Disney que sigue siendo popular a través de los años.","Si te gustan las películas de suspenso, 'El Sexto Sentido' de M. Night Shyamalan tiene un giro final inolvidable.","La película 'Titanic' se convirtió en un clásico romántico y es una de las más taquilleras de todos los tiempos.","En el cine de terror psicológico, 'El Resplandor' de Stanley Kubrick es una obra maestra con una atmósfera única.","Para un thriller de acción, 'Inception' de Christopher Nolan es un juego mental visualmente impresionante.","En el género de fantasía, 'El Señor de los Anillos' es una trilogía épica que ha dejado una huella en el cine moderno.","Si prefieres una película de acción, 'Mad Max: Fury Road' es un espectáculo visual con un ritmo frenético.","¿Buscas algo más específico? Puedo recomendarte películas por género: drama, terror, comedia, ciencia ficción, etc."]},{"tag":"movie_en","patterns":["Recommend movies to me","Tell me about famous movies","What are the best movies?","Give me information about popular movies","What movies should I watch?"],"responses":["If you like adventures, I recommend 'Indiana Jones', one of the most iconic action-adventure franchises.","If you prefer science fiction, you can't miss 'Star Wars', which revolutionized cinema and remains a legendary saga.","In horror cinema, 'The Exorcist' is one of the scariest movies of all time.","For a superhero movie, 'Avengers: Endgame' is an epic conclusion to the Marvel universe.","If you're interested in dramatic stories, 'Schindler's List' is a powerful film about the Holocaust.","If you're a fan of comedy, Monty Python's 'Life of Brian' is one of the funniest of all time.","In the animation genre, 'The Lion King' is a Disney masterpiece that remains popular through the years.","If you like thrillers, M. Night Shyamalan's 'The Sixth Sense' has an unforgettable final twist.","The film 'Titanic' became a romantic classic and is one of the highest-grossing films of all time.","In psychological horror cinema, Stanley Kubrick's 'The Shining' is a masterpiece with a unique atmosphere.","For an action thriller, Christopher Nolan's 'Inception' is a visually stunning mind game.","In the fantasy genre, 'The Lord of the Rings' is an epic trilogy that has left a mark on modern cinema.","If you prefer an action film, 'Mad Max: Fury Road' is a visual spectacle with a frenetic pace.","Looking for something more specific? I can recommend movies by genre: drama, horror, comedy, sci-fi, etc."]},{"tag":"flor_es","patterns":["Háblame de flores","¿Cuáles son las flores más populares?","Recomiéndame algunas flores bonitas","¿Qué flores son ideales para un jardín?","Cuéntame sobre flores de colores"],"responses":["Las rosas son una de las flores más populares, conocidas por su belleza y variedad de colores. Son símbolos de amor y pasión.","Los girasoles son flores grandes y brillantes que siguen al sol. Son símbolos de felicidad y lealtad.","Las tulipanes son muy apreciadas por su simplicidad y colores vibrantes. Son populares en primavera.","Las orquídeas son flores elegantes y exóticas, a menudo asociadas con el lujo y la belleza refinada.","Las margaritas son flores sencillas pero encantadoras, con pétalos blancos y un centro amarillo. Simbolizan la pureza y la inocencia.","Los lirios son flores fragantes y hermosas, conocidas por su elegancia. Se asocian con la renovación y la pureza.","Las peonías son flores grandes y coloridas, muy apreciadas en jardines debido a su belleza y su aroma dulce.","Los tulipanes vienen en una variedad de colores, incluidos rojo, rosa, blanco, y amarillo, y son muy populares en jardines durante la primavera.","Las violetas son pequeñas flores delicadas con un aroma sutil, a menudo asociadas con la modestia y la lealtad.","Las azucenas son flores grandes y fragantes que se encuentran comúnmente en tonos de blanco, amarillo y naranja, conocidas por su belleza y elegancia.","Las lavandas tienen un aroma encantador y se utilizan tanto en jardines como en aceites esenciales. Son conocidas por sus propiedades relajantes.","Las lilas son flores con tonos de morado y blanco, que florecen en primavera. Son símbolos de la belleza y el primer amor.","Si te gustan las flores para interiores, las violetas africanas son una excelente opción, conocidas por sus colores vibrantes y fáciles de cuidar.","Los crisantemos son flores populares en otoño, con una gran variedad de colores y formas, y son símbolos de longevidad y salud."]},{"tag":"flor_en","patterns":["Tell me about flowers","What are the most popular flowers?","Recommend me some pretty flowers","What flowers are ideal for a garden?","Tell me about colorful flowers"],"responses":["Roses are one of the most popular flowers, known for their beauty and variety of colors. They are symbols of love and passion.","Sunflowers are large, bright flowers that follow the sun. They are symbols of happiness and loyalty.","Tulips are highly prized for their simplicity and vibrant colors. They are popular in spring.","Orchids are elegant and exotic flowers, often associated with luxury and refined beauty.","Daisies are simple yet lovely flowers, with white petals and a yellow center. They symbolize purity and innocence.","Lilies are fragrant and beautiful flowers, known for their elegance. They are associated with renewal and purity.","Peonies are large, colorful flowers, highly prized in gardens because of their beauty and sweet scent.","Tulips come in a variety of colors, including red, pink, white, and yellow, and are very popular in gardens during spring.","Violets are delicate little flowers with a subtle scent, Often associated with modesty and loyalty.","Lilies are large, fragrant flowers commonly found in shades of white, yellow, and orange, known for their beauty and elegance.","Lavenders have a lovely scent and are used in both gardens and essential oils. They are known for their relaxing properties.","Lilacs are flowers with shades of purple and white, which bloom in spring. They are symbols of beauty and first love.","If you like indoor flowers, African violets are a great choice, known for their vibrant colors and easy care.","Chrysanthemums are popular fall flowers, with a wide variety of colors and shapes, and are symbols of longevity and health."]},{"tag":"flower_es","patterns":["Háblame de flores","¿Cuáles son las flores más populares?","Recomiéndame algunas flores bonitas","¿Qué flores son ideales para un jardín?","Cuéntame sobre flores de colores"],"responses":["Las rosas son una de las flores más populares, conocidas por su belleza y variedad de colores. Son símbolos de amor y pasión.","Los girasoles son flores grandes y brillantes que siguen al sol. Son símbolos de felicidad y lealtad.","Las tulipanes son muy apreciadas por su simplicidad y colores vibrantes. Son populares en primavera.","Las orquídeas son flores elegantes y exóticas, a menudo asociadas con el lujo y la belleza refinada.","Las margaritas son flores sencillas pero encantadoras, con pétalos blancos y un centro amarillo. Simbolizan la pureza y la inocencia.","Los lirios son flores fragantes y hermosas, conocidas por su elegancia. Se asocian con la renovación y la pureza.","Las peonías son flores grandes y coloridas, muy apreciadas en jardines debido a su belleza y su aroma dulce.","Los tulipanes vienen en una variedad de colores, incluidos rojo, rosa, blanco, y amarillo, y son muy populares en jardines durante la primavera.","Las violetas son pequeñas flores delicadas con un aroma sutil, a menudo asociadas con la modestia y la lealtad.","Las azucenas son flores grandes y fragantes que se encuentran comúnmente en tonos de blanco, amarillo y naranja, conocidas por su belleza y elegancia.","Las lavandas tienen un aroma encantador y se utilizan tanto en jardines como en aceites esenciales. Son conocidas por sus propiedades relajantes.","Las lilas son flores con tonos de morado y blanco, que florecen en primavera. Son símbolos de la belleza y el primer amor.","Si te gustan las flores para interiores, las violetas africanas son una excelente opción, conocidas por sus colores vibrantes y fáciles de cuidar.","Los crisantemos son flores populares en otoño, con una gran variedad de colores y formas, y son símbolos de longevidad y salud."]},{"tag":"flower_en","patterns":["Tell me about flowers","What are the most popular flowers?","Recommend me some pretty flowers","What flowers are ideal for a garden?","Tell me about colorful flowers"],"responses":["Roses are one of the most popular flowers, known for their beauty and variety of colors. They are symbols of love and passion.","Sunflowers are large, bright flowers that follow the sun. They are symbols of happiness and loyalty.","Tulips are highly prized for their simplicity and vibrant colors. They are popular in spring.","Orchids are elegant and exotic flowers, often associated with luxury and refined beauty.","Daisies are simple yet lovely flowers, with white petals and a yellow center. They symbolize purity and innocence.","Lilies are fragrant and beautiful flowers, known for their elegance. They are associated with renewal and purity.","Peonies are large, colorful flowers, highly prized in gardens because of their beauty and sweet scent.","Tulips come in a variety of colors, including red, pink, white, and yellow, and are very popular in gardens during spring.","Violets are delicate little flowers with a subtle scent, Often associated with modesty and loyalty.","Lilies are large, fragrant flowers commonly found in shades of white, yellow, and orange, known for their beauty and elegance.","Lavenders have a lovely scent and are used in both gardens and essential oils. They are known for their relaxing properties.","Lilacs are flowers with shades of purple and white, which bloom in spring. They are symbols of beauty and first love.","If you like indoor flowers, African violets are a great choice, known for their vibrant colors and easy care.","Chrysanthemums are popular fall flowers, with a wide variety of colors and shapes, and are symbols of longevity and health."]},{"tag":"color_es","patterns":["Háblame de colores","¿Cuáles son los colores más comunes?","Dime sobre los colores y su significado","¿Qué simboliza el color rojo?","¿Qué colores combinan bien?"],"responses":["El color rojo es asociado con la pasión, el amor y la energía. También puede representar peligro o advertencia.","El color azul simboliza la calma, la serenidad y la confianza. Es un color popular en el diseño de interiores y ropa.","El color verde está relacionado con la naturaleza, el crecimiento y la renovación. Es un color que transmite equilibrio y frescura.","El color amarillo es brillante y alegre, asociado con la felicidad, la creatividad y la luz del sol.","El color negro es elegante y sofisticado, pero también puede representar oscuridad o misterio.","El blanco es un color que simboliza pureza, paz y simplicidad. Es comúnmente utilizado en bodas y celebraciones.","El color morado está relacionado con la realeza, el lujo y la espiritualidad. También simboliza la creatividad y la sabiduría.","El color naranja combina la energía del rojo y la alegría del amarillo, asociado con el entusiasmo, la vitalidad y la creatividad.","El color rosa es un color suave y romántico, relacionado con el amor, la dulzura y la ternura.","El color marrón es un color terroso que simboliza la estabilidad, la confiabilidad y la naturaleza.","El color gris es neutral y puede simbolizar equilibrio, profesionalismo y elegancia. A veces se asocia con la tristeza.","El color turquesa se asocia con la tranquilidad, la frescura y la serenidad. Es un color que combina el azul y el verde.","El color plateado simboliza sofisticación, modernidad y elegancia. Se utiliza a menudo para representar tecnología y lujo.","El color dorado es un color de lujo, riqueza y éxito. A menudo se asocia con la opulencia y el logro.","En cuanto a combinaciones, los colores complementarios como el azul y el naranja, o el rojo y el verde, crean contrastes vibrantes.","Colores como el blanco y el negro pueden combinarse fácilmente y crear un look elegante y atemporal. También puedes combinar colores como el azul y el gris para un estilo más profesional."]},{"tag":"color_en","patterns":["Tell me about colors","What are the most common colors?","Tell me about colors and their meaning","What does the color red symbolize?","What colors go well together?"],"responses":["The color red is associated with passion, love and energy. It can also represent danger or warning.","The color blue symbolizes calm, serenity and confidence. It is a popular color in interior design and clothing.","The color green is related to nature, growth and renewal. It is a color that conveys balance and freshness.","The color yellow is bright and cheerful, associated with happiness, creativity and sunlight.","The color black is elegant and sophisticated, but can also represent darkness or mystery.","White is a color that symbolizes purity, peace and simplicity. It is commonly used in weddings and celebrations.","The color purple is related to royalty, luxury and spirituality. It also symbolizes creativity and wisdom.","The color orange combines the energy of red and the joy of yellow, associated with enthusiasm, vitality and creativity.","The color pink is a soft and romantic color, related to love, sweetness and tenderness.","The color brown is a color that symbolizes Earthy color that symbolizes stability, reliability, and nature.","The color gray is neutral and can symbolize balance, professionalism, and elegance. It is sometimes associated with sadness.","The color turquoise is associated with tranquility, freshness, and serenity. It is a color that combines blue and green.","The color silver symbolizes sophistication, modernity, and elegance. It is often used to represent technology and luxury.","The color gold is a color of luxury, wealth, and success. It is often associated with opulence and achievement.","As for combinations, complementary colors like blue and orange, or red and green, create vibrant contrasts.","Colors like black and white can easily be combined and create an elegant and timeless look. You can also combine colors like blue and gray for a more professional style."]},{"tag":"maquillaje_es","patterns":["Háblame de maquillaje","¿Cómo puedo maquillarme?","Recomiéndame tips de maquillaje","¿Qué productos de maquillaje son esenciales?","¿Cómo puedo hacer un maquillaje natural?"],"responses":["El maquillaje es una forma de arte que permite resaltar las características faciales y expresar la creatividad.","Si buscas un maquillaje natural, opta por bases ligeras, correctores para disimular imperfecciones, y sombras neutras. Un toque de iluminador en puntos estratégicos y un bálsamo labial para un look fresco.","Para un maquillaje de noche, puedes elegir tonos más intensos en los ojos, como sombras oscuras o ahumadas, y un labial de color vibrante. Asegúrate de aplicar varias capas de máscara para un acabado dramático.","Algunos productos esenciales en un set básico de maquillaje son: base o BB cream, corrector, polvo compacto, sombras neutras, máscara de pestañas, delineador, rubor y un labial.","Si quieres un maquillaje duradero, es importante aplicar un primer antes de la base, usar productos en polvo para sellar el maquillaje y un fijador para mantenerlo todo en su lugar durante el día.","El 'contouring' o esculpido es una técnica popular para definir los pómulos, la nariz y la mandíbula. Utiliza un bronzer o polvo oscuro para sombrear las áreas que quieras reducir y un iluminador para resaltar las áreas que quieras enfatizar.","Para un maquillaje de ojos impactante, puedes probar un look de 'smokey eyes', que se logra difuminando sombras oscuras en el párpado móvil y aplicando un delineado en la línea de agua para intensificar la mirada.","Si tienes piel grasa, elige productos mate que controlen el brillo. Para piel seca, busca fórmulas hidratantes y bases con acabado luminoso.","Los tonos de labios pueden variar dependiendo de la ocasión: los tonos nude son ideales para el día a día, mientras que los rojos o burdeos aportan elegancia para la noche."]},{"tag":"maquillaje_en","patterns":["Tell me about makeup","How can I apply makeup?","Recommend makeup tips","What makeup products are essential?","How can I do natural makeup?"],"responses":["Makeup is an art form that allows you to highlight your facial features and express your creativity.","If you're looking for a natural makeup look, go for light foundations, concealers to hide imperfections, and neutral eyeshadows. A touch of highlighter in strategic spots and a lip balm for a fresh look.","For an evening makeup look, you can choose more intense shades on the eyes, such as dark or smoky eyeshadows, and a vibrant lipstick. Make sure to apply several layers of mascara for a dramatic finish.","Some essential products in a basic makeup set are: foundation or BB cream, concealer, compact powder, neutral eyeshadows, mascara, eyeliner, blush, and a lipstick.","If you want long-lasting makeup, it's important to apply a primer before foundation, use powder products to seal the makeup, and a setting spray to keep everything in place throughout the day.","Contouring or sculpting is a popular technique to define the eyes. cheekbones, nose and jawline. Use a bronzer or dark powder to shade the areas you want to reduce and a highlighter to highlight the areas you want to emphasize.","For a striking eye makeup, you can try a 'smokey eyes' look, which is achieved by blending dark shadows on the mobile eyelid and applying a liner on the waterline to intensify the look.","If you have oily skin, choose matte products that control shine. For dry skin, look for moisturizing formulas and foundations with a luminous finish.","Lip shades can vary depending on the occasion: nude shades are ideal for day to day, while reds or burgundies add elegance for the night."]},{"tag":"make-up_es","patterns":["Háblame de maquillaje","¿Cómo puedo maquillarme?","Recomiéndame tips de maquillaje","¿Qué productos de maquillaje son esenciales?","¿Cómo puedo hacer un maquillaje natural?"],"responses":["El maquillaje es una forma de arte que permite resaltar las características faciales y expresar la creatividad.","Si buscas un maquillaje natural, opta por bases ligeras, correctores para disimular imperfecciones, y sombras neutras. Un toque de iluminador en puntos estratégicos y un bálsamo labial para un look fresco.","Para un maquillaje de noche, puedes elegir tonos más intensos en los ojos, como sombras oscuras o ahumadas, y un labial de color vibrante. Asegúrate de aplicar varias capas de máscara para un acabado dramático.","Algunos productos esenciales en un set básico de maquillaje son: base o BB cream, corrector, polvo compacto, sombras neutras, máscara de pestañas, delineador, rubor y un labial.","Si quieres un maquillaje duradero, es importante aplicar un primer antes de la base, usar productos en polvo para sellar el maquillaje y un fijador para mantenerlo todo en su lugar durante el día.","El 'contouring' o esculpido es una técnica popular para definir los pómulos, la nariz y la mandíbula. Utiliza un bronzer o polvo oscuro para sombrear las áreas que quieras reducir y un iluminador para resaltar las áreas que quieras enfatizar.","Para un maquillaje de ojos impactante, puedes probar un look de 'smokey eyes', que se logra difuminando sombras oscuras en el párpado móvil y aplicando un delineado en la línea de agua para intensificar la mirada.","Si tienes piel grasa, elige productos mate que controlen el brillo. Para piel seca, busca fórmulas hidratantes y bases con acabado luminoso.","Los tonos de labios pueden variar dependiendo de la ocasión: los tonos nude son ideales para el día a día, mientras que los rojos o burdeos aportan elegancia para la noche."]},{"tag":"make-up_en","patterns":["Tell me about makeup","How can I apply makeup?","Recommend makeup tips","What makeup products are essential?","How can I do natural makeup?"],"responses":["Makeup is an art form that allows you to highlight your facial features and express your creativity.","If you're looking for a natural makeup look, go for light foundations, concealers to hide imperfections, and neutral eyeshadows. A touch of highlighter in strategic spots and a lip balm for a fresh look.","For an evening makeup look, you can choose more intense shades on the eyes, such as dark or smoky eyeshadows, and a vibrant lipstick. Make sure to apply several layers of mascara for a dramatic finish.","Some essential products in a basic makeup set are: foundation or BB cream, concealer, compact powder, neutral eyeshadows, mascara, eyeliner, blush, and a lipstick.","If you want long-lasting makeup, it's important to apply a primer before foundation, use powder products to seal the makeup, and a setting spray to keep everything in place throughout the day.","Contouring or sculpting is a popular technique to define the eyes. cheekbones, nose and jawline. Use a bronzer or dark powder to shade the areas you want to reduce and a highlighter to highlight the areas you want to emphasize.","For a striking eye makeup, you can try a 'smokey eyes' look, which is achieved by blending dark shadows on the mobile eyelid and applying a liner on the waterline to intensify the look.","If you have oily skin, choose matte products that control shine. For dry skin, look for moisturizing formulas and foundations with a luminous finish.","Lip shades can vary depending on the occasion: nude shades are ideal for day to day, while reds or burgundies add elegance for the night."]},{"tag":"contabilidad_es","patterns":["Háblame de contabilidad","¿Qué es la contabilidad?","¿Cuáles son los principios de la contabilidad?","¿Qué es un balance general?","Explícame qué es el libro mayor","¿Cómo se hace un estado de resultados?"],"responses":["La contabilidad es la disciplina que se encarga de estudiar, medir y analizar el patrimonio y la situación económica de una empresa u organización. A través de ella, se lleva un registro sistemático de las transacciones financieras.","Algunos principios fundamentales de la contabilidad incluyen: el principio de la entidad económica, el principio de la continuidad, el principio de la uniformidad y el principio de la prudencia.","Un balance general es un estado financiero que muestra la situación económica de una empresa en un momento específico. Se divide en tres partes: activos, pasivos y patrimonio neto.","El libro mayor es un registro contable en el cual se anotan todas las transacciones financieras de una empresa, organizadas por cuentas. Cada cuenta tiene su propio registro, lo que permite un análisis detallado de cada categoría.","El estado de resultados es un informe financiero que muestra los ingresos, costos y gastos de una empresa durante un periodo de tiempo determinado. Ayuda a determinar la rentabilidad de la empresa en ese periodo.","Los estados financieros más comunes incluyen el balance general, el estado de resultados y el estado de flujos de efectivo. Estos informes permiten a los interesados conocer la salud financiera de una empresa.","Un activo es todo aquello que posee un valor económico para la empresa, como el dinero en efectivo, los equipos, las propiedades y las cuentas por cobrar. Los pasivos son las deudas y obligaciones de la empresa, y el patrimonio neto es la diferencia entre los activos y los pasivos, lo que representa el valor residual de la empresa.","En contabilidad, las cuentas se dividen en diferentes categorías como activos, pasivos, ingresos, gastos y patrimonio. Cada transacción afecta una o más de estas cuentas, y se registra en los libros contables de acuerdo con el principio de la partida doble.","El ciclo contable es el proceso completo de registro, clasificación y resumen de las transacciones financieras de una empresa. Este ciclo incluye la recopilación de documentos, el registro en los libros contables, la elaboración de los estados financieros y la auditoría."]},{"tag":"contabilidad_en","patterns":["Tell me about accounting","What is accounting?","What are the principles of accounting?","What is a balance sheet?","Explain to me what the general ledger is","How do you make an income statement?"],"responses":["Accounting is the discipline that is responsible for studying, measuring and analyzing the assets and economic situation of a company or organization. Through it, a systematic record of financial transactions is kept.","Some fundamental principles of accounting include: the principle of the economic entity, the principle of continuity, the principle of uniformity and the principle of prudence.","A balance sheet is a financial statement that shows the economic situation of a company at a specific time. It is divided into three parts: assets, liabilities and net worth.","The general ledger is an accounting record in which all the financial transactions of a company are recorded, organized by accounts. Each account has its own record, which allows a detailed analysis of each category.","The income statement is a financial report that shows the income, costs and expenses of a company during a given period of time. It helps determine the profitability of the company in that period.","The most common financial statements include the balance sheet, the income statement and the cash flow statement. These reports allow stakeholders to understand the financial health of a company.","An asset is anything that has an economic value to the company, such as cash, equipment, property, and accounts receivable. Liabilities are the debts and obligations of the company, and net worth is the difference between assets and liabilities, which represents the residual value of the company.","In accounting, accounts are divided into different categories such as assets, liabilities, income, expenses, and equity. Each transaction affects one or more of these accounts, and is recorded in the accounting books according to the double-entry principle.","The accounting cycle is the complete process of recording, classifying, and summarizing the financial transactions of a company. This cycle includes collecting documents, recording them in the accounting books, preparing financial statements, and auditing."]},{"tag":"accounting_es","patterns":["Háblame de contabilidad","¿Qué es la contabilidad?","¿Cuáles son los principios de la contabilidad?","¿Qué es un balance general?","Explícame qué es el libro mayor","¿Cómo se hace un estado de resultados?"],"responses":["La contabilidad es la disciplina que se encarga de estudiar, medir y analizar el patrimonio y la situación económica de una empresa u organización. A través de ella, se lleva un registro sistemático de las transacciones financieras.","Algunos principios fundamentales de la contabilidad incluyen: el principio de la entidad económica, el principio de la continuidad, el principio de la uniformidad y el principio de la prudencia.","Un balance general es un estado financiero que muestra la situación económica de una empresa en un momento específico. Se divide en tres partes: activos, pasivos y patrimonio neto.","El libro mayor es un registro contable en el cual se anotan todas las transacciones financieras de una empresa, organizadas por cuentas. Cada cuenta tiene su propio registro, lo que permite un análisis detallado de cada categoría.","El estado de resultados es un informe financiero que muestra los ingresos, costos y gastos de una empresa durante un periodo de tiempo determinado. Ayuda a determinar la rentabilidad de la empresa en ese periodo.","Los estados financieros más comunes incluyen el balance general, el estado de resultados y el estado de flujos de efectivo. Estos informes permiten a los interesados conocer la salud financiera de una empresa.","Un activo es todo aquello que posee un valor económico para la empresa, como el dinero en efectivo, los equipos, las propiedades y las cuentas por cobrar. Los pasivos son las deudas y obligaciones de la empresa, y el patrimonio neto es la diferencia entre los activos y los pasivos, lo que representa el valor residual de la empresa.","En contabilidad, las cuentas se dividen en diferentes categorías como activos, pasivos, ingresos, gastos y patrimonio. Cada transacción afecta una o más de estas cuentas, y se registra en los libros contables de acuerdo con el principio de la partida doble.","El ciclo contable es el proceso completo de registro, clasificación y resumen de las transacciones financieras de una empresa. Este ciclo incluye la recopilación de documentos, el registro en los libros contables, la elaboración de los estados financieros y la auditoría."]},{"tag":"accounting_en","patterns":["Tell me about accounting","What is accounting?","What are the principles of accounting?","What is a balance sheet?","Explain to me what the general ledger is","How do you make an income statement?"],"responses":["Accounting is the discipline that is responsible for studying, measuring and analyzing the assets and economic situation of a company or organization. Through it, a systematic record of financial transactions is kept.","Some fundamental principles of accounting include: the principle of the economic entity, the principle of continuity, the principle of uniformity and the principle of prudence.","A balance sheet is a financial statement that shows the economic situation of a company at a specific time. It is divided into three parts: assets, liabilities and net worth.","The general ledger is an accounting record in which all the financial transactions of a company are recorded, organized by accounts. Each account has its own record, which allows a detailed analysis of each category.","The income statement is a financial report that shows the income, costs and expenses of a company during a given period of time. It helps determine the profitability of the company in that period.","The most common financial statements include the balance sheet, the income statement and the cash flow statement. These reports allow stakeholders to understand the financial health of a company.","An asset is anything that has an economic value to the company, such as cash, equipment, property, and accounts receivable. Liabilities are the debts and obligations of the company, and net worth is the difference between assets and liabilities, which represents the residual value of the company.","In accounting, accounts are divided into different categories such as assets, liabilities, income, expenses, and equity. Each transaction affects one or more of these accounts, and is recorded in the accounting books according to the double-entry principle.","The accounting cycle is the complete process of recording, classifying, and summarizing the financial transactions of a company. This cycle includes collecting documents, recording them in the accounting books, preparing financial statements, and auditing."]},{"tag":"deporte_es","patterns":["Háblame de deportes","¿Cuáles son los deportes más populares?","¿Qué deportes se practican en los Juegos Olímpicos?","¿Cuáles son los deportes más antiguos?","¿Qué deportes se juegan en equipo?"],"responses":["Aquí tienes información sobre algunos de los deportes más populares y sus características:'Fútbol' es el deporte más popular del mundo, jugado en equipos de 11 jugadores, cuyo objetivo es meter el balón en la portería contraria. Es especialmente popular en Europa, América Latina y África.","'Baloncesto' es otro deporte muy popular, jugado por dos equipos de cinco jugadores, donde el objetivo es encestar el balón en el aro del equipo contrario. Es muy común en Estados Unidos y Europa.","'Béisbol' es un deporte que se juega con un bate y una pelota, con dos equipos de nueve jugadores cada uno. Es muy popular en países como Estados Unidos, Japón y Cuba.","'Tenis' es un deporte que se juega entre dos jugadores o dos equipos de dos jugadores. Se juega con una raqueta y una pelota, y el objetivo es golpear la pelota para que pase sobre una red y caiga en el campo contrario.","'Atletismo' abarca una serie de disciplinas como carreras, saltos y lanzamientos. Es uno de los deportes más antiguos y se practica en las competiciones de los Juegos Olímpicos.","'Natación' es otro deporte antiguo que se practica en piscinas o en aguas abiertas. Los nadadores compiten en diferentes estilos como libre, espalda, pecho y mariposa.","'Fútbol Americano' es muy popular en Estados Unidos, donde los equipos luchan por avanzar el balón a través del campo mientras evitan que el equipo contrario lo haga.","'Ciclismo' es un deporte que se puede practicar en carretera, montaña o pista, y es conocido por eventos importantes como el Tour de Francia.","'Boxeo' es un deporte de combate en el que dos participantes se enfrentan usando guantes y luchan en un ring. Es un deporte popular en muchas partes del mundo, especialmente en América Latina y los EE. UU.","'Rugby' es un deporte de equipo originado en Inglaterra, en el cual dos equipos compiten por llevar el balón hacia la zona de gol del contrario, sin utilizar una pelota redonda como en el fútbol."]},{"tag":"deporte_en","patterns":["Tell me about sports","What are the most popular sports?","What sports are played in the Olympic Games?","What are the oldest sports?","What sports are played in teams?"],"responses":["Here is some information about some of the most popular sports and their characteristics: 'Soccer' is the most popular sport in the world, played by teams of 11 players, whose objective is to get the ball into the opposing team's goal. It is especially popular in Europe, Latin America and Africa.","'Basketball' is another very popular sport, played by two teams of five players, where the objective is to shoot the ball into the opposing team's hoop. It is very common in the United States and Europe.","'Baseball' is a sport played with a bat and ball, with two teams of nine players each. It is very popular in countries such as the United States, Japan and Cuba.","'Tennis' is a sport played between two players or two teams of two players. It is played with a racket and a ball, and the objective is to hit the ball so that it passes over a net and lands in the opposing field.","'Athletics' covers a number of disciplines such as running, jumping and throwing. It is one of the oldest sports and is practiced in competitions at the Olympic Games.","'Swimming' is another ancient sport that is practiced in pools or open water. Swimmers compete in different styles such as freestyle, backstroke, breaststroke and butterfly.","'American football' is very popular in the United States, where teams fight to advance the ball across the field while preventing the opposing team from doing so.","'Cycling' is a sport that can be practiced on the road, mountain or track, and is known for major events such as the Tour de France.","'Boxing' is a combat sport in which two participants face each other using gloves and fight in a ring. It is a popular sport in many parts of the world, especially in Latin America and the USA.","'Rugby' is a team sport originated in England, in which two teams compete to get the ball into the opponent's goal area, without using a round ball as in soccer."]},{"tag":"sport_es","patterns":["Háblame de deportes","¿Cuáles son los deportes más populares?","¿Qué deportes se practican en los Juegos Olímpicos?","¿Cuáles son los deportes más antiguos?","¿Qué deportes se juegan en equipo?"],"responses":["Aquí tienes información sobre algunos de los deportes más populares y sus características:'Fútbol' es el deporte más popular del mundo, jugado en equipos de 11 jugadores, cuyo objetivo es meter el balón en la portería contraria. Es especialmente popular en Europa, América Latina y África.","'Baloncesto' es otro deporte muy popular, jugado por dos equipos de cinco jugadores, donde el objetivo es encestar el balón en el aro del equipo contrario. Es muy común en Estados Unidos y Europa.","'Béisbol' es un deporte que se juega con un bate y una pelota, con dos equipos de nueve jugadores cada uno. Es muy popular en países como Estados Unidos, Japón y Cuba.","'Tenis' es un deporte que se juega entre dos jugadores o dos equipos de dos jugadores. Se juega con una raqueta y una pelota, y el objetivo es golpear la pelota para que pase sobre una red y caiga en el campo contrario.","'Atletismo' abarca una serie de disciplinas como carreras, saltos y lanzamientos. Es uno de los deportes más antiguos y se practica en las competiciones de los Juegos Olímpicos.","'Natación' es otro deporte antiguo que se practica en piscinas o en aguas abiertas. Los nadadores compiten en diferentes estilos como libre, espalda, pecho y mariposa.","'Fútbol Americano' es muy popular en Estados Unidos, donde los equipos luchan por avanzar el balón a través del campo mientras evitan que el equipo contrario lo haga.","'Ciclismo' es un deporte que se puede practicar en carretera, montaña o pista, y es conocido por eventos importantes como el Tour de Francia.","'Boxeo' es un deporte de combate en el que dos participantes se enfrentan usando guantes y luchan en un ring. Es un deporte popular en muchas partes del mundo, especialmente en América Latina y los EE. UU.","'Rugby' es un deporte de equipo originado en Inglaterra, en el cual dos equipos compiten por llevar el balón hacia la zona de gol del contrario, sin utilizar una pelota redonda como en el fútbol."]},{"tag":"sport_en","patterns":["Tell me about sports","What are the most popular sports?","What sports are played in the Olympic Games?","What are the oldest sports?","What sports are played in teams?"],"responses":["Here is some information about some of the most popular sports and their characteristics: 'Soccer' is the most popular sport in the world, played by teams of 11 players, whose objective is to get the ball into the opposing team's goal. It is especially popular in Europe, Latin America and Africa.","'Basketball' is another very popular sport, played by two teams of five players, where the objective is to shoot the ball into the opposing team's hoop. It is very common in the United States and Europe.","'Baseball' is a sport played with a bat and ball, with two teams of nine players each. It is very popular in countries such as the United States, Japan and Cuba.","'Tennis' is a sport played between two players or two teams of two players. It is played with a racket and a ball, and the objective is to hit the ball so that it passes over a net and lands in the opposing field.","'Athletics' covers a number of disciplines such as running, jumping and throwing. It is one of the oldest sports and is practiced in competitions at the Olympic Games.","'Swimming' is another ancient sport that is practiced in pools or open water. Swimmers compete in different styles such as freestyle, backstroke, breaststroke and butterfly.","'American football' is very popular in the United States, where teams fight to advance the ball across the field while preventing the opposing team from doing so.","'Cycling' is a sport that can be practiced on the road, mountain or track, and is known for major events such as the Tour de France.","'Boxing' is a combat sport in which two participants face each other using gloves and fight in a ring. It is a popular sport in many parts of the world, especially in Latin America and the USA.","'Rugby' is a team sport originated in England, in which two teams compete to get the ball into the opponent's goal area, without using a round ball as in soccer."]},{"tag":"futbol_es","patterns":["Háblame de fútbol","¿Cuáles son los mejores equipos de fútbol?","¿Qué competiciones de fútbol existen?","¿Quiénes son los jugadores más famosos del fútbol?","¿Cuál es la historia del fútbol?"],"responses":["El fútbol es el deporte más popular del mundo, jugado en equipos de 11 jugadores. El objetivo es marcar más goles que el equipo contrario en un campo rectangular con dos porterías.","Algunos de los equipos más destacados en la historia del fútbol son: 'Real Madrid': Considerado uno de los clubes más grandes y exitosos del mundo, con numerosas victorias en la Liga de Campeones de la UEFA y La Liga.","'FC Barcelona': Otro gigante del fútbol español, conocido por su estilo de juego tiki-taka y por ser el club que ha visto a leyendas como Lionel Messi.","'Manchester United': Uno de los clubes más exitosos en la historia del fútbol inglés, con múltiples títulos de la Premier League y la Liga de Campeones de la UEFA.","'Bayern Munich': El club más exitoso de Alemania, con una gran cantidad de títulos nacionales e internacionales.","'Juventus': Un club de fútbol italiano con una gran tradición en la Serie A y en competiciones internacionales.","'Paris Saint-Germain (PSG)': Un equipo francés que ha crecido rápidamente en popularidad y éxito gracias a la inversión de grandes figuras como Neymar y Messi.","Las competiciones más importantes en el fútbol incluyen: 'La Copa del Mundo de la FIFA': El torneo internacional más prestigioso, jugado cada cuatro años, donde compiten selecciones nacionales de todo el mundo.","'La Liga de Campeones de la UEFA': La competición de clubes más importante de Europa, que reúne a los mejores equipos de fútbol del continente.","'La Copa América': El torneo de selecciones más importante de América Latina, que reúne a países de la región.","'La Copa Africana de Naciones': El torneo más importante de fútbol de selecciones en África.","'La Premier League': La liga de fútbol más famosa de Inglaterra, conocida por su alta competitividad.","'La Liga': La liga española, que ha sido hogar de jugadores legendarios como Cristiano Ronaldo, Lionel Messi y muchos otros.","'Serie A': La liga de fútbol profesional de Italia, famosa por equipos como Juventus, AC Milan e Inter de Milán.","Algunos de los jugadores más famosos en la historia del fútbol incluyen: 'Pelé': Considerado uno de los mejores futbolistas de todos los tiempos, quien ganó tres Copas del Mundo con Brasil.","'Diego Maradona': Famoso por su habilidad y su famoso gol de la 'Mano de Dios' en la Copa del Mundo de 1986.","'Lionel Messi': Considerado por muchos como uno de los mejores jugadores de todos los tiempos, ganador de múltiples Balones de Oro.","'Cristiano Ronaldo': Otro de los grandes futbolistas de la historia, conocido por su increíble capacidad física y sus logros con equipos como el Manchester United, Real Madrid y Juventus.","'Zinedine Zidane': Famoso por su clase en el campo y por su éxito como entrenador del Real Madrid.","'Neymar': Uno de los futbolistas más talentosos de la generación actual, conocido por su habilidad técnica y su paso por el Barcelona y el PSG."]},{"tag":"futbol_en","patterns":["Tell me about football","What are the best football teams?","What football competitions are there?","Who are the most famous football players?","What is the history of football?"],"responses":["Football is the most popular sport in the world, played in teams of 11 players. The objective is to score more goals than the opposing team on a rectangular field with two goals.","Some of the most notable teams in football history are: 'Real Madrid': Considered one of the biggest and most successful clubs in the world, with numerous UEFA Champions League and La Liga victories.","'FC Barcelona': Another giant of Spanish football, known for its tiki-taka style of play and for being the club that has seen legends such as Lionel Messi.","'Manchester United': One of the most successful clubs in English football history, with multiple Premier League and UEFA Champions League titles.","'Bayern Munich': The most successful club in Germany, with a wealth of national and international titles.","'Juventus': An Italian football club with a great tradition in Serie A and international competitions.","'Paris Saint-Germain (PSG)': A French team that has grown rapidly in popularity and success thanks to the investment of big names like Neymar and Messi.","The most important competitions in football include: 'FIFA World Cup': The most prestigious international tournament, played every four years, where national teams from around the world compete.","'UEFA Champions League': The most important club competition in Europe, bringing together the best football teams on the continent.","'Copa America': The most important national team tournament in Latin America, bringing together countries from the region.","'Africa Cup of Nations': The most important national team football tournament in Africa.","'Premier League': The most famous football league in England, known for its high competitiveness.","'La Liga': The Spanish league, which has been home to legendary players like Cristiano Ronaldo, Lionel Messi and many others.","'Serie A': The professional football league in Italy, famous for teams like Juventus, AC Milan, and Inter Milan.","Some of the most famous players in football history include: 'Pelé': Considered one of the greatest footballers of all time, who won three World Cups with Brazil.","'Diego Maradona': Famous for his skill and his famous 'Hand of God' goal at the 1986 World Cup.","'Lionel Messi': Considered by many to be one of the greatest players of all time, winner of multiple Ballon d'Or awards.","'Cristiano Ronaldo': Another of the great footballers in history, known for his incredible physical ability and his achievements with teams like Manchester United, Real Madrid, and Juventus.","'Zinedine Zidane': Famous for his class on the field and for his success as manager of Real Madrid.","'Neymar': One of the most talented footballers of the current generation, known for his technical ability and his time with Barcelona and PSG."]},{"tag":"soccer_es","patterns":["Háblame de fútbol","¿Cuáles son los mejores equipos de fútbol?","¿Qué competiciones de fútbol existen?","¿Quiénes son los jugadores más famosos del fútbol?","¿Cuál es la historia del fútbol?"],"responses":["El fútbol es el deporte más popular del mundo, jugado en equipos de 11 jugadores. El objetivo es marcar más goles que el equipo contrario en un campo rectangular con dos porterías.","Algunos de los equipos más destacados en la historia del fútbol son: 'Real Madrid': Considerado uno de los clubes más grandes y exitosos del mundo, con numerosas victorias en la Liga de Campeones de la UEFA y La Liga.","'FC Barcelona': Otro gigante del fútbol español, conocido por su estilo de juego tiki-taka y por ser el club que ha visto a leyendas como Lionel Messi.","'Manchester United': Uno de los clubes más exitosos en la historia del fútbol inglés, con múltiples títulos de la Premier League y la Liga de Campeones de la UEFA.","'Bayern Munich': El club más exitoso de Alemania, con una gran cantidad de títulos nacionales e internacionales.","'Juventus': Un club de fútbol italiano con una gran tradición en la Serie A y en competiciones internacionales.","'Paris Saint-Germain (PSG)': Un equipo francés que ha crecido rápidamente en popularidad y éxito gracias a la inversión de grandes figuras como Neymar y Messi.","Las competiciones más importantes en el fútbol incluyen: 'La Copa del Mundo de la FIFA': El torneo internacional más prestigioso, jugado cada cuatro años, donde compiten selecciones nacionales de todo el mundo.","'La Liga de Campeones de la UEFA': La competición de clubes más importante de Europa, que reúne a los mejores equipos de fútbol del continente.","'La Copa América': El torneo de selecciones más importante de América Latina, que reúne a países de la región.","'La Copa Africana de Naciones': El torneo más importante de fútbol de selecciones en África.","'La Premier League': La liga de fútbol más famosa de Inglaterra, conocida por su alta competitividad.","'La Liga': La liga española, que ha sido hogar de jugadores legendarios como Cristiano Ronaldo, Lionel Messi y muchos otros.","'Serie A': La liga de fútbol profesional de Italia, famosa por equipos como Juventus, AC Milan e Inter de Milán.","Algunos de los jugadores más famosos en la historia del fútbol incluyen: 'Pelé': Considerado uno de los mejores futbolistas de todos los tiempos, quien ganó tres Copas del Mundo con Brasil.","'Diego Maradona': Famoso por su habilidad y su famoso gol de la 'Mano de Dios' en la Copa del Mundo de 1986.","'Lionel Messi': Considerado por muchos como uno de los mejores jugadores de todos los tiempos, ganador de múltiples Balones de Oro.","'Cristiano Ronaldo': Otro de los grandes futbolistas de la historia, conocido por su increíble capacidad física y sus logros con equipos como el Manchester United, Real Madrid y Juventus.","'Zinedine Zidane': Famoso por su clase en el campo y por su éxito como entrenador del Real Madrid.","'Neymar': Uno de los futbolistas más talentosos de la generación actual, conocido por su habilidad técnica y su paso por el Barcelona y el PSG."]},{"tag":"soccer_en","patterns":["Tell me about football","What are the best football teams?","What football competitions are there?","Who are the most famous football players?","What is the history of football?"],"responses":["Football is the most popular sport in the world, played in teams of 11 players. The objective is to score more goals than the opposing team on a rectangular field with two goals.","Some of the most notable teams in football history are: 'Real Madrid': Considered one of the biggest and most successful clubs in the world, with numerous UEFA Champions League and La Liga victories.","'FC Barcelona': Another giant of Spanish football, known for its tiki-taka style of play and for being the club that has seen legends such as Lionel Messi.","'Manchester United': One of the most successful clubs in English football history, with multiple Premier League and UEFA Champions League titles.","'Bayern Munich': The most successful club in Germany, with a wealth of national and international titles.","'Juventus': An Italian football club with a great tradition in Serie A and international competitions.","'Paris Saint-Germain (PSG)': A French team that has grown rapidly in popularity and success thanks to the investment of big names like Neymar and Messi.","The most important competitions in football include: 'FIFA World Cup': The most prestigious international tournament, played every four years, where national teams from around the world compete.","'UEFA Champions League': The most important club competition in Europe, bringing together the best football teams on the continent.","'Copa America': The most important national team tournament in Latin America, bringing together countries from the region.","'Africa Cup of Nations': The most important national team football tournament in Africa.","'Premier League': The most famous football league in England, known for its high competitiveness.","'La Liga': The Spanish league, which has been home to legendary players like Cristiano Ronaldo, Lionel Messi and many others.","'Serie A': The professional football league in Italy, famous for teams like Juventus, AC Milan, and Inter Milan.","Some of the most famous players in football history include: 'Pelé': Considered one of the greatest footballers of all time, who won three World Cups with Brazil.","'Diego Maradona': Famous for his skill and his famous 'Hand of God' goal at the 1986 World Cup.","'Lionel Messi': Considered by many to be one of the greatest players of all time, winner of multiple Ballon d'Or awards.","'Cristiano Ronaldo': Another of the great footballers in history, known for his incredible physical ability and his achievements with teams like Manchester United, Real Madrid, and Juventus.","'Zinedine Zidane': Famous for his class on the field and for his success as manager of Real Madrid.","'Neymar': One of the most talented footballers of the current generation, known for his technical ability and his time with Barcelona and PSG."]},{"tag":"animal_es","patterns":["Háblame de animales","¿Cuáles son los animales más peligrosos?","¿Qué animales viven en la selva?","¿Cuáles son los animales más grandes del mundo?","¿Cuáles son los animales marinos más interesantes?"],"responses":["Los animales son seres vivos que habitan en diversos ecosistemas, y existen miles de especies en todo el mundo. Aquí tienes algunos ejemplos de animales populares y sus características: 'León': El león es conocido como el 'rey de la selva'. Es un gran felino que vive en las sabanas de África y es conocido por su melena y su poderosa caza en manada.","'Elefante': Los elefantes son los mamíferos terrestres más grandes. Tienen una memoria increíble y son conocidos por su inteligencia y su trompa.","'Ballena Azul': Este es el animal más grande del planeta, con una longitud de hasta 30 metros. Las ballenas azules viven en los océanos y se alimentan principalmente de kril.","'Cocodrilo': Los cocodrilos son reptiles que viven en ríos, lagos y pantanos. Son conocidos por su tamaño y su feroz naturaleza, siendo uno de los depredadores más antiguos de la Tierra.","'Águila': Las águilas son aves rapaces que se encuentran en todo el mundo. Son famosas por su aguda visión y su capacidad para cazar presas desde grandes alturas.","'Jirafa': La jirafa es el animal terrestre más alto del mundo, conocida por su largo cuello y su capacidad para comer hojas altas de los árboles en la sabana africana.","'Panda': Los pandas son conocidos por su apariencia adorable, pero también son animales muy fuertes. Se alimentan principalmente de bambú y viven en las montañas de China.","'Tigre': El tigre es otro gran felino que habita en Asia. Es famoso por sus rayas y su agilidad en la caza.","'Cebra': Las cebras son animales sociales que viven en grupos llamados manadas. Son conocidas por sus rayas blancas y negras que las hacen únicas entre los herbívoros.","'Koala': El koala es un marsupial que vive en los árboles de eucalipto en Australia. Son conocidos por su aspecto tierno y por pasar la mayor parte de su vida durmiendo.","'Delfín': Los delfines son mamíferos marinos que viven en los océanos. Son conocidos por su inteligencia y su naturaleza juguetona.","Los animales tienen diferentes hábitats según su especie, como la selva, la sabana, los océanos y las montañas. También algunos, como los camellos, están adaptados para vivir en lugares áridos como el desierto."]},{"tag":"animal_en","patterns":["Tell me about animals","What are the most dangerous animals?","What animals live in the jungle?","What are the largest animals in the world?","What are the most interesting marine animals?"],"responses":["Animals are living beings that inhabit diverse ecosystems, and there are thousands of species around the world. Here are some examples of popular animals and their characteristics: 'Lion': The lion is known as the 'king of the jungle'. It is a large cat that lives in the savannahs of Africa and is known for its mane and powerful pack hunting.","'Elephant': Elephants are the largest land mammals. They have incredible memory and are known for their intelligence and trunk.","'Blue Whale': This is the largest animal on the planet, reaching up to 30 meters in length. Blue whales live in the oceans and feed primarily on krill.","'Crocodile': Crocodiles are reptiles that live in rivers, lakes, and swamps. They are known for their size and ferocious nature, being one of the oldest predators on Earth.","'Eagle': Eagles are birds of prey found all over the world. They are famous for their keen vision and ability to hunt prey from great heights.","'Giraffe': The giraffe is the tallest land animal in the world, known for its long neck and ability to eat leaves high up in the trees of the African savannah.","'Panda': Pandas are known for their adorable appearance, but they are also very strong animals. They feed primarily on bamboo and live in the mountains of China.","'Tiger': The tiger is another big cat that lives in Asia. It is famous for its stripes and agility in hunting.","'Zebra': Zebras are social animals that live in groups called herds. They are known for their black and white stripes that make them unique among herbivores.","'Koala': The koala is a marsupial that lives in eucalyptus trees in Australia. They are known for their cute appearance and for spending most of their lives sleeping.","'Dolphin': Dolphins are marine mammals that live in the oceans. They are known for their intelligence and playful nature.","Animals have different habitats depending on their species, such as the jungle, the savannah, the oceans and the mountains. Some, like camels, are also adapted to live in arid places like the desert."]},{"tag":"computadora_es","patterns":["Háblame de computadoras","¿Cuáles son los componentes principales de una computadora?","¿Qué tipos de computadoras existen?","¿Cuál es la historia de las computadoras?","¿Cuáles son las computadoras más potentes del mundo?"],"responses":["Las computadoras son máquinas electrónicas que procesan datos y realizan cálculos de manera rápida y precisa. Están compuestas por varios componentes esenciales: 'CPU (Unidad Central de Procesamiento)': La CPU es el cerebro de la computadora, responsable de ejecutar las instrucciones de los programas y coordinar las operaciones del sistema.","'Memoria RAM (Memoria de Acceso Aleatorio)': La RAM es la memoria temporal que la computadora utiliza para almacenar datos y programas que se están ejecutando en el momento.","'Disco duro (HDD) o unidad de estado sólido (SSD)': Son los dispositivos de almacenamiento donde se guardan los datos y programas. Los SSD son más rápidos que los HDD.","'Placa base (Motherboard)': La placa base es la tarjeta principal que conecta todos los componentes de la computadora, permitiendo que se comuniquen entre sí.","'Tarjeta gráfica (GPU)': La GPU es responsable de procesar los gráficos y las imágenes en una computadora, especialmente importante para juegos y aplicaciones de diseño gráfico.","'Fuente de alimentación': La fuente de alimentación convierte la corriente eléctrica para que pueda ser utilizada por la computadora.","Existen varios tipos de computadoras, que varían en tamaño, capacidad y uso:","'Computadoras de escritorio': Son las computadoras tradicionales, que suelen tener un monitor, una torre y periféricos como teclado y ratón. Son populares para el uso doméstico y oficinas.","'Portátiles': Son computadoras compactas y portátiles, que incluyen una pantalla y un teclado integrados. Las laptops y las ultrabooks son ejemplos comunes.","'Supercomputadoras': Son las computadoras más potentes del mundo, utilizadas para tareas de alto rendimiento, como la investigación científica y el modelado climático. Ejemplos incluyen la 'Fugaku' en Japón.","'Tabletas': Son dispositivos móviles que combinan la funcionalidad de una computadora con la portabilidad de un teléfono inteligente. Funcionan con pantallas táctiles y son populares para navegar por Internet y ver videos.","'Estaciones de trabajo': Son computadoras diseñadas para tareas profesionales de alto rendimiento, como diseño gráfico, modelado 3D y programación de software.","'Computadoras embebidas': Son sistemas computacionales dedicados a realizar tareas específicas, como en automóviles, electrodomésticos y dispositivos electrónicos.","La historia de las computadoras comenzó con las primeras máquinas de calcular, como la máquina analítica de Charles Babbage. Sin embargo, las computadoras modernas comenzaron a tomar forma en el siglo XX: La 'ENIAC' (Electronic Numerical Integrator and Computer), desarrollada en la década de 1940, fue una de las primeras computadoras electrónicas de propósito general.","La evolución de los microprocesadores en la década de 1970 permitió la creación de computadoras personales como la 'Apple I' y la 'Commodore PET', que trajeron las computadoras a los hogares y oficinas.","En los últimos años, las computadoras han evolucionado con la aparición de la inteligencia artificial, la computación cuántica y avances en la miniaturización de los componentes.","Las computadoras más potentes del mundo se utilizan para tareas complejas como simulaciones científicas, inteligencia artificial y predicción meteorológica. Un ejemplo es la 'Fugaku', que se considera la supercomputadora más rápida del mundo."]},{"tag":"computadora_en","patterns":["Tell me about computers","What are the main components of a computer?","What types of computers are there?","What is the history of computers?","What are the most powerful computers in the world?"],"responses":["Computers are electronic machines that process data and perform calculations quickly and accurately. They are made up of several essential components: 'CPU (Central Processing Unit)': The CPU is the brain of the computer, responsible for executing program instructions and coordinating system operations.","'RAM (Random Access Memory)': RAM is the temporary memory that the computer uses to store data and programs that are currently running.","'Hard disk (HDD) or solid state drive (SSD)': These are the storage devices where data and programs are stored. SSDs are faster than HDDs.","'Motherboard': The motherboard is the main card that connects all the components of the computer, allowing them to communicate with each other.","'Graphics card (GPU)': The GPU is responsible for processing graphics and images on a computer, especially important for games and graphic design applications.","'Source of 'Power supply': The power supply converts electrical current so that it can be used by the computer.","There are several types of computers, varying in size, capacity, and use:","'Desktop computers': These are traditional computers, typically featuring a monitor, a case, and peripherals such as a keyboard and mouse. They are popular for home and office use.","'Notebooks': These are compact, portable computers, featuring a built-in display and keyboard. Laptops and ultrabooks are common examples.","'Supercomputers': These are the world's most powerful computers, used for high-performance tasks such as scientific research and climate modeling. Examples include the 'Fugaku' in Japan.","'Tablets': These are mobile devices that combine the functionality of a computer with the portability of a smartphone. They operate with touch screens and are popular for surfing the Internet and watching videos.","'Workstations': These are computers designed for high-performance professional tasks, such as graphic design, 3D modeling, and software programming.","'Embedded computers': These are computer systems dedicated to performing specific tasks, such as in automobiles, household appliances, and electronic devices.","The history of computers began with the first calculating machines, such as Charles Babbage's Analytical Engine. However, modern computers began to take shape in the 20th century: The 'ENIAC' (Electronic Numerical Integrator and Computer), developed in the 1940s, was one of the first general-purpose electronic computers.","The evolution of microprocessors in the 1970s allowed the creation of personal computers such as the 'Apple I' and the 'Commodore PET', which brought computers into homes and offices.","In recent years, computers have evolved with the emergence of artificial intelligence, quantum computing, and advances in the miniaturization of components.","The most powerful computers in the world are used for complex tasks such as scientific simulations, artificial intelligence, and weather prediction. One example is the 'Fugaku', which is considered the fastest supercomputer in the world."]},{"tag":"computer_es","patterns":["Háblame de computadoras","¿Cuáles son los componentes principales de una computadora?","¿Qué tipos de computadoras existen?","¿Cuál es la historia de las computadoras?","¿Cuáles son las computadoras más potentes del mundo?"],"responses":["Las computadoras son máquinas electrónicas que procesan datos y realizan cálculos de manera rápida y precisa. Están compuestas por varios componentes esenciales: 'CPU (Unidad Central de Procesamiento)': La CPU es el cerebro de la computadora, responsable de ejecutar las instrucciones de los programas y coordinar las operaciones del sistema.","'Memoria RAM (Memoria de Acceso Aleatorio)': La RAM es la memoria temporal que la computadora utiliza para almacenar datos y programas que se están ejecutando en el momento.","'Disco duro (HDD) o unidad de estado sólido (SSD)': Son los dispositivos de almacenamiento donde se guardan los datos y programas. Los SSD son más rápidos que los HDD.","'Placa base (Motherboard)': La placa base es la tarjeta principal que conecta todos los componentes de la computadora, permitiendo que se comuniquen entre sí.","'Tarjeta gráfica (GPU)': La GPU es responsable de procesar los gráficos y las imágenes en una computadora, especialmente importante para juegos y aplicaciones de diseño gráfico.","'Fuente de alimentación': La fuente de alimentación convierte la corriente eléctrica para que pueda ser utilizada por la computadora.","Existen varios tipos de computadoras, que varían en tamaño, capacidad y uso:","'Computadoras de escritorio': Son las computadoras tradicionales, que suelen tener un monitor, una torre y periféricos como teclado y ratón. Son populares para el uso doméstico y oficinas.","'Portátiles': Son computadoras compactas y portátiles, que incluyen una pantalla y un teclado integrados. Las laptops y las ultrabooks son ejemplos comunes.","'Supercomputadoras': Son las computadoras más potentes del mundo, utilizadas para tareas de alto rendimiento, como la investigación científica y el modelado climático. Ejemplos incluyen la 'Fugaku' en Japón.","'Tabletas': Son dispositivos móviles que combinan la funcionalidad de una computadora con la portabilidad de un teléfono inteligente. Funcionan con pantallas táctiles y son populares para navegar por Internet y ver videos.","'Estaciones de trabajo': Son computadoras diseñadas para tareas profesionales de alto rendimiento, como diseño gráfico, modelado 3D y programación de software.","'Computadoras embebidas': Son sistemas computacionales dedicados a realizar tareas específicas, como en automóviles, electrodomésticos y dispositivos electrónicos.","La historia de las computadoras comenzó con las primeras máquinas de calcular, como la máquina analítica de Charles Babbage. Sin embargo, las computadoras modernas comenzaron a tomar forma en el siglo XX: La 'ENIAC' (Electronic Numerical Integrator and Computer), desarrollada en la década de 1940, fue una de las primeras computadoras electrónicas de propósito general.","La evolución de los microprocesadores en la década de 1970 permitió la creación de computadoras personales como la 'Apple I' y la 'Commodore PET', que trajeron las computadoras a los hogares y oficinas.","En los últimos años, las computadoras han evolucionado con la aparición de la inteligencia artificial, la computación cuántica y avances en la miniaturización de los componentes.","Las computadoras más potentes del mundo se utilizan para tareas complejas como simulaciones científicas, inteligencia artificial y predicción meteorológica. Un ejemplo es la 'Fugaku', que se considera la supercomputadora más rápida del mundo."]},{"tag":"computer_en","patterns":["Tell me about computers","What are the main components of a computer?","What types of computers are there?","What is the history of computers?","What are the most powerful computers in the world?"],"responses":["Computers are electronic machines that process data and perform calculations quickly and accurately. They are made up of several essential components: 'CPU (Central Processing Unit)': The CPU is the brain of the computer, responsible for executing program instructions and coordinating system operations.","'RAM (Random Access Memory)': RAM is the temporary memory that the computer uses to store data and programs that are currently running.","'Hard disk (HDD) or solid state drive (SSD)': These are the storage devices where data and programs are stored. SSDs are faster than HDDs.","'Motherboard': The motherboard is the main card that connects all the components of the computer, allowing them to communicate with each other.","'Graphics card (GPU)': The GPU is responsible for processing graphics and images on a computer, especially important for games and graphic design applications.","'Source of 'Power supply': The power supply converts electrical current so that it can be used by the computer.","There are several types of computers, varying in size, capacity, and use:","'Desktop computers': These are traditional computers, typically featuring a monitor, a case, and peripherals such as a keyboard and mouse. They are popular for home and office use.","'Notebooks': These are compact, portable computers, featuring a built-in display and keyboard. Laptops and ultrabooks are common examples.","'Supercomputers': These are the world's most powerful computers, used for high-performance tasks such as scientific research and climate modeling. Examples include the 'Fugaku' in Japan.","'Tablets': These are mobile devices that combine the functionality of a computer with the portability of a smartphone. They operate with touch screens and are popular for surfing the Internet and watching videos.","'Workstations': These are computers designed for high-performance professional tasks, such as graphic design, 3D modeling, and software programming.","'Embedded computers': These are computer systems dedicated to performing specific tasks, such as in automobiles, household appliances, and electronic devices.","The history of computers began with the first calculating machines, such as Charles Babbage's Analytical Engine. However, modern computers began to take shape in the 20th century: The 'ENIAC' (Electronic Numerical Integrator and Computer), developed in the 1940s, was one of the first general-purpose electronic computers.","The evolution of microprocessors in the 1970s allowed the creation of personal computers such as the 'Apple I' and the 'Commodore PET', which brought computers into homes and offices.","In recent years, computers have evolved with the emergence of artificial intelligence, quantum computing, and advances in the miniaturization of components.","The most powerful computers in the world are used for complex tasks such as scientific simulations, artificial intelligence, and weather prediction. One example is the 'Fugaku', which is considered the fastest supercomputer in the world."]},{"tag":"idioma_es","patterns":["Háblame de idiomas","¿Cuáles son los idiomas más hablados del mundo?","¿Cuántos idiomas existen en el mundo?","¿Cuál es el idioma más difícil de aprender?","¿Cuáles son los idiomas más populares para aprender?"],"responses":["Los idiomas son sistemas de comunicación compuestos por palabras, signos o símbolos que las personas utilizan para intercambiar ideas. Existen miles de idiomas en todo el mundo, cada uno con su propia estructura y características.","'Mandarín': Es el idioma más hablado del mundo, con más de mil millones de hablantes, principalmente en China, Taiwán y Singapur.","'Español': El español es el segundo idioma más hablado, con aproximadamente 460 millones de hablantes nativos, especialmente en países de América Latina y España.","'Inglés': Aunque tiene menos hablantes nativos que el español, el inglés es el idioma más hablado a nivel global debido a su papel como lengua internacional en negocios, ciencia y cultura. Tiene más de 370 millones de hablantes nativos.","'Hindi': El hindi es hablado por más de 340 millones de personas, principalmente en la India y en algunas zonas de Pakistán.","'Árabe': El árabe es hablado por más de 310 millones de personas en países de África y Medio Oriente.","'Francés': El francés es hablado por aproximadamente 280 millones de personas en varios países, y es una lengua oficial en muchas organizaciones internacionales.","'Ruso': El ruso tiene alrededor de 260 millones de hablantes, principalmente en Rusia y en países de la antigua Unión Soviética.","En total, se estima que hay más de 7,000 idiomas diferentes en el mundo, aunque muchos están en peligro de extinción debido a la globalización y la adopción de idiomas más dominantes.","La dificultad de aprender un idioma depende de varios factores, como la similitud con el idioma nativo, la gramática, la pronunciación y la disponibilidad de recursos para aprenderlo. Algunos idiomas que son comúnmente considerados difíciles incluyen:","'Chino Mandarín': Debido a su sistema de escritura logográfico y sus tonos, el mandarín es considerado uno de los idiomas más difíciles para los hablantes nativos de idiomas indoeuropeos.","'Árabe': El árabe es complejo debido a su escritura de derecha a izquierda, su gramática compleja y sus sonidos únicos.","'Japonés': El japonés tiene tres sistemas de escritura (hiragana, katakana y kanji) y una gramática que difiere mucho de la de los idiomas occidentales.","Algunos de los idiomas más populares para aprender incluyen:","'Inglés': Debido a su uso global y su importancia en el mundo de los negocios, la ciencia y la tecnología.","'Español': Como el segundo idioma más hablado, el español es popular entre quienes buscan aprender un idioma con muchos hablantes nativos.","'Francés': Es un idioma muy solicitado por su importancia cultural, histórica y económica, especialmente en Europa y África.","'Alemán': Como idioma de la economía europea, el alemán es útil para aquellos interesados en trabajar o estudiar en países de habla alemana.","'Mandarín': El mandarín está ganando popularidad debido al crecimiento económico de China y la influencia cultural que tiene en el mundo.","Cada idioma tiene su propio conjunto de reglas y estructuras, lo que lo hace único y fascinante para quienes se aventuran en su aprendizaje. El dominio de varios idiomas puede abrir muchas puertas, tanto a nivel profesional como personal."]},{"tag":"idioma_en","patterns":["Tell me about languages","What are the most spoken languages ​​in the world?","How many languages ​​are there in the world?","What is the most difficult language to learn?","What are the most popular languages ​​to learn?"],"responses":["Languages ​​are communication systems made up of words, signs, or symbols that people use to exchange ideas. There are thousands of languages ​​around the world, each with its own structure and characteristics.","'Mandarin': It is the most widely spoken language in the world, with over a billion speakers, mainly in China, Taiwan, and Singapore.","'Spanish': Spanish is the second most widely spoken language, with approximately 460 million native speakers, especially in Latin American countries and Spain.","'English': Although it has fewer native speakers than Spanish, English is the most widely spoken language globally due to its role as an international language in business, science, and culture. It has over 370 million native speakers.","'Hindi': Hindi is spoken by over 340 million people, mainly in India and parts of Pakistan.","'Arabic': Arabic is spoken by over 310 million people in countries in Africa and the Middle East.","'French': French is spoken by approximately 280 million people in several countries, and is an official language in many international organizations.","'Russian': Russian has around 260 million speakers, mainly in Russia and countries of the former Soviet Union.","In total, it is estimated that there are more than 7,000 different languages ​​in the world, although many are in danger of extinction due to globalization and the adoption of more dominant languages.","The difficulty of learning a language depends on several factors, such as similarity to the native language, grammar, pronunciation, and the availability of resources to learn it. Some languages ​​that are commonly considered difficult include:","'Mandarin Chinese': Due to its logographic writing system and tones, Mandarin is considered one of the most difficult languages ​​for native speakers of Indo-European languages.","'Arabic': Arabic is complex due to its right-to-left script, complex grammar, and unique sounds.","'Japanese': Japanese has three writing systems (hiragana, katakana, and kanji) and grammar that differs greatly from that of Western languages.","Some of the most popular languages ​​to learn include:","'English': Due to its global use and importance in the world of business, science, and technology.","'Spanish': As the second most widely spoken language, Spanish is popular among those looking to learn a language with many native speakers.","'French': It is a highly sought-after language due to its cultural, historical, and economic importance, especially in Europe and Africa.","'German': As the language of the European economy, German is useful for those interested in working or studying in German-speaking countries.","'Mandarin': Mandarin is gaining popularity due to China's economic growth and the cultural influence it has on the world.","Each language has its own set of rules and structures, making it unique and fascinating for those who venture into learning it. Mastery of multiple languages ​​can open many doors, both professionally and personally."]},{"tag":"languag_es","patterns":["Háblame de idiomas","¿Cuáles son los idiomas más hablados del mundo?","¿Cuántos idiomas existen en el mundo?","¿Cuál es el idioma más difícil de aprender?","¿Cuáles son los idiomas más populares para aprender?"],"responses":["Los idiomas son sistemas de comunicación compuestos por palabras, signos o símbolos que las personas utilizan para intercambiar ideas. Existen miles de idiomas en todo el mundo, cada uno con su propia estructura y características.","'Mandarín': Es el idioma más hablado del mundo, con más de mil millones de hablantes, principalmente en China, Taiwán y Singapur.","'Español': El español es el segundo idioma más hablado, con aproximadamente 460 millones de hablantes nativos, especialmente en países de América Latina y España.","'Inglés': Aunque tiene menos hablantes nativos que el español, el inglés es el idioma más hablado a nivel global debido a su papel como lengua internacional en negocios, ciencia y cultura. Tiene más de 370 millones de hablantes nativos.","'Hindi': El hindi es hablado por más de 340 millones de personas, principalmente en la India y en algunas zonas de Pakistán.","'Árabe': El árabe es hablado por más de 310 millones de personas en países de África y Medio Oriente.","'Francés': El francés es hablado por aproximadamente 280 millones de personas en varios países, y es una lengua oficial en muchas organizaciones internacionales.","'Ruso': El ruso tiene alrededor de 260 millones de hablantes, principalmente en Rusia y en países de la antigua Unión Soviética.","En total, se estima que hay más de 7,000 idiomas diferentes en el mundo, aunque muchos están en peligro de extinción debido a la globalización y la adopción de idiomas más dominantes.","La dificultad de aprender un idioma depende de varios factores, como la similitud con el idioma nativo, la gramática, la pronunciación y la disponibilidad de recursos para aprenderlo. Algunos idiomas que son comúnmente considerados difíciles incluyen:","'Chino Mandarín': Debido a su sistema de escritura logográfico y sus tonos, el mandarín es considerado uno de los idiomas más difíciles para los hablantes nativos de idiomas indoeuropeos.","'Árabe': El árabe es complejo debido a su escritura de derecha a izquierda, su gramática compleja y sus sonidos únicos.","'Japonés': El japonés tiene tres sistemas de escritura (hiragana, katakana y kanji) y una gramática que difiere mucho de la de los idiomas occidentales.","Algunos de los idiomas más populares para aprender incluyen:","'Inglés': Debido a su uso global y su importancia en el mundo de los negocios, la ciencia y la tecnología.","'Español': Como el segundo idioma más hablado, el español es popular entre quienes buscan aprender un idioma con muchos hablantes nativos.","'Francés': Es un idioma muy solicitado por su importancia cultural, histórica y económica, especialmente en Europa y África.","'Alemán': Como idioma de la economía europea, el alemán es útil para aquellos interesados en trabajar o estudiar en países de habla alemana.","'Mandarín': El mandarín está ganando popularidad debido al crecimiento económico de China y la influencia cultural que tiene en el mundo.","Cada idioma tiene su propio conjunto de reglas y estructuras, lo que lo hace único y fascinante para quienes se aventuran en su aprendizaje. El dominio de varios idiomas puede abrir muchas puertas, tanto a nivel profesional como personal."]},{"tag":"languag_en","patterns":["Tell me about languages","What are the most spoken languages ​​in the world?","How many languages ​​are there in the world?","What is the most difficult language to learn?","What are the most popular languages ​​to learn?"],"responses":["Languages ​​are communication systems made up of words, signs, or symbols that people use to exchange ideas. There are thousands of languages ​​around the world, each with its own structure and characteristics.","'Mandarin': It is the most widely spoken language in the world, with over a billion speakers, mainly in China, Taiwan, and Singapore.","'Spanish': Spanish is the second most widely spoken language, with approximately 460 million native speakers, especially in Latin American countries and Spain.","'English': Although it has fewer native speakers than Spanish, English is the most widely spoken language globally due to its role as an international language in business, science, and culture. It has over 370 million native speakers.","'Hindi': Hindi is spoken by over 340 million people, mainly in India and parts of Pakistan.","'Arabic': Arabic is spoken by over 310 million people in countries in Africa and the Middle East.","'French': French is spoken by approximately 280 million people in several countries, and is an official language in many international organizations.","'Russian': Russian has around 260 million speakers, mainly in Russia and countries of the former Soviet Union.","In total, it is estimated that there are more than 7,000 different languages ​​in the world, although many are in danger of extinction due to globalization and the adoption of more dominant languages.","The difficulty of learning a language depends on several factors, such as similarity to the native language, grammar, pronunciation, and the availability of resources to learn it. Some languages ​​that are commonly considered difficult include:","'Mandarin Chinese': Due to its logographic writing system and tones, Mandarin is considered one of the most difficult languages ​​for native speakers of Indo-European languages.","'Arabic': Arabic is complex due to its right-to-left script, complex grammar, and unique sounds.","'Japanese': Japanese has three writing systems (hiragana, katakana, and kanji) and grammar that differs greatly from that of Western languages.","Some of the most popular languages ​​to learn include:","'English': Due to its global use and importance in the world of business, science, and technology.","'Spanish': As the second most widely spoken language, Spanish is popular among those looking to learn a language with many native speakers.","'French': It is a highly sought-after language due to its cultural, historical, and economic importance, especially in Europe and Africa.","'German': As the language of the European economy, German is useful for those interested in working or studying in German-speaking countries.","'Mandarin': Mandarin is gaining popularity due to China's economic growth and the cultural influence it has on the world.","Each language has its own set of rules and structures, making it unique and fascinating for those who venture into learning it. Mastery of multiple languages ​​can open many doors, both professionally and personally."]}]`),jE={intents:Wte},HE=n=>n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s]/gi,"").split(" "),Vte=n=>{const e=[],t=[],s=[];n.intents.forEach(d=>{d.patterns.forEach(h=>{const p=HE(h);e.push(...p),s.push({input:p,output:d.tag})}),t.includes(d.tag)||t.push(d.tag)});const r=[...new Set(e)].reduce((d,h,p)=>({...d,[h]:p+1}),{}),i=20,a=s.map(d=>d.input.map(h=>r[h]||0).concat(new Array(i).fill(0)).slice(0,i)),u=s.map(d=>{const h=t.indexOf(d.output),p=Array(t.length).fill(0);return p[h]=1,p});return{inputs:a,outputs:u,vocab:r,labels:t,maxInputLength:i}},{inputs:Ute,outputs:Gte,vocab:jte,labels:qE,maxInputLength:Oy}=Vte(jE),sl=oV();sl.add(f1({inputShape:[Oy],units:16,activation:"relu"}));sl.add(f1({units:16,activation:"relu"}));sl.add(f1({units:qE.length,activation:"softmax"}));sl.compile({optimizer:"adam",loss:"categoricalCrossentropy",metrics:["accuracy"]});let qg=!1;const Hte=async()=>{if(qg){console.warn("El modelo ya está en proceso de entrenamiento.");return}qg=!0;try{const n=Sa(Ute),e=Sa(Gte);console.log("Entrenando el modelo..."),await sl.fit(n,e,{epochs:1e3,batchSize:8}),console.log("Modelo entrenado")}catch(n){console.error("Error durante el entrenamiento:",n)}finally{qg=!1}},qte=async n=>{const t=HE(n).map(h=>jte[h]||0).concat(new Array(Oy).fill(0)).slice(0,Oy),s=Sa([t]),o=sl.predict(s),r=await o.data(),i=o.argMax(-1).dataSync()[0],a=Math.max(...r);if(console.log("Probabilidades:",r),a<.5)return"Lo siento, no estoy seguro de entenderte. ¿Puedes reformular tu pregunta?";const u=qE[i],d=jE.intents.find(h=>h.tag===u);if(d){const h=Math.floor(Math.random()*d.responses.length);return d.responses[h]}return"No estoy seguro, ¿puedes hacer otra pregunta?"};function Kte(){const[n,e]=ue.useState(""),[t,s]=ue.useState([]),[o,r]=ue.useState(!1),[i,a]=ue.useState(!1),u=async d=>{if(d.preventDefault(),n){s(h=>[...h,{texto:n,usuario:!0}]);try{const h=await qte(n);s(p=>[...p,{texto:h,usuario:!1}])}catch(h){console.error("Error al obtener la respuesta del bot:",h),s(p=>[...p,{texto:"Ocurrió un error al procesar tu mensaje.",usuario:!1}])}e("")}};return ue.useEffect(()=>{(async()=>{a(!0);try{await Hte(),r(!0)}catch(h){console.error("Error al entrenar el modelo:",h)}a(!1)})()},[]),oe.jsxs(fu,{className:"chat-container",children:[oe.jsx(gh,{className:"flex-grow-1",children:oe.jsx(eu,{children:oe.jsx(Fw,{children:oe.jsx(Fw.Body,{className:"card-body",children:oe.jsxs("div",{children:[o&&oe.jsx("div",{className:"alert alert-success",role:"alert",children:"El modelo está entrenado y listo para usarse."}),i&&oe.jsx("div",{className:"alert alert-info",role:"alert",children:"El modelo se está entrenando, por favor espera..."}),t.map((d,h)=>oe.jsxs("div",{className:`d-flex ${d.usuario?"justify-content-end":"justify-content-start"}`,children:[oe.jsx("img",{src:d.usuario?OF:LF,alt:"Avatar",className:"chat-avatar animated-avatar"}),oe.jsx("div",{className:`message-bubble ${d.usuario?"bg-primary":"bg-light"} animated-message`,children:d.texto})]},h))]})})})})}),oe.jsx(gh,{children:oe.jsx(eu,{children:oe.jsxs("div",{className:"d-flex align-items-center",children:[oe.jsx(tF.Control,{type:"text",placeholder:"Escribe un mensaje...",value:n,onChange:d=>e(d.target.value),style:{flex:1}}),oe.jsx(fo,{variant:"link",onClick:u,style:{marginLeft:"10px"},disabled:!o,children:oe.jsx("img",{src:MF,alt:"Enviar",className:"send-icon"})})]})})})]})}const Xte="https://zenthic22.github.io/IA1_Proyecto_11/assets/F2%20-%20Manual%20tecnico-DPQnkI4i.pdf",Yte="https://zenthic22.github.io/IA1_Proyecto_11/assets/F2%20-%20Manual%20usuario-CQt3lY0K.pdf",Qte="https://zenthic22.github.io/IA1_Proyecto_11/assets/social-Bgs5ejdz.png",Jte="https://zenthic22.github.io/IA1_Proyecto_11/assets/manual-usuario-4yaHrR3p.png",Zte="https://zenthic22.github.io/IA1_Proyecto_11/assets/manual-tecnico-BunwLdvI.png";function ene(){return oe.jsx(fu,{className:"info-container",children:oe.jsx(gh,{className:"justify-content-center",children:oe.jsxs(eu,{xs:12,sm:10,md:8,lg:8,children:[oe.jsx("div",{className:"info-box",children:oe.jsx("h2",{children:"Integrantes del Grupo - 11"})}),oe.jsxs(FF,{striped:!0,bordered:!0,hover:!0,className:"info-table",children:[oe.jsx("thead",{children:oe.jsxs("tr",{children:[oe.jsx("th",{children:"Nombre"}),oe.jsx("th",{children:"Carnet"})]})}),oe.jsxs("tbody",{children:[oe.jsxs("tr",{children:[oe.jsx("td",{children:"Erick Abdul Chacon Barillas"}),oe.jsx("td",{children:"201807169"})]}),oe.jsxs("tr",{children:[oe.jsx("td",{children:"Nataly Saraí Guzmán Duarte"}),oe.jsx("td",{children:"202001570"})]}),oe.jsxs("tr",{children:[oe.jsx("td",{children:"Ana Belén Contreras Orozco"}),oe.jsx("td",{children:"201901604"})]})]})]}),oe.jsxs("div",{className:"button-container",children:[oe.jsx(fo,{variant:"link",href:"https://github.com/zenthic22/IA1_Proyecto_11",target:"_blank",className:"info-button left",children:oe.jsx("img",{src:Qte,alt:"Repositorio",className:"button-img"})}),oe.jsx(fo,{variant:"link",href:Xte,download:!0,className:"info-button center",children:oe.jsx("img",{src:Jte,alt:"Manual Usuario",className:"button-img"})}),oe.jsx(fo,{variant:"link",href:Yte,download:!0,className:"info-button right",children:oe.jsx("img",{src:Zte,alt:"Manual Técnico",className:"button-img"})})]})]})})})}const tne="https://zenthic22.github.io/IA1_Proyecto_11/assets/cuadricula-9mV_gMdr.png",nne="https://zenthic22.github.io/IA1_Proyecto_11/assets/chat-qk_PSEm9.png",sne="https://zenthic22.github.io/IA1_Proyecto_11/assets/theme-DFa1ZnGm.png",one="https://zenthic22.github.io/IA1_Proyecto_11/assets/info-CUbyHVIZ.png",rne="https://zenthic22.github.io/IA1_Proyecto_11/assets/flecha-qQTEqp_B.png";function ine(){const[n,e]=ue.useState("bienvenida"),[t,s]=ue.useState("light"),[o,r]=ue.useState(!1),i=()=>{const f=t==="light"?"dark":"light";s(f),document.body.classList.remove("light","dark"),document.body.classList.add(f)},a=()=>r(!0),u=()=>r(!1),d=()=>{e("chatbot"),r(!1)},h=()=>{e("informacion"),r(!1)},p=()=>{e("bienvenida")};return oe.jsxs(fu,{className:"d-flex flex-column justify-content-center align-items-center",style:{maxWidth:"500px",maxHeight:"90vh",padding:"20px",marginTop:"50px"},children:[oe.jsx(fo,{variant:"link",onClick:a,style:{position:"absolute",top:"10px",left:"10px",padding:0,border:"none"},children:oe.jsx("img",{src:tne,alt:"Menú",style:{width:"40px",height:"40px"}})}),n!=="bienvenida"&&oe.jsx(fo,{variant:"link",onClick:p,style:{position:"absolute",top:"10px",right:"10px",padding:0,border:"none"},children:oe.jsx("img",{src:rne,alt:"Regresar",style:{width:"40px",height:"40px"}})}),oe.jsxs(Ud,{show:o,onHide:u,children:[oe.jsx(Ud.Header,{closeButton:!0,children:oe.jsx(Ud.Title,{children:"Menú Principal"})}),oe.jsx(Ud.Body,{children:oe.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[oe.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[oe.jsx("img",{src:nne,alt:"Ir al Chat",style:{width:"30px",height:"30px"}}),oe.jsx(fo,{variant:"link",onClick:d,style:{textDecoration:"none",color:"inherit"},children:"Ir al Chat"})]}),oe.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[oe.jsx("img",{src:sne,alt:"Cambiar Tema",style:{width:"30px",height:"30px"}}),oe.jsxs(fo,{variant:"link",onClick:i,style:{textDecoration:"none",color:"inherit"},children:["Cambiar a ",t==="light"?"Oscuro":"Claro"]})]}),oe.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[oe.jsx("img",{src:one,alt:"Información",style:{width:"30px",height:"30px"}}),oe.jsx(fo,{variant:"link",onClick:h,style:{textDecoration:"none",color:"inherit"},children:"Información"})]})]})})]}),n==="bienvenida"&&oe.jsx(_F,{}),n==="chatbot"&&oe.jsx(Kte,{}),n==="informacion"&&oe.jsx(ene,{})]})}QA.createRoot(document.getElementById("root")).render(oe.jsx(ue.StrictMode,{children:oe.jsx(ine,{})}));
